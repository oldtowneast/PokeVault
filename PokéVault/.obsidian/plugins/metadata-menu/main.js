/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __defProp = Object.defineProperty;
var __defProps = Object.defineProperties;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropDescs = Object.getOwnPropertyDescriptors;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __getOwnPropSymbols = Object.getOwnPropertySymbols;
var __getProtoOf = Object.getPrototypeOf;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __propIsEnum = Object.prototype.propertyIsEnumerable;
var __reflectGet = Reflect.get;
var __defNormalProp = (obj, key, value) => key in obj ? __defProp(obj, key, { enumerable: true, configurable: true, writable: true, value }) : obj[key] = value;
var __spreadValues = (a, b) => {
  for (var prop in b || (b = {}))
    if (__hasOwnProp.call(b, prop))
      __defNormalProp(a, prop, b[prop]);
  if (__getOwnPropSymbols)
    for (var prop of __getOwnPropSymbols(b)) {
      if (__propIsEnum.call(b, prop))
        __defNormalProp(a, prop, b[prop]);
    }
  return a;
};
var __spreadProps = (a, b) => __defProps(a, __getOwnPropDescs(b));
var __objRest = (source, exclude) => {
  var target = {};
  for (var prop in source)
    if (__hasOwnProp.call(source, prop) && exclude.indexOf(prop) < 0)
      target[prop] = source[prop];
  if (source != null && __getOwnPropSymbols)
    for (var prop of __getOwnPropSymbols(source)) {
      if (exclude.indexOf(prop) < 0 && __propIsEnum.call(source, prop))
        target[prop] = source[prop];
    }
  return target;
};
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);
var __superGet = (cls, obj, key) => __reflectGet(__getProtoOf(cls), key, obj);
var __async = (__this, __arguments, generator) => {
  return new Promise((resolve, reject) => {
    var fulfilled = (value) => {
      try {
        step(generator.next(value));
      } catch (e) {
        reject(e);
      }
    };
    var rejected = (value) => {
      try {
        step(generator.throw(value));
      } catch (e) {
        reject(e);
      }
    };
    var step = (x) => x.done ? resolve(x.value) : Promise.resolve(x.value).then(fulfilled, rejected);
    step((generator = generator.apply(__this, __arguments)).next());
  });
};

// main.ts
var main_exports = {};
__export(main_exports, {
  default: () => MetadataMenu
});
module.exports = __toCommonJS(main_exports);
var import_obsidian46 = require("obsidian");

// src/fields/fieldManagers/InputField.ts
var import_obsidian9 = require("obsidian");

// src/optionModals/fields/InputModal.ts
var import_obsidian3 = require("obsidian");

// src/commands/insertValues.ts
var import_obsidian = require("obsidian");
function insertValues(plugin, fileOrFilePath, fieldName, value, lineNumber, inFrontmatter, after = true) {
  return __async(this, null, function* () {
    var _a;
    let file;
    if (fileOrFilePath instanceof import_obsidian.TFile) {
      file = fileOrFilePath;
    } else {
      const _file = plugin.app.vault.getAbstractFileByPath(fileOrFilePath);
      if (_file instanceof import_obsidian.TFile && _file.extension == "md") {
        file = _file;
      } else {
        throw Error("path doesn't correspond to a proper file");
      }
    }
    const result = yield plugin.app.vault.read(file);
    let newContent = [];
    result.split("\n").forEach((line, _lineNumber) => {
      if (_lineNumber == lineNumber) {
        if (after)
          newContent.push(line);
        newContent.push(`${fieldName}${inFrontmatter ? ":" : "::"} ${value}`);
        if (!after)
          newContent.push(line);
      } else {
        newContent.push(line);
      }
    });
    yield plugin.app.vault.modify(file, newContent.join("\n"));
    const editor = (_a = plugin.app.workspace.getActiveViewOfType(import_obsidian.MarkdownView)) == null ? void 0 : _a.editor;
    if (editor) {
      const lineNumber2 = editor.getCursor().line;
      editor.setCursor({ line: editor.getCursor().line, ch: editor.getLine(lineNumber2).length });
    }
  });
}

// src/commands/replaceValues.ts
var import_obsidian2 = require("obsidian");

// src/types/lookupTypes.ts
var BuiltinSummarizing = /* @__PURE__ */ ((BuiltinSummarizing2) => {
  BuiltinSummarizing2["Sum"] = "Sum";
  BuiltinSummarizing2["Count"] = "Count";
  BuiltinSummarizing2["CountAll"] = "CountAll";
  BuiltinSummarizing2["Average"] = "Average";
  BuiltinSummarizing2["Max"] = "Max";
  BuiltinSummarizing2["Min"] = "Min";
  return BuiltinSummarizing2;
})(BuiltinSummarizing || {});
var BuiltinSummarizingFunctionDescription = {
  "Sum": "Returns the sum of <{{summarizedFieldName}}> fields in the pages matching the query",
  "Count": "Counts all pages matching the query where <{{summarizedFieldName}}> is non empty",
  "CountAll": "Counts all pages matching the query (including empty fields)",
  "Average": "Returns the average value of <{{summarizedFieldName}}> fields in the pages matching the query",
  "Max": "Returns the maximum value of <{{summarizedFieldName}}> fields in the pages matching the query",
  "Min": "Returns the minimum value of <{{summarizedFieldName}}> fields in the pages matching the query"
};
var BuiltinSummarizingFunction = {
  "Sum": 'const i=0;const sum = pages.reduce((p, c) => p + c["{{summarizedFieldName}}"], i); return sum',
  "CountAll": "return pages.length",
  "Count": 'return pages.filter(p => !!p["{{summarizedFieldName}}"]).length',
  "Average": 'const i=0.0;const sum = pages.reduce((p, c) => p + c["{{summarizedFieldName}}"], i); return sum / pages.length',
  "Max": 'return pages.reduce((p,c) => p["{{summarizedFieldName}}"] >= c["{{summarizedFieldName}}"] ? p : c)["{{summarizedFieldName}}"]',
  "Min": 'return pages.reduce((p,c) => p["{{summarizedFieldName}}"]!==null && p["{{summarizedFieldName}}"] <= c["{{summarizedFieldName}}"] ? p : c)["{{summarizedFieldName}}"]'
};
var Type = /* @__PURE__ */ ((Type3) => {
  Type3["LinksList"] = "LinksList";
  Type3["LinksBulletList"] = "LinksBulletList";
  Type3["BuiltinSummarizing"] = "BuiltinSummarizing";
  Type3["CustomList"] = "CustomList";
  Type3["CustomBulletList"] = "CustomBulletList";
  Type3["CustomSummarizing"] = "CustomSummarizing";
  return Type3;
})(Type || {});
var ShortDescription = {
  "LinksList": "Inline list of links",
  "LinksBulletList": "Bullet list of links",
  "BuiltinSummarizing": "",
  "CustomList": "Inline list of customized links",
  "CustomBulletList": "Bullet list of customized links",
  "CustomSummarizing": "Custom summarizing function"
};
var Description = {
  "LinksList": "List of related links displayed inline",
  "LinksBulletList": "List of related links displayed below the field",
  "BuiltinSummarizing": "Built-in summarizing function",
  "CustomList": "Custom list rendering function displayed inline",
  "CustomBulletList": "Custom list rendering function displayed below the field",
  "CustomSummarizing": "Custom summarizing function"
};
var OptionLabel = {
  "LinksList": "",
  "LinksBulletList": "",
  "BuiltinSummarizing": "Built-in summarize function:",
  "CustomList": "Query's results' list's rendering function:",
  "CustomBulletList": "Query's results' list's rendering function:",
  "CustomSummarizing": "Query's results' list's summarizing function:"
};
var OptionSubLabel = {
  "LinksList": "",
  "LinksBulletList": "",
  "BuiltinSummarizing": "",
  "CustomList": `function(page) { return <function using "page">; }`,
  "CustomBulletList": `function(page) { return <function using "page">; }`,
  "CustomSummarizing": `function(page) { return <function using "page">; }`
};
var Helper = {
  "LinksList": "",
  "LinksBulletList": "",
  "BuiltinSummarizing": "",
  "CustomList": 'Javascript string, the "page" (dataview page type) variable is available\nexample 1: page.file.name\nexample 2: `${page.file.name} of gender ${page.gender}`',
  "CustomBulletList": 'Javascript string, the "page" (dataview page type) variable is available\nexample 1: page.file.name\nexample 2: `${page.file.name} of gender ${page.gender}`',
  "CustomSummarizing": 'Javascript string, the "pages" (dataview pages type) variable is available\nexample: \nconst initialValue = 0;\nconst sumWithInitial = pages.reduce(\n    (previousValue, currentValue) => previousValue + currentValue,\n    initialValue\n);\nreturn `${sumWithInitial}`\n'
};
var Default = {
  "LinksList": "",
  "LinksBulletList": "",
  "BuiltinSummarizing": "Count" /* Count */,
  "CustomList": "page.file.name",
  "CustomBulletList": "page.file.name",
  "CustomSummarizing": "return pages.length"
};
var bulletListLookupTypes = [
  "LinksBulletList" /* LinksBulletList */,
  "CustomBulletList" /* CustomBulletList */
];

// src/utils/list.ts
function getListBounds(plugin, file, parent) {
  var _a;
  const listItems = ((_a = plugin.app.metadataCache.getFileCache(file)) == null ? void 0 : _a.listItems) || [];
  return getListBoundsFromListItemCacheList(listItems, parent);
}
function getListBoundsFromListItemCacheList(listItems, parent) {
  const subParentsLines = [-parent - 1];
  let start2 = parent;
  let end2 = -1;
  let outOfList = false;
  listItems.sort((a, b) => a.position.start.line - b.position.start.line).forEach((listItem) => {
    if (subParentsLines.includes(listItem.parent) && !outOfList) {
      subParentsLines.push(listItem.position.start.line);
      if (start2 > listItem.position.start.line)
        start2 = listItem.position.start.line;
      if (end2 <= listItem.position.end.line) {
        if (listItem.position.end.line == listItem.position.start.line) {
          end2 = listItem.position.end.line;
        } else {
          end2 = listItem.position.start.line;
          outOfList = true;
        }
      }
    }
  });
  if (end2 >= 0) {
    return { start: start2, end: end2 };
  }
  return;
}

// src/utils/parser.ts
var fieldComponents = ["inQuote", "inList", "startStyle", "attribute", "endStyle", "beforeSeparatorSpacer", "afterSeparatorSpacer", "values"];
var genericFieldRegex = "(?<inQuote>>(\\s+)?)?(?<inList>- )?(?<startStyle>[_\\*~`]*)(?<attribute>[0-9\\w\\p{Letter}\\p{Emoji_Presentation}][-0-9\\w\\p{Letter}\\p{Emoji_Presentation}\\s]*)(?<endStyle>[_\\*~`]*)(?<beforeSeparatorSpacer>\\s*)";
var inlineFieldRegex = (attribute) => `(?<inQuote>>(\\s+)?)?(?<inList>- )?(?<startStyle>[_\\*~\`]*)(?<attribute>${attribute})(?<endStyle>[_\\*~\`]*)(?<beforeSeparatorSpacer>\\s*)::(?<afterSeparatorSpacer>\\s*)`;
var fullLineRegex = new RegExp(`^${genericFieldRegex}::\\s*(?<values>.*)?`, "u");
var inSentenceRegexBrackets = new RegExp(`\\[${genericFieldRegex}::\\s*(?<values>[^\\]]+)?\\]`, "gu");
var inSentenceRegexPar = new RegExp(`\\(${genericFieldRegex}::\\s*(?<values>[^\\)]+)?\\)`, "gu");
var encodeLink = (value) => {
  return value ? value.replace(/\[\[/g, "\u{1F527}\u{1F400}").replace(/\]\]/g, "\u{1F413}\u{1F54C}") : value;
};
var decodeLink = (value) => {
  return value ? value.replace(/ðŸ”§ðŸ€/gu, "[[").replace(/ðŸ“ðŸ•Œ/gu, "]]") : value;
};
var frontMatterLineField = (line) => {
  const frontMatterRegex = new RegExp(new RegExp("(?<attribute>[0-9\\w\\p{Letter}\\p{Emoji_Presentation}][-0-9\\w\\p{Letter}\\p{Emoji_Presentation}\\s]*[^\\s])(?<beforeSeparatorSpacer>\\s*):(?<afterSeparatorSpacer>\\s*)(?<values>.*)", "u"));
  const fR = line.match(frontMatterRegex);
  if (fR == null ? void 0 : fR.groups) {
    const { attribute, values } = fR == null ? void 0 : fR.groups;
    return attribute;
  }
};
var getLineFields = (line) => {
  const fields = [];
  const fR = line.match(fullLineRegex);
  if (fR == null ? void 0 : fR.groups) {
    const { attribute, values } = fR == null ? void 0 : fR.groups;
    fields.push({ attribute, values, index: 0, length: line.length });
  } else {
    const sRBk = encodeLink(line).matchAll(inSentenceRegexBrackets);
    let next = sRBk.next();
    while (!next.done) {
      if (next.value.groups) {
        const { attribute, values } = next.value.groups;
        fields.push({ attribute, values: decodeLink(values), index: next.value.index || 0, length: next.value[0].length });
      }
      next = sRBk.next();
    }
    const sRBc = encodeLink(line).matchAll(inSentenceRegexPar);
    next = sRBc.next();
    while (!next.done) {
      if (next.value.groups) {
        const { attribute, values } = next.value.groups;
        fields.push({ attribute, values: decodeLink(values), index: next.value.index || 0, length: next.value[0].length });
      }
      next = sRBc.next();
    }
  }
  fields.sort((a, b) => {
    if (a.index < b.index)
      return -1;
    if (a.index > b.index)
      return 1;
    return 0;
  });
  return fields;
};

// src/commands/replaceValues.ts
var LocationWrapper = {
  "fullLine": { start: "", end: "" },
  "brackets": { start: "[", end: "]" },
  "parenthesis": { start: "(", end: ")" }
};
var matchInlineFields = (regex, line, attribute, input, location = "fullLine") => {
  const sR = line.matchAll(regex);
  let next = sR.next();
  const newFields = [];
  while (!next.done) {
    const match = next.value;
    if (match.groups && Object.keys(match.groups).every((j) => fieldComponents.includes(j))) {
      const { inList, inQuote, startStyle, endStyle, beforeSeparatorSpacer, afterSeparatorSpacer, values } = match.groups;
      const inputArray = input ? input.replace(/(\,\s+)/g, ",").split(",") : [""];
      const newValue = inputArray.length == 1 ? inputArray[0] : `${inputArray.join(", ")}`;
      const start2 = LocationWrapper[location].start;
      const end2 = LocationWrapper[location].end;
      newFields.push({
        oldField: match[0],
        newField: `${inQuote || ""}${start2}${inList || ""}${startStyle}${attribute}${endStyle}${beforeSeparatorSpacer}::${afterSeparatorSpacer}${newValue}${end2}`
      });
    }
    next = sR.next();
  }
  return newFields;
};
function replaceValues(plugin, fileOrFilePath, attribute, input, previousItemsCount = 0) {
  return __async(this, null, function* () {
    var _a, _b;
    let file;
    if (fileOrFilePath instanceof import_obsidian2.TFile) {
      file = fileOrFilePath;
    } else {
      const _file = plugin.app.vault.getAbstractFileByPath(fileOrFilePath);
      if (_file instanceof import_obsidian2.TFile && _file.extension == "md") {
        file = _file;
      } else {
        throw Error("path doesn't correspond to a proper file");
      }
    }
    const content = (yield plugin.app.vault.cachedRead(file)).split("\n");
    const frontmatter = (_a = plugin.app.metadataCache.getFileCache(file)) == null ? void 0 : _a.frontmatter;
    const skippedLines = [];
    const { position: { start: start2, end: end2 } } = frontmatter ? frontmatter : { position: { start: void 0, end: void 0 } };
    const newContent = content.map((line, i) => {
      var _a2;
      if (start2 && end2 && i >= start2.line && i <= end2.line) {
        const regex = new RegExp(`^${attribute}:`, "u");
        const r = line.match(regex);
        if (r && r.length > 0) {
          const inputArray = input ? input.replace(/(\,\s+)/g, ",").split(",") : [""];
          const newValue = inputArray.length == 1 ? inputArray[0] : `[${inputArray.join(", ")}]`;
          return `${attribute}: ${newValue}`;
        } else {
          return line;
        }
      } else {
        const encodedInput = encodeLink(input);
        let encodedLine = encodeLink(line);
        const fullLineRegex2 = new RegExp(`^${inlineFieldRegex(attribute)}(?<values>[^\\]]*)`, "u");
        const fR = encodedLine.match(fullLineRegex2);
        if ((fR == null ? void 0 : fR.groups) && Object.keys(fR.groups).every((j) => fieldComponents.includes(j))) {
          const field = (_a2 = plugin.fieldIndex.filesFields.get(file.path)) == null ? void 0 : _a2.find((f) => f.name === attribute);
          if ((field == null ? void 0 : field.type) === "Lookup" /* Lookup */) {
            const bounds = getListBounds(plugin, file, i);
            if (bounds) {
              const { start: start3, end: end3 } = bounds;
              for (let j = start3 + 1; j < start3 + previousItemsCount + 1 && j < end3 + 1; j++) {
                skippedLines.push(j);
              }
            }
          }
          const { inList, inQuote, startStyle, endStyle, beforeSeparatorSpacer, afterSeparatorSpacer, values } = fR.groups;
          const inputArray = input ? input.replace(/(\,\s+)/g, ",").split(",").sort() : [];
          let newValue;
          if ((field == null ? void 0 : field.type) === "Lookup" /* Lookup */ && bulletListLookupTypes.includes(field == null ? void 0 : field.options.outputType)) {
            newValue = inputArray.length == 1 ? "\n- " + inputArray[0] : `${inputArray.length > 0 ? "\n" : ""}${inputArray.map((item) => "- " + item).join("\n")}`;
          } else {
            newValue = inputArray.length == 1 ? inputArray[0] : `${inputArray.join(", ")}`;
          }
          return `${inQuote || ""}${inList || ""}${startStyle}${attribute}${endStyle}${beforeSeparatorSpacer}::${afterSeparatorSpacer}${newValue}`;
        } else {
          const newFields = [];
          const inSentenceRegexBrackets2 = new RegExp(`\\[${inlineFieldRegex(attribute)}(?<values>[^\\]]+)?\\]`, "gu");
          const inSentenceRegexPar2 = new RegExp(`\\(${inlineFieldRegex(attribute)}(?<values>[^\\)]+)?\\)`, "gu");
          newFields.push(...matchInlineFields(inSentenceRegexBrackets2, encodedLine, attribute, encodedInput, "brackets" /* brackets */));
          newFields.push(...matchInlineFields(inSentenceRegexPar2, encodedLine, attribute, encodedInput, "parenthesis" /* parenthesis */));
          newFields.forEach((field) => {
            const fieldRegex = new RegExp(field.oldField.replace(/[.*+?^${}()|[\]\\]/g, "\\$&"), "u");
            encodedLine = encodedLine.replace(fieldRegex, field.newField);
          });
          return decodeLink(encodedLine);
        }
      }
    });
    yield plugin.app.vault.modify(file, newContent.filter((line, i) => !skippedLines.includes(i)).join("\n"));
    const editor = (_b = plugin.app.workspace.getActiveViewOfType(import_obsidian2.MarkdownView)) == null ? void 0 : _b.editor;
    if (editor) {
      const lineNumber = editor.getCursor().line;
      editor.setCursor({ line: editor.getCursor().line, ch: editor.getLine(lineNumber).length });
    }
  });
}

// src/optionModals/fields/InputModal.ts
var InputModal = class extends import_obsidian3.Modal {
  constructor(plugin, file, field, value, lineNumber = -1, inFrontmatter = false, after = false) {
    super(plugin.app);
    this.plugin = plugin;
    this.file = file;
    this.field = field;
    this.value = value;
    this.lineNumber = lineNumber;
    this.inFrontmatter = inFrontmatter;
    this.after = after;
    this.templateValues = {};
  }
  onOpen() {
    const inputDiv = this.contentEl.createDiv();
    if (this.field.options.template) {
      const templateFieldRegex = new RegExp(`\\{\\{(?<field>[^\\}]+?)\\}\\}`, "gu");
      const tF = this.field.options.template.matchAll(templateFieldRegex);
      let next = tF.next();
      while (!next.done) {
        if (next.value.groups) {
          const value = next.value.groups.field;
          const [name, optionsString] = value.split(new RegExp(":(.*)", "s")).map((v) => v.trim());
          this.templateValues[name] = "";
          if (optionsString) {
            const options = JSON.parse(optionsString);
            this.buildTemplateSelectItem(inputDiv, name, options);
          } else {
            this.buildTemplateInputItem(inputDiv, name);
          }
        }
        next = tF.next();
      }
      this.buildResultPreview(inputDiv);
      this.buildSaveBtn(inputDiv);
    } else {
      this.buildInputEl(inputDiv);
    }
  }
  renderValue() {
    let renderedString = this.field.options.template.slice();
    Object.keys(this.templateValues).forEach((k) => {
      const fieldRegex = new RegExp(`\\{\\{${k.replace(/[.*+?^${}()|[\]\\]/g, "\\$&")}(:[^\\}]*)?\\}\\}`, "u");
      renderedString = renderedString.replace(fieldRegex, this.templateValues[k]);
    });
    this.renderedValue.setValue(renderedString);
  }
  buildTemplateInputItem(inputDiv, name) {
    inputDiv.createDiv({ text: name, cls: "metadata-menu-input-label" });
    const inputEl = new import_obsidian3.TextComponent(inputDiv);
    inputEl.setPlaceholder(`Enter a value for ${name}`);
    inputEl.inputEl.addClass("metadata-menu-prompt-input");
    inputEl.onChange((value) => {
      this.templateValues[name] = value;
      this.renderValue();
    });
  }
  buildTemplateSelectItem(inputDiv, name, options) {
    inputDiv.createDiv({ text: name, cls: "metadata-menu-input-label" });
    const selectEl = new import_obsidian3.DropdownComponent(inputDiv);
    selectEl.addOption("", "--select--");
    options.forEach((o) => selectEl.addOption(o, o));
    selectEl.onChange((value) => {
      this.templateValues[name] = value;
      this.renderValue();
    });
  }
  buildResultPreview(inputDiv) {
    inputDiv.createEl("hr");
    inputDiv.createDiv({ text: "Result preview", cls: "metadata-menu-input-label" });
    const renderedValueContainer = inputDiv.createDiv();
    this.renderedValue = new import_obsidian3.TextAreaComponent(renderedValueContainer);
    this.renderedValue.inputEl.addClass("metadata-menu-prompt-input");
    this.renderedValue.inputEl.rows = 3;
    this.renderedValue.setValue(this.value);
  }
  buildSaveBtn(inputDiv) {
    inputDiv.createEl("hr");
    const saveBtnContainer = inputDiv.createDiv({ cls: "metadata-menu-textarea-buttons" });
    const saveBtn = saveBtnContainer.createEl("button");
    (0, import_obsidian3.setIcon)(saveBtn, "checkmark");
    saveBtn.onclick = () => __async(this, null, function* () {
      let inputValue = this.renderedValue.getValue();
      if (this.lineNumber == -1) {
        yield this.plugin.fileTaskManager.pushTask(() => {
          replaceValues(this.plugin, this.file, this.field.name, inputValue);
        });
      } else {
        yield this.plugin.fileTaskManager.pushTask(() => {
          insertValues(this.plugin, this.file, this.field.name, inputValue, this.lineNumber, this.inFrontmatter, this.after);
        });
      }
      ;
      this.close();
    });
  }
  buildInputEl(inputDiv) {
    const form = inputDiv.createEl("form");
    form.type = "submit";
    const inputEl = new import_obsidian3.TextComponent(form);
    inputEl.inputEl.focus();
    inputEl.setValue(`${this.value}`);
    inputEl.inputEl.addClass("metadata-menu-prompt-input");
    form.onsubmit = (e) => __async(this, null, function* () {
      e.preventDefault();
      let inputValue = inputEl.getValue();
      if (this.lineNumber == -1) {
        yield this.plugin.fileTaskManager.pushTask(() => {
          replaceValues(this.plugin, this.file, this.field.name, inputValue);
        });
      } else {
        yield this.plugin.fileTaskManager.pushTask(() => {
          insertValues(this.plugin, this.file, this.field.name, inputValue, this.lineNumber, this.inFrontmatter, this.after);
        });
      }
      ;
      this.close();
    });
  }
};

// src/fields/FieldManager.ts
var import_obsidian8 = require("obsidian");

// src/optionModals/insertFieldSuggestModal.ts
var import_obsidian5 = require("obsidian");

// src/optionModals/addNewFieldModal.ts
var import_obsidian4 = require("obsidian");
var addNewFieldModal = class extends import_obsidian4.Modal {
  constructor(plugin, lineNumber, file, inFrontmatter, after) {
    super(plugin.app);
    this.plugin = plugin;
    this.lineNumber = lineNumber;
    this.file = file;
    this.inFrontmatter = inFrontmatter;
    this.after = after;
  }
  onOpen() {
    this.titleEl.setText("Insert new field");
    const addNewFieldContainer = this.contentEl.createDiv();
    const nameInputContainer = addNewFieldContainer.createDiv({ cls: "metadata-menu-prompt-container" });
    nameInputContainer.setText("Field Name: ");
    const nameInputEl = new import_obsidian4.TextComponent(nameInputContainer);
    nameInputEl.inputEl.addClass("metadata-menu-prompt-input");
    nameInputEl.setPlaceholder("Field name");
    const valueInputContainer = addNewFieldContainer.createDiv({ cls: "metadata-menu-prompt-container" });
    valueInputContainer.setText("Field value: ");
    const valueInputEl = new import_obsidian4.TextComponent(valueInputContainer);
    valueInputEl.inputEl.addClass("metadata-menu-prompt-input");
    valueInputEl.setPlaceholder("Field value");
    const footerButtons = this.contentEl.createDiv({
      cls: "metadata-menu-textarea-buttons"
    });
    const saveButton = new import_obsidian4.ButtonComponent(footerButtons);
    saveButton.setIcon("checkmark");
    saveButton.onClick(() => __async(this, null, function* () {
      yield this.plugin.fileTaskManager.pushTask(() => {
        insertValues(this.plugin, this.file, nameInputEl.getValue(), valueInputEl.getValue(), this.lineNumber, this.inFrontmatter, this.after);
      });
      this.close();
    }));
    const cancelButton = new import_obsidian4.ExtraButtonComponent(footerButtons);
    cancelButton.setIcon("cross");
    cancelButton.onClick(() => {
      this.close();
    });
  }
};

// src/optionModals/insertFieldSuggestModal.ts
var InsertFieldSuggestModal = class extends import_obsidian5.FuzzySuggestModal {
  constructor(plugin, file, lineNumber, inFrontmatter, after, fileClass) {
    super(plugin.app);
    this.plugin = plugin;
    this.file = file;
    this.lineNumber = lineNumber;
    this.inFrontmatter = inFrontmatter;
    this.after = after;
    this.fileClass = fileClass;
  }
  getItems() {
    if (this.fileClass) {
      return [{ actionLabel: "++New++" }].concat(this.fileClass.attributes.map((attr) => {
        return { actionLabel: attr.name, type: attr.type };
      }));
    } else {
      return [{ actionLabel: "++New++" }].concat(this.plugin.settings.presetFields.map((setting) => {
        return { actionLabel: setting.name, type: setting.type };
      }));
    }
    ;
  }
  getItemText(item) {
    return item.actionLabel;
  }
  renderSuggestion(item, el) {
    el.addClass("metadata-menu-command-suggest-item");
    const iconContainer = el.createDiv({ cls: "metadata-menu-command-suggest-icon" });
    item.item.type ? (0, import_obsidian5.setIcon)(iconContainer, FieldIcon[item.item.type]) : (0, import_obsidian5.setIcon)(iconContainer, "plus-with-circle");
    el.createDiv({ text: item.item.actionLabel, cls: "metadata-menu-command-suggest-action-label" });
    el.createDiv({ cls: "metadata-menu-command-suggest-spacer" });
    if (item.item.type) {
      const typeContainer = el.createEl("div");
      typeContainer.setAttr("class", `metadata-menu-setting-item-info-type ${FieldTypeTagClass[item.item.type]}`);
      typeContainer.setText(item.item.type);
    }
  }
  onChooseItem(item, evt) {
    if (item.actionLabel === "++New++") {
      const newFieldModal = new addNewFieldModal(this.plugin, this.lineNumber, this.file, this.inFrontmatter, this.after);
      newFieldModal.open();
      this.close();
    } else if (this.fileClass) {
      const fileClassAttributesWithName = this.fileClass.attributes.filter((attr) => attr.name == item.actionLabel);
      let field;
      let type;
      if (fileClassAttributesWithName.length > 0) {
        const fileClassAttribute = fileClassAttributesWithName[0];
        field = fileClassAttribute.getField();
        type = fileClassAttribute.type;
      }
      if (field) {
        const fieldManager = new FieldManager[field.type](this.plugin, field);
        fieldManager.createAndOpenFieldModal(this.file, item.actionLabel, "", this.lineNumber, this.inFrontmatter, this.after);
      }
      this.close();
    } else {
      const field = this.plugin.settings.presetFields.filter((_field) => _field.name == item.actionLabel)[0];
      const fieldManager = new FieldManager[field.type](this.plugin, field);
      fieldManager.createAndOpenFieldModal(this.file, item.actionLabel, "", this.lineNumber, this.inFrontmatter, this.after);
      this.close();
    }
    ;
  }
};

// src/settings/FieldSettingsModal.ts
var import_obsidian7 = require("obsidian");

// src/settings/FieldSetting.ts
var import_obsidian6 = require("obsidian");
var FieldSetting = class extends import_obsidian6.Setting {
  constructor(containerEl, field, plugin) {
    super(containerEl);
    this.containerEl = containerEl;
    this.field = field;
    this.plugin = plugin;
    this.setTextContentWithname();
    this.addEditButton();
    this.addDeleteButton();
  }
  setTextContentWithname() {
    const manager = new FieldManager[this.field.type](this.plugin, this.field);
    this.infoEl.textContent = "";
    this.infoEl.addClass("metadata-menu-setting-item");
    this.fieldNameContainer = this.infoEl.createEl("div", "metadata-menu-setting-item-name");
    this.fieldNameContainer.setText(this.field.name);
    this.typeContainer = this.infoEl.createEl("div");
    this.typeContainer.setAttr("class", `metadata-menu-setting-item-info-type ${FieldTypeTagClass[this.field.type]}`);
    this.typeContainer.setText(this.field.type);
    this.fieldOptionsContainer = this.infoEl.createEl("div");
    this.fieldOptionsContainer.setText(`${manager.getOptionsStr()}`);
  }
  addEditButton() {
    this.addButton((b) => {
      b.setIcon("pencil").setTooltip("Edit").onClick(() => {
        let modal = new FieldSettingsModal(this.plugin, this.containerEl, this, this.field);
        modal.open();
      });
    });
  }
  addDeleteButton() {
    this.addButton((b) => {
      b.setIcon("trash").setTooltip("Delete").onClick(() => {
        var _a;
        const currentExistingProperty = this.plugin.initialProperties.filter((p) => p.id == this.field.id)[0];
        if (currentExistingProperty) {
          this.plugin.initialProperties.remove(currentExistingProperty);
        }
        ;
        (_a = this.settingEl.parentElement) == null ? void 0 : _a.removeChild(this.settingEl);
        this.plugin.saveSettings();
      });
    });
  }
  static getValuesListFromNote(plugin, notePath) {
    return __async(this, null, function* () {
      let values = [];
      const file = plugin.app.vault.getAbstractFileByPath(notePath);
      if (file instanceof import_obsidian6.TFile && file.extension == "md") {
        const result = yield plugin.app.vault.read(file);
        result.split("\n").forEach((line) => {
          if (/^(.*)$/.test(line)) {
            values.push(line.trim());
          }
          ;
        });
        return values;
      } else {
        return [];
      }
      ;
    });
  }
};

// src/settings/FieldSettingsModal.ts
var FieldSettingsModal = class extends import_obsidian7.Modal {
  constructor(plugin, parentSettingContainer, parentSetting, field) {
    super(plugin.app);
    this.plugin = plugin;
    this.parentSettingContainer = parentSettingContainer;
    this.parentSetting = parentSetting;
    this.saved = false;
    this.new = true;
    this.initialField = new Field_default();
    if (field) {
      this.new = false;
      this.field = field;
      Field_default.copyProperty(this.initialField, this.field);
    } else {
      let newId = 1;
      this.plugin.initialProperties.forEach((prop) => {
        if (parseInt(prop.id) && parseInt(prop.id) >= newId) {
          newId = parseInt(prop.id) + 1;
        }
        ;
      });
      this.field = new Field_default();
      this.field.id = newId.toString();
      this.initialField.id = newId.toString();
    }
    ;
    this.fieldManager = new FieldManager[this.field.type](this.plugin, this.field);
  }
  onOpen() {
    return __async(this, null, function* () {
      if (this.field.name == "") {
        this.titleEl.setText(`Add a field and define options`);
      } else {
        this.titleEl.setText(`Manage settings options for ${this.field.name}`);
      }
      ;
      yield this.createForm();
    });
  }
  onClose() {
    Object.assign(this.field, this.initialField);
    if (!this.new && this.parentSetting) {
      this.parentSetting.setTextContentWithname();
    } else if (this.saved) {
      new FieldSetting(this.parentSettingContainer, this.field, this.plugin);
    }
    ;
  }
  createnameInputContainer(parentNode) {
    const fieldNameContainerLabel = parentNode.createDiv();
    fieldNameContainerLabel.setText(`Field Name:`);
    const input = new import_obsidian7.TextComponent(parentNode);
    const name = this.field.name;
    input.setValue(name);
    input.setPlaceholder("Name of the field");
    input.onChange((value) => {
      this.field.name = value;
      this.titleEl.setText(`Manage predefined options for ${this.field.name}`);
      FieldSettingsModal.removeValidationError(input);
    });
    return input;
  }
  createTypeSelectorContainer(parentNode) {
    const typeSelectorContainerLabel = parentNode.createDiv();
    typeSelectorContainerLabel.setText(`Field type:`);
    const select = new import_obsidian7.DropdownComponent(parentNode);
    Object.keys(FieldTypeLabelMapping).forEach((f) => select.addOption(f, FieldTypeTooltip[f]));
    if (this.field.type) {
      select.setValue(this.field.type);
    }
    select.onChange((typeLabel) => {
      this.field = new Field_default();
      Field_default.copyProperty(this.field, this.initialField);
      this.field.name = this.namePromptComponent.getValue();
      this.field.type = FieldTypeLabelMapping[typeLabel];
      if (this.field.type !== this.initialField.type && ![this.field.type, this.initialField.type].every((fieldType) => ["Multi" /* Multi */, "Select" /* Select */, "Cycle" /* Cycle */].includes(fieldType))) {
        this.field.options = {};
      }
      while (this.fieldOptionsContainer.firstChild) {
        this.fieldOptionsContainer.removeChild(this.fieldOptionsContainer.firstChild);
      }
      this.fieldManager = new FieldManager[this.field.type](this.plugin, this.field);
      this.fieldManager.createSettingContainer(this.fieldOptionsContainer, this.plugin, 0 /* PluginSettings */);
    });
  }
  createForm() {
    return __async(this, null, function* () {
      const div = this.contentEl.createDiv({ cls: "metadata-menu-prompt-div" });
      const mainDiv = div.createDiv({ cls: "metadata-menu-prompt-form" });
      const nameContainer = mainDiv.createDiv();
      this.namePromptComponent = this.createnameInputContainer(nameContainer);
      mainDiv.createDiv({ cls: "metadata-menu-separator" }).createEl("hr");
      const typeSelectContainer = mainDiv.createDiv();
      this.fieldOptionsContainer = mainDiv.createDiv();
      const footerEl = this.contentEl.createDiv();
      const footerButtons = new import_obsidian7.Setting(footerEl);
      footerButtons.addButton((b) => this.createSaveButton(b));
      footerButtons.addExtraButton((b) => this.createCancelButton(b));
      this.createTypeSelectorContainer(typeSelectContainer);
      this.fieldManager.createSettingContainer(this.fieldOptionsContainer, this.plugin, 0 /* PluginSettings */);
    });
  }
  validateFields() {
    return this.fieldManager.validateName(this.namePromptComponent, this.namePromptComponent.inputEl) && this.fieldManager.validateOptions();
  }
  createSaveButton(b) {
    b.setTooltip("Save");
    b.setIcon("checkmark");
    b.onClick(() => __async(this, null, function* () {
      var _a;
      let error = !this.validateFields();
      if (error) {
        new import_obsidian7.Notice("Fix errors before saving.");
        return;
      }
      ;
      this.saved = true;
      const currentExistingField = this.plugin.initialProperties.filter((p) => p.id == this.field.id)[0];
      if (currentExistingField) {
        Field_default.copyProperty(currentExistingField, this.field);
      } else {
        this.plugin.initialProperties.push(this.field);
      }
      ;
      Field_default.copyProperty(this.initialField, this.field);
      if (this.parentSetting)
        Field_default.copyProperty(this.parentSetting.field, this.field);
      (_a = this.parentSetting) == null ? void 0 : _a.setTextContentWithname();
      this.plugin.saveSettings();
      this.close();
    }));
    return b;
  }
  createCancelButton(b) {
    b.setIcon("cross").setTooltip("Cancel").onClick(() => {
      this.saved = false;
      if (this.initialField.name != "") {
        Object.assign(this.field, this.initialField);
      }
      ;
      this.close();
    });
    return b;
  }
  static setValidationError(textInput, insertAfter, message) {
    var _a;
    textInput.inputEl.addClass("is-invalid");
    if (message && ((_a = textInput.inputEl.parentElement) == null ? void 0 : _a.lastElementChild)) {
      let mDiv = textInput.inputEl.parentElement.querySelector(".invalid-feedback");
      if (!mDiv) {
        mDiv = createDiv({ cls: "invalid-feedback" });
      }
      mDiv.innerText = message;
      mDiv.insertAfter(insertAfter);
    }
  }
  static removeValidationError(textInput) {
    var _a;
    if (textInput.inputEl.hasClass("is-invalid") && ((_a = textInput.inputEl.parentElement) == null ? void 0 : _a.lastElementChild)) {
      textInput.inputEl.removeClass("is-invalid");
      textInput.inputEl.parentElement.removeChild(textInput.inputEl.parentElement.lastElementChild);
    }
    ;
  }
};

// src/fields/FieldManager.ts
var FieldManager2 = class {
  constructor(plugin, field, type) {
    this.plugin = plugin;
    this.field = field;
    this.type = type;
    if (field.type !== type)
      throw Error(`This field is not of type ${type}`);
  }
  static buildMarkDownLink(plugin, file, path, alias) {
    const destFile = plugin.app.metadataCache.getFirstLinkpathDest(path, file.path);
    if (destFile) {
      return plugin.app.fileManager.generateMarkdownLink(destFile, file.path, void 0, alias);
    }
    return "";
  }
  validateName(textInput, insertAfter) {
    let error = false;
    if (/^[#>-]/.test(this.field.name)) {
      FieldSettingsModal.setValidationError(textInput, insertAfter, "Field name cannot start with #, >, -");
      error = true;
    }
    ;
    if (this.field.name == "") {
      FieldSettingsModal.setValidationError(textInput, insertAfter, "Field name can not be Empty");
      error = true;
    }
    ;
    return !error;
  }
  validateValue(value) {
    return true;
  }
  static replaceValues(plugin, path, fieldName, value) {
    return __async(this, null, function* () {
      const file = plugin.app.vault.getAbstractFileByPath(path);
      if (file instanceof import_obsidian8.TFile && file.extension == "md") {
        yield plugin.fileTaskManager.pushTask(() => {
          replaceValues(plugin, file, fieldName, value);
        });
      }
    });
  }
  static isMenu(location) {
    return location.addItem !== void 0;
  }
  static isSuggest(location) {
    return location.getItems !== void 0;
  }
  static isInsertFieldCommand(location) {
    return location === "InsertFieldCommand";
  }
  static createAndOpenModal(plugin, file, fieldName, field, value, lineNumber, inFrontmatter, after) {
    if (field) {
      const fieldManager = new FieldManager[field.type](plugin, field);
      fieldManager.createAndOpenFieldModal(file, fieldName, value, lineNumber, inFrontmatter, after);
    } else {
      const fieldManager = FieldManager2.createDefault(plugin, fieldName);
      fieldManager.createAndOpenFieldModal(file, fieldName, value, lineNumber, inFrontmatter, after);
    }
  }
  static openFieldModal(plugin, file, fieldName, value, lineNumber, inFrontmatter, after, fileClass) {
    if (!fieldName) {
      const modal = new InsertFieldSuggestModal(plugin, file, lineNumber, inFrontmatter, after, fileClass);
      modal.open();
    } else {
      if (fileClass) {
        const fileClassAttributesWithName = fileClass.attributes.filter((attr) => attr.name == fieldName);
        let field;
        if (fileClassAttributesWithName.length > 0) {
          const fileClassAttribute = fileClassAttributesWithName[0];
          field = fileClassAttribute.getField();
        }
        this.createAndOpenModal(plugin, file, fieldName, field, value, lineNumber, inFrontmatter, after);
      } else {
        const field = plugin.settings.presetFields.filter((_field) => _field.name == fieldName)[0];
        this.createAndOpenModal(plugin, file, fieldName, field, value, lineNumber, inFrontmatter, after);
      }
      ;
    }
  }
  static createDefault(plugin, name) {
    const field = Field_default.createDefault(name);
    return new FieldManager[field.type](plugin, field);
  }
  static stringToBoolean(value) {
    let toBooleanValue = false;
    if (isBoolean(value)) {
      toBooleanValue = value;
    } else if (/true/i.test(value)) {
      toBooleanValue = true;
    } else if (/false/i.test(value)) {
      toBooleanValue = false;
    } else {
      throw Error("this value is not a boolean");
    }
    ;
    return toBooleanValue;
  }
};

// src/fields/fieldManagers/InputField.ts
var InputField = class extends FieldManager2 {
  constructor(plugin, field) {
    super(plugin, field, "Input" /* Input */);
  }
  getOptionsStr() {
    return this.field.options.template;
  }
  addFieldOption(name, value, file, location) {
    const modal = new InputModal(this.plugin, file, this.field, value);
    modal.titleEl.setText(`Change Value for <${name}>`);
    if (InputField.isMenu(location)) {
      location.addItem((item) => {
        item.setTitle(`Update <${name}>`);
        item.setIcon(FieldIcon["Input" /* Input */]);
        item.onClick(() => modal.open());
        item.setSection("metadata-menu.fields");
      });
    } else if (InputField.isSuggest(location)) {
      location.options.push({
        id: `update_${name}`,
        actionLabel: `<span>Update <b>${name}</b></span>`,
        action: () => modal.open(),
        icon: FieldIcon["Input" /* Input */]
      });
    }
    ;
  }
  createSettingContainer(parentContainer, plugin) {
    const templateContainer = parentContainer.createDiv();
    templateContainer.createEl("span", { text: "Template", cls: "metadata-menu-field-option" });
    const templateValue = new import_obsidian9.TextAreaComponent(templateContainer);
    templateValue.inputEl.cols = 50;
    templateValue.inputEl.rows = 4;
    templateValue.setValue(this.field.options.template || "");
    templateValue.onChange((value) => {
      this.field.options.template = value;
    });
  }
  validateOptions() {
    return true;
  }
  createAndOpenFieldModal(file, selectedFieldName, value, lineNumber, inFrontmatter, after) {
    const fieldModal = new InputModal(this.plugin, file, this.field, value || "", lineNumber, inFrontmatter, after);
    fieldModal.titleEl.setText(`Enter value for ${selectedFieldName}`);
    fieldModal.open();
  }
  createDvField(dv, p, fieldContainer, attrs) {
    var _a;
    const fieldValue = dv.el("span", p[this.field.name], attrs);
    const inputContainer = document.createElement("div");
    const input = document.createElement("input");
    input.setAttr("class", "metadata-menu-dv-input");
    inputContainer.appendChild(input);
    input.value = p[this.field.name];
    const spacer = document.createElement("div");
    spacer.setAttr("class", "metadata-menu-dv-field-spacer");
    const button = document.createElement("button");
    (0, import_obsidian9.setIcon)(button, FieldIcon["Input" /* Input */]);
    button.setAttr("class", "metadata-menu-dv-field-button");
    if (!((_a = attrs == null ? void 0 : attrs.options) == null ? void 0 : _a.alwaysOn)) {
      button.hide();
      spacer.show();
      fieldContainer.onmouseover = () => {
        button.show();
        spacer.hide();
      };
      fieldContainer.onmouseout = () => {
        button.hide();
        spacer.show();
      };
    }
    const validateIcon = document.createElement("button");
    (0, import_obsidian9.setIcon)(validateIcon, "checkmark");
    validateIcon.setAttr("class", "metadata-menu-dv-field-button");
    validateIcon.onclick = (e) => {
      InputField.replaceValues(this.plugin, p.file.path, this.field.name, input.value);
      fieldContainer.removeChild(inputContainer);
    };
    inputContainer == null ? void 0 : inputContainer.appendChild(validateIcon);
    const cancelIcon = document.createElement("button");
    cancelIcon.setAttr("class", "metadata-menu-dv-field-button");
    (0, import_obsidian9.setIcon)(cancelIcon, "cross");
    cancelIcon.onclick = (e) => {
      fieldContainer.removeChild(inputContainer);
      fieldContainer.appendChild(button);
      fieldContainer.appendChild(fieldValue);
      fieldContainer.appendChild(spacer);
    };
    inputContainer.appendChild(cancelIcon);
    input.focus();
    input.onkeydown = (e) => {
      if (e.key === "Enter") {
        InputField.replaceValues(this.plugin, p.file.path, this.field.name, input.value);
        fieldContainer.removeChild(inputContainer);
      }
      if (e.key === "Escape") {
        fieldContainer.removeChild(inputContainer);
        fieldContainer.appendChild(button);
        fieldContainer.appendChild(fieldValue);
        fieldContainer.appendChild(spacer);
      }
    };
    button.onclick = (e) => {
      if (this.field.options.template) {
        const file = this.plugin.app.vault.getAbstractFileByPath(p.file.path);
        if (file instanceof import_obsidian9.TFile && file.extension === "md") {
          const inputModal = new InputModal(this.plugin, file, this.field, p[this.field.name]);
          inputModal.open();
        }
      } else {
        fieldContainer.removeChild(fieldValue);
        fieldContainer.removeChild(button);
        fieldContainer.removeChild(spacer);
        fieldContainer.appendChild(inputContainer);
        input.focus();
      }
    };
    fieldContainer.appendChild(button);
    fieldContainer.appendChild(fieldValue);
    fieldContainer.appendChild(spacer);
  }
};

// src/optionModals/fields/BooleanModal.ts
var import_obsidian10 = require("obsidian");
var BooleanModal = class extends import_obsidian10.Modal {
  constructor(plugin, file, field, value, lineNumber = -1, inFrontmatter = false, after = false) {
    super(plugin.app);
    this.plugin = plugin;
    this.file = file;
    this.field = field;
    this.value = value;
    this.lineNumber = lineNumber;
    this.inFrontmatter = inFrontmatter;
    this.after = after;
    this.plugin = plugin;
    this.file = file;
    this.value = value;
    this.lineNumber = lineNumber;
    this.inFrontmatter = inFrontmatter;
    this.after = after;
    this.field = field;
  }
  onOpen() {
    const inputDiv = this.contentEl.createDiv({
      cls: "metadata-menu-toggler"
    });
    this.buildToggleEl(inputDiv);
  }
  buildToggleEl(inputDiv) {
    const toggleEl = new import_obsidian10.ToggleComponent(inputDiv);
    const footer = this.contentEl.createDiv({ cls: "metadata-menu-value-grid-footer" });
    const saveButton = new import_obsidian10.ButtonComponent(footer);
    toggleEl.setValue(this.value);
    toggleEl.onChange((value) => {
      this.value = value;
      saveButton.buttonEl.focus();
    });
    saveButton.setIcon("checkmark");
    saveButton.onClick(() => __async(this, null, function* () {
      const value = this.value.toString();
      if (this.lineNumber == -1) {
        yield this.plugin.fileTaskManager.pushTask(() => {
          replaceValues(this.plugin, this.file, this.field.name, value);
        });
      } else {
        yield this.plugin.fileTaskManager.pushTask(() => {
          insertValues(this.plugin, this.file, this.field.name, value, this.lineNumber, this.inFrontmatter, this.after);
        });
      }
      ;
      this.close();
    }));
  }
};

// src/fields/fieldManagers/BooleanField.ts
var BooleanField = class extends FieldManager2 {
  constructor(plugin, field) {
    super(plugin, field, "Boolean" /* Boolean */);
  }
  addFieldOption(name, value, file, location) {
    const bValue = BooleanField.stringToBoolean(value);
    if (BooleanField.isMenu(location)) {
      location.addItem((item) => {
        item.setTitle(`<${name}> ${bValue ? "\u2705 \u25B7 \u274C" : "\u274C \u25B7 \u2705"}`);
        item.setIcon(FieldIcon["Boolean" /* Boolean */]);
        item.onClick(() => __async(this, null, function* () {
          return yield this.plugin.fileTaskManager.pushTask(() => {
            replaceValues(this.plugin, file, name, (!bValue).toString());
          });
        }));
        item.setSection("metadata-menu.fields");
      });
    } else if (BooleanField.isSuggest(location)) {
      location.options.push({
        id: `update_${name}`,
        actionLabel: `<span><b>${name}</b> ${bValue ? "\u2705 \u25B7 \u274C" : "\u274C \u25B7 \u2705"}</span>`,
        action: () => __async(this, null, function* () {
          return yield this.plugin.fileTaskManager.pushTask(() => {
            replaceValues(this.plugin, file, name, (!bValue).toString());
          });
        }),
        icon: FieldIcon["Boolean" /* Boolean */]
      });
    }
    ;
  }
  getOptionsStr() {
    return "";
  }
  createSettingContainer(parentContainer, plugin) {
  }
  validateValue(value) {
    try {
      const bValue = BooleanField.stringToBoolean(value);
      return isBoolean(bValue);
    } catch (error) {
      return false;
    }
  }
  validateOptions() {
    return true;
  }
  createAndOpenFieldModal(file, selectedFieldName, value, lineNumber, inFrontmatter, after) {
    const bValue = BooleanField.stringToBoolean(value || "false");
    const fieldModal = new BooleanModal(this.plugin, file, this.field, bValue, lineNumber, inFrontmatter, after);
    fieldModal.titleEl.setText(`Set value for ${selectedFieldName}`);
    fieldModal.open();
  }
  createDvField(dv, p, fieldContainer, attrs) {
    const checkbox = dv.el("input", "", __spreadProps(__spreadValues({}, attrs), { "type": "checkbox" }));
    checkbox.checked = p[this.field.name];
    fieldContainer.appendChild(checkbox);
    checkbox.onchange = (value) => {
      BooleanField.replaceValues(this.plugin, p.file.path, this.field.name, checkbox.checked.toString());
    };
  }
};

// src/fields/fieldManagers/NumberField.ts
var import_obsidian12 = require("obsidian");

// src/optionModals/fields/NumberModal.ts
var import_obsidian11 = require("obsidian");
var NumbertModal = class extends import_obsidian11.Modal {
  constructor(plugin, file, field, value, lineNumber = -1, inFrontmatter = false, after = false) {
    super(plugin.app);
    this.plugin = plugin;
    this.file = file;
    this.field = field;
    this.value = value;
    this.lineNumber = lineNumber;
    this.inFrontmatter = inFrontmatter;
    this.after = after;
    this.fieldManager = new FieldManager[this.field.type](this.plugin, this.field);
  }
  onOpen() {
    const inputDiv = this.contentEl.createDiv();
    this.buildInputEl(inputDiv);
  }
  decrement(inputEl) {
    const { step } = this.field.options;
    const fStep = parseFloat(step);
    if (!isNaN(fStep)) {
      inputEl.setValue((parseFloat(inputEl.getValue()) - fStep).toString());
    } else {
      inputEl.setValue((parseFloat(inputEl.getValue()) - 1).toString());
    }
  }
  increment(inputEl) {
    const { step } = this.field.options;
    const fStep = parseFloat(step);
    if (!isNaN(fStep)) {
      inputEl.setValue((parseFloat(inputEl.getValue()) + fStep).toString());
    } else {
      inputEl.setValue((parseFloat(inputEl.getValue()) + 1).toString());
    }
  }
  toggleButtonsState(minusBtn, plusBtn, inputEl) {
    minusBtn.setDisabled(!this.fieldManager.canDecrement(inputEl.getValue()));
    plusBtn.setDisabled(!this.fieldManager.canIncrement(inputEl.getValue()));
    if (this.fieldManager.canDecrement(inputEl.getValue())) {
      minusBtn.setCta();
    } else {
      minusBtn.removeCta();
    }
    if (this.fieldManager.canIncrement(inputEl.getValue())) {
      plusBtn.setCta();
    } else {
      plusBtn.removeCta();
    }
  }
  buildInputEl(inputDiv) {
    const { step } = this.field.options;
    const form = inputDiv.createEl("form");
    form.type = "submit";
    const fieldContainer = form.createEl("div", { cls: "metadata-menu-modal-value-with-btn" });
    const inputEl = new import_obsidian11.TextComponent(fieldContainer);
    inputEl.inputEl.focus();
    inputEl.setValue(`${this.value}`);
    const minusBtn = new import_obsidian11.ButtonComponent(fieldContainer);
    minusBtn.setButtonText(`- ${!!step ? step : 1}`);
    minusBtn.setDisabled(!this.fieldManager.canDecrement(inputEl.getValue()));
    const plusBtn = new import_obsidian11.ButtonComponent(fieldContainer);
    plusBtn.setButtonText(`+ ${!!step ? step : 1}`);
    plusBtn.setDisabled(!this.fieldManager.canIncrement(inputEl.getValue()));
    const errorField = form.createEl("div", { cls: "metadata-menu-modal-value-with-btn-error-field" });
    errorField.hide();
    const footer = form.createEl("div", { cls: "metadata-menu-value-grid-footer" });
    const validateBtn = new import_obsidian11.ButtonComponent(footer);
    validateBtn.setIcon("checkmark");
    const cancelBtn = new import_obsidian11.ButtonComponent(footer);
    cancelBtn.setIcon("cross");
    this.toggleButtonsState(minusBtn, plusBtn, inputEl);
    inputEl.onChange(() => {
      inputEl.inputEl.removeClass("is-invalid");
      errorField.hide();
      errorField.setText("");
      this.toggleButtonsState(minusBtn, plusBtn, inputEl);
    });
    plusBtn.onClick((e) => {
      e.preventDefault();
      this.increment(inputEl);
      this.toggleButtonsState(minusBtn, plusBtn, inputEl);
    });
    minusBtn.onClick((e) => {
      e.preventDefault();
      this.decrement(inputEl);
      this.toggleButtonsState(minusBtn, plusBtn, inputEl);
    });
    cancelBtn.onClick((e) => {
      e.preventDefault();
      this.close();
    });
    form.onsubmit = (e) => __async(this, null, function* () {
      e.preventDefault();
      let inputValue = inputEl.getValue();
      if (!this.fieldManager.validateValue(inputValue)) {
        const { min: min2, max: max2 } = this.field.options;
        errorField.show();
        errorField.setText(`value must be numeric${min2 ? " and >= " + min2 : ""} ${max2 ? " and <= " + max2 : ""}`);
        inputEl.inputEl.setAttr("class", "is-invalid");
        return;
      }
      if (this.lineNumber == -1) {
        yield this.plugin.fileTaskManager.pushTask(() => {
          replaceValues(this.plugin, this.file, this.field.name, inputValue);
        });
      } else {
        yield this.plugin.fileTaskManager.pushTask(() => {
          insertValues(this.plugin, this.file, this.field.name, inputValue, this.lineNumber, this.inFrontmatter, this.after);
        });
      }
      ;
      this.close();
    });
  }
};

// src/fields/fieldManagers/NumberField.ts
var NumberField = class extends FieldManager2 {
  constructor(plugin, field) {
    super(plugin, field, "Number" /* Number */);
  }
  getOptionsStr() {
    const options = [];
    Object.keys(this.field.options).forEach((k) => {
      if (this.field.options[k])
        options.push(`${k}: ${this.field.options[k]}`);
    });
    return options.join(" | ");
  }
  canDecrement(value) {
    const { step, min: min2 } = this.field.options;
    const fStep = parseFloat(step);
    const fMin = parseFloat(min2);
    return !(isNaN(parseFloat(value)) || !isNaN(fMin) && (!isNaN(fStep) && (parseFloat(value) - fStep < fMin || parseFloat(value) - 1 < fMin)));
  }
  canIncrement(value) {
    const { step, max: max2 } = this.field.options;
    const fStep = parseFloat(step);
    const fMax = parseFloat(max2);
    return !(isNaN(parseFloat(value)) || !isNaN(fMax) && (!isNaN(fStep) && (parseFloat(value) + fStep > fMax || parseFloat(value) + 1 > fMax)));
  }
  validateValue(value) {
    const { min: min2, max: max2 } = this.field.options;
    const fMin = parseFloat(min2);
    const fMax = parseFloat(max2);
    const fValue = parseFloat(value);
    return !isNaN(fValue) && (isNaN(fMin) || fValue >= fMin) && (isNaN(fMax) || fValue <= fMax);
  }
  addFieldOption(name, value, file, location) {
    const modal = new NumbertModal(this.plugin, file, this.field, value);
    modal.titleEl.setText(`Change Value for <${name}>`);
    if (NumberField.isMenu(location)) {
      location.addItem((item) => {
        item.setTitle(`Update <${name}>`);
        item.setIcon(FieldIcon["Number" /* Number */]);
        item.onClick(() => modal.open());
        item.setSection("metadata-menu.fields");
      });
      const { min: min2, max: max2, step } = this.field.options;
      const fMin = parseFloat(min2);
      const fMax = parseFloat(max2);
      const fStep = parseFloat(step);
      const fValue = parseFloat(value);
      if (fStep) {
        if (!isNaN(fMin) && fValue - fStep > fMin)
          location.addItem((item) => {
            item.setIcon(FieldIcon["Number" /* Number */]);
            item.setTitle(`<${name}> \u2198\uFE0F ${fValue - fStep}`);
            item.onClick(() => __async(this, null, function* () {
              return yield this.plugin.fileTaskManager.pushTask(() => {
                replaceValues(this.plugin, file, name, (fValue - fStep).toString());
              });
            }));
            item.setSection("metadata-menu.fields");
          });
        if (!isNaN(fMax) && fValue + fStep < fMax)
          location.addItem((item) => {
            item.setIcon(FieldIcon["Number" /* Number */]);
            item.setTitle(`<${name}> \u2197\uFE0F ${fValue + fStep}`);
            item.onClick(() => __async(this, null, function* () {
              return yield this.plugin.fileTaskManager.pushTask(() => {
                replaceValues(this.plugin, file, name, (fValue + fStep).toString());
              });
            }));
            item.setSection("metadata-menu.fields");
          });
      }
    } else if (NumberField.isSuggest(location)) {
      location.options.push({
        id: `update_${name}`,
        actionLabel: `<span>Update <b>${name}</b></span>`,
        action: () => modal.open(),
        icon: FieldIcon["Number" /* Number */]
      });
    }
    ;
  }
  createNumberContainer(parentContainer) {
    const numberStepValueContainer = parentContainer.createDiv();
    numberStepValueContainer.createEl("span", { text: "Step (optional)", cls: "metadata-menu-field-option" });
    this.numberStepValue = new import_obsidian12.TextComponent(numberStepValueContainer);
    this.numberStepValue.setValue(this.field.options.step || "");
    const numberMinValueContainer = parentContainer.createDiv();
    numberMinValueContainer.createEl("span", { text: "Min value (optional)", cls: "metadata-menu-field-option" });
    this.numberMinValue = new import_obsidian12.TextComponent(numberMinValueContainer);
    this.numberMinValue.setValue(this.field.options.min || "");
    const numberMaxValueContainer = parentContainer.createDiv();
    numberMaxValueContainer.createEl("span", { text: "Max value (optional)", cls: "metadata-menu-field-option" });
    this.numberMaxValue = new import_obsidian12.TextComponent(numberMaxValueContainer);
    this.numberMaxValue.setValue(this.field.options.max || "");
    this.numberStepValue.onChange((value) => {
      this.field.options.step = value;
      FieldSettingsModal.removeValidationError(this.numberStepValue);
    });
    this.numberMinValue.onChange((value) => {
      this.field.options.min = value;
      FieldSettingsModal.removeValidationError(this.numberMinValue);
    });
    this.numberMaxValue.onChange((value) => {
      this.field.options.max = value;
      FieldSettingsModal.removeValidationError(this.numberMaxValue);
    });
  }
  createSettingContainer(parentContainer, plugin) {
    this.numberValidatorField = parentContainer.createDiv({ cls: "metadata-menu-number-options" });
    this.createNumberContainer(this.numberValidatorField);
    this.numberValidatorField.createDiv({ cls: "metadata-menu-separator" }).createEl("hr");
  }
  validateOptions() {
    let error = false;
    if (this.field.options.step && isNaN(parseFloat(this.field.options.step))) {
      FieldSettingsModal.setValidationError(this.numberStepValue, this.numberStepValue.inputEl, "Values must be numeric.");
      error = true;
    }
    if (this.field.options.min && isNaN(parseFloat(this.field.options.min))) {
      FieldSettingsModal.setValidationError(this.numberMinValue, this.numberMinValue.inputEl, "Values must be numeric.");
      error = true;
    }
    if (this.field.options.max && isNaN(parseFloat(this.field.options.max))) {
      FieldSettingsModal.setValidationError(this.numberMaxValue, this.numberMaxValue.inputEl, "Values must be numeric.");
      error = true;
    }
    return !error;
  }
  createAndOpenFieldModal(file, selectedFieldName, value, lineNumber, inFrontmatter, after) {
    const fieldModal = new NumbertModal(this.plugin, file, this.field, value || "", lineNumber, inFrontmatter, after);
    fieldModal.titleEl.setText(`Enter value for ${selectedFieldName}`);
    fieldModal.open();
  }
  toggleDvButtons(decrementBtn, incrementBtn, value) {
    if (this.canDecrement(value)) {
      decrementBtn.removeClass("disabled");
    } else {
      decrementBtn.addClass("disabled");
    }
    if (this.canIncrement(value)) {
      incrementBtn.removeClass("disabled");
    } else {
      incrementBtn.addClass("disabled");
      ;
    }
  }
  createDvField(dv, p, fieldContainer, attrs) {
    var _a;
    const fieldValue = dv.el("span", p[this.field.name], attrs);
    const inputContainer = document.createElement("div");
    const input = document.createElement("input");
    input.setAttr("class", "metadata-menu-dv-input");
    inputContainer.appendChild(input);
    input.value = p[this.field.name];
    const tripleSpacer = document.createElement("div");
    tripleSpacer.setAttr("class", "metadata-menu-dv-field-triple-spacer");
    const editButton = document.createElement("button");
    (0, import_obsidian12.setIcon)(editButton, FieldIcon["Number" /* Number */]);
    editButton.setAttr("class", "metadata-menu-dv-field-button");
    const decrementButton = document.createElement("button");
    (0, import_obsidian12.setIcon)(decrementButton, "left-arrow");
    decrementButton.setAttr("class", "metadata-menu-dv-field-button");
    const incrementButton = document.createElement("button");
    (0, import_obsidian12.setIcon)(incrementButton, "right-arrow");
    incrementButton.setAttr("class", "metadata-menu-dv-field-button");
    if (!((_a = attrs == null ? void 0 : attrs.options) == null ? void 0 : _a.alwaysOn)) {
      editButton.hide();
      decrementButton.hide();
      incrementButton.hide();
      tripleSpacer.show();
      fieldContainer.onmouseover = () => {
        editButton.show();
        decrementButton.show();
        incrementButton.show();
        tripleSpacer.hide();
      };
      fieldContainer.onmouseout = () => {
        editButton.hide();
        decrementButton.hide();
        incrementButton.hide();
        tripleSpacer.show();
      };
    }
    const validateIcon = document.createElement("a");
    (0, import_obsidian12.setIcon)(validateIcon, "checkmark");
    validateIcon.setAttr("class", "metadata-menu-dv-field-button");
    validateIcon.onclick = () => __async(this, null, function* () {
      if (this.validateValue(input.value)) {
        const file = this.plugin.app.vault.getAbstractFileByPath(p.file.path);
        if (file instanceof import_obsidian12.TFile && file.extension == "md") {
          yield this.plugin.fileTaskManager.pushTask(() => {
            replaceValues(this.plugin, file, this.field.name, input.value);
          });
          this.toggleDvButtons(decrementButton, incrementButton, input.value);
        }
        fieldContainer.removeChild(inputContainer);
      }
    });
    inputContainer == null ? void 0 : inputContainer.appendChild(validateIcon);
    const cancelIcon = document.createElement("a");
    cancelIcon.setAttr("class", "metadata-menu-dv-field-button");
    (0, import_obsidian12.setIcon)(cancelIcon, "cross");
    cancelIcon.onclick = (e) => {
      fieldContainer.removeChild(inputContainer);
      fieldContainer.appendChild(decrementButton);
      fieldContainer.appendChild(fieldValue);
      fieldContainer.appendChild(editButton);
      fieldContainer.appendChild(incrementButton);
      fieldContainer.appendChild(tripleSpacer);
    };
    inputContainer.appendChild(cancelIcon);
    input.focus();
    input.onkeyup = (e) => {
      if (!this.validateValue(input.value)) {
        input.addClass("is-invalid");
        validateIcon.addClass("disabled");
      } else {
        input.removeClass("is-invalid");
        validateIcon.removeClass("disabled");
      }
    };
    input.onkeydown = (e) => __async(this, null, function* () {
      if (e.key === "Enter") {
        if (this.validateValue(input.value)) {
          const file = this.plugin.app.vault.getAbstractFileByPath(p.file.path);
          if (file instanceof import_obsidian12.TFile && file.extension == "md") {
            yield this.plugin.fileTaskManager.pushTask(() => {
              replaceValues(this.plugin, file, this.field.name, input.value);
            });
            this.toggleDvButtons(decrementButton, incrementButton, input.value);
          }
          fieldContainer.removeChild(inputContainer);
        }
      }
      if (e.key === "Escape") {
        fieldContainer.removeChild(inputContainer);
        fieldContainer.appendChild(decrementButton);
        fieldContainer.appendChild(fieldValue);
        fieldContainer.appendChild(editButton);
        fieldContainer.appendChild(incrementButton);
        fieldContainer.appendChild(tripleSpacer);
      }
    });
    editButton.onclick = () => {
      fieldContainer.removeChild(fieldValue);
      fieldContainer.removeChild(editButton);
      fieldContainer.removeChild(decrementButton);
      fieldContainer.removeChild(incrementButton);
      fieldContainer.removeChild(tripleSpacer);
      fieldContainer.appendChild(inputContainer);
      input.focus();
    };
    decrementButton.onclick = () => __async(this, null, function* () {
      if (this.canDecrement(p[this.field.name])) {
        const { step } = this.field.options;
        const fStep = parseFloat(step);
        const file = this.plugin.app.vault.getAbstractFileByPath(p["file"]["path"]);
        if (file instanceof import_obsidian12.TFile && file.extension == "md") {
          const newValue = (!!fStep ? p[this.field.name] - fStep : p[this.field.name] - 1).toString();
          yield this.plugin.fileTaskManager.pushTask(() => {
            replaceValues(this.plugin, file, this.field.name, newValue);
          });
          this.toggleDvButtons(decrementButton, incrementButton, newValue);
        }
      }
    });
    incrementButton.onclick = () => __async(this, null, function* () {
      if (this.canIncrement(p[this.field.name])) {
        const { step } = this.field.options;
        const fStep = parseFloat(step);
        const file = this.plugin.app.vault.getAbstractFileByPath(p["file"]["path"]);
        if (file instanceof import_obsidian12.TFile && file.extension == "md") {
          const newValue = (!!fStep ? p[this.field.name] + fStep : p[this.field.name] + 1).toString();
          yield this.plugin.fileTaskManager.pushTask(() => {
            replaceValues(this.plugin, file, this.field.name, newValue);
          });
          this.toggleDvButtons(decrementButton, incrementButton, newValue);
        }
      }
    });
    fieldContainer.appendChild(decrementButton);
    fieldContainer.appendChild(fieldValue);
    fieldContainer.appendChild(editButton);
    fieldContainer.appendChild(incrementButton);
    fieldContainer.appendChild(tripleSpacer);
    this.toggleDvButtons(decrementButton, incrementButton, p[this.field.name]);
  }
};

// src/fields/fieldManagers/SelectField.ts
var import_obsidian18 = require("obsidian");

// src/optionModals/fields/SelectModal.ts
var import_obsidian13 = require("obsidian");

// src/types/selectValuesSourceTypes.ts
var Type2 = /* @__PURE__ */ ((Type3) => {
  Type3["ValuesList"] = "ValuesList";
  Type3["ValuesListNotePath"] = "ValuesListNotePath";
  Type3["ValuesFromDVQuery"] = "ValuesFromDVQuery";
  return Type3;
})(Type2 || {});
var Key = {
  "ValuesList": "valuesList",
  "ValuesListNotePath": "valuesListNotePath",
  "ValuesFromDVQuery": "valuesFromDVQuery"
};
var typeDisplay = {
  "ValuesList": "Values defined in this settings",
  "ValuesListNotePath": "Values from a note",
  "ValuesFromDVQuery": "Values returned from a dataview query"
};

// src/optionModals/fields/SelectModal.ts
var ValueSuggestModal = class extends import_obsidian13.SuggestModal {
  constructor(plugin, file, value, field, lineNumber = -1, inFrontmatter = false, after = false) {
    super(plugin.app);
    this.plugin = plugin;
    this.file = file;
    this.value = value;
    this.field = field;
    this.lineNumber = lineNumber;
    this.inFrontmatter = inFrontmatter;
    this.after = after;
  }
  onOpen() {
    return __async(this, null, function* () {
      __superGet(ValueSuggestModal.prototype, this, "onOpen").call(this);
      const inputContainer = this.containerEl.createDiv({ cls: "metadata-menu-value-suggester-input-container" });
      inputContainer.appendChild(this.inputEl);
      this.containerEl.find(".prompt").prepend(inputContainer);
      const buttonContainer = this.containerEl.createDiv({ cls: "metadata-menu-value-suggester-actions" });
      buttonContainer.createDiv({ cls: "metadata-menu-value-suggester-actions-spacer" });
      const infoContainer = buttonContainer.createDiv({ cls: "metadata-menu-value-suggester-info" });
      infoContainer.setText("Shift+Enter to save");
      this.addButton = new import_obsidian13.ButtonComponent(inputContainer);
      this.addButton.setIcon("plus");
      this.addButton.onClick(() => this.addNewValueToSettings());
      this.addButton.buttonEl.addClass("metadata-menu-value-suggester-button");
      this.addButton.setCta();
      this.addButton.setTooltip("Add this value to this field settings");
      this.addButton.buttonEl.hide();
      const cancelButton = new import_obsidian13.ButtonComponent(buttonContainer);
      cancelButton.setIcon("cross");
      cancelButton.onClick(() => this.close());
      cancelButton.buttonEl.addClass("metadata-menu-value-suggester-button");
      cancelButton.setTooltip("Cancel");
      const clearButton = new import_obsidian13.ButtonComponent(buttonContainer);
      clearButton.setIcon("eraser");
      clearButton.onClick(() => __async(this, null, function* () {
        yield this.clearValues();
        this.close();
      }));
      clearButton.buttonEl.addClass("metadata-menu-value-suggester-button");
      clearButton.buttonEl.addClass("danger");
      clearButton.setTooltip("Clear the field value");
      this.modalEl.appendChild(buttonContainer);
    });
  }
  addNewValueToSettings() {
    return __async(this, null, function* () {
      const newValue = this.inputEl.value;
      const fileClassName = this.plugin.fieldIndex.filesFileClassName.get(this.file.path);
      if (fileClassName) {
        const fileClass = this.plugin.fieldIndex.fileClassesName.get(fileClassName);
        const fileClassAttribute = fileClass == null ? void 0 : fileClass.attributes.find((attr) => attr.name === this.field.name);
        if (fileClass && fileClassAttribute) {
          let newOptions;
          if (Array.isArray(fileClassAttribute.options)) {
            newOptions = [...fileClassAttribute.options, newValue];
            yield fileClass.updateAttribute(fileClassAttribute.type, fileClassAttribute.name, newOptions, fileClassAttribute);
          } else if (fileClassAttribute.options.sourceType === "ValuesList" /* ValuesList */) {
            newOptions = fileClassAttribute.options.valuesList;
            newOptions[`${Object.keys(fileClassAttribute.options.valuesList).length}`] = newValue;
            yield fileClass.updateAttribute(fileClassAttribute.type, fileClassAttribute.name, newOptions, fileClassAttribute);
          } else if (fileClassAttribute.options.sourceType === "ValuesListNotePath" /* ValuesListNotePath */) {
            const valuesFile = this.plugin.app.vault.getAbstractFileByPath(fileClassAttribute.options.valuesListNotePath);
            if (valuesFile instanceof import_obsidian13.TFile && valuesFile.extension == "md") {
              const result = yield this.plugin.app.vault.read(valuesFile);
              this.plugin.app.vault.modify(valuesFile, `${result}
${newValue}`);
            }
          } else {
            newOptions = fileClassAttribute.options;
            newOptions[`${Object.keys(fileClassAttribute.options).length}`] = newValue;
            yield fileClass.updateAttribute(fileClassAttribute.type, fileClassAttribute.name, newOptions, fileClassAttribute);
          }
        }
      } else {
        const presetField = this.plugin.settings.presetFields.find((field) => field.name === this.field.name);
        if ((presetField == null ? void 0 : presetField.options.sourceType) === "ValuesListNotePath" /* ValuesListNotePath */) {
          const valuesFile = this.plugin.app.vault.getAbstractFileByPath(presetField.options.valuesListNotePath);
          if (valuesFile instanceof import_obsidian13.TFile && valuesFile.extension == "md") {
            const result = yield this.plugin.app.vault.read(valuesFile);
            this.plugin.app.vault.modify(valuesFile, `${result}
${newValue}`);
          }
        } else if ((presetField == null ? void 0 : presetField.options.sourceType) === "ValuesList" /* ValuesList */) {
          const currentExistingField = this.plugin.initialProperties.find((p) => p.id == this.field.id);
          if (currentExistingField) {
            const valuesList = currentExistingField.options.valuesList;
            valuesList[`${Object.keys(valuesList).length + 1}`] = newValue;
          }
          this.plugin.saveSettings();
        }
      }
      yield this.saveItem(newValue);
      this.close();
    });
  }
  clearValues() {
    return __async(this, null, function* () {
      if (this.lineNumber == -1) {
        yield this.plugin.fileTaskManager.pushTask(() => {
          replaceValues(this.plugin, this.file, this.field.name, "");
        });
      } else {
        yield this.plugin.fileTaskManager.pushTask(() => {
          insertValues(this.plugin, this.file, this.field.name, "", this.lineNumber, this.inFrontmatter, this.after);
        });
      }
      ;
    });
  }
  getSuggestions(query) {
    var _a;
    const dvApi = (_a = this.plugin.app.plugins.plugins.dataview) == null ? void 0 : _a.api;
    let dvFile;
    if (dvApi)
      dvFile = dvApi.page(this.file.path);
    const fieldManager = new FieldManager[this.field.type](this.plugin, this.field);
    const values = fieldManager.getOptionsList(dvFile).filter((o) => o.toLowerCase().includes(query.toLowerCase()));
    if (this.addButton) {
      values.some((p) => p === query) || this.field.options.sourceType == "ValuesFromDVQuery" /* ValuesFromDVQuery */ || !query ? this.addButton.buttonEl.hide() : this.addButton.buttonEl.show();
    }
    ;
    return values;
  }
  renderSuggestion(value, el) {
    el.setText(value);
    if (value === this.value)
      el.addClass("metadata-menu-value-selected");
  }
  saveItem(item) {
    return __async(this, null, function* () {
      if (this.lineNumber == -1) {
        yield this.plugin.fileTaskManager.pushTask(() => {
          replaceValues(this.plugin, this.file, this.field.name, item.toString());
        });
      } else {
        yield this.plugin.fileTaskManager.pushTask(() => {
          insertValues(this.plugin, this.file, this.field.name, item.toString(), this.lineNumber, this.inFrontmatter, this.after);
        });
      }
      ;
    });
  }
  onChooseSuggestion(item, evt) {
    return __async(this, null, function* () {
      this.saveItem(item);
    });
  }
};

// src/fields/fieldManagers/AbstractListBasedField.ts
var import_obsidian17 = require("obsidian");

// src/suggester/FileSuggester.ts
var import_obsidian16 = require("obsidian");

// src/suggester/suggest.ts
var import_obsidian14 = require("obsidian");

// node_modules/@popperjs/core/lib/enums.js
var top = "top";
var bottom = "bottom";
var right = "right";
var left = "left";
var auto = "auto";
var basePlacements = [top, bottom, right, left];
var start = "start";
var end = "end";
var clippingParents = "clippingParents";
var viewport = "viewport";
var popper = "popper";
var reference = "reference";
var variationPlacements = /* @__PURE__ */ basePlacements.reduce(function(acc, placement) {
  return acc.concat([placement + "-" + start, placement + "-" + end]);
}, []);
var placements = /* @__PURE__ */ [].concat(basePlacements, [auto]).reduce(function(acc, placement) {
  return acc.concat([placement, placement + "-" + start, placement + "-" + end]);
}, []);
var beforeRead = "beforeRead";
var read = "read";
var afterRead = "afterRead";
var beforeMain = "beforeMain";
var main = "main";
var afterMain = "afterMain";
var beforeWrite = "beforeWrite";
var write = "write";
var afterWrite = "afterWrite";
var modifierPhases = [beforeRead, read, afterRead, beforeMain, main, afterMain, beforeWrite, write, afterWrite];

// node_modules/@popperjs/core/lib/dom-utils/getNodeName.js
function getNodeName(element) {
  return element ? (element.nodeName || "").toLowerCase() : null;
}

// node_modules/@popperjs/core/lib/dom-utils/getWindow.js
function getWindow(node) {
  if (node == null) {
    return window;
  }
  if (node.toString() !== "[object Window]") {
    var ownerDocument = node.ownerDocument;
    return ownerDocument ? ownerDocument.defaultView || window : window;
  }
  return node;
}

// node_modules/@popperjs/core/lib/dom-utils/instanceOf.js
function isElement(node) {
  var OwnElement = getWindow(node).Element;
  return node instanceof OwnElement || node instanceof Element;
}
function isHTMLElement(node) {
  var OwnElement = getWindow(node).HTMLElement;
  return node instanceof OwnElement || node instanceof HTMLElement;
}
function isShadowRoot(node) {
  if (typeof ShadowRoot === "undefined") {
    return false;
  }
  var OwnElement = getWindow(node).ShadowRoot;
  return node instanceof OwnElement || node instanceof ShadowRoot;
}

// node_modules/@popperjs/core/lib/modifiers/applyStyles.js
function applyStyles(_ref) {
  var state = _ref.state;
  Object.keys(state.elements).forEach(function(name) {
    var style = state.styles[name] || {};
    var attributes = state.attributes[name] || {};
    var element = state.elements[name];
    if (!isHTMLElement(element) || !getNodeName(element)) {
      return;
    }
    Object.assign(element.style, style);
    Object.keys(attributes).forEach(function(name2) {
      var value = attributes[name2];
      if (value === false) {
        element.removeAttribute(name2);
      } else {
        element.setAttribute(name2, value === true ? "" : value);
      }
    });
  });
}
function effect(_ref2) {
  var state = _ref2.state;
  var initialStyles = {
    popper: {
      position: state.options.strategy,
      left: "0",
      top: "0",
      margin: "0"
    },
    arrow: {
      position: "absolute"
    },
    reference: {}
  };
  Object.assign(state.elements.popper.style, initialStyles.popper);
  state.styles = initialStyles;
  if (state.elements.arrow) {
    Object.assign(state.elements.arrow.style, initialStyles.arrow);
  }
  return function() {
    Object.keys(state.elements).forEach(function(name) {
      var element = state.elements[name];
      var attributes = state.attributes[name] || {};
      var styleProperties = Object.keys(state.styles.hasOwnProperty(name) ? state.styles[name] : initialStyles[name]);
      var style = styleProperties.reduce(function(style2, property) {
        style2[property] = "";
        return style2;
      }, {});
      if (!isHTMLElement(element) || !getNodeName(element)) {
        return;
      }
      Object.assign(element.style, style);
      Object.keys(attributes).forEach(function(attribute) {
        element.removeAttribute(attribute);
      });
    });
  };
}
var applyStyles_default = {
  name: "applyStyles",
  enabled: true,
  phase: "write",
  fn: applyStyles,
  effect,
  requires: ["computeStyles"]
};

// node_modules/@popperjs/core/lib/utils/getBasePlacement.js
function getBasePlacement(placement) {
  return placement.split("-")[0];
}

// node_modules/@popperjs/core/lib/utils/math.js
var max = Math.max;
var min = Math.min;
var round = Math.round;

// node_modules/@popperjs/core/lib/dom-utils/getBoundingClientRect.js
function getBoundingClientRect(element, includeScale) {
  if (includeScale === void 0) {
    includeScale = false;
  }
  var rect = element.getBoundingClientRect();
  var scaleX = 1;
  var scaleY = 1;
  if (isHTMLElement(element) && includeScale) {
    var offsetHeight = element.offsetHeight;
    var offsetWidth = element.offsetWidth;
    if (offsetWidth > 0) {
      scaleX = round(rect.width) / offsetWidth || 1;
    }
    if (offsetHeight > 0) {
      scaleY = round(rect.height) / offsetHeight || 1;
    }
  }
  return {
    width: rect.width / scaleX,
    height: rect.height / scaleY,
    top: rect.top / scaleY,
    right: rect.right / scaleX,
    bottom: rect.bottom / scaleY,
    left: rect.left / scaleX,
    x: rect.left / scaleX,
    y: rect.top / scaleY
  };
}

// node_modules/@popperjs/core/lib/dom-utils/getLayoutRect.js
function getLayoutRect(element) {
  var clientRect = getBoundingClientRect(element);
  var width = element.offsetWidth;
  var height = element.offsetHeight;
  if (Math.abs(clientRect.width - width) <= 1) {
    width = clientRect.width;
  }
  if (Math.abs(clientRect.height - height) <= 1) {
    height = clientRect.height;
  }
  return {
    x: element.offsetLeft,
    y: element.offsetTop,
    width,
    height
  };
}

// node_modules/@popperjs/core/lib/dom-utils/contains.js
function contains(parent, child) {
  var rootNode = child.getRootNode && child.getRootNode();
  if (parent.contains(child)) {
    return true;
  } else if (rootNode && isShadowRoot(rootNode)) {
    var next = child;
    do {
      if (next && parent.isSameNode(next)) {
        return true;
      }
      next = next.parentNode || next.host;
    } while (next);
  }
  return false;
}

// node_modules/@popperjs/core/lib/dom-utils/getComputedStyle.js
function getComputedStyle(element) {
  return getWindow(element).getComputedStyle(element);
}

// node_modules/@popperjs/core/lib/dom-utils/isTableElement.js
function isTableElement(element) {
  return ["table", "td", "th"].indexOf(getNodeName(element)) >= 0;
}

// node_modules/@popperjs/core/lib/dom-utils/getDocumentElement.js
function getDocumentElement(element) {
  return ((isElement(element) ? element.ownerDocument : element.document) || window.document).documentElement;
}

// node_modules/@popperjs/core/lib/dom-utils/getParentNode.js
function getParentNode(element) {
  if (getNodeName(element) === "html") {
    return element;
  }
  return element.assignedSlot || element.parentNode || (isShadowRoot(element) ? element.host : null) || getDocumentElement(element);
}

// node_modules/@popperjs/core/lib/dom-utils/getOffsetParent.js
function getTrueOffsetParent(element) {
  if (!isHTMLElement(element) || getComputedStyle(element).position === "fixed") {
    return null;
  }
  return element.offsetParent;
}
function getContainingBlock(element) {
  var isFirefox = navigator.userAgent.toLowerCase().indexOf("firefox") !== -1;
  var isIE = navigator.userAgent.indexOf("Trident") !== -1;
  if (isIE && isHTMLElement(element)) {
    var elementCss = getComputedStyle(element);
    if (elementCss.position === "fixed") {
      return null;
    }
  }
  var currentNode = getParentNode(element);
  if (isShadowRoot(currentNode)) {
    currentNode = currentNode.host;
  }
  while (isHTMLElement(currentNode) && ["html", "body"].indexOf(getNodeName(currentNode)) < 0) {
    var css = getComputedStyle(currentNode);
    if (css.transform !== "none" || css.perspective !== "none" || css.contain === "paint" || ["transform", "perspective"].indexOf(css.willChange) !== -1 || isFirefox && css.willChange === "filter" || isFirefox && css.filter && css.filter !== "none") {
      return currentNode;
    } else {
      currentNode = currentNode.parentNode;
    }
  }
  return null;
}
function getOffsetParent(element) {
  var window2 = getWindow(element);
  var offsetParent = getTrueOffsetParent(element);
  while (offsetParent && isTableElement(offsetParent) && getComputedStyle(offsetParent).position === "static") {
    offsetParent = getTrueOffsetParent(offsetParent);
  }
  if (offsetParent && (getNodeName(offsetParent) === "html" || getNodeName(offsetParent) === "body" && getComputedStyle(offsetParent).position === "static")) {
    return window2;
  }
  return offsetParent || getContainingBlock(element) || window2;
}

// node_modules/@popperjs/core/lib/utils/getMainAxisFromPlacement.js
function getMainAxisFromPlacement(placement) {
  return ["top", "bottom"].indexOf(placement) >= 0 ? "x" : "y";
}

// node_modules/@popperjs/core/lib/utils/within.js
function within(min2, value, max2) {
  return max(min2, min(value, max2));
}
function withinMaxClamp(min2, value, max2) {
  var v = within(min2, value, max2);
  return v > max2 ? max2 : v;
}

// node_modules/@popperjs/core/lib/utils/getFreshSideObject.js
function getFreshSideObject() {
  return {
    top: 0,
    right: 0,
    bottom: 0,
    left: 0
  };
}

// node_modules/@popperjs/core/lib/utils/mergePaddingObject.js
function mergePaddingObject(paddingObject) {
  return Object.assign({}, getFreshSideObject(), paddingObject);
}

// node_modules/@popperjs/core/lib/utils/expandToHashMap.js
function expandToHashMap(value, keys) {
  return keys.reduce(function(hashMap, key) {
    hashMap[key] = value;
    return hashMap;
  }, {});
}

// node_modules/@popperjs/core/lib/modifiers/arrow.js
var toPaddingObject = function toPaddingObject2(padding, state) {
  padding = typeof padding === "function" ? padding(Object.assign({}, state.rects, {
    placement: state.placement
  })) : padding;
  return mergePaddingObject(typeof padding !== "number" ? padding : expandToHashMap(padding, basePlacements));
};
function arrow(_ref) {
  var _state$modifiersData$;
  var state = _ref.state, name = _ref.name, options = _ref.options;
  var arrowElement = state.elements.arrow;
  var popperOffsets2 = state.modifiersData.popperOffsets;
  var basePlacement = getBasePlacement(state.placement);
  var axis = getMainAxisFromPlacement(basePlacement);
  var isVertical = [left, right].indexOf(basePlacement) >= 0;
  var len = isVertical ? "height" : "width";
  if (!arrowElement || !popperOffsets2) {
    return;
  }
  var paddingObject = toPaddingObject(options.padding, state);
  var arrowRect = getLayoutRect(arrowElement);
  var minProp = axis === "y" ? top : left;
  var maxProp = axis === "y" ? bottom : right;
  var endDiff = state.rects.reference[len] + state.rects.reference[axis] - popperOffsets2[axis] - state.rects.popper[len];
  var startDiff = popperOffsets2[axis] - state.rects.reference[axis];
  var arrowOffsetParent = getOffsetParent(arrowElement);
  var clientSize = arrowOffsetParent ? axis === "y" ? arrowOffsetParent.clientHeight || 0 : arrowOffsetParent.clientWidth || 0 : 0;
  var centerToReference = endDiff / 2 - startDiff / 2;
  var min2 = paddingObject[minProp];
  var max2 = clientSize - arrowRect[len] - paddingObject[maxProp];
  var center = clientSize / 2 - arrowRect[len] / 2 + centerToReference;
  var offset2 = within(min2, center, max2);
  var axisProp = axis;
  state.modifiersData[name] = (_state$modifiersData$ = {}, _state$modifiersData$[axisProp] = offset2, _state$modifiersData$.centerOffset = offset2 - center, _state$modifiersData$);
}
function effect2(_ref2) {
  var state = _ref2.state, options = _ref2.options;
  var _options$element = options.element, arrowElement = _options$element === void 0 ? "[data-popper-arrow]" : _options$element;
  if (arrowElement == null) {
    return;
  }
  if (typeof arrowElement === "string") {
    arrowElement = state.elements.popper.querySelector(arrowElement);
    if (!arrowElement) {
      return;
    }
  }
  if (true) {
    if (!isHTMLElement(arrowElement)) {
      console.error(['Popper: "arrow" element must be an HTMLElement (not an SVGElement).', "To use an SVG arrow, wrap it in an HTMLElement that will be used as", "the arrow."].join(" "));
    }
  }
  if (!contains(state.elements.popper, arrowElement)) {
    if (true) {
      console.error(['Popper: "arrow" modifier\'s `element` must be a child of the popper', "element."].join(" "));
    }
    return;
  }
  state.elements.arrow = arrowElement;
}
var arrow_default = {
  name: "arrow",
  enabled: true,
  phase: "main",
  fn: arrow,
  effect: effect2,
  requires: ["popperOffsets"],
  requiresIfExists: ["preventOverflow"]
};

// node_modules/@popperjs/core/lib/utils/getVariation.js
function getVariation(placement) {
  return placement.split("-")[1];
}

// node_modules/@popperjs/core/lib/modifiers/computeStyles.js
var unsetSides = {
  top: "auto",
  right: "auto",
  bottom: "auto",
  left: "auto"
};
function roundOffsetsByDPR(_ref) {
  var x = _ref.x, y = _ref.y;
  var win = window;
  var dpr = win.devicePixelRatio || 1;
  return {
    x: round(x * dpr) / dpr || 0,
    y: round(y * dpr) / dpr || 0
  };
}
function mapToStyles(_ref2) {
  var _Object$assign2;
  var popper2 = _ref2.popper, popperRect = _ref2.popperRect, placement = _ref2.placement, variation = _ref2.variation, offsets = _ref2.offsets, position = _ref2.position, gpuAcceleration = _ref2.gpuAcceleration, adaptive = _ref2.adaptive, roundOffsets = _ref2.roundOffsets, isFixed = _ref2.isFixed;
  var _offsets$x = offsets.x, x = _offsets$x === void 0 ? 0 : _offsets$x, _offsets$y = offsets.y, y = _offsets$y === void 0 ? 0 : _offsets$y;
  var _ref3 = typeof roundOffsets === "function" ? roundOffsets({
    x,
    y
  }) : {
    x,
    y
  };
  x = _ref3.x;
  y = _ref3.y;
  var hasX = offsets.hasOwnProperty("x");
  var hasY = offsets.hasOwnProperty("y");
  var sideX = left;
  var sideY = top;
  var win = window;
  if (adaptive) {
    var offsetParent = getOffsetParent(popper2);
    var heightProp = "clientHeight";
    var widthProp = "clientWidth";
    if (offsetParent === getWindow(popper2)) {
      offsetParent = getDocumentElement(popper2);
      if (getComputedStyle(offsetParent).position !== "static" && position === "absolute") {
        heightProp = "scrollHeight";
        widthProp = "scrollWidth";
      }
    }
    offsetParent = offsetParent;
    if (placement === top || (placement === left || placement === right) && variation === end) {
      sideY = bottom;
      var offsetY = isFixed && offsetParent === win && win.visualViewport ? win.visualViewport.height : offsetParent[heightProp];
      y -= offsetY - popperRect.height;
      y *= gpuAcceleration ? 1 : -1;
    }
    if (placement === left || (placement === top || placement === bottom) && variation === end) {
      sideX = right;
      var offsetX = isFixed && offsetParent === win && win.visualViewport ? win.visualViewport.width : offsetParent[widthProp];
      x -= offsetX - popperRect.width;
      x *= gpuAcceleration ? 1 : -1;
    }
  }
  var commonStyles = Object.assign({
    position
  }, adaptive && unsetSides);
  var _ref4 = roundOffsets === true ? roundOffsetsByDPR({
    x,
    y
  }) : {
    x,
    y
  };
  x = _ref4.x;
  y = _ref4.y;
  if (gpuAcceleration) {
    var _Object$assign;
    return Object.assign({}, commonStyles, (_Object$assign = {}, _Object$assign[sideY] = hasY ? "0" : "", _Object$assign[sideX] = hasX ? "0" : "", _Object$assign.transform = (win.devicePixelRatio || 1) <= 1 ? "translate(" + x + "px, " + y + "px)" : "translate3d(" + x + "px, " + y + "px, 0)", _Object$assign));
  }
  return Object.assign({}, commonStyles, (_Object$assign2 = {}, _Object$assign2[sideY] = hasY ? y + "px" : "", _Object$assign2[sideX] = hasX ? x + "px" : "", _Object$assign2.transform = "", _Object$assign2));
}
function computeStyles(_ref5) {
  var state = _ref5.state, options = _ref5.options;
  var _options$gpuAccelerat = options.gpuAcceleration, gpuAcceleration = _options$gpuAccelerat === void 0 ? true : _options$gpuAccelerat, _options$adaptive = options.adaptive, adaptive = _options$adaptive === void 0 ? true : _options$adaptive, _options$roundOffsets = options.roundOffsets, roundOffsets = _options$roundOffsets === void 0 ? true : _options$roundOffsets;
  if (true) {
    var transitionProperty = getComputedStyle(state.elements.popper).transitionProperty || "";
    if (adaptive && ["transform", "top", "right", "bottom", "left"].some(function(property) {
      return transitionProperty.indexOf(property) >= 0;
    })) {
      console.warn(["Popper: Detected CSS transitions on at least one of the following", 'CSS properties: "transform", "top", "right", "bottom", "left".', "\n\n", 'Disable the "computeStyles" modifier\'s `adaptive` option to allow', "for smooth transitions, or remove these properties from the CSS", "transition declaration on the popper element if only transitioning", "opacity or background-color for example.", "\n\n", "We recommend using the popper element as a wrapper around an inner", "element that can have any CSS property transitioned for animations."].join(" "));
    }
  }
  var commonStyles = {
    placement: getBasePlacement(state.placement),
    variation: getVariation(state.placement),
    popper: state.elements.popper,
    popperRect: state.rects.popper,
    gpuAcceleration,
    isFixed: state.options.strategy === "fixed"
  };
  if (state.modifiersData.popperOffsets != null) {
    state.styles.popper = Object.assign({}, state.styles.popper, mapToStyles(Object.assign({}, commonStyles, {
      offsets: state.modifiersData.popperOffsets,
      position: state.options.strategy,
      adaptive,
      roundOffsets
    })));
  }
  if (state.modifiersData.arrow != null) {
    state.styles.arrow = Object.assign({}, state.styles.arrow, mapToStyles(Object.assign({}, commonStyles, {
      offsets: state.modifiersData.arrow,
      position: "absolute",
      adaptive: false,
      roundOffsets
    })));
  }
  state.attributes.popper = Object.assign({}, state.attributes.popper, {
    "data-popper-placement": state.placement
  });
}
var computeStyles_default = {
  name: "computeStyles",
  enabled: true,
  phase: "beforeWrite",
  fn: computeStyles,
  data: {}
};

// node_modules/@popperjs/core/lib/modifiers/eventListeners.js
var passive = {
  passive: true
};
function effect3(_ref) {
  var state = _ref.state, instance = _ref.instance, options = _ref.options;
  var _options$scroll = options.scroll, scroll = _options$scroll === void 0 ? true : _options$scroll, _options$resize = options.resize, resize = _options$resize === void 0 ? true : _options$resize;
  var window2 = getWindow(state.elements.popper);
  var scrollParents = [].concat(state.scrollParents.reference, state.scrollParents.popper);
  if (scroll) {
    scrollParents.forEach(function(scrollParent) {
      scrollParent.addEventListener("scroll", instance.update, passive);
    });
  }
  if (resize) {
    window2.addEventListener("resize", instance.update, passive);
  }
  return function() {
    if (scroll) {
      scrollParents.forEach(function(scrollParent) {
        scrollParent.removeEventListener("scroll", instance.update, passive);
      });
    }
    if (resize) {
      window2.removeEventListener("resize", instance.update, passive);
    }
  };
}
var eventListeners_default = {
  name: "eventListeners",
  enabled: true,
  phase: "write",
  fn: function fn() {
  },
  effect: effect3,
  data: {}
};

// node_modules/@popperjs/core/lib/utils/getOppositePlacement.js
var hash = {
  left: "right",
  right: "left",
  bottom: "top",
  top: "bottom"
};
function getOppositePlacement(placement) {
  return placement.replace(/left|right|bottom|top/g, function(matched) {
    return hash[matched];
  });
}

// node_modules/@popperjs/core/lib/utils/getOppositeVariationPlacement.js
var hash2 = {
  start: "end",
  end: "start"
};
function getOppositeVariationPlacement(placement) {
  return placement.replace(/start|end/g, function(matched) {
    return hash2[matched];
  });
}

// node_modules/@popperjs/core/lib/dom-utils/getWindowScroll.js
function getWindowScroll(node) {
  var win = getWindow(node);
  var scrollLeft = win.pageXOffset;
  var scrollTop = win.pageYOffset;
  return {
    scrollLeft,
    scrollTop
  };
}

// node_modules/@popperjs/core/lib/dom-utils/getWindowScrollBarX.js
function getWindowScrollBarX(element) {
  return getBoundingClientRect(getDocumentElement(element)).left + getWindowScroll(element).scrollLeft;
}

// node_modules/@popperjs/core/lib/dom-utils/getViewportRect.js
function getViewportRect(element) {
  var win = getWindow(element);
  var html = getDocumentElement(element);
  var visualViewport = win.visualViewport;
  var width = html.clientWidth;
  var height = html.clientHeight;
  var x = 0;
  var y = 0;
  if (visualViewport) {
    width = visualViewport.width;
    height = visualViewport.height;
    if (!/^((?!chrome|android).)*safari/i.test(navigator.userAgent)) {
      x = visualViewport.offsetLeft;
      y = visualViewport.offsetTop;
    }
  }
  return {
    width,
    height,
    x: x + getWindowScrollBarX(element),
    y
  };
}

// node_modules/@popperjs/core/lib/dom-utils/getDocumentRect.js
function getDocumentRect(element) {
  var _element$ownerDocumen;
  var html = getDocumentElement(element);
  var winScroll = getWindowScroll(element);
  var body = (_element$ownerDocumen = element.ownerDocument) == null ? void 0 : _element$ownerDocumen.body;
  var width = max(html.scrollWidth, html.clientWidth, body ? body.scrollWidth : 0, body ? body.clientWidth : 0);
  var height = max(html.scrollHeight, html.clientHeight, body ? body.scrollHeight : 0, body ? body.clientHeight : 0);
  var x = -winScroll.scrollLeft + getWindowScrollBarX(element);
  var y = -winScroll.scrollTop;
  if (getComputedStyle(body || html).direction === "rtl") {
    x += max(html.clientWidth, body ? body.clientWidth : 0) - width;
  }
  return {
    width,
    height,
    x,
    y
  };
}

// node_modules/@popperjs/core/lib/dom-utils/isScrollParent.js
function isScrollParent(element) {
  var _getComputedStyle = getComputedStyle(element), overflow = _getComputedStyle.overflow, overflowX = _getComputedStyle.overflowX, overflowY = _getComputedStyle.overflowY;
  return /auto|scroll|overlay|hidden/.test(overflow + overflowY + overflowX);
}

// node_modules/@popperjs/core/lib/dom-utils/getScrollParent.js
function getScrollParent(node) {
  if (["html", "body", "#document"].indexOf(getNodeName(node)) >= 0) {
    return node.ownerDocument.body;
  }
  if (isHTMLElement(node) && isScrollParent(node)) {
    return node;
  }
  return getScrollParent(getParentNode(node));
}

// node_modules/@popperjs/core/lib/dom-utils/listScrollParents.js
function listScrollParents(element, list) {
  var _element$ownerDocumen;
  if (list === void 0) {
    list = [];
  }
  var scrollParent = getScrollParent(element);
  var isBody = scrollParent === ((_element$ownerDocumen = element.ownerDocument) == null ? void 0 : _element$ownerDocumen.body);
  var win = getWindow(scrollParent);
  var target = isBody ? [win].concat(win.visualViewport || [], isScrollParent(scrollParent) ? scrollParent : []) : scrollParent;
  var updatedList = list.concat(target);
  return isBody ? updatedList : updatedList.concat(listScrollParents(getParentNode(target)));
}

// node_modules/@popperjs/core/lib/utils/rectToClientRect.js
function rectToClientRect(rect) {
  return Object.assign({}, rect, {
    left: rect.x,
    top: rect.y,
    right: rect.x + rect.width,
    bottom: rect.y + rect.height
  });
}

// node_modules/@popperjs/core/lib/dom-utils/getClippingRect.js
function getInnerBoundingClientRect(element) {
  var rect = getBoundingClientRect(element);
  rect.top = rect.top + element.clientTop;
  rect.left = rect.left + element.clientLeft;
  rect.bottom = rect.top + element.clientHeight;
  rect.right = rect.left + element.clientWidth;
  rect.width = element.clientWidth;
  rect.height = element.clientHeight;
  rect.x = rect.left;
  rect.y = rect.top;
  return rect;
}
function getClientRectFromMixedType(element, clippingParent) {
  return clippingParent === viewport ? rectToClientRect(getViewportRect(element)) : isElement(clippingParent) ? getInnerBoundingClientRect(clippingParent) : rectToClientRect(getDocumentRect(getDocumentElement(element)));
}
function getClippingParents(element) {
  var clippingParents2 = listScrollParents(getParentNode(element));
  var canEscapeClipping = ["absolute", "fixed"].indexOf(getComputedStyle(element).position) >= 0;
  var clipperElement = canEscapeClipping && isHTMLElement(element) ? getOffsetParent(element) : element;
  if (!isElement(clipperElement)) {
    return [];
  }
  return clippingParents2.filter(function(clippingParent) {
    return isElement(clippingParent) && contains(clippingParent, clipperElement) && getNodeName(clippingParent) !== "body";
  });
}
function getClippingRect(element, boundary, rootBoundary) {
  var mainClippingParents = boundary === "clippingParents" ? getClippingParents(element) : [].concat(boundary);
  var clippingParents2 = [].concat(mainClippingParents, [rootBoundary]);
  var firstClippingParent = clippingParents2[0];
  var clippingRect = clippingParents2.reduce(function(accRect, clippingParent) {
    var rect = getClientRectFromMixedType(element, clippingParent);
    accRect.top = max(rect.top, accRect.top);
    accRect.right = min(rect.right, accRect.right);
    accRect.bottom = min(rect.bottom, accRect.bottom);
    accRect.left = max(rect.left, accRect.left);
    return accRect;
  }, getClientRectFromMixedType(element, firstClippingParent));
  clippingRect.width = clippingRect.right - clippingRect.left;
  clippingRect.height = clippingRect.bottom - clippingRect.top;
  clippingRect.x = clippingRect.left;
  clippingRect.y = clippingRect.top;
  return clippingRect;
}

// node_modules/@popperjs/core/lib/utils/computeOffsets.js
function computeOffsets(_ref) {
  var reference2 = _ref.reference, element = _ref.element, placement = _ref.placement;
  var basePlacement = placement ? getBasePlacement(placement) : null;
  var variation = placement ? getVariation(placement) : null;
  var commonX = reference2.x + reference2.width / 2 - element.width / 2;
  var commonY = reference2.y + reference2.height / 2 - element.height / 2;
  var offsets;
  switch (basePlacement) {
    case top:
      offsets = {
        x: commonX,
        y: reference2.y - element.height
      };
      break;
    case bottom:
      offsets = {
        x: commonX,
        y: reference2.y + reference2.height
      };
      break;
    case right:
      offsets = {
        x: reference2.x + reference2.width,
        y: commonY
      };
      break;
    case left:
      offsets = {
        x: reference2.x - element.width,
        y: commonY
      };
      break;
    default:
      offsets = {
        x: reference2.x,
        y: reference2.y
      };
  }
  var mainAxis = basePlacement ? getMainAxisFromPlacement(basePlacement) : null;
  if (mainAxis != null) {
    var len = mainAxis === "y" ? "height" : "width";
    switch (variation) {
      case start:
        offsets[mainAxis] = offsets[mainAxis] - (reference2[len] / 2 - element[len] / 2);
        break;
      case end:
        offsets[mainAxis] = offsets[mainAxis] + (reference2[len] / 2 - element[len] / 2);
        break;
      default:
    }
  }
  return offsets;
}

// node_modules/@popperjs/core/lib/utils/detectOverflow.js
function detectOverflow(state, options) {
  if (options === void 0) {
    options = {};
  }
  var _options = options, _options$placement = _options.placement, placement = _options$placement === void 0 ? state.placement : _options$placement, _options$boundary = _options.boundary, boundary = _options$boundary === void 0 ? clippingParents : _options$boundary, _options$rootBoundary = _options.rootBoundary, rootBoundary = _options$rootBoundary === void 0 ? viewport : _options$rootBoundary, _options$elementConte = _options.elementContext, elementContext = _options$elementConte === void 0 ? popper : _options$elementConte, _options$altBoundary = _options.altBoundary, altBoundary = _options$altBoundary === void 0 ? false : _options$altBoundary, _options$padding = _options.padding, padding = _options$padding === void 0 ? 0 : _options$padding;
  var paddingObject = mergePaddingObject(typeof padding !== "number" ? padding : expandToHashMap(padding, basePlacements));
  var altContext = elementContext === popper ? reference : popper;
  var popperRect = state.rects.popper;
  var element = state.elements[altBoundary ? altContext : elementContext];
  var clippingClientRect = getClippingRect(isElement(element) ? element : element.contextElement || getDocumentElement(state.elements.popper), boundary, rootBoundary);
  var referenceClientRect = getBoundingClientRect(state.elements.reference);
  var popperOffsets2 = computeOffsets({
    reference: referenceClientRect,
    element: popperRect,
    strategy: "absolute",
    placement
  });
  var popperClientRect = rectToClientRect(Object.assign({}, popperRect, popperOffsets2));
  var elementClientRect = elementContext === popper ? popperClientRect : referenceClientRect;
  var overflowOffsets = {
    top: clippingClientRect.top - elementClientRect.top + paddingObject.top,
    bottom: elementClientRect.bottom - clippingClientRect.bottom + paddingObject.bottom,
    left: clippingClientRect.left - elementClientRect.left + paddingObject.left,
    right: elementClientRect.right - clippingClientRect.right + paddingObject.right
  };
  var offsetData = state.modifiersData.offset;
  if (elementContext === popper && offsetData) {
    var offset2 = offsetData[placement];
    Object.keys(overflowOffsets).forEach(function(key) {
      var multiply = [right, bottom].indexOf(key) >= 0 ? 1 : -1;
      var axis = [top, bottom].indexOf(key) >= 0 ? "y" : "x";
      overflowOffsets[key] += offset2[axis] * multiply;
    });
  }
  return overflowOffsets;
}

// node_modules/@popperjs/core/lib/utils/computeAutoPlacement.js
function computeAutoPlacement(state, options) {
  if (options === void 0) {
    options = {};
  }
  var _options = options, placement = _options.placement, boundary = _options.boundary, rootBoundary = _options.rootBoundary, padding = _options.padding, flipVariations = _options.flipVariations, _options$allowedAutoP = _options.allowedAutoPlacements, allowedAutoPlacements = _options$allowedAutoP === void 0 ? placements : _options$allowedAutoP;
  var variation = getVariation(placement);
  var placements2 = variation ? flipVariations ? variationPlacements : variationPlacements.filter(function(placement2) {
    return getVariation(placement2) === variation;
  }) : basePlacements;
  var allowedPlacements = placements2.filter(function(placement2) {
    return allowedAutoPlacements.indexOf(placement2) >= 0;
  });
  if (allowedPlacements.length === 0) {
    allowedPlacements = placements2;
    if (true) {
      console.error(["Popper: The `allowedAutoPlacements` option did not allow any", "placements. Ensure the `placement` option matches the variation", "of the allowed placements.", 'For example, "auto" cannot be used to allow "bottom-start".', 'Use "auto-start" instead.'].join(" "));
    }
  }
  var overflows = allowedPlacements.reduce(function(acc, placement2) {
    acc[placement2] = detectOverflow(state, {
      placement: placement2,
      boundary,
      rootBoundary,
      padding
    })[getBasePlacement(placement2)];
    return acc;
  }, {});
  return Object.keys(overflows).sort(function(a, b) {
    return overflows[a] - overflows[b];
  });
}

// node_modules/@popperjs/core/lib/modifiers/flip.js
function getExpandedFallbackPlacements(placement) {
  if (getBasePlacement(placement) === auto) {
    return [];
  }
  var oppositePlacement = getOppositePlacement(placement);
  return [getOppositeVariationPlacement(placement), oppositePlacement, getOppositeVariationPlacement(oppositePlacement)];
}
function flip(_ref) {
  var state = _ref.state, options = _ref.options, name = _ref.name;
  if (state.modifiersData[name]._skip) {
    return;
  }
  var _options$mainAxis = options.mainAxis, checkMainAxis = _options$mainAxis === void 0 ? true : _options$mainAxis, _options$altAxis = options.altAxis, checkAltAxis = _options$altAxis === void 0 ? true : _options$altAxis, specifiedFallbackPlacements = options.fallbackPlacements, padding = options.padding, boundary = options.boundary, rootBoundary = options.rootBoundary, altBoundary = options.altBoundary, _options$flipVariatio = options.flipVariations, flipVariations = _options$flipVariatio === void 0 ? true : _options$flipVariatio, allowedAutoPlacements = options.allowedAutoPlacements;
  var preferredPlacement = state.options.placement;
  var basePlacement = getBasePlacement(preferredPlacement);
  var isBasePlacement = basePlacement === preferredPlacement;
  var fallbackPlacements = specifiedFallbackPlacements || (isBasePlacement || !flipVariations ? [getOppositePlacement(preferredPlacement)] : getExpandedFallbackPlacements(preferredPlacement));
  var placements2 = [preferredPlacement].concat(fallbackPlacements).reduce(function(acc, placement2) {
    return acc.concat(getBasePlacement(placement2) === auto ? computeAutoPlacement(state, {
      placement: placement2,
      boundary,
      rootBoundary,
      padding,
      flipVariations,
      allowedAutoPlacements
    }) : placement2);
  }, []);
  var referenceRect = state.rects.reference;
  var popperRect = state.rects.popper;
  var checksMap = /* @__PURE__ */ new Map();
  var makeFallbackChecks = true;
  var firstFittingPlacement = placements2[0];
  for (var i = 0; i < placements2.length; i++) {
    var placement = placements2[i];
    var _basePlacement = getBasePlacement(placement);
    var isStartVariation = getVariation(placement) === start;
    var isVertical = [top, bottom].indexOf(_basePlacement) >= 0;
    var len = isVertical ? "width" : "height";
    var overflow = detectOverflow(state, {
      placement,
      boundary,
      rootBoundary,
      altBoundary,
      padding
    });
    var mainVariationSide = isVertical ? isStartVariation ? right : left : isStartVariation ? bottom : top;
    if (referenceRect[len] > popperRect[len]) {
      mainVariationSide = getOppositePlacement(mainVariationSide);
    }
    var altVariationSide = getOppositePlacement(mainVariationSide);
    var checks = [];
    if (checkMainAxis) {
      checks.push(overflow[_basePlacement] <= 0);
    }
    if (checkAltAxis) {
      checks.push(overflow[mainVariationSide] <= 0, overflow[altVariationSide] <= 0);
    }
    if (checks.every(function(check) {
      return check;
    })) {
      firstFittingPlacement = placement;
      makeFallbackChecks = false;
      break;
    }
    checksMap.set(placement, checks);
  }
  if (makeFallbackChecks) {
    var numberOfChecks = flipVariations ? 3 : 1;
    var _loop = function _loop2(_i2) {
      var fittingPlacement = placements2.find(function(placement2) {
        var checks2 = checksMap.get(placement2);
        if (checks2) {
          return checks2.slice(0, _i2).every(function(check) {
            return check;
          });
        }
      });
      if (fittingPlacement) {
        firstFittingPlacement = fittingPlacement;
        return "break";
      }
    };
    for (var _i = numberOfChecks; _i > 0; _i--) {
      var _ret = _loop(_i);
      if (_ret === "break")
        break;
    }
  }
  if (state.placement !== firstFittingPlacement) {
    state.modifiersData[name]._skip = true;
    state.placement = firstFittingPlacement;
    state.reset = true;
  }
}
var flip_default = {
  name: "flip",
  enabled: true,
  phase: "main",
  fn: flip,
  requiresIfExists: ["offset"],
  data: {
    _skip: false
  }
};

// node_modules/@popperjs/core/lib/modifiers/hide.js
function getSideOffsets(overflow, rect, preventedOffsets) {
  if (preventedOffsets === void 0) {
    preventedOffsets = {
      x: 0,
      y: 0
    };
  }
  return {
    top: overflow.top - rect.height - preventedOffsets.y,
    right: overflow.right - rect.width + preventedOffsets.x,
    bottom: overflow.bottom - rect.height + preventedOffsets.y,
    left: overflow.left - rect.width - preventedOffsets.x
  };
}
function isAnySideFullyClipped(overflow) {
  return [top, right, bottom, left].some(function(side) {
    return overflow[side] >= 0;
  });
}
function hide(_ref) {
  var state = _ref.state, name = _ref.name;
  var referenceRect = state.rects.reference;
  var popperRect = state.rects.popper;
  var preventedOffsets = state.modifiersData.preventOverflow;
  var referenceOverflow = detectOverflow(state, {
    elementContext: "reference"
  });
  var popperAltOverflow = detectOverflow(state, {
    altBoundary: true
  });
  var referenceClippingOffsets = getSideOffsets(referenceOverflow, referenceRect);
  var popperEscapeOffsets = getSideOffsets(popperAltOverflow, popperRect, preventedOffsets);
  var isReferenceHidden = isAnySideFullyClipped(referenceClippingOffsets);
  var hasPopperEscaped = isAnySideFullyClipped(popperEscapeOffsets);
  state.modifiersData[name] = {
    referenceClippingOffsets,
    popperEscapeOffsets,
    isReferenceHidden,
    hasPopperEscaped
  };
  state.attributes.popper = Object.assign({}, state.attributes.popper, {
    "data-popper-reference-hidden": isReferenceHidden,
    "data-popper-escaped": hasPopperEscaped
  });
}
var hide_default = {
  name: "hide",
  enabled: true,
  phase: "main",
  requiresIfExists: ["preventOverflow"],
  fn: hide
};

// node_modules/@popperjs/core/lib/modifiers/offset.js
function distanceAndSkiddingToXY(placement, rects, offset2) {
  var basePlacement = getBasePlacement(placement);
  var invertDistance = [left, top].indexOf(basePlacement) >= 0 ? -1 : 1;
  var _ref = typeof offset2 === "function" ? offset2(Object.assign({}, rects, {
    placement
  })) : offset2, skidding = _ref[0], distance = _ref[1];
  skidding = skidding || 0;
  distance = (distance || 0) * invertDistance;
  return [left, right].indexOf(basePlacement) >= 0 ? {
    x: distance,
    y: skidding
  } : {
    x: skidding,
    y: distance
  };
}
function offset(_ref2) {
  var state = _ref2.state, options = _ref2.options, name = _ref2.name;
  var _options$offset = options.offset, offset2 = _options$offset === void 0 ? [0, 0] : _options$offset;
  var data = placements.reduce(function(acc, placement) {
    acc[placement] = distanceAndSkiddingToXY(placement, state.rects, offset2);
    return acc;
  }, {});
  var _data$state$placement = data[state.placement], x = _data$state$placement.x, y = _data$state$placement.y;
  if (state.modifiersData.popperOffsets != null) {
    state.modifiersData.popperOffsets.x += x;
    state.modifiersData.popperOffsets.y += y;
  }
  state.modifiersData[name] = data;
}
var offset_default = {
  name: "offset",
  enabled: true,
  phase: "main",
  requires: ["popperOffsets"],
  fn: offset
};

// node_modules/@popperjs/core/lib/modifiers/popperOffsets.js
function popperOffsets(_ref) {
  var state = _ref.state, name = _ref.name;
  state.modifiersData[name] = computeOffsets({
    reference: state.rects.reference,
    element: state.rects.popper,
    strategy: "absolute",
    placement: state.placement
  });
}
var popperOffsets_default = {
  name: "popperOffsets",
  enabled: true,
  phase: "read",
  fn: popperOffsets,
  data: {}
};

// node_modules/@popperjs/core/lib/utils/getAltAxis.js
function getAltAxis(axis) {
  return axis === "x" ? "y" : "x";
}

// node_modules/@popperjs/core/lib/modifiers/preventOverflow.js
function preventOverflow(_ref) {
  var state = _ref.state, options = _ref.options, name = _ref.name;
  var _options$mainAxis = options.mainAxis, checkMainAxis = _options$mainAxis === void 0 ? true : _options$mainAxis, _options$altAxis = options.altAxis, checkAltAxis = _options$altAxis === void 0 ? false : _options$altAxis, boundary = options.boundary, rootBoundary = options.rootBoundary, altBoundary = options.altBoundary, padding = options.padding, _options$tether = options.tether, tether = _options$tether === void 0 ? true : _options$tether, _options$tetherOffset = options.tetherOffset, tetherOffset = _options$tetherOffset === void 0 ? 0 : _options$tetherOffset;
  var overflow = detectOverflow(state, {
    boundary,
    rootBoundary,
    padding,
    altBoundary
  });
  var basePlacement = getBasePlacement(state.placement);
  var variation = getVariation(state.placement);
  var isBasePlacement = !variation;
  var mainAxis = getMainAxisFromPlacement(basePlacement);
  var altAxis = getAltAxis(mainAxis);
  var popperOffsets2 = state.modifiersData.popperOffsets;
  var referenceRect = state.rects.reference;
  var popperRect = state.rects.popper;
  var tetherOffsetValue = typeof tetherOffset === "function" ? tetherOffset(Object.assign({}, state.rects, {
    placement: state.placement
  })) : tetherOffset;
  var normalizedTetherOffsetValue = typeof tetherOffsetValue === "number" ? {
    mainAxis: tetherOffsetValue,
    altAxis: tetherOffsetValue
  } : Object.assign({
    mainAxis: 0,
    altAxis: 0
  }, tetherOffsetValue);
  var offsetModifierState = state.modifiersData.offset ? state.modifiersData.offset[state.placement] : null;
  var data = {
    x: 0,
    y: 0
  };
  if (!popperOffsets2) {
    return;
  }
  if (checkMainAxis) {
    var _offsetModifierState$;
    var mainSide = mainAxis === "y" ? top : left;
    var altSide = mainAxis === "y" ? bottom : right;
    var len = mainAxis === "y" ? "height" : "width";
    var offset2 = popperOffsets2[mainAxis];
    var min2 = offset2 + overflow[mainSide];
    var max2 = offset2 - overflow[altSide];
    var additive = tether ? -popperRect[len] / 2 : 0;
    var minLen = variation === start ? referenceRect[len] : popperRect[len];
    var maxLen = variation === start ? -popperRect[len] : -referenceRect[len];
    var arrowElement = state.elements.arrow;
    var arrowRect = tether && arrowElement ? getLayoutRect(arrowElement) : {
      width: 0,
      height: 0
    };
    var arrowPaddingObject = state.modifiersData["arrow#persistent"] ? state.modifiersData["arrow#persistent"].padding : getFreshSideObject();
    var arrowPaddingMin = arrowPaddingObject[mainSide];
    var arrowPaddingMax = arrowPaddingObject[altSide];
    var arrowLen = within(0, referenceRect[len], arrowRect[len]);
    var minOffset = isBasePlacement ? referenceRect[len] / 2 - additive - arrowLen - arrowPaddingMin - normalizedTetherOffsetValue.mainAxis : minLen - arrowLen - arrowPaddingMin - normalizedTetherOffsetValue.mainAxis;
    var maxOffset = isBasePlacement ? -referenceRect[len] / 2 + additive + arrowLen + arrowPaddingMax + normalizedTetherOffsetValue.mainAxis : maxLen + arrowLen + arrowPaddingMax + normalizedTetherOffsetValue.mainAxis;
    var arrowOffsetParent = state.elements.arrow && getOffsetParent(state.elements.arrow);
    var clientOffset = arrowOffsetParent ? mainAxis === "y" ? arrowOffsetParent.clientTop || 0 : arrowOffsetParent.clientLeft || 0 : 0;
    var offsetModifierValue = (_offsetModifierState$ = offsetModifierState == null ? void 0 : offsetModifierState[mainAxis]) != null ? _offsetModifierState$ : 0;
    var tetherMin = offset2 + minOffset - offsetModifierValue - clientOffset;
    var tetherMax = offset2 + maxOffset - offsetModifierValue;
    var preventedOffset = within(tether ? min(min2, tetherMin) : min2, offset2, tether ? max(max2, tetherMax) : max2);
    popperOffsets2[mainAxis] = preventedOffset;
    data[mainAxis] = preventedOffset - offset2;
  }
  if (checkAltAxis) {
    var _offsetModifierState$2;
    var _mainSide = mainAxis === "x" ? top : left;
    var _altSide = mainAxis === "x" ? bottom : right;
    var _offset = popperOffsets2[altAxis];
    var _len = altAxis === "y" ? "height" : "width";
    var _min = _offset + overflow[_mainSide];
    var _max = _offset - overflow[_altSide];
    var isOriginSide = [top, left].indexOf(basePlacement) !== -1;
    var _offsetModifierValue = (_offsetModifierState$2 = offsetModifierState == null ? void 0 : offsetModifierState[altAxis]) != null ? _offsetModifierState$2 : 0;
    var _tetherMin = isOriginSide ? _min : _offset - referenceRect[_len] - popperRect[_len] - _offsetModifierValue + normalizedTetherOffsetValue.altAxis;
    var _tetherMax = isOriginSide ? _offset + referenceRect[_len] + popperRect[_len] - _offsetModifierValue - normalizedTetherOffsetValue.altAxis : _max;
    var _preventedOffset = tether && isOriginSide ? withinMaxClamp(_tetherMin, _offset, _tetherMax) : within(tether ? _tetherMin : _min, _offset, tether ? _tetherMax : _max);
    popperOffsets2[altAxis] = _preventedOffset;
    data[altAxis] = _preventedOffset - _offset;
  }
  state.modifiersData[name] = data;
}
var preventOverflow_default = {
  name: "preventOverflow",
  enabled: true,
  phase: "main",
  fn: preventOverflow,
  requiresIfExists: ["offset"]
};

// node_modules/@popperjs/core/lib/dom-utils/getHTMLElementScroll.js
function getHTMLElementScroll(element) {
  return {
    scrollLeft: element.scrollLeft,
    scrollTop: element.scrollTop
  };
}

// node_modules/@popperjs/core/lib/dom-utils/getNodeScroll.js
function getNodeScroll(node) {
  if (node === getWindow(node) || !isHTMLElement(node)) {
    return getWindowScroll(node);
  } else {
    return getHTMLElementScroll(node);
  }
}

// node_modules/@popperjs/core/lib/dom-utils/getCompositeRect.js
function isElementScaled(element) {
  var rect = element.getBoundingClientRect();
  var scaleX = round(rect.width) / element.offsetWidth || 1;
  var scaleY = round(rect.height) / element.offsetHeight || 1;
  return scaleX !== 1 || scaleY !== 1;
}
function getCompositeRect(elementOrVirtualElement, offsetParent, isFixed) {
  if (isFixed === void 0) {
    isFixed = false;
  }
  var isOffsetParentAnElement = isHTMLElement(offsetParent);
  var offsetParentIsScaled = isHTMLElement(offsetParent) && isElementScaled(offsetParent);
  var documentElement = getDocumentElement(offsetParent);
  var rect = getBoundingClientRect(elementOrVirtualElement, offsetParentIsScaled);
  var scroll = {
    scrollLeft: 0,
    scrollTop: 0
  };
  var offsets = {
    x: 0,
    y: 0
  };
  if (isOffsetParentAnElement || !isOffsetParentAnElement && !isFixed) {
    if (getNodeName(offsetParent) !== "body" || isScrollParent(documentElement)) {
      scroll = getNodeScroll(offsetParent);
    }
    if (isHTMLElement(offsetParent)) {
      offsets = getBoundingClientRect(offsetParent, true);
      offsets.x += offsetParent.clientLeft;
      offsets.y += offsetParent.clientTop;
    } else if (documentElement) {
      offsets.x = getWindowScrollBarX(documentElement);
    }
  }
  return {
    x: rect.left + scroll.scrollLeft - offsets.x,
    y: rect.top + scroll.scrollTop - offsets.y,
    width: rect.width,
    height: rect.height
  };
}

// node_modules/@popperjs/core/lib/utils/orderModifiers.js
function order(modifiers) {
  var map = /* @__PURE__ */ new Map();
  var visited = /* @__PURE__ */ new Set();
  var result = [];
  modifiers.forEach(function(modifier) {
    map.set(modifier.name, modifier);
  });
  function sort(modifier) {
    visited.add(modifier.name);
    var requires = [].concat(modifier.requires || [], modifier.requiresIfExists || []);
    requires.forEach(function(dep) {
      if (!visited.has(dep)) {
        var depModifier = map.get(dep);
        if (depModifier) {
          sort(depModifier);
        }
      }
    });
    result.push(modifier);
  }
  modifiers.forEach(function(modifier) {
    if (!visited.has(modifier.name)) {
      sort(modifier);
    }
  });
  return result;
}
function orderModifiers(modifiers) {
  var orderedModifiers = order(modifiers);
  return modifierPhases.reduce(function(acc, phase) {
    return acc.concat(orderedModifiers.filter(function(modifier) {
      return modifier.phase === phase;
    }));
  }, []);
}

// node_modules/@popperjs/core/lib/utils/debounce.js
function debounce(fn2) {
  var pending;
  return function() {
    if (!pending) {
      pending = new Promise(function(resolve) {
        Promise.resolve().then(function() {
          pending = void 0;
          resolve(fn2());
        });
      });
    }
    return pending;
  };
}

// node_modules/@popperjs/core/lib/utils/format.js
function format(str) {
  for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
    args[_key - 1] = arguments[_key];
  }
  return [].concat(args).reduce(function(p, c) {
    return p.replace(/%s/, c);
  }, str);
}

// node_modules/@popperjs/core/lib/utils/validateModifiers.js
var INVALID_MODIFIER_ERROR = 'Popper: modifier "%s" provided an invalid %s property, expected %s but got %s';
var MISSING_DEPENDENCY_ERROR = 'Popper: modifier "%s" requires "%s", but "%s" modifier is not available';
var VALID_PROPERTIES = ["name", "enabled", "phase", "fn", "effect", "requires", "options"];
function validateModifiers(modifiers) {
  modifiers.forEach(function(modifier) {
    [].concat(Object.keys(modifier), VALID_PROPERTIES).filter(function(value, index, self) {
      return self.indexOf(value) === index;
    }).forEach(function(key) {
      switch (key) {
        case "name":
          if (typeof modifier.name !== "string") {
            console.error(format(INVALID_MODIFIER_ERROR, String(modifier.name), '"name"', '"string"', '"' + String(modifier.name) + '"'));
          }
          break;
        case "enabled":
          if (typeof modifier.enabled !== "boolean") {
            console.error(format(INVALID_MODIFIER_ERROR, modifier.name, '"enabled"', '"boolean"', '"' + String(modifier.enabled) + '"'));
          }
          break;
        case "phase":
          if (modifierPhases.indexOf(modifier.phase) < 0) {
            console.error(format(INVALID_MODIFIER_ERROR, modifier.name, '"phase"', "either " + modifierPhases.join(", "), '"' + String(modifier.phase) + '"'));
          }
          break;
        case "fn":
          if (typeof modifier.fn !== "function") {
            console.error(format(INVALID_MODIFIER_ERROR, modifier.name, '"fn"', '"function"', '"' + String(modifier.fn) + '"'));
          }
          break;
        case "effect":
          if (modifier.effect != null && typeof modifier.effect !== "function") {
            console.error(format(INVALID_MODIFIER_ERROR, modifier.name, '"effect"', '"function"', '"' + String(modifier.fn) + '"'));
          }
          break;
        case "requires":
          if (modifier.requires != null && !Array.isArray(modifier.requires)) {
            console.error(format(INVALID_MODIFIER_ERROR, modifier.name, '"requires"', '"array"', '"' + String(modifier.requires) + '"'));
          }
          break;
        case "requiresIfExists":
          if (!Array.isArray(modifier.requiresIfExists)) {
            console.error(format(INVALID_MODIFIER_ERROR, modifier.name, '"requiresIfExists"', '"array"', '"' + String(modifier.requiresIfExists) + '"'));
          }
          break;
        case "options":
        case "data":
          break;
        default:
          console.error('PopperJS: an invalid property has been provided to the "' + modifier.name + '" modifier, valid properties are ' + VALID_PROPERTIES.map(function(s) {
            return '"' + s + '"';
          }).join(", ") + '; but "' + key + '" was provided.');
      }
      modifier.requires && modifier.requires.forEach(function(requirement) {
        if (modifiers.find(function(mod) {
          return mod.name === requirement;
        }) == null) {
          console.error(format(MISSING_DEPENDENCY_ERROR, String(modifier.name), requirement, requirement));
        }
      });
    });
  });
}

// node_modules/@popperjs/core/lib/utils/uniqueBy.js
function uniqueBy(arr, fn2) {
  var identifiers = /* @__PURE__ */ new Set();
  return arr.filter(function(item) {
    var identifier = fn2(item);
    if (!identifiers.has(identifier)) {
      identifiers.add(identifier);
      return true;
    }
  });
}

// node_modules/@popperjs/core/lib/utils/mergeByName.js
function mergeByName(modifiers) {
  var merged = modifiers.reduce(function(merged2, current) {
    var existing = merged2[current.name];
    merged2[current.name] = existing ? Object.assign({}, existing, current, {
      options: Object.assign({}, existing.options, current.options),
      data: Object.assign({}, existing.data, current.data)
    }) : current;
    return merged2;
  }, {});
  return Object.keys(merged).map(function(key) {
    return merged[key];
  });
}

// node_modules/@popperjs/core/lib/createPopper.js
var INVALID_ELEMENT_ERROR = "Popper: Invalid reference or popper argument provided. They must be either a DOM element or virtual element.";
var INFINITE_LOOP_ERROR = "Popper: An infinite loop in the modifiers cycle has been detected! The cycle has been interrupted to prevent a browser crash.";
var DEFAULT_OPTIONS = {
  placement: "bottom",
  modifiers: [],
  strategy: "absolute"
};
function areValidElements() {
  for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
    args[_key] = arguments[_key];
  }
  return !args.some(function(element) {
    return !(element && typeof element.getBoundingClientRect === "function");
  });
}
function popperGenerator(generatorOptions) {
  if (generatorOptions === void 0) {
    generatorOptions = {};
  }
  var _generatorOptions = generatorOptions, _generatorOptions$def = _generatorOptions.defaultModifiers, defaultModifiers2 = _generatorOptions$def === void 0 ? [] : _generatorOptions$def, _generatorOptions$def2 = _generatorOptions.defaultOptions, defaultOptions = _generatorOptions$def2 === void 0 ? DEFAULT_OPTIONS : _generatorOptions$def2;
  return function createPopper2(reference2, popper2, options) {
    if (options === void 0) {
      options = defaultOptions;
    }
    var state = {
      placement: "bottom",
      orderedModifiers: [],
      options: Object.assign({}, DEFAULT_OPTIONS, defaultOptions),
      modifiersData: {},
      elements: {
        reference: reference2,
        popper: popper2
      },
      attributes: {},
      styles: {}
    };
    var effectCleanupFns = [];
    var isDestroyed = false;
    var instance = {
      state,
      setOptions: function setOptions(setOptionsAction) {
        var options2 = typeof setOptionsAction === "function" ? setOptionsAction(state.options) : setOptionsAction;
        cleanupModifierEffects();
        state.options = Object.assign({}, defaultOptions, state.options, options2);
        state.scrollParents = {
          reference: isElement(reference2) ? listScrollParents(reference2) : reference2.contextElement ? listScrollParents(reference2.contextElement) : [],
          popper: listScrollParents(popper2)
        };
        var orderedModifiers = orderModifiers(mergeByName([].concat(defaultModifiers2, state.options.modifiers)));
        state.orderedModifiers = orderedModifiers.filter(function(m) {
          return m.enabled;
        });
        if (true) {
          var modifiers = uniqueBy([].concat(orderedModifiers, state.options.modifiers), function(_ref) {
            var name = _ref.name;
            return name;
          });
          validateModifiers(modifiers);
          if (getBasePlacement(state.options.placement) === auto) {
            var flipModifier = state.orderedModifiers.find(function(_ref2) {
              var name = _ref2.name;
              return name === "flip";
            });
            if (!flipModifier) {
              console.error(['Popper: "auto" placements require the "flip" modifier be', "present and enabled to work."].join(" "));
            }
          }
          var _getComputedStyle = getComputedStyle(popper2), marginTop = _getComputedStyle.marginTop, marginRight = _getComputedStyle.marginRight, marginBottom = _getComputedStyle.marginBottom, marginLeft = _getComputedStyle.marginLeft;
          if ([marginTop, marginRight, marginBottom, marginLeft].some(function(margin) {
            return parseFloat(margin);
          })) {
            console.warn(['Popper: CSS "margin" styles cannot be used to apply padding', "between the popper and its reference element or boundary.", "To replicate margin, use the `offset` modifier, as well as", "the `padding` option in the `preventOverflow` and `flip`", "modifiers."].join(" "));
          }
        }
        runModifierEffects();
        return instance.update();
      },
      forceUpdate: function forceUpdate() {
        if (isDestroyed) {
          return;
        }
        var _state$elements = state.elements, reference3 = _state$elements.reference, popper3 = _state$elements.popper;
        if (!areValidElements(reference3, popper3)) {
          if (true) {
            console.error(INVALID_ELEMENT_ERROR);
          }
          return;
        }
        state.rects = {
          reference: getCompositeRect(reference3, getOffsetParent(popper3), state.options.strategy === "fixed"),
          popper: getLayoutRect(popper3)
        };
        state.reset = false;
        state.placement = state.options.placement;
        state.orderedModifiers.forEach(function(modifier) {
          return state.modifiersData[modifier.name] = Object.assign({}, modifier.data);
        });
        var __debug_loops__ = 0;
        for (var index = 0; index < state.orderedModifiers.length; index++) {
          if (true) {
            __debug_loops__ += 1;
            if (__debug_loops__ > 100) {
              console.error(INFINITE_LOOP_ERROR);
              break;
            }
          }
          if (state.reset === true) {
            state.reset = false;
            index = -1;
            continue;
          }
          var _state$orderedModifie = state.orderedModifiers[index], fn2 = _state$orderedModifie.fn, _state$orderedModifie2 = _state$orderedModifie.options, _options = _state$orderedModifie2 === void 0 ? {} : _state$orderedModifie2, name = _state$orderedModifie.name;
          if (typeof fn2 === "function") {
            state = fn2({
              state,
              options: _options,
              name,
              instance
            }) || state;
          }
        }
      },
      update: debounce(function() {
        return new Promise(function(resolve) {
          instance.forceUpdate();
          resolve(state);
        });
      }),
      destroy: function destroy() {
        cleanupModifierEffects();
        isDestroyed = true;
      }
    };
    if (!areValidElements(reference2, popper2)) {
      if (true) {
        console.error(INVALID_ELEMENT_ERROR);
      }
      return instance;
    }
    instance.setOptions(options).then(function(state2) {
      if (!isDestroyed && options.onFirstUpdate) {
        options.onFirstUpdate(state2);
      }
    });
    function runModifierEffects() {
      state.orderedModifiers.forEach(function(_ref3) {
        var name = _ref3.name, _ref3$options = _ref3.options, options2 = _ref3$options === void 0 ? {} : _ref3$options, effect4 = _ref3.effect;
        if (typeof effect4 === "function") {
          var cleanupFn = effect4({
            state,
            name,
            instance,
            options: options2
          });
          var noopFn = function noopFn2() {
          };
          effectCleanupFns.push(cleanupFn || noopFn);
        }
      });
    }
    function cleanupModifierEffects() {
      effectCleanupFns.forEach(function(fn2) {
        return fn2();
      });
      effectCleanupFns = [];
    }
    return instance;
  };
}

// node_modules/@popperjs/core/lib/popper.js
var defaultModifiers = [eventListeners_default, popperOffsets_default, computeStyles_default, applyStyles_default, offset_default, flip_default, preventOverflow_default, arrow_default, hide_default];
var createPopper = /* @__PURE__ */ popperGenerator({
  defaultModifiers
});

// src/suggester/suggest.ts
var wrapAround = (value, size) => {
  return (value % size + size) % size;
};
var Suggest = class {
  constructor(owner, containerEl, scope) {
    this.owner = owner;
    this.containerEl = containerEl;
    containerEl.on("click", ".suggestion-item", this.onSuggestionClick.bind(this));
    containerEl.on("mousemove", ".suggestion-item", this.onSuggestionMouseover.bind(this));
    scope.register([], "ArrowUp", (event) => {
      if (!event.isComposing) {
        this.setSelectedItem(this.selectedItem - 1, true);
        return false;
      }
    });
    scope.register([], "ArrowDown", (event) => {
      if (!event.isComposing) {
        this.setSelectedItem(this.selectedItem + 1, true);
        return false;
      }
    });
    scope.register([], "Enter", (event) => {
      if (!event.isComposing) {
        this.useSelectedItem(event);
        return false;
      }
    });
  }
  onSuggestionClick(event, el) {
    event.preventDefault();
    const item = this.suggestions.indexOf(el);
    this.setSelectedItem(item, false);
    this.useSelectedItem(event);
  }
  onSuggestionMouseover(_event, el) {
    const item = this.suggestions.indexOf(el);
    this.setSelectedItem(item, false);
  }
  setSuggestions(values) {
    this.containerEl.empty();
    const suggestionEls = [];
    values.forEach((value) => {
      const suggestionEl = this.containerEl.createDiv("suggestion-item");
      this.owner.renderSuggestion(value, suggestionEl);
      suggestionEls.push(suggestionEl);
    });
    this.values = values;
    this.suggestions = suggestionEls;
    this.setSelectedItem(0, false);
  }
  useSelectedItem(event) {
    const currentValue = this.values[this.selectedItem];
    if (currentValue) {
      this.owner.selectSuggestion(currentValue, event);
    }
  }
  setSelectedItem(selectedIndex, scrollIntoView) {
    const normalizedIndex = wrapAround(selectedIndex, this.suggestions.length);
    const prevSelectedSuggestion = this.suggestions[this.selectedItem];
    const selectedSuggestion = this.suggestions[normalizedIndex];
    prevSelectedSuggestion == null ? void 0 : prevSelectedSuggestion.removeClass("is-selected");
    selectedSuggestion == null ? void 0 : selectedSuggestion.addClass("is-selected");
    this.selectedItem = normalizedIndex;
    if (scrollIntoView) {
      selectedSuggestion.scrollIntoView(false);
    }
  }
};
var TextInputSuggest = class {
  constructor(inputEl) {
    this.inputEl = inputEl;
    this.scope = new import_obsidian14.Scope();
    this.suggestEl = createDiv("suggestion-container");
    const suggestion = this.suggestEl.createDiv("suggestion");
    this.suggest = new Suggest(this, suggestion, this.scope);
    this.scope.register([], "Escape", this.close.bind(this));
    this.inputEl.addEventListener("input", this.onInputChanged.bind(this));
    this.inputEl.addEventListener("focus", this.onInputChanged.bind(this));
    this.inputEl.addEventListener("blur", this.close.bind(this));
    this.suggestEl.on("mousedown", ".suggestion-container", (event) => {
      event.preventDefault();
    });
  }
  onInputChanged() {
    const inputStr = this.inputEl.value;
    const suggestions = this.getSuggestions(inputStr);
    if (!suggestions) {
      this.close();
      return;
    }
    if (suggestions.length > 0) {
      this.suggest.setSuggestions(suggestions);
      this.open(app.dom.appContainerEl, this.inputEl);
    } else {
      this.close();
    }
  }
  open(container, inputEl) {
    app.keymap.pushScope(this.scope);
    container.appendChild(this.suggestEl);
    this.popper = createPopper(inputEl, this.suggestEl, {
      placement: "bottom-start",
      modifiers: [
        {
          name: "sameWidth",
          enabled: true,
          fn: ({ state, instance }) => {
            const targetWidth = `${state.rects.reference.width}px`;
            if (state.styles.popper.width === targetWidth) {
              return;
            }
            state.styles.popper.width = targetWidth;
            instance.update();
          },
          phase: "beforeWrite",
          requires: ["computeStyles"]
        }
      ]
    });
  }
  close() {
    app.keymap.popScope(this.scope);
    this.suggest.setSuggestions([]);
    if (this.popper)
      this.popper.destroy();
    this.suggestEl.detach();
  }
};

// src/utils/fileUtils.ts
var import_obsidian15 = require("obsidian");
function resolve_tfolder(plugin, folder_str) {
  folder_str = (0, import_obsidian15.normalizePath)(folder_str);
  const folder = plugin.app.vault.getAbstractFileByPath(folder_str);
  if (!folder) {
    throw new Error(`Folder "${folder_str}" doesn't exist`);
  }
  if (!(folder instanceof import_obsidian15.TFolder)) {
    throw new Error(`${folder_str} is a file, not a folder`);
  }
  return folder;
}
function get_tfiles_from_folder(plugin, folder_str) {
  const folder = resolve_tfolder(plugin, folder_str);
  const files = [];
  import_obsidian15.Vault.recurseChildren(folder, (file) => {
    if (file instanceof import_obsidian15.TFile) {
      files.push(file);
    }
  });
  files.sort((a, b) => {
    return a.basename.localeCompare(b.basename);
  });
  return files;
}

// src/suggester/FileSuggester.ts
var FileSuggest = class extends TextInputSuggest {
  constructor(inputEl, plugin, folder) {
    super(inputEl);
    this.inputEl = inputEl;
    this.plugin = plugin;
    this.folder = folder;
    this.plugin = plugin;
  }
  getSuggestions(input_str) {
    const all_files = [];
    try {
      all_files.push(...get_tfiles_from_folder(this.plugin, this.folder));
    } catch (error) {
    }
    const files = [];
    const lower_input_str = input_str.toLowerCase();
    all_files.forEach((file) => {
      if (file instanceof import_obsidian16.TFile && file.extension === "md" && file.path.toLowerCase().contains(lower_input_str)) {
        files.push(file);
      }
    });
    return files;
  }
  renderSuggestion(file, el) {
    el.setText(file.path);
  }
  selectSuggestion(file) {
    this.inputEl.value = file.path;
    this.inputEl.trigger("input");
    this.close();
  }
};

// src/fields/fieldManagers/AbstractListBasedField.ts
var AbstractListBasedField = class extends FieldManager2 {
  constructor(plugin, field, type) {
    super(plugin, field, type);
  }
  setValueListText(header) {
    header.setText(`Preset options: ${Object.values(this.field.options.valuesList).join(", ")}`);
  }
  createListNotePathContainer(parentNode, plugin) {
    const valuesListNotePathContainer = parentNode.createDiv({});
    const listNoteContainerLabel = valuesListNotePathContainer.createDiv({ cls: "metadata-menu-setting-fileClass-search" });
    listNoteContainerLabel.setText(`Path of the note containing the values:`);
    const input = new import_obsidian17.TextComponent(valuesListNotePathContainer);
    new FileSuggest(input.inputEl, plugin, "/");
    const listNotePath = this.field.options.valuesListNotePath;
    input.setValue(listNotePath || "");
    input.setPlaceholder("Path/of/the/note.md");
    input.onChange((value) => this.field.options.valuesListNotePath = value);
    return valuesListNotePathContainer;
  }
  removePresetValue(key) {
    let newValues = {};
    for (let _key in this.field.options.valuesList) {
      if (key !== _key) {
        newValues[_key] = this.field.options.valuesList[_key];
      }
      ;
    }
    ;
    this.field.options.valuesList = newValues;
  }
  createValuesListContainer(parentContainer) {
    const presetValuesFields = parentContainer.createDiv();
    const valuesList = presetValuesFields.createDiv();
    const valuesListHeader = valuesList.createDiv({ cls: "metadata-menu-field-option" });
    valuesListHeader.createEl("h2");
    valuesListHeader.setText(`Preset options: ${Object.values(this.field.options.valuesList).join(", ")}`);
    const valuesListBody = valuesList.createDiv();
    Object.keys(this.field.options.valuesList).forEach((key) => {
      this.valuesPromptComponents.push(this.createValueContainer(valuesListBody, valuesListHeader, key));
    });
    this.createAddButton(valuesList, valuesListBody, valuesListHeader);
    return presetValuesFields;
  }
  createValueContainer(parentNode, header, key) {
    const values = this.field.options.valuesList || {};
    const presetValue = values[key];
    const valueContainer = parentNode.createDiv({
      cls: "metadata-menu-prompt-container"
    });
    const input = new import_obsidian17.TextComponent(valueContainer);
    this.valuesPromptComponents.push(input);
    input.setValue(presetValue);
    input.onChange((value) => {
      this.field.options.valuesList[key] = value;
      this.setValueListText(header);
      FieldSettingsModal.removeValidationError(input);
    });
    const valueRemoveButton = new import_obsidian17.ButtonComponent(valueContainer);
    valueRemoveButton.setIcon("trash").onClick((evt) => {
      evt.preventDefault;
      this.removePresetValue(key);
      this.setValueListText(header);
      parentNode.removeChild(valueContainer);
      this.valuesPromptComponents.remove(input);
    });
    if (key != Object.keys(this.field.options)[0]) {
      const valueUpgradeButton = new import_obsidian17.ButtonComponent(valueContainer);
      (0, import_obsidian17.setIcon)(valueUpgradeButton.buttonEl, "up-chevron-glyph");
      valueUpgradeButton.onClick((evt) => {
        const thisValue = values[key];
        const inputIndex = this.valuesPromptComponents.indexOf(input);
        const upperComponent = inputIndex !== -1 ? this.valuesPromptComponents[inputIndex - 1] : this.valuesPromptComponents.last();
        if (upperComponent) {
          const upperValue = upperComponent.inputEl.value;
          const upperKey = Object.keys(values).filter((k) => values[k] == upperValue)[0];
          if (upperKey) {
            upperComponent.setValue(thisValue);
            values[upperKey] = thisValue;
            input.setValue(upperValue);
            values[key] = upperValue;
          }
          ;
        }
        ;
      });
    }
    ;
    return input;
  }
  validateValue(value) {
    if (this.field.options.valuesList && Object.values(this.field.options.valuesList).length > 0) {
      if (value) {
        return Object.values(this.field.options).includes(value.trim());
      } else {
        return true;
      }
    } else if (this.field.options.valuesListNotePath) {
      const listNoteValues = this.plugin.fieldIndex.valuesListNotePathValues.get(this.field.options.valuesListNotePath);
      return listNoteValues !== void 0 ? listNoteValues.contains(value.trim()) : false;
    } else {
      return false;
    }
  }
  getOptionsStr() {
    switch (this.field.options.sourceType) {
      case "ValuesList" /* ValuesList */:
        return Object.values(this.field.options.valuesList).join(", ");
      case "ValuesListNotePath" /* ValuesListNotePath */:
        return this.field.options.valuesListNotePath;
      case "ValuesFromDVQuery" /* ValuesFromDVQuery */:
        return this.field.options.valuesFromDVQuery;
      default:
        return "";
    }
  }
  getOptionsList(dvFile = void 0) {
    var _a;
    let values = [];
    if (Array.isArray(this.field.options)) {
      values = this.field.options;
    } else if (!this.field.options.sourceType) {
      values = Object.values(this.field.options);
    } else {
      switch (this.field.options.sourceType) {
        case "ValuesList" /* ValuesList */:
          values = Object.values(this.field.options.valuesList);
          break;
        case "ValuesListNotePath" /* ValuesListNotePath */:
          values = this.plugin.fieldIndex.valuesListNotePathValues.get(this.field.options.valuesListNotePath) || [];
          break;
        case "ValuesFromDVQuery" /* ValuesFromDVQuery */:
          {
            const dvApi = (_a = this.plugin.app.plugins.plugins.dataview) == null ? void 0 : _a.api;
            if (dvApi) {
              values = new Function("dv", "current", `return ${this.field.options.valuesFromDVQuery}`)(dvApi, dvFile);
            } else {
              values = [];
            }
          }
          break;
        default:
          values = [];
          break;
      }
    }
    return values;
  }
  validateOptions() {
    let error = false;
    this.valuesPromptComponents.forEach((input) => {
      var _a, _b;
      if (/[,]/gu.test(input.inputEl.value) && ((_a = input.inputEl.parentElement) == null ? void 0 : _a.lastElementChild)) {
        FieldSettingsModal.setValidationError(input, input.inputEl.parentElement.lastElementChild, "Values cannot contain a comma");
        error = true;
      }
      ;
      if (input.inputEl.value == "" && ((_b = input.inputEl.parentElement) == null ? void 0 : _b.lastElementChild)) {
        FieldSettingsModal.setValidationError(input, input.inputEl.parentElement.lastElementChild, "Values can't be null.");
        error = true;
      }
      ;
    });
    return !error;
  }
  createAddButton(valuesList, valuesListBody, valuesListHeader) {
    const valuesListFooter = valuesList.createDiv();
    const addValue = valuesListFooter.createEl("button");
    addValue.type = "button";
    addValue.textContent = "Add";
    addValue.onClickEvent((evt) => __async(this, null, function* () {
      evt.preventDefault;
      let newKeyNumber = 1;
      Object.keys(this.field.options.valuesList).forEach((key) => {
        if (parseInt(key) && parseInt(key) >= newKeyNumber) {
          newKeyNumber = parseInt(key) + 1;
        }
        ;
      });
      const newKey = newKeyNumber.toString();
      this.field.options.valuesList[newKey] = "";
      this.createValueContainer(valuesListBody, valuesListHeader, newKey);
    }));
    valuesList.createDiv({ cls: "metadata-menu-separator" }).createEl("hr");
  }
  createValuesFromDVQueryContainer(parentContainer) {
    const valuesFromDVQueryContainer = parentContainer.createDiv({});
    valuesFromDVQueryContainer.createEl("span", { text: "Dataview function", cls: "metadata-menu-field-option" });
    valuesFromDVQueryContainer.createEl("span", { text: "Dataview query returning a list of string (<dv> object is available)", cls: "metadata-menu-field-option-subtext" });
    const valuesFromDVQuery = new import_obsidian17.TextAreaComponent(valuesFromDVQueryContainer);
    valuesFromDVQuery.inputEl.cols = 65;
    valuesFromDVQuery.inputEl.rows = 8;
    valuesFromDVQuery.setPlaceholder("ex: dv.pages('#student').map(p => p.name)");
    valuesFromDVQuery.setValue(this.field.options.valuesFromDVQuery || "");
    valuesFromDVQuery.onChange((value) => {
      this.field.options.valuesFromDVQuery = value;
    });
    return valuesFromDVQueryContainer;
  }
  displaySelectedTypeContainer(optionContainers, value) {
    Object.keys(optionContainers).forEach((key) => {
      if (key === value) {
        optionContainers[key].show();
      } else {
        optionContainers[key].hide();
      }
    });
  }
  createSettingContainer(parentContainer, plugin, location) {
    const sourceTypeContainer = parentContainer.createDiv();
    sourceTypeContainer.createDiv({ text: "Select the source of values for this field", cls: "metadata-menu-field-option" });
    const sourceType = new import_obsidian17.DropdownComponent(sourceTypeContainer);
    if (!this.field.options.sourceType) {
      if (typeof this.field.options === "object" && Object.keys(this.field.options).every((key) => !isNaN(parseInt(key)))) {
        const valuesList = {};
        Object.keys(this.field.options).forEach((key) => valuesList[key] = this.field.options[key]);
        this.field.options = {};
        this.field.options.valuesList = valuesList;
      } else {
        this.field.options = {};
      }
      this.field.options.sourceType = "ValuesList" /* ValuesList */;
      this.field.options.valuesListNotePath = "";
      this.field.options.valuesFromDVQuery = "";
    }
    Object.keys(Type2).forEach((option) => sourceType.addOption(option, typeDisplay[option]));
    sourceType.setValue(this.field.options.sourceType || "ValuesList" /* ValuesList */);
    const valuesListNotePathContainer = this.createListNotePathContainer(parentContainer, plugin);
    const presetValuesFieldsContainer = this.createValuesListContainer(parentContainer);
    const valuesFromDVQueryContainer = this.createValuesFromDVQueryContainer(parentContainer);
    const valuesContainers = {
      "ValuesList": presetValuesFieldsContainer,
      "ValuesListNotePath": valuesListNotePathContainer,
      "ValuesFromDVQuery": valuesFromDVQueryContainer
    };
    sourceType.onChange((value) => {
      this.field.options.sourceType = value;
      this.displaySelectedTypeContainer(valuesContainers, value);
    });
    this.displaySelectedTypeContainer(valuesContainers, this.field.options.sourceType);
  }
  createDvField(dv, p, fieldContainer, attrs) {
    const fieldValue = dv.el("span", p[this.field.name]);
    fieldContainer.appendChild(fieldValue);
  }
};

// src/fields/fieldManagers/SelectField.ts
var SelectField = class extends AbstractListBasedField {
  constructor(plugin, field) {
    super(plugin, field, "Select" /* Select */);
    this.valuesPromptComponents = [];
  }
  addFieldOption(name, value, file, location) {
    const modal = new ValueSuggestModal(this.plugin, file, value, this.field);
    modal.titleEl.setText("Select value");
    if (SelectField.isMenu(location)) {
      location.addItem((item) => {
        item.setTitle(`Update ${name}`);
        item.setIcon(FieldIcon["Select" /* Select */]);
        item.onClick(() => modal.open());
        item.setSection("metadata-menu.fields");
      });
    } else if (SelectField.isSuggest(location)) {
      location.options.push({
        id: `update_${name}`,
        actionLabel: `<span>Update <b>${name}</b></span>`,
        action: () => modal.open(),
        icon: FieldIcon["Select" /* Select */]
      });
    }
    ;
  }
  createAndOpenFieldModal(file, selectedFieldName, value, lineNumber, inFrontmatter, after) {
    const fieldModal = new ValueSuggestModal(this.plugin, file, value || "", this.field, lineNumber, inFrontmatter, after);
    fieldModal.titleEl.setText(`Select option for ${selectedFieldName}`);
    fieldModal.open();
  }
  createDvField(dv, p, fieldContainer, attrs) {
    var _a;
    const valueContainer = document.createElement("div");
    ;
    const valueLabel = dv.el("span", p[this.field.name] || "");
    valueContainer.appendChild(valueLabel);
    const dropDownButton = document.createElement("button");
    (0, import_obsidian18.setIcon)(dropDownButton, "down-chevron-glyph");
    dropDownButton.addClass("metadata-menu-dv-field-button");
    valueContainer.appendChild(dropDownButton);
    const selectContainer = document.createElement("div");
    const select = document.createElement("select");
    select.setAttr("class", "metadata-menu-dv-select");
    selectContainer.appendChild(select);
    const dismissBtn = document.createElement("button");
    (0, import_obsidian18.setIcon)(dismissBtn, "cross");
    dismissBtn.addClass("metadata-menu-dv-field-button");
    selectContainer.appendChild(dismissBtn);
    const nullOption = new Option("--select--", void 0);
    select.add(nullOption);
    const values = this.getOptionsList();
    values.forEach((v) => {
      const value = new Option(v, v);
      if (p[this.field.name] === v || p[this.field.name] && Object.keys(p[this.field.name]).includes("path") && `[[${p[this.field.name].path.replace(".md", "")}]]` === v) {
        value.selected = true;
      }
      select.add(value);
      select.onchange = () => __async(this, null, function* () {
        let newValue = "";
        if (select.value !== void 0) {
          newValue = select.value;
        }
        fieldContainer.removeChild(selectContainer);
        fieldContainer.appendChild(valueContainer);
        SelectField.replaceValues(this.plugin, p.file.path, this.field.name, newValue);
      });
    });
    dropDownButton.onclick = () => {
      fieldContainer.removeChild(valueContainer);
      fieldContainer.appendChild(selectContainer);
    };
    dismissBtn.onclick = () => {
      fieldContainer.removeChild(selectContainer);
      fieldContainer.appendChild(valueContainer);
    };
    if (!((_a = attrs == null ? void 0 : attrs.options) == null ? void 0 : _a.alwaysOn)) {
      fieldContainer.appendChild(valueContainer);
    } else {
      fieldContainer.appendChild(selectContainer);
    }
  }
};

// src/fields/fieldManagers/CycleField.ts
var import_obsidian19 = require("obsidian");
var CycleField = class extends AbstractListBasedField {
  constructor(plugin, field) {
    super(plugin, field, "Cycle" /* Cycle */);
    this.valuesPromptComponents = [];
  }
  nextOption(value) {
    let nextOption;
    const values = this.getOptionsList();
    if (values.indexOf(value) === -1) {
      nextOption = values[0] || "";
    } else {
      nextOption = values[(values.indexOf(value) + 1) % values.length];
    }
    return nextOption;
  }
  addFieldOption(name, value, file, location) {
    if (CycleField.isMenu(location)) {
      location.addItem((item) => {
        item.setTitle(`${name} : ${value} \u25B7 ${this.nextOption(value)}`);
        item.setIcon(FieldIcon["Cycle" /* Cycle */]);
        item.onClick(() => __async(this, null, function* () {
          return yield this.plugin.fileTaskManager.pushTask(() => {
            replaceValues(this.plugin, file, name, this.nextOption(value).toString());
          });
        }));
        item.setSection("metadata-menu.fields");
      });
    } else if (CycleField.isSuggest(location)) {
      location.options.push({
        id: `${name}_${value}_${this.nextOption(value)}`,
        actionLabel: `<span><b>${name}</b> : ${value} \u25B7 ${this.nextOption(value)}</span>`,
        action: () => __async(this, null, function* () {
          return yield this.plugin.fileTaskManager.pushTask(() => {
            replaceValues(this.plugin, file, name, this.nextOption(value).toString());
          });
        }),
        icon: FieldIcon["Cycle" /* Cycle */]
      });
    }
    ;
  }
  createAndOpenFieldModal(file, selectedFieldName, value, lineNumber, inFrontmatter, after) {
    const fieldModal = new ValueSuggestModal(this.plugin, file, value || "", this.field, lineNumber, inFrontmatter, after);
    fieldModal.titleEl.setText(`Select option for ${selectedFieldName}`);
    fieldModal.open();
  }
  createDvField(dv, p, fieldContainer, attrs) {
    var _a;
    const nextOption = this.nextOption(p[this.field.name]);
    const fieldValue = dv.el("span", p[this.field.name], attrs);
    const spacer = document.createElement("div");
    spacer.setAttr("class", "metadata-menu-dv-field-spacer");
    const button = document.createElement("button");
    (0, import_obsidian19.setIcon)(button, FieldIcon["Cycle" /* Cycle */]);
    button.setAttr("class", "metadata-menu-dv-field-button");
    if (!((_a = attrs == null ? void 0 : attrs.options) == null ? void 0 : _a.alwaysOn)) {
      button.hide();
      spacer.show();
      fieldContainer.onmouseover = () => {
        button.show();
        spacer.hide();
      };
      fieldContainer.onmouseout = () => {
        button.hide();
        spacer.show();
      };
    }
    button.onclick = (e) => {
      var _a2;
      CycleField.replaceValues(this.plugin, p.file.path, this.field.name, nextOption);
      if (!((_a2 = attrs == null ? void 0 : attrs.options) == null ? void 0 : _a2.alwaysOn)) {
        button.hide();
        spacer.show();
      }
    };
    fieldContainer.appendChild(button);
    fieldContainer.appendChild(fieldValue);
    fieldContainer.appendChild(spacer);
  }
};

// src/fields/fieldManagers/MultiField.ts
var import_obsidian23 = require("obsidian");

// src/optionModals/fields/MultiSelectModal.ts
var import_obsidian22 = require("obsidian");

// src/fields/fieldManagers/FileField.ts
var import_obsidian21 = require("obsidian");

// src/optionModals/fields/SingleFileModal.ts
var import_obsidian20 = require("obsidian");
var FileFuzzySuggester = class extends import_obsidian20.FuzzySuggestModal {
  constructor(plugin, file, field, initialValueObject, lineNumber = -1, inFrontmatter = false, after = false) {
    var _a;
    super(plugin.app);
    this.plugin = plugin;
    this.file = file;
    this.field = field;
    this.lineNumber = lineNumber;
    this.inFrontmatter = inFrontmatter;
    this.after = after;
    const dvApi = (_a = this.plugin.app.plugins.plugins["dataview"]) == null ? void 0 : _a.api;
    if (dvApi) {
      if (dvApi.value.isLink(initialValueObject)) {
        const file2 = this.plugin.app.vault.getAbstractFileByPath(initialValueObject.path);
        if (file2 instanceof import_obsidian20.TFile)
          this.selectedFile = file2;
      }
    }
  }
  getItems() {
    try {
      const fileManager = new FieldManager[this.field.type](this.plugin, this.field);
      return fileManager.getFiles(this.file);
    } catch (error) {
      this.close();
      throw error;
    }
  }
  getItemText(item) {
    return item.basename;
  }
  renderSuggestion(value, el) {
    var _a, _b;
    const dvApi = (_a = this.plugin.app.plugins.plugins.dataview) == null ? void 0 : _a.api;
    if (dvApi && this.field.options.customRendering) {
      const suggestionContainer = el.createDiv({ cls: "metadata-menu-suggester-item-with-alias" });
      const label = suggestionContainer.createDiv({ cls: "metadata-menu-suggester-item-with-alias-label" });
      label.setText(new Function("page", `return ${this.field.options.customRendering}`)(dvApi.page(value.item.path)));
      const filePath = suggestionContainer.createDiv({ cls: "metadata-menu-suggester-item-with-alias-filepath" });
      filePath.setText(value.item.path);
    } else {
      el.setText(value.item.basename);
    }
    el.addClass("metadata-menu-value-suggester-value-container");
    const spacer = this.containerEl.createDiv({ cls: "metadata-menu-value-suggester-value-container-spacer" });
    el.appendChild(spacer);
    if (((_b = this.selectedFile) == null ? void 0 : _b.path) === value.item.path) {
      el.addClass("metadata-menu-value-selected");
      const iconContainer = el.createDiv({ cls: "metadata-menu-command-suggest-icon" });
      (0, import_obsidian20.setIcon)(iconContainer, "check-circle");
    }
    this.inputEl.focus();
  }
  onChooseItem(item) {
    return __async(this, null, function* () {
      var _a;
      const dvApi = (_a = this.plugin.app.plugins.plugins.dataview) == null ? void 0 : _a.api;
      let alias = void 0;
      if (dvApi && this.field.options.customRendering) {
        alias = new Function("page", `return ${this.field.options.customRendering}`)(dvApi.page(item.path));
      }
      if (this.lineNumber == -1) {
        yield this.plugin.fileTaskManager.pushTask(() => {
          replaceValues(this.plugin, this.file, this.field.name, FileField.buildMarkDownLink(this.plugin, this.file, item.basename, alias));
        });
      } else {
        yield this.plugin.fileTaskManager.pushTask(() => {
          insertValues(this.plugin, this.file, this.field.name, FileField.buildMarkDownLink(this.plugin, this.file, item.basename, alias), this.lineNumber, this.inFrontmatter, this.after);
        });
      }
      ;
    });
  }
};

// src/fields/fieldManagers/FileField.ts
var FileField = class extends FieldManager2 {
  constructor(plugin, field) {
    super(plugin, field, "File" /* File */);
    this.getFiles = (currentFile) => {
      const getResults = (api) => {
        try {
          return new Function("dv", "current", `return ${this.field.options.dvQueryString}`)(api, api.page(currentFile == null ? void 0 : currentFile.path));
        } catch (error) {
          new import_obsidian21.Notice(`Wrong query for field <${this.field.name}>
check your settings`, 3e3);
        }
      };
      const dataview = this.plugin.app.plugins.plugins["dataview"];
      if (this.field.options.dvQueryString && (dataview == null ? void 0 : dataview.settings.enableDataviewJs) && (dataview == null ? void 0 : dataview.settings.enableInlineDataviewJs)) {
        try {
          const filesPath = getResults(dataview.api).values.map((v) => v.file.path);
          return this.plugin.app.vault.getMarkdownFiles().filter((f) => filesPath.includes(f.path));
        } catch (error) {
          throw error;
        }
      } else {
        return this.plugin.app.vault.getMarkdownFiles();
      }
    };
  }
  addFieldOption(name, value, file, location) {
    const modal = new FileFuzzySuggester(this.plugin, file, this.field, value);
    modal.titleEl.setText("Select value");
    if (FileField.isMenu(location)) {
      location.addItem((item) => {
        item.setTitle(`Update ${name}`);
        item.setIcon(FieldIcon["File" /* File */]);
        item.onClick(() => modal.open());
        item.setSection("metadata-menu.fields");
      });
    } else if (FileField.isSuggest(location)) {
      location.options.push({
        id: `update_${name}`,
        actionLabel: `<span>Update <b>${name}</b></span>`,
        action: () => modal.open(),
        icon: FieldIcon["File" /* File */]
      });
    }
    ;
  }
  createAndOpenFieldModal(file, selectedFieldName, value, lineNumber, inFrontmatter, after) {
    const fieldModal = new FileFuzzySuggester(this.plugin, file, this.field, value, lineNumber, inFrontmatter, after);
    fieldModal.titleEl.setText(`Enter value for ${selectedFieldName}`);
    fieldModal.open();
  }
  createDvField(dv, p, fieldContainer, attrs) {
    var _a;
    const fieldValue = dv.el("span", p[this.field.name], attrs);
    const searchBtn = document.createElement("button");
    (0, import_obsidian21.setIcon)(searchBtn, FieldIcon["File" /* File */]);
    searchBtn.addClass("metadata-menu-dv-field-button");
    const spacer = document.createElement("div");
    spacer.setAttr("class", "metadata-menu-dv-field-spacer");
    const file = this.plugin.app.vault.getAbstractFileByPath(p["file"]["path"]);
    let fieldModal;
    if (file instanceof import_obsidian21.TFile && file.extension == "md") {
      fieldModal = new FileFuzzySuggester(this.plugin, file, this.field, p[this.field.name]);
    } else {
      throw Error("path doesn't correspond to a proper file");
    }
    searchBtn.onclick = () => {
      fieldModal.open();
    };
    if (!((_a = attrs == null ? void 0 : attrs.options) == null ? void 0 : _a.alwaysOn)) {
      searchBtn.hide();
      spacer.show();
      fieldContainer.onmouseover = () => {
        searchBtn.show();
        spacer.hide();
      };
      fieldContainer.onmouseout = () => {
        searchBtn.hide();
        spacer.show();
      };
    }
    fieldContainer.appendChild(fieldValue);
    fieldContainer.appendChild(searchBtn);
    fieldContainer.appendChild(spacer);
  }
  createFileContainer(parentContainer) {
    const dvQueryStringContainer = parentContainer.createDiv();
    dvQueryStringContainer.createEl("span", { text: "Dataview Query (optional)", cls: "metadata-menu-field-option" });
    this.dvQueryString = new import_obsidian21.TextAreaComponent(dvQueryStringContainer);
    this.dvQueryString.inputEl.cols = 50;
    this.dvQueryString.inputEl.rows = 4;
    this.dvQueryString.setValue(this.field.options.dvQueryString || "");
    this.dvQueryString.onChange((value) => {
      this.field.options.dvQueryString = value;
      FieldSettingsModal.removeValidationError(this.dvQueryString);
    });
    const customeRenderingContainer = parentContainer.createDiv();
    customeRenderingContainer.createEl("span", { text: "Alias", cls: "metadata-menu-field-option" });
    customeRenderingContainer.createEl("span", { text: "Personalise the rendering of your links' aliases with a function returning a string (<page> object is available)", cls: "metadata-menu-field-option-subtext" });
    customeRenderingContainer.createEl("code", {
      text: `function(page) { return <function using "page">; }`
    });
    const customRendering = new import_obsidian21.TextAreaComponent(customeRenderingContainer);
    customRendering.inputEl.cols = 50;
    customRendering.inputEl.rows = 4;
    customRendering.setValue(this.field.options.customRendering || "");
    customRendering.setPlaceholder('Javascript string, the "page" (dataview page type) variable is available\nexample 1: page.file.name\nexample 2: `${page.file.name} of gender ${page.gender}`');
    customRendering.onChange((value) => {
      this.field.options.customRendering = value;
      FieldSettingsModal.removeValidationError(customRendering);
    });
  }
  createSettingContainer(parentContainer, plugin, location) {
    this.fileValidatorField = parentContainer.createDiv({ cls: "metadata-menu-number-options" });
    this.createFileContainer(this.fileValidatorField);
    this.fileValidatorField.createDiv({ cls: "metadata-menu-separator" }).createEl("hr");
  }
  getOptionsStr() {
    return this.field.options.dvQueryString || "";
  }
  validateOptions() {
    return true;
  }
  validateValue(value) {
    const basename = value.trim().replace(/^\[\[/g, "").replace(/\]\]$/g, "");
    return !!this.getFiles().map((f) => f.basename).find((item) => item === basename);
  }
};

// src/optionModals/fields/MultiSelectModal.ts
var MultiSuggestModal = class extends import_obsidian22.SuggestModal {
  constructor(plugin, file, field, initialOptions, lineNumber = -1, inFrontmatter = false, after = false) {
    var _a;
    super(plugin.app);
    this.plugin = plugin;
    this.file = file;
    this.field = field;
    this.lineNumber = lineNumber;
    this.inFrontmatter = inFrontmatter;
    this.after = after;
    if (initialOptions) {
      if (Array.isArray(initialOptions)) {
        const dvApi = (_a = this.plugin.app.plugins.plugins.dataview) == null ? void 0 : _a.api;
        if (dvApi && initialOptions.some((o) => dvApi.value.isLink(o))) {
          this.selectedOptions = initialOptions.map((item) => {
            if (dvApi.value.isLink(item)) {
              return FileField.buildMarkDownLink(this.plugin, this.file, item.path);
            } else {
              return item.toString();
            }
          });
        }
        this.selectedOptions = initialOptions.map((item) => item.toString());
      } else if (initialOptions.toString().startsWith("[[")) {
        this.selectedOptions = initialOptions.split(",").map((item) => item.trim());
      } else {
        this.selectedOptions = initialOptions.toString().replace(/^\[(.*)\]$/, "$1").split(",").map((item) => item.trim());
      }
    } else {
      this.selectedOptions = [];
    }
  }
  onOpen() {
    return __async(this, null, function* () {
      __superGet(MultiSuggestModal.prototype, this, "onOpen").call(this);
      this.containerEl.onkeydown = (e) => __async(this, null, function* () {
        if (e.key == "Enter" && e.altKey) {
          yield this.replaceValues();
          this.close();
        }
      });
      const updateSettingsInfoContainer = this.containerEl.createDiv({ cls: "metadata-menu-value-suggester-notice-container" });
      const notice = updateSettingsInfoContainer.createDiv({ cls: "metadata-menu-value-suggester-notice-label" });
      updateSettingsInfoContainer.createDiv({ cls: "metadata-menu-value-suggester-notice-spacer" });
      updateSettingsInfoContainer.hide();
      this.containerEl.find(".prompt").prepend(updateSettingsInfoContainer);
      const inputContainer = this.containerEl.createDiv({ cls: "metadata-menu-value-suggester-input-container" });
      inputContainer.appendChild(this.inputEl);
      this.containerEl.find(".prompt").prepend(inputContainer);
      const buttonContainer = this.containerEl.createDiv({ cls: "metadata-menu-value-suggester-actions" });
      buttonContainer.createDiv({ cls: "metadata-menu-value-suggester-actions-spacer" });
      const infoContainer = buttonContainer.createDiv({ cls: "metadata-menu-value-suggester-info" });
      infoContainer.setText("Alt+Enter to save");
      this.addButton = new import_obsidian22.ButtonComponent(inputContainer);
      this.addButton.setIcon("plus");
      this.addButton.onClick(() => __async(this, null, function* () {
        yield this.addNewValueToSettings();
        notice.setText(`${this.inputEl.value} added to the field settings
click on reload`);
        this.addButton.buttonEl.hide();
        updateSettingsInfoContainer.show();
      }));
      this.addButton.buttonEl.addClass("metadata-menu-value-suggester-button");
      this.addButton.setCta();
      this.addButton.setTooltip("Add this value to this field settings");
      this.addButton.buttonEl.hide();
      this.reloadButton = new import_obsidian22.ButtonComponent(updateSettingsInfoContainer);
      this.reloadButton.buttonEl.addClass("metadata-menu-value-suggester-button");
      this.reloadButton.setIcon("refresh-cw");
      this.reloadButton.setCta();
      this.reloadButton.onClick(() => __async(this, null, function* () {
        this.inputEl.value = "";
        this.updateSuggestions();
        updateSettingsInfoContainer.hide();
        this.addButton.buttonEl.hide();
      }));
      const confirmButton = new import_obsidian22.ButtonComponent(buttonContainer);
      confirmButton.setIcon("checkmark");
      confirmButton.onClick(() => __async(this, null, function* () {
        yield this.replaceValues();
        this.close();
      }));
      confirmButton.buttonEl.addClass("metadata-menu-value-suggester-button");
      const cancelButton = new import_obsidian22.ButtonComponent(buttonContainer);
      cancelButton.setIcon("cross");
      cancelButton.onClick(() => {
        this.close();
      });
      cancelButton.buttonEl.addClass("metadata-menu-value-suggester-button");
      const clearButton = new import_obsidian22.ButtonComponent(buttonContainer);
      clearButton.setIcon("trash");
      clearButton.onClick(() => __async(this, null, function* () {
        yield this.clearValues();
        this.close();
      }));
      clearButton.buttonEl.addClass("metadata-menu-value-suggester-button");
      clearButton.buttonEl.addClass("danger");
      this.modalEl.appendChild(buttonContainer);
    });
  }
  addNewValueToSettings() {
    return __async(this, null, function* () {
      const newValue = this.inputEl.value;
      const fileClassName = this.plugin.fieldIndex.filesFileClassName.get(this.file.path);
      if (fileClassName) {
        const fileClass = this.plugin.fieldIndex.fileClassesName.get(fileClassName);
        const fileClassAttribute = fileClass == null ? void 0 : fileClass.attributes.find((attr) => attr.name === this.field.name);
        if (fileClass && fileClassAttribute) {
          let newOptions;
          if (Array.isArray(fileClassAttribute.options)) {
            newOptions = [...fileClassAttribute.options, newValue];
            yield fileClass.updateAttribute(fileClassAttribute.type, fileClassAttribute.name, newOptions, fileClassAttribute);
          } else if (fileClassAttribute.options.sourceType === "ValuesList" /* ValuesList */) {
            newOptions = fileClassAttribute.options.valuesList;
            newOptions[`${Object.keys(fileClassAttribute.options.valuesList).length}`] = newValue;
            yield fileClass.updateAttribute(fileClassAttribute.type, fileClassAttribute.name, newOptions, fileClassAttribute);
          } else if (fileClassAttribute.options.sourceType === "ValuesListNotePath" /* ValuesListNotePath */) {
            const valuesFile = this.plugin.app.vault.getAbstractFileByPath(fileClassAttribute.options.valuesListNotePath);
            if (valuesFile instanceof import_obsidian22.TFile && valuesFile.extension == "md") {
              const result = yield this.plugin.app.vault.read(valuesFile);
              this.plugin.app.vault.modify(valuesFile, `${result}
${newValue}`);
            }
          } else {
            newOptions = fileClassAttribute.options;
            newOptions[`${Object.keys(fileClassAttribute.options).length}`] = newValue;
            yield fileClass.updateAttribute(fileClassAttribute.type, fileClassAttribute.name, newOptions, fileClassAttribute);
          }
        }
      } else {
        const presetField = this.plugin.settings.presetFields.find((field) => field.name === this.field.name);
        if ((presetField == null ? void 0 : presetField.options.sourceType) === "ValuesListNotePath" /* ValuesListNotePath */) {
          const valuesFile = this.plugin.app.vault.getAbstractFileByPath(presetField.options.valuesListNotePath);
          if (valuesFile instanceof import_obsidian22.TFile && valuesFile.extension == "md") {
            const result = yield this.plugin.app.vault.read(valuesFile);
            this.plugin.app.vault.modify(valuesFile, `${result}
${newValue}`);
          }
        } else if ((presetField == null ? void 0 : presetField.options.sourceType) === "ValuesList" /* ValuesList */) {
          const currentExistingField = this.plugin.initialProperties.find((p) => p.id == this.field.id);
          if (currentExistingField) {
            const valuesList = currentExistingField.options.valuesList;
            valuesList[`${Object.keys(valuesList).length + 1}`] = newValue;
          }
          this.plugin.saveSettings();
        }
      }
      yield this.plugin.fieldIndex.fullIndex("valueAdd");
      this.selectedOptions.push(newValue);
    });
  }
  replaceValues() {
    return __async(this, null, function* () {
      const options = this.selectedOptions;
      if (this.lineNumber == -1) {
        yield this.plugin.fileTaskManager.pushTask(() => {
          replaceValues(this.plugin, this.file, this.field.name, options.join(", "));
        });
      } else {
        const renderedValues = !this.inFrontmatter ? options.join(", ") : options.length > 1 ? `[${options.join(", ")}]` : `${options[0]}`;
        yield this.plugin.fileTaskManager.pushTask(() => {
          insertValues(this.plugin, this.file, this.field.name, renderedValues, this.lineNumber, this.inFrontmatter, this.after);
        });
      }
      ;
      this.close();
    });
  }
  clearValues() {
    return __async(this, null, function* () {
      if (this.lineNumber == -1) {
        yield this.plugin.fileTaskManager.pushTask(() => {
          replaceValues(this.plugin, this.file, this.field.name, "");
        });
      } else {
        yield this.plugin.fileTaskManager.pushTask(() => {
          insertValues(this.plugin, this.file, this.field.name, "", this.lineNumber, this.inFrontmatter, this.after);
        });
      }
      ;
    });
  }
  renderSelected() {
    const chooser = this.chooser;
    const suggestions = chooser.suggestions;
    const values = chooser.values;
    suggestions.forEach((s, i) => {
      if (this.selectedOptions.includes(values[i].toString())) {
        s.addClass("metadata-menu-value-selected");
        if (s.querySelectorAll(".metadata-menu-command-suggest-icon").length == 0) {
          const iconContainer = s.createDiv({ cls: "metadata-menu-command-suggest-icon" });
          (0, import_obsidian22.setIcon)(iconContainer, "check-circle");
        }
      } else {
        s.removeClass("metadata-menu-value-selected");
        s.querySelectorAll(".metadata-menu-command-suggest-icon").forEach((icon) => icon.remove());
      }
    });
  }
  getSuggestions(query) {
    var _a;
    const dvApi = (_a = this.plugin.app.plugins.plugins.dataview) == null ? void 0 : _a.api;
    let dvFile;
    if (dvApi)
      dvFile = dvApi.page(this.file.path);
    const fieldManager = new FieldManager[this.field.type](this.plugin, this.field);
    const values = fieldManager.getOptionsList(dvFile).filter((o) => o.toLowerCase().includes(query.toLowerCase()));
    if (this.addButton) {
      values.some((p) => p === query) || this.field.options.sourceType == "ValuesFromDVQuery" /* ValuesFromDVQuery */ || !query ? this.addButton.buttonEl.hide() : this.addButton.buttonEl.show();
    }
    ;
    return values;
  }
  renderSuggestion(value, el) {
    el.setText(value);
    el.addClass("metadata-menu-value-suggester-value-container");
    const spacer = this.containerEl.createDiv({ cls: "metadata-menu-value-suggester-value-container-spacer" });
    el.appendChild(spacer);
    if (this.selectedOptions.includes(value.toString())) {
      el.addClass("metadata-menu-value-selected");
      const iconContainer = el.createDiv({ cls: "metadata-menu-command-suggest-icon" });
      (0, import_obsidian22.setIcon)(iconContainer, "check-circle");
    }
    this.inputEl.focus();
  }
  selectSuggestion(value, evt) {
    if (this.selectedOptions.includes(value.toString())) {
      this.selectedOptions.remove(value.toString());
    } else {
      this.selectedOptions.push(value.toString());
    }
    this.renderSelected();
  }
  onChooseSuggestion(item, evt) {
  }
};

// src/fields/fieldManagers/MultiField.ts
var MultiField = class extends AbstractListBasedField {
  constructor(plugin, field) {
    super(plugin, field, "Multi" /* Multi */);
    this.valuesPromptComponents = [];
  }
  addFieldOption(name, value, file, location) {
    const modal = new MultiSuggestModal(this.plugin, file, this.field, value);
    modal.titleEl.setText("Select values");
    if (MultiField.isMenu(location)) {
      location.addItem((item) => {
        item.setTitle(`Update <${name}>`);
        item.setIcon(FieldIcon["Multi" /* Multi */]);
        item.onClick(() => modal.open());
        item.setSection("metadata-menu.fields");
      });
    } else if (MultiField.isSuggest(location)) {
      location.options.push({
        id: `update_${name}`,
        actionLabel: `<span>Update <b>${name}</b></span>`,
        action: () => modal.open(),
        icon: FieldIcon["Multi" /* Multi */]
      });
    }
    ;
  }
  createAndOpenFieldModal(file, selectedFieldName, value, lineNumber, inFrontmatter, after) {
    const fieldModal = new MultiSuggestModal(this.plugin, file, this.field, value || "", lineNumber, inFrontmatter, after);
    fieldModal.titleEl.setText(`Select options for ${selectedFieldName}`);
    fieldModal.open();
  }
  createDvField(dv, p, fieldContainer, attrs) {
    var _a, _b;
    let valueHovered = false;
    let currentValues = [];
    if (p[this.field.name]) {
      if (Object.keys(p[this.field.name]).includes("path")) {
        currentValues = [`[[${p[this.field.name].path.replace(".md", "")}]]`];
      } else if (Array.isArray(p[this.field.name])) {
        currentValues.push(...p[this.field.name].map((v) => v.trim()));
      } else {
        currentValues = p[this.field.name].split(",").map((v) => v.trim());
      }
    }
    const selectContainer = document.createElement("div");
    const select = document.createElement("select");
    select.setAttr("class", "metadata-menu-dv-select");
    selectContainer.appendChild(select);
    const nullOption = new Option("--select--", void 0);
    select.add(nullOption);
    const values = this.getOptionsList();
    values.filter((v) => !currentValues.contains(v)).forEach((v) => {
      const value = new Option(v, v);
      if (p[this.field.name] === value) {
        value.selected = true;
      }
      select.add(value);
    });
    select.onchange = () => __async(this, null, function* () {
      const newValues = [...currentValues, select.value].join(", ");
      MultiField.replaceValues(this.plugin, p.file.path, this.field.name, newValues);
      singleSpacer.hide();
      doubleSpacer.show();
      addBtn.hide();
      fieldContainer.appendChild(valuesContainer);
      fieldContainer.appendChild(singleSpacer);
      fieldContainer.appendChild(doubleSpacer);
      fieldContainer.removeChild(selectContainer);
    });
    select.onkeydown = (e) => {
      if (e.key === "Escape") {
        fieldContainer.appendChild(valuesContainer);
        fieldContainer.appendChild(singleSpacer);
        fieldContainer.appendChild(doubleSpacer);
        fieldContainer.removeChild(selectContainer);
      }
    };
    const closeSelect = document.createElement("button");
    (0, import_obsidian23.setIcon)(closeSelect, "cross");
    closeSelect.addClass("metadata-menu-dv-field-button");
    closeSelect.addClass("multi");
    closeSelect.onclick = () => {
      fieldContainer.appendChild(valuesContainer);
      fieldContainer.appendChild(singleSpacer);
      fieldContainer.appendChild(doubleSpacer);
      fieldContainer.removeChild(selectContainer);
    };
    selectContainer.appendChild(closeSelect);
    const valuesContainer = document.createElement("div");
    valuesContainer.addClass("metadata-menu-dv-multi-values-container");
    currentValues.forEach((v) => {
      const valueContainer = document.createElement("div");
      valueContainer.addClass("metadata-menu-dv-multi-values-container");
      const valueRemoveBtn = document.createElement("button");
      (0, import_obsidian23.setIcon)(valueRemoveBtn, "cross");
      valueRemoveBtn.addClass("metadata-menu-dv-field-button");
      valueRemoveBtn.addClass("multi");
      valueRemoveBtn.hide();
      valueRemoveBtn.onclick = () => __async(this, null, function* () {
        const remainingValues = currentValues.filter((cV) => cV !== v).join(", ");
        MultiField.replaceValues(this.plugin, p.file.path, this.field.name, remainingValues);
      });
      valueContainer.appendChild(valueRemoveBtn);
      const valueLabel = document.createElement("div");
      valueLabel.setText(v);
      valueLabel.addClass("metadata-menu-dv-multi-value-label");
      valueContainer.appendChild(valueLabel);
      valueContainer.onmouseover = () => {
        valueHovered = true;
        doubleSpacer.hide();
        singleSpacer.hide();
        valueRemoveBtn.show();
        valueLabel.addClass("hovered");
      };
      valueContainer.onmouseout = () => {
        valueHovered = false;
        valueRemoveBtn.hide();
        singleSpacer.show();
        doubleSpacer.hide();
        valueLabel.removeClass("hovered");
      };
      valuesContainer.appendChild(valueContainer);
    });
    const addBtn = document.createElement("button");
    (0, import_obsidian23.setIcon)(addBtn, "bullet-list");
    addBtn.setAttr("class", "metadata-menu-dv-field-button");
    valuesContainer.appendChild(addBtn);
    addBtn.onclick = () => {
      fieldContainer.removeChild(valuesContainer);
      fieldContainer.removeChild(singleSpacer);
      fieldContainer.removeChild(doubleSpacer);
      fieldContainer.appendChild(selectContainer);
    };
    const singleSpacer = document.createElement("div");
    singleSpacer.setAttr("class", "metadata-menu-dv-field-spacer");
    const doubleSpacer = document.createElement("div");
    doubleSpacer.setAttr("class", "metadata-menu-dv-field-double-spacer");
    if (!((_a = attrs == null ? void 0 : attrs.options) == null ? void 0 : _a.alwaysOn)) {
      addBtn.hide();
      fieldContainer.onmouseover = () => {
        addBtn.show();
        doubleSpacer.hide();
        if (!valueHovered)
          singleSpacer.show();
      };
      fieldContainer.onmouseout = () => {
        addBtn.hide();
        singleSpacer.hide();
        doubleSpacer.show();
      };
    }
    if (!((_b = attrs == null ? void 0 : attrs.options) == null ? void 0 : _b.alwaysOn)) {
      singleSpacer.hide();
      doubleSpacer.show();
      addBtn.hide();
    } else {
      singleSpacer.show();
      doubleSpacer.hide();
      addBtn.show();
    }
    fieldContainer.appendChild(valuesContainer);
    fieldContainer.appendChild(singleSpacer);
    fieldContainer.appendChild(doubleSpacer);
  }
};

// src/fields/fieldManagers/DateField.ts
var import_obsidian27 = require("obsidian");

// src/optionModals/fields/DateModal.ts
var import_obsidian24 = require("obsidian");
var import_obsidian25 = require("obsidian");

// node_modules/flatpickr/dist/esm/types/options.js
var HOOKS = [
  "onChange",
  "onClose",
  "onDayCreate",
  "onDestroy",
  "onKeyDown",
  "onMonthChange",
  "onOpen",
  "onParseConfig",
  "onReady",
  "onValueUpdate",
  "onYearChange",
  "onPreCalendarPosition"
];
var defaults = {
  _disable: [],
  allowInput: false,
  allowInvalidPreload: false,
  altFormat: "F j, Y",
  altInput: false,
  altInputClass: "form-control input",
  animate: typeof window === "object" && window.navigator.userAgent.indexOf("MSIE") === -1,
  ariaDateFormat: "F j, Y",
  autoFillDefaultTime: true,
  clickOpens: true,
  closeOnSelect: true,
  conjunction: ", ",
  dateFormat: "Y-m-d",
  defaultHour: 12,
  defaultMinute: 0,
  defaultSeconds: 0,
  disable: [],
  disableMobile: false,
  enableSeconds: false,
  enableTime: false,
  errorHandler: function(err) {
    return typeof console !== "undefined" && console.warn(err);
  },
  getWeek: function(givenDate) {
    var date = new Date(givenDate.getTime());
    date.setHours(0, 0, 0, 0);
    date.setDate(date.getDate() + 3 - (date.getDay() + 6) % 7);
    var week1 = new Date(date.getFullYear(), 0, 4);
    return 1 + Math.round(((date.getTime() - week1.getTime()) / 864e5 - 3 + (week1.getDay() + 6) % 7) / 7);
  },
  hourIncrement: 1,
  ignoredFocusElements: [],
  inline: false,
  locale: "default",
  minuteIncrement: 5,
  mode: "single",
  monthSelectorType: "dropdown",
  nextArrow: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 17 17'><g></g><path d='M13.207 8.472l-7.854 7.854-0.707-0.707 7.146-7.146-7.146-7.148 0.707-0.707 7.854 7.854z' /></svg>",
  noCalendar: false,
  now: new Date(),
  onChange: [],
  onClose: [],
  onDayCreate: [],
  onDestroy: [],
  onKeyDown: [],
  onMonthChange: [],
  onOpen: [],
  onParseConfig: [],
  onReady: [],
  onValueUpdate: [],
  onYearChange: [],
  onPreCalendarPosition: [],
  plugins: [],
  position: "auto",
  positionElement: void 0,
  prevArrow: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 17 17'><g></g><path d='M5.207 8.471l7.146 7.147-0.707 0.707-7.853-7.854 7.854-7.853 0.707 0.707-7.147 7.146z' /></svg>",
  shorthandCurrentMonth: false,
  showMonths: 1,
  static: false,
  time_24hr: false,
  weekNumbers: false,
  wrap: false
};

// node_modules/flatpickr/dist/esm/l10n/default.js
var english = {
  weekdays: {
    shorthand: ["Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat"],
    longhand: [
      "Sunday",
      "Monday",
      "Tuesday",
      "Wednesday",
      "Thursday",
      "Friday",
      "Saturday"
    ]
  },
  months: {
    shorthand: [
      "Jan",
      "Feb",
      "Mar",
      "Apr",
      "May",
      "Jun",
      "Jul",
      "Aug",
      "Sep",
      "Oct",
      "Nov",
      "Dec"
    ],
    longhand: [
      "January",
      "February",
      "March",
      "April",
      "May",
      "June",
      "July",
      "August",
      "September",
      "October",
      "November",
      "December"
    ]
  },
  daysInMonth: [31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31],
  firstDayOfWeek: 0,
  ordinal: function(nth) {
    var s = nth % 100;
    if (s > 3 && s < 21)
      return "th";
    switch (s % 10) {
      case 1:
        return "st";
      case 2:
        return "nd";
      case 3:
        return "rd";
      default:
        return "th";
    }
  },
  rangeSeparator: " to ",
  weekAbbreviation: "Wk",
  scrollTitle: "Scroll to increment",
  toggleTitle: "Click to toggle",
  amPM: ["AM", "PM"],
  yearAriaLabel: "Year",
  monthAriaLabel: "Month",
  hourAriaLabel: "Hour",
  minuteAriaLabel: "Minute",
  time_24hr: false
};
var default_default = english;

// node_modules/flatpickr/dist/esm/utils/index.js
var pad = function(number, length) {
  if (length === void 0) {
    length = 2;
  }
  return ("000" + number).slice(length * -1);
};
var int = function(bool) {
  return bool === true ? 1 : 0;
};
function debounce2(fn2, wait) {
  var t;
  return function() {
    var _this = this;
    var args = arguments;
    clearTimeout(t);
    t = setTimeout(function() {
      return fn2.apply(_this, args);
    }, wait);
  };
}
var arrayify = function(obj) {
  return obj instanceof Array ? obj : [obj];
};

// node_modules/flatpickr/dist/esm/utils/dom.js
function toggleClass(elem, className, bool) {
  if (bool === true)
    return elem.classList.add(className);
  elem.classList.remove(className);
}
function createElement(tag, className, content) {
  var e = window.document.createElement(tag);
  className = className || "";
  content = content || "";
  e.className = className;
  if (content !== void 0)
    e.textContent = content;
  return e;
}
function clearNode(node) {
  while (node.firstChild)
    node.removeChild(node.firstChild);
}
function findParent(node, condition) {
  if (condition(node))
    return node;
  else if (node.parentNode)
    return findParent(node.parentNode, condition);
  return void 0;
}
function createNumberInput(inputClassName, opts) {
  var wrapper = createElement("div", "numInputWrapper"), numInput = createElement("input", "numInput " + inputClassName), arrowUp = createElement("span", "arrowUp"), arrowDown = createElement("span", "arrowDown");
  if (navigator.userAgent.indexOf("MSIE 9.0") === -1) {
    numInput.type = "number";
  } else {
    numInput.type = "text";
    numInput.pattern = "\\d*";
  }
  if (opts !== void 0)
    for (var key in opts)
      numInput.setAttribute(key, opts[key]);
  wrapper.appendChild(numInput);
  wrapper.appendChild(arrowUp);
  wrapper.appendChild(arrowDown);
  return wrapper;
}
function getEventTarget(event) {
  try {
    if (typeof event.composedPath === "function") {
      var path = event.composedPath();
      return path[0];
    }
    return event.target;
  } catch (error) {
    return event.target;
  }
}

// node_modules/flatpickr/dist/esm/utils/formatting.js
var doNothing = function() {
  return void 0;
};
var monthToStr = function(monthNumber, shorthand, locale) {
  return locale.months[shorthand ? "shorthand" : "longhand"][monthNumber];
};
var revFormat = {
  D: doNothing,
  F: function(dateObj, monthName, locale) {
    dateObj.setMonth(locale.months.longhand.indexOf(monthName));
  },
  G: function(dateObj, hour) {
    dateObj.setHours((dateObj.getHours() >= 12 ? 12 : 0) + parseFloat(hour));
  },
  H: function(dateObj, hour) {
    dateObj.setHours(parseFloat(hour));
  },
  J: function(dateObj, day) {
    dateObj.setDate(parseFloat(day));
  },
  K: function(dateObj, amPM, locale) {
    dateObj.setHours(dateObj.getHours() % 12 + 12 * int(new RegExp(locale.amPM[1], "i").test(amPM)));
  },
  M: function(dateObj, shortMonth, locale) {
    dateObj.setMonth(locale.months.shorthand.indexOf(shortMonth));
  },
  S: function(dateObj, seconds) {
    dateObj.setSeconds(parseFloat(seconds));
  },
  U: function(_, unixSeconds) {
    return new Date(parseFloat(unixSeconds) * 1e3);
  },
  W: function(dateObj, weekNum, locale) {
    var weekNumber = parseInt(weekNum);
    var date = new Date(dateObj.getFullYear(), 0, 2 + (weekNumber - 1) * 7, 0, 0, 0, 0);
    date.setDate(date.getDate() - date.getDay() + locale.firstDayOfWeek);
    return date;
  },
  Y: function(dateObj, year) {
    dateObj.setFullYear(parseFloat(year));
  },
  Z: function(_, ISODate) {
    return new Date(ISODate);
  },
  d: function(dateObj, day) {
    dateObj.setDate(parseFloat(day));
  },
  h: function(dateObj, hour) {
    dateObj.setHours((dateObj.getHours() >= 12 ? 12 : 0) + parseFloat(hour));
  },
  i: function(dateObj, minutes) {
    dateObj.setMinutes(parseFloat(minutes));
  },
  j: function(dateObj, day) {
    dateObj.setDate(parseFloat(day));
  },
  l: doNothing,
  m: function(dateObj, month) {
    dateObj.setMonth(parseFloat(month) - 1);
  },
  n: function(dateObj, month) {
    dateObj.setMonth(parseFloat(month) - 1);
  },
  s: function(dateObj, seconds) {
    dateObj.setSeconds(parseFloat(seconds));
  },
  u: function(_, unixMillSeconds) {
    return new Date(parseFloat(unixMillSeconds));
  },
  w: doNothing,
  y: function(dateObj, year) {
    dateObj.setFullYear(2e3 + parseFloat(year));
  }
};
var tokenRegex = {
  D: "",
  F: "",
  G: "(\\d\\d|\\d)",
  H: "(\\d\\d|\\d)",
  J: "(\\d\\d|\\d)\\w+",
  K: "",
  M: "",
  S: "(\\d\\d|\\d)",
  U: "(.+)",
  W: "(\\d\\d|\\d)",
  Y: "(\\d{4})",
  Z: "(.+)",
  d: "(\\d\\d|\\d)",
  h: "(\\d\\d|\\d)",
  i: "(\\d\\d|\\d)",
  j: "(\\d\\d|\\d)",
  l: "",
  m: "(\\d\\d|\\d)",
  n: "(\\d\\d|\\d)",
  s: "(\\d\\d|\\d)",
  u: "(.+)",
  w: "(\\d\\d|\\d)",
  y: "(\\d{2})"
};
var formats = {
  Z: function(date) {
    return date.toISOString();
  },
  D: function(date, locale, options) {
    return locale.weekdays.shorthand[formats.w(date, locale, options)];
  },
  F: function(date, locale, options) {
    return monthToStr(formats.n(date, locale, options) - 1, false, locale);
  },
  G: function(date, locale, options) {
    return pad(formats.h(date, locale, options));
  },
  H: function(date) {
    return pad(date.getHours());
  },
  J: function(date, locale) {
    return locale.ordinal !== void 0 ? date.getDate() + locale.ordinal(date.getDate()) : date.getDate();
  },
  K: function(date, locale) {
    return locale.amPM[int(date.getHours() > 11)];
  },
  M: function(date, locale) {
    return monthToStr(date.getMonth(), true, locale);
  },
  S: function(date) {
    return pad(date.getSeconds());
  },
  U: function(date) {
    return date.getTime() / 1e3;
  },
  W: function(date, _, options) {
    return options.getWeek(date);
  },
  Y: function(date) {
    return pad(date.getFullYear(), 4);
  },
  d: function(date) {
    return pad(date.getDate());
  },
  h: function(date) {
    return date.getHours() % 12 ? date.getHours() % 12 : 12;
  },
  i: function(date) {
    return pad(date.getMinutes());
  },
  j: function(date) {
    return date.getDate();
  },
  l: function(date, locale) {
    return locale.weekdays.longhand[date.getDay()];
  },
  m: function(date) {
    return pad(date.getMonth() + 1);
  },
  n: function(date) {
    return date.getMonth() + 1;
  },
  s: function(date) {
    return date.getSeconds();
  },
  u: function(date) {
    return date.getTime();
  },
  w: function(date) {
    return date.getDay();
  },
  y: function(date) {
    return String(date.getFullYear()).substring(2);
  }
};

// node_modules/flatpickr/dist/esm/utils/dates.js
var createDateFormatter = function(_a) {
  var _b = _a.config, config = _b === void 0 ? defaults : _b, _c = _a.l10n, l10n = _c === void 0 ? english : _c, _d = _a.isMobile, isMobile = _d === void 0 ? false : _d;
  return function(dateObj, frmt, overrideLocale) {
    var locale = overrideLocale || l10n;
    if (config.formatDate !== void 0 && !isMobile) {
      return config.formatDate(dateObj, frmt, locale);
    }
    return frmt.split("").map(function(c, i, arr) {
      return formats[c] && arr[i - 1] !== "\\" ? formats[c](dateObj, locale, config) : c !== "\\" ? c : "";
    }).join("");
  };
};
var createDateParser = function(_a) {
  var _b = _a.config, config = _b === void 0 ? defaults : _b, _c = _a.l10n, l10n = _c === void 0 ? english : _c;
  return function(date, givenFormat, timeless, customLocale) {
    if (date !== 0 && !date)
      return void 0;
    var locale = customLocale || l10n;
    var parsedDate;
    var dateOrig = date;
    if (date instanceof Date)
      parsedDate = new Date(date.getTime());
    else if (typeof date !== "string" && date.toFixed !== void 0)
      parsedDate = new Date(date);
    else if (typeof date === "string") {
      var format2 = givenFormat || (config || defaults).dateFormat;
      var datestr = String(date).trim();
      if (datestr === "today") {
        parsedDate = new Date();
        timeless = true;
      } else if (config && config.parseDate) {
        parsedDate = config.parseDate(date, format2);
      } else if (/Z$/.test(datestr) || /GMT$/.test(datestr)) {
        parsedDate = new Date(date);
      } else {
        var matched = void 0, ops = [];
        for (var i = 0, matchIndex = 0, regexStr = ""; i < format2.length; i++) {
          var token = format2[i];
          var isBackSlash = token === "\\";
          var escaped = format2[i - 1] === "\\" || isBackSlash;
          if (tokenRegex[token] && !escaped) {
            regexStr += tokenRegex[token];
            var match = new RegExp(regexStr).exec(date);
            if (match && (matched = true)) {
              ops[token !== "Y" ? "push" : "unshift"]({
                fn: revFormat[token],
                val: match[++matchIndex]
              });
            }
          } else if (!isBackSlash)
            regexStr += ".";
        }
        parsedDate = !config || !config.noCalendar ? new Date(new Date().getFullYear(), 0, 1, 0, 0, 0, 0) : new Date(new Date().setHours(0, 0, 0, 0));
        ops.forEach(function(_a2) {
          var fn2 = _a2.fn, val = _a2.val;
          return parsedDate = fn2(parsedDate, val, locale) || parsedDate;
        });
        parsedDate = matched ? parsedDate : void 0;
      }
    }
    if (!(parsedDate instanceof Date && !isNaN(parsedDate.getTime()))) {
      config.errorHandler(new Error("Invalid date provided: " + dateOrig));
      return void 0;
    }
    if (timeless === true)
      parsedDate.setHours(0, 0, 0, 0);
    return parsedDate;
  };
};
function compareDates(date1, date2, timeless) {
  if (timeless === void 0) {
    timeless = true;
  }
  if (timeless !== false) {
    return new Date(date1.getTime()).setHours(0, 0, 0, 0) - new Date(date2.getTime()).setHours(0, 0, 0, 0);
  }
  return date1.getTime() - date2.getTime();
}
var isBetween = function(ts, ts1, ts2) {
  return ts > Math.min(ts1, ts2) && ts < Math.max(ts1, ts2);
};
var calculateSecondsSinceMidnight = function(hours, minutes, seconds) {
  return hours * 3600 + minutes * 60 + seconds;
};
var parseSeconds = function(secondsSinceMidnight) {
  var hours = Math.floor(secondsSinceMidnight / 3600), minutes = (secondsSinceMidnight - hours * 3600) / 60;
  return [hours, minutes, secondsSinceMidnight - hours * 3600 - minutes * 60];
};
var duration = {
  DAY: 864e5
};
function getDefaultHours(config) {
  var hours = config.defaultHour;
  var minutes = config.defaultMinute;
  var seconds = config.defaultSeconds;
  if (config.minDate !== void 0) {
    var minHour = config.minDate.getHours();
    var minMinutes = config.minDate.getMinutes();
    var minSeconds = config.minDate.getSeconds();
    if (hours < minHour) {
      hours = minHour;
    }
    if (hours === minHour && minutes < minMinutes) {
      minutes = minMinutes;
    }
    if (hours === minHour && minutes === minMinutes && seconds < minSeconds)
      seconds = config.minDate.getSeconds();
  }
  if (config.maxDate !== void 0) {
    var maxHr = config.maxDate.getHours();
    var maxMinutes = config.maxDate.getMinutes();
    hours = Math.min(hours, maxHr);
    if (hours === maxHr)
      minutes = Math.min(maxMinutes, minutes);
    if (hours === maxHr && minutes === maxMinutes)
      seconds = config.maxDate.getSeconds();
  }
  return { hours, minutes, seconds };
}

// node_modules/flatpickr/dist/esm/utils/polyfills.js
if (typeof Object.assign !== "function") {
  Object.assign = function(target) {
    var args = [];
    for (var _i = 1; _i < arguments.length; _i++) {
      args[_i - 1] = arguments[_i];
    }
    if (!target) {
      throw TypeError("Cannot convert undefined or null to object");
    }
    var _loop_1 = function(source2) {
      if (source2) {
        Object.keys(source2).forEach(function(key) {
          return target[key] = source2[key];
        });
      }
    };
    for (var _a = 0, args_1 = args; _a < args_1.length; _a++) {
      var source = args_1[_a];
      _loop_1(source);
    }
    return target;
  };
}

// node_modules/flatpickr/dist/esm/index.js
var __assign = function() {
  __assign = Object.assign || function(t) {
    for (var s, i = 1, n = arguments.length; i < n; i++) {
      s = arguments[i];
      for (var p in s)
        if (Object.prototype.hasOwnProperty.call(s, p))
          t[p] = s[p];
    }
    return t;
  };
  return __assign.apply(this, arguments);
};
var __spreadArrays = function() {
  for (var s = 0, i = 0, il = arguments.length; i < il; i++)
    s += arguments[i].length;
  for (var r = Array(s), k = 0, i = 0; i < il; i++)
    for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)
      r[k] = a[j];
  return r;
};
var DEBOUNCED_CHANGE_MS = 300;
function FlatpickrInstance(element, instanceConfig) {
  var self = {
    config: __assign(__assign({}, defaults), flatpickr.defaultConfig),
    l10n: default_default
  };
  self.parseDate = createDateParser({ config: self.config, l10n: self.l10n });
  self._handlers = [];
  self.pluginElements = [];
  self.loadedPlugins = [];
  self._bind = bind;
  self._setHoursFromDate = setHoursFromDate;
  self._positionCalendar = positionCalendar;
  self.changeMonth = changeMonth;
  self.changeYear = changeYear;
  self.clear = clear;
  self.close = close;
  self.onMouseOver = onMouseOver;
  self._createElement = createElement;
  self.createDay = createDay;
  self.destroy = destroy;
  self.isEnabled = isEnabled;
  self.jumpToDate = jumpToDate;
  self.updateValue = updateValue;
  self.open = open;
  self.redraw = redraw;
  self.set = set;
  self.setDate = setDate;
  self.toggle = toggle;
  function setupHelperFunctions() {
    self.utils = {
      getDaysInMonth: function(month, yr) {
        if (month === void 0) {
          month = self.currentMonth;
        }
        if (yr === void 0) {
          yr = self.currentYear;
        }
        if (month === 1 && (yr % 4 === 0 && yr % 100 !== 0 || yr % 400 === 0))
          return 29;
        return self.l10n.daysInMonth[month];
      }
    };
  }
  function init() {
    self.element = self.input = element;
    self.isOpen = false;
    parseConfig();
    setupLocale();
    setupInputs();
    setupDates();
    setupHelperFunctions();
    if (!self.isMobile)
      build();
    bindEvents();
    if (self.selectedDates.length || self.config.noCalendar) {
      if (self.config.enableTime) {
        setHoursFromDate(self.config.noCalendar ? self.latestSelectedDateObj : void 0);
      }
      updateValue(false);
    }
    setCalendarWidth();
    var isSafari = /^((?!chrome|android).)*safari/i.test(navigator.userAgent);
    if (!self.isMobile && isSafari) {
      positionCalendar();
    }
    triggerEvent("onReady");
  }
  function getClosestActiveElement() {
    var _a;
    return ((_a = self.calendarContainer) === null || _a === void 0 ? void 0 : _a.getRootNode()).activeElement || document.activeElement;
  }
  function bindToInstance(fn2) {
    return fn2.bind(self);
  }
  function setCalendarWidth() {
    var config = self.config;
    if (config.weekNumbers === false && config.showMonths === 1) {
      return;
    } else if (config.noCalendar !== true) {
      window.requestAnimationFrame(function() {
        if (self.calendarContainer !== void 0) {
          self.calendarContainer.style.visibility = "hidden";
          self.calendarContainer.style.display = "block";
        }
        if (self.daysContainer !== void 0) {
          var daysWidth = (self.days.offsetWidth + 1) * config.showMonths;
          self.daysContainer.style.width = daysWidth + "px";
          self.calendarContainer.style.width = daysWidth + (self.weekWrapper !== void 0 ? self.weekWrapper.offsetWidth : 0) + "px";
          self.calendarContainer.style.removeProperty("visibility");
          self.calendarContainer.style.removeProperty("display");
        }
      });
    }
  }
  function updateTime(e) {
    if (self.selectedDates.length === 0) {
      var defaultDate = self.config.minDate === void 0 || compareDates(new Date(), self.config.minDate) >= 0 ? new Date() : new Date(self.config.minDate.getTime());
      var defaults2 = getDefaultHours(self.config);
      defaultDate.setHours(defaults2.hours, defaults2.minutes, defaults2.seconds, defaultDate.getMilliseconds());
      self.selectedDates = [defaultDate];
      self.latestSelectedDateObj = defaultDate;
    }
    if (e !== void 0 && e.type !== "blur") {
      timeWrapper(e);
    }
    var prevValue = self._input.value;
    setHoursFromInputs();
    updateValue();
    if (self._input.value !== prevValue) {
      self._debouncedChange();
    }
  }
  function ampm2military(hour, amPM) {
    return hour % 12 + 12 * int(amPM === self.l10n.amPM[1]);
  }
  function military2ampm(hour) {
    switch (hour % 24) {
      case 0:
      case 12:
        return 12;
      default:
        return hour % 12;
    }
  }
  function setHoursFromInputs() {
    if (self.hourElement === void 0 || self.minuteElement === void 0)
      return;
    var hours = (parseInt(self.hourElement.value.slice(-2), 10) || 0) % 24, minutes = (parseInt(self.minuteElement.value, 10) || 0) % 60, seconds = self.secondElement !== void 0 ? (parseInt(self.secondElement.value, 10) || 0) % 60 : 0;
    if (self.amPM !== void 0) {
      hours = ampm2military(hours, self.amPM.textContent);
    }
    var limitMinHours = self.config.minTime !== void 0 || self.config.minDate && self.minDateHasTime && self.latestSelectedDateObj && compareDates(self.latestSelectedDateObj, self.config.minDate, true) === 0;
    var limitMaxHours = self.config.maxTime !== void 0 || self.config.maxDate && self.maxDateHasTime && self.latestSelectedDateObj && compareDates(self.latestSelectedDateObj, self.config.maxDate, true) === 0;
    if (self.config.maxTime !== void 0 && self.config.minTime !== void 0 && self.config.minTime > self.config.maxTime) {
      var minBound = calculateSecondsSinceMidnight(self.config.minTime.getHours(), self.config.minTime.getMinutes(), self.config.minTime.getSeconds());
      var maxBound = calculateSecondsSinceMidnight(self.config.maxTime.getHours(), self.config.maxTime.getMinutes(), self.config.maxTime.getSeconds());
      var currentTime = calculateSecondsSinceMidnight(hours, minutes, seconds);
      if (currentTime > maxBound && currentTime < minBound) {
        var result = parseSeconds(minBound);
        hours = result[0];
        minutes = result[1];
        seconds = result[2];
      }
    } else {
      if (limitMaxHours) {
        var maxTime = self.config.maxTime !== void 0 ? self.config.maxTime : self.config.maxDate;
        hours = Math.min(hours, maxTime.getHours());
        if (hours === maxTime.getHours())
          minutes = Math.min(minutes, maxTime.getMinutes());
        if (minutes === maxTime.getMinutes())
          seconds = Math.min(seconds, maxTime.getSeconds());
      }
      if (limitMinHours) {
        var minTime = self.config.minTime !== void 0 ? self.config.minTime : self.config.minDate;
        hours = Math.max(hours, minTime.getHours());
        if (hours === minTime.getHours() && minutes < minTime.getMinutes())
          minutes = minTime.getMinutes();
        if (minutes === minTime.getMinutes())
          seconds = Math.max(seconds, minTime.getSeconds());
      }
    }
    setHours(hours, minutes, seconds);
  }
  function setHoursFromDate(dateObj) {
    var date = dateObj || self.latestSelectedDateObj;
    if (date && date instanceof Date) {
      setHours(date.getHours(), date.getMinutes(), date.getSeconds());
    }
  }
  function setHours(hours, minutes, seconds) {
    if (self.latestSelectedDateObj !== void 0) {
      self.latestSelectedDateObj.setHours(hours % 24, minutes, seconds || 0, 0);
    }
    if (!self.hourElement || !self.minuteElement || self.isMobile)
      return;
    self.hourElement.value = pad(!self.config.time_24hr ? (12 + hours) % 12 + 12 * int(hours % 12 === 0) : hours);
    self.minuteElement.value = pad(minutes);
    if (self.amPM !== void 0)
      self.amPM.textContent = self.l10n.amPM[int(hours >= 12)];
    if (self.secondElement !== void 0)
      self.secondElement.value = pad(seconds);
  }
  function onYearInput(event) {
    var eventTarget = getEventTarget(event);
    var year = parseInt(eventTarget.value) + (event.delta || 0);
    if (year / 1e3 > 1 || event.key === "Enter" && !/[^\d]/.test(year.toString())) {
      changeYear(year);
    }
  }
  function bind(element2, event, handler, options) {
    if (event instanceof Array)
      return event.forEach(function(ev) {
        return bind(element2, ev, handler, options);
      });
    if (element2 instanceof Array)
      return element2.forEach(function(el) {
        return bind(el, event, handler, options);
      });
    element2.addEventListener(event, handler, options);
    self._handlers.push({
      remove: function() {
        return element2.removeEventListener(event, handler, options);
      }
    });
  }
  function triggerChange() {
    triggerEvent("onChange");
  }
  function bindEvents() {
    if (self.config.wrap) {
      ["open", "close", "toggle", "clear"].forEach(function(evt) {
        Array.prototype.forEach.call(self.element.querySelectorAll("[data-" + evt + "]"), function(el) {
          return bind(el, "click", self[evt]);
        });
      });
    }
    if (self.isMobile) {
      setupMobile();
      return;
    }
    var debouncedResize = debounce2(onResize, 50);
    self._debouncedChange = debounce2(triggerChange, DEBOUNCED_CHANGE_MS);
    if (self.daysContainer && !/iPhone|iPad|iPod/i.test(navigator.userAgent))
      bind(self.daysContainer, "mouseover", function(e) {
        if (self.config.mode === "range")
          onMouseOver(getEventTarget(e));
      });
    bind(self._input, "keydown", onKeyDown);
    if (self.calendarContainer !== void 0) {
      bind(self.calendarContainer, "keydown", onKeyDown);
    }
    if (!self.config.inline && !self.config.static)
      bind(window, "resize", debouncedResize);
    if (window.ontouchstart !== void 0)
      bind(window.document, "touchstart", documentClick);
    else
      bind(window.document, "mousedown", documentClick);
    bind(window.document, "focus", documentClick, { capture: true });
    if (self.config.clickOpens === true) {
      bind(self._input, "focus", self.open);
      bind(self._input, "click", self.open);
    }
    if (self.daysContainer !== void 0) {
      bind(self.monthNav, "click", onMonthNavClick);
      bind(self.monthNav, ["keyup", "increment"], onYearInput);
      bind(self.daysContainer, "click", selectDate);
    }
    if (self.timeContainer !== void 0 && self.minuteElement !== void 0 && self.hourElement !== void 0) {
      var selText = function(e) {
        return getEventTarget(e).select();
      };
      bind(self.timeContainer, ["increment"], updateTime);
      bind(self.timeContainer, "blur", updateTime, { capture: true });
      bind(self.timeContainer, "click", timeIncrement);
      bind([self.hourElement, self.minuteElement], ["focus", "click"], selText);
      if (self.secondElement !== void 0)
        bind(self.secondElement, "focus", function() {
          return self.secondElement && self.secondElement.select();
        });
      if (self.amPM !== void 0) {
        bind(self.amPM, "click", function(e) {
          updateTime(e);
        });
      }
    }
    if (self.config.allowInput) {
      bind(self._input, "blur", onBlur);
    }
  }
  function jumpToDate(jumpDate, triggerChange2) {
    var jumpTo = jumpDate !== void 0 ? self.parseDate(jumpDate) : self.latestSelectedDateObj || (self.config.minDate && self.config.minDate > self.now ? self.config.minDate : self.config.maxDate && self.config.maxDate < self.now ? self.config.maxDate : self.now);
    var oldYear = self.currentYear;
    var oldMonth = self.currentMonth;
    try {
      if (jumpTo !== void 0) {
        self.currentYear = jumpTo.getFullYear();
        self.currentMonth = jumpTo.getMonth();
      }
    } catch (e) {
      e.message = "Invalid date supplied: " + jumpTo;
      self.config.errorHandler(e);
    }
    if (triggerChange2 && self.currentYear !== oldYear) {
      triggerEvent("onYearChange");
      buildMonthSwitch();
    }
    if (triggerChange2 && (self.currentYear !== oldYear || self.currentMonth !== oldMonth)) {
      triggerEvent("onMonthChange");
    }
    self.redraw();
  }
  function timeIncrement(e) {
    var eventTarget = getEventTarget(e);
    if (~eventTarget.className.indexOf("arrow"))
      incrementNumInput(e, eventTarget.classList.contains("arrowUp") ? 1 : -1);
  }
  function incrementNumInput(e, delta, inputElem) {
    var target = e && getEventTarget(e);
    var input = inputElem || target && target.parentNode && target.parentNode.firstChild;
    var event = createEvent("increment");
    event.delta = delta;
    input && input.dispatchEvent(event);
  }
  function build() {
    var fragment = window.document.createDocumentFragment();
    self.calendarContainer = createElement("div", "flatpickr-calendar");
    self.calendarContainer.tabIndex = -1;
    if (!self.config.noCalendar) {
      fragment.appendChild(buildMonthNav());
      self.innerContainer = createElement("div", "flatpickr-innerContainer");
      if (self.config.weekNumbers) {
        var _a = buildWeeks(), weekWrapper = _a.weekWrapper, weekNumbers = _a.weekNumbers;
        self.innerContainer.appendChild(weekWrapper);
        self.weekNumbers = weekNumbers;
        self.weekWrapper = weekWrapper;
      }
      self.rContainer = createElement("div", "flatpickr-rContainer");
      self.rContainer.appendChild(buildWeekdays());
      if (!self.daysContainer) {
        self.daysContainer = createElement("div", "flatpickr-days");
        self.daysContainer.tabIndex = -1;
      }
      buildDays();
      self.rContainer.appendChild(self.daysContainer);
      self.innerContainer.appendChild(self.rContainer);
      fragment.appendChild(self.innerContainer);
    }
    if (self.config.enableTime) {
      fragment.appendChild(buildTime());
    }
    toggleClass(self.calendarContainer, "rangeMode", self.config.mode === "range");
    toggleClass(self.calendarContainer, "animate", self.config.animate === true);
    toggleClass(self.calendarContainer, "multiMonth", self.config.showMonths > 1);
    self.calendarContainer.appendChild(fragment);
    var customAppend = self.config.appendTo !== void 0 && self.config.appendTo.nodeType !== void 0;
    if (self.config.inline || self.config.static) {
      self.calendarContainer.classList.add(self.config.inline ? "inline" : "static");
      if (self.config.inline) {
        if (!customAppend && self.element.parentNode)
          self.element.parentNode.insertBefore(self.calendarContainer, self._input.nextSibling);
        else if (self.config.appendTo !== void 0)
          self.config.appendTo.appendChild(self.calendarContainer);
      }
      if (self.config.static) {
        var wrapper = createElement("div", "flatpickr-wrapper");
        if (self.element.parentNode)
          self.element.parentNode.insertBefore(wrapper, self.element);
        wrapper.appendChild(self.element);
        if (self.altInput)
          wrapper.appendChild(self.altInput);
        wrapper.appendChild(self.calendarContainer);
      }
    }
    if (!self.config.static && !self.config.inline)
      (self.config.appendTo !== void 0 ? self.config.appendTo : window.document.body).appendChild(self.calendarContainer);
  }
  function createDay(className, date, _dayNumber, i) {
    var dateIsEnabled = isEnabled(date, true), dayElement = createElement("span", className, date.getDate().toString());
    dayElement.dateObj = date;
    dayElement.$i = i;
    dayElement.setAttribute("aria-label", self.formatDate(date, self.config.ariaDateFormat));
    if (className.indexOf("hidden") === -1 && compareDates(date, self.now) === 0) {
      self.todayDateElem = dayElement;
      dayElement.classList.add("today");
      dayElement.setAttribute("aria-current", "date");
    }
    if (dateIsEnabled) {
      dayElement.tabIndex = -1;
      if (isDateSelected(date)) {
        dayElement.classList.add("selected");
        self.selectedDateElem = dayElement;
        if (self.config.mode === "range") {
          toggleClass(dayElement, "startRange", self.selectedDates[0] && compareDates(date, self.selectedDates[0], true) === 0);
          toggleClass(dayElement, "endRange", self.selectedDates[1] && compareDates(date, self.selectedDates[1], true) === 0);
          if (className === "nextMonthDay")
            dayElement.classList.add("inRange");
        }
      }
    } else {
      dayElement.classList.add("flatpickr-disabled");
    }
    if (self.config.mode === "range") {
      if (isDateInRange(date) && !isDateSelected(date))
        dayElement.classList.add("inRange");
    }
    if (self.weekNumbers && self.config.showMonths === 1 && className !== "prevMonthDay" && i % 7 === 6) {
      self.weekNumbers.insertAdjacentHTML("beforeend", "<span class='flatpickr-day'>" + self.config.getWeek(date) + "</span>");
    }
    triggerEvent("onDayCreate", dayElement);
    return dayElement;
  }
  function focusOnDayElem(targetNode) {
    targetNode.focus();
    if (self.config.mode === "range")
      onMouseOver(targetNode);
  }
  function getFirstAvailableDay(delta) {
    var startMonth = delta > 0 ? 0 : self.config.showMonths - 1;
    var endMonth = delta > 0 ? self.config.showMonths : -1;
    for (var m = startMonth; m != endMonth; m += delta) {
      var month = self.daysContainer.children[m];
      var startIndex = delta > 0 ? 0 : month.children.length - 1;
      var endIndex = delta > 0 ? month.children.length : -1;
      for (var i = startIndex; i != endIndex; i += delta) {
        var c = month.children[i];
        if (c.className.indexOf("hidden") === -1 && isEnabled(c.dateObj))
          return c;
      }
    }
    return void 0;
  }
  function getNextAvailableDay(current, delta) {
    var givenMonth = current.className.indexOf("Month") === -1 ? current.dateObj.getMonth() : self.currentMonth;
    var endMonth = delta > 0 ? self.config.showMonths : -1;
    var loopDelta = delta > 0 ? 1 : -1;
    for (var m = givenMonth - self.currentMonth; m != endMonth; m += loopDelta) {
      var month = self.daysContainer.children[m];
      var startIndex = givenMonth - self.currentMonth === m ? current.$i + delta : delta < 0 ? month.children.length - 1 : 0;
      var numMonthDays = month.children.length;
      for (var i = startIndex; i >= 0 && i < numMonthDays && i != (delta > 0 ? numMonthDays : -1); i += loopDelta) {
        var c = month.children[i];
        if (c.className.indexOf("hidden") === -1 && isEnabled(c.dateObj) && Math.abs(current.$i - i) >= Math.abs(delta))
          return focusOnDayElem(c);
      }
    }
    self.changeMonth(loopDelta);
    focusOnDay(getFirstAvailableDay(loopDelta), 0);
    return void 0;
  }
  function focusOnDay(current, offset2) {
    var activeElement = getClosestActiveElement();
    var dayFocused = isInView(activeElement || document.body);
    var startElem = current !== void 0 ? current : dayFocused ? activeElement : self.selectedDateElem !== void 0 && isInView(self.selectedDateElem) ? self.selectedDateElem : self.todayDateElem !== void 0 && isInView(self.todayDateElem) ? self.todayDateElem : getFirstAvailableDay(offset2 > 0 ? 1 : -1);
    if (startElem === void 0) {
      self._input.focus();
    } else if (!dayFocused) {
      focusOnDayElem(startElem);
    } else {
      getNextAvailableDay(startElem, offset2);
    }
  }
  function buildMonthDays(year, month) {
    var firstOfMonth = (new Date(year, month, 1).getDay() - self.l10n.firstDayOfWeek + 7) % 7;
    var prevMonthDays = self.utils.getDaysInMonth((month - 1 + 12) % 12, year);
    var daysInMonth = self.utils.getDaysInMonth(month, year), days = window.document.createDocumentFragment(), isMultiMonth = self.config.showMonths > 1, prevMonthDayClass = isMultiMonth ? "prevMonthDay hidden" : "prevMonthDay", nextMonthDayClass = isMultiMonth ? "nextMonthDay hidden" : "nextMonthDay";
    var dayNumber = prevMonthDays + 1 - firstOfMonth, dayIndex = 0;
    for (; dayNumber <= prevMonthDays; dayNumber++, dayIndex++) {
      days.appendChild(createDay("flatpickr-day " + prevMonthDayClass, new Date(year, month - 1, dayNumber), dayNumber, dayIndex));
    }
    for (dayNumber = 1; dayNumber <= daysInMonth; dayNumber++, dayIndex++) {
      days.appendChild(createDay("flatpickr-day", new Date(year, month, dayNumber), dayNumber, dayIndex));
    }
    for (var dayNum = daysInMonth + 1; dayNum <= 42 - firstOfMonth && (self.config.showMonths === 1 || dayIndex % 7 !== 0); dayNum++, dayIndex++) {
      days.appendChild(createDay("flatpickr-day " + nextMonthDayClass, new Date(year, month + 1, dayNum % daysInMonth), dayNum, dayIndex));
    }
    var dayContainer = createElement("div", "dayContainer");
    dayContainer.appendChild(days);
    return dayContainer;
  }
  function buildDays() {
    if (self.daysContainer === void 0) {
      return;
    }
    clearNode(self.daysContainer);
    if (self.weekNumbers)
      clearNode(self.weekNumbers);
    var frag = document.createDocumentFragment();
    for (var i = 0; i < self.config.showMonths; i++) {
      var d = new Date(self.currentYear, self.currentMonth, 1);
      d.setMonth(self.currentMonth + i);
      frag.appendChild(buildMonthDays(d.getFullYear(), d.getMonth()));
    }
    self.daysContainer.appendChild(frag);
    self.days = self.daysContainer.firstChild;
    if (self.config.mode === "range" && self.selectedDates.length === 1) {
      onMouseOver();
    }
  }
  function buildMonthSwitch() {
    if (self.config.showMonths > 1 || self.config.monthSelectorType !== "dropdown")
      return;
    var shouldBuildMonth = function(month2) {
      if (self.config.minDate !== void 0 && self.currentYear === self.config.minDate.getFullYear() && month2 < self.config.minDate.getMonth()) {
        return false;
      }
      return !(self.config.maxDate !== void 0 && self.currentYear === self.config.maxDate.getFullYear() && month2 > self.config.maxDate.getMonth());
    };
    self.monthsDropdownContainer.tabIndex = -1;
    self.monthsDropdownContainer.innerHTML = "";
    for (var i = 0; i < 12; i++) {
      if (!shouldBuildMonth(i))
        continue;
      var month = createElement("option", "flatpickr-monthDropdown-month");
      month.value = new Date(self.currentYear, i).getMonth().toString();
      month.textContent = monthToStr(i, self.config.shorthandCurrentMonth, self.l10n);
      month.tabIndex = -1;
      if (self.currentMonth === i) {
        month.selected = true;
      }
      self.monthsDropdownContainer.appendChild(month);
    }
  }
  function buildMonth() {
    var container = createElement("div", "flatpickr-month");
    var monthNavFragment = window.document.createDocumentFragment();
    var monthElement;
    if (self.config.showMonths > 1 || self.config.monthSelectorType === "static") {
      monthElement = createElement("span", "cur-month");
    } else {
      self.monthsDropdownContainer = createElement("select", "flatpickr-monthDropdown-months");
      self.monthsDropdownContainer.setAttribute("aria-label", self.l10n.monthAriaLabel);
      bind(self.monthsDropdownContainer, "change", function(e) {
        var target = getEventTarget(e);
        var selectedMonth = parseInt(target.value, 10);
        self.changeMonth(selectedMonth - self.currentMonth);
        triggerEvent("onMonthChange");
      });
      buildMonthSwitch();
      monthElement = self.monthsDropdownContainer;
    }
    var yearInput = createNumberInput("cur-year", { tabindex: "-1" });
    var yearElement = yearInput.getElementsByTagName("input")[0];
    yearElement.setAttribute("aria-label", self.l10n.yearAriaLabel);
    if (self.config.minDate) {
      yearElement.setAttribute("min", self.config.minDate.getFullYear().toString());
    }
    if (self.config.maxDate) {
      yearElement.setAttribute("max", self.config.maxDate.getFullYear().toString());
      yearElement.disabled = !!self.config.minDate && self.config.minDate.getFullYear() === self.config.maxDate.getFullYear();
    }
    var currentMonth = createElement("div", "flatpickr-current-month");
    currentMonth.appendChild(monthElement);
    currentMonth.appendChild(yearInput);
    monthNavFragment.appendChild(currentMonth);
    container.appendChild(monthNavFragment);
    return {
      container,
      yearElement,
      monthElement
    };
  }
  function buildMonths() {
    clearNode(self.monthNav);
    self.monthNav.appendChild(self.prevMonthNav);
    if (self.config.showMonths) {
      self.yearElements = [];
      self.monthElements = [];
    }
    for (var m = self.config.showMonths; m--; ) {
      var month = buildMonth();
      self.yearElements.push(month.yearElement);
      self.monthElements.push(month.monthElement);
      self.monthNav.appendChild(month.container);
    }
    self.monthNav.appendChild(self.nextMonthNav);
  }
  function buildMonthNav() {
    self.monthNav = createElement("div", "flatpickr-months");
    self.yearElements = [];
    self.monthElements = [];
    self.prevMonthNav = createElement("span", "flatpickr-prev-month");
    self.prevMonthNav.innerHTML = self.config.prevArrow;
    self.nextMonthNav = createElement("span", "flatpickr-next-month");
    self.nextMonthNav.innerHTML = self.config.nextArrow;
    buildMonths();
    Object.defineProperty(self, "_hidePrevMonthArrow", {
      get: function() {
        return self.__hidePrevMonthArrow;
      },
      set: function(bool) {
        if (self.__hidePrevMonthArrow !== bool) {
          toggleClass(self.prevMonthNav, "flatpickr-disabled", bool);
          self.__hidePrevMonthArrow = bool;
        }
      }
    });
    Object.defineProperty(self, "_hideNextMonthArrow", {
      get: function() {
        return self.__hideNextMonthArrow;
      },
      set: function(bool) {
        if (self.__hideNextMonthArrow !== bool) {
          toggleClass(self.nextMonthNav, "flatpickr-disabled", bool);
          self.__hideNextMonthArrow = bool;
        }
      }
    });
    self.currentYearElement = self.yearElements[0];
    updateNavigationCurrentMonth();
    return self.monthNav;
  }
  function buildTime() {
    self.calendarContainer.classList.add("hasTime");
    if (self.config.noCalendar)
      self.calendarContainer.classList.add("noCalendar");
    var defaults2 = getDefaultHours(self.config);
    self.timeContainer = createElement("div", "flatpickr-time");
    self.timeContainer.tabIndex = -1;
    var separator = createElement("span", "flatpickr-time-separator", ":");
    var hourInput = createNumberInput("flatpickr-hour", {
      "aria-label": self.l10n.hourAriaLabel
    });
    self.hourElement = hourInput.getElementsByTagName("input")[0];
    var minuteInput = createNumberInput("flatpickr-minute", {
      "aria-label": self.l10n.minuteAriaLabel
    });
    self.minuteElement = minuteInput.getElementsByTagName("input")[0];
    self.hourElement.tabIndex = self.minuteElement.tabIndex = -1;
    self.hourElement.value = pad(self.latestSelectedDateObj ? self.latestSelectedDateObj.getHours() : self.config.time_24hr ? defaults2.hours : military2ampm(defaults2.hours));
    self.minuteElement.value = pad(self.latestSelectedDateObj ? self.latestSelectedDateObj.getMinutes() : defaults2.minutes);
    self.hourElement.setAttribute("step", self.config.hourIncrement.toString());
    self.minuteElement.setAttribute("step", self.config.minuteIncrement.toString());
    self.hourElement.setAttribute("min", self.config.time_24hr ? "0" : "1");
    self.hourElement.setAttribute("max", self.config.time_24hr ? "23" : "12");
    self.hourElement.setAttribute("maxlength", "2");
    self.minuteElement.setAttribute("min", "0");
    self.minuteElement.setAttribute("max", "59");
    self.minuteElement.setAttribute("maxlength", "2");
    self.timeContainer.appendChild(hourInput);
    self.timeContainer.appendChild(separator);
    self.timeContainer.appendChild(minuteInput);
    if (self.config.time_24hr)
      self.timeContainer.classList.add("time24hr");
    if (self.config.enableSeconds) {
      self.timeContainer.classList.add("hasSeconds");
      var secondInput = createNumberInput("flatpickr-second");
      self.secondElement = secondInput.getElementsByTagName("input")[0];
      self.secondElement.value = pad(self.latestSelectedDateObj ? self.latestSelectedDateObj.getSeconds() : defaults2.seconds);
      self.secondElement.setAttribute("step", self.minuteElement.getAttribute("step"));
      self.secondElement.setAttribute("min", "0");
      self.secondElement.setAttribute("max", "59");
      self.secondElement.setAttribute("maxlength", "2");
      self.timeContainer.appendChild(createElement("span", "flatpickr-time-separator", ":"));
      self.timeContainer.appendChild(secondInput);
    }
    if (!self.config.time_24hr) {
      self.amPM = createElement("span", "flatpickr-am-pm", self.l10n.amPM[int((self.latestSelectedDateObj ? self.hourElement.value : self.config.defaultHour) > 11)]);
      self.amPM.title = self.l10n.toggleTitle;
      self.amPM.tabIndex = -1;
      self.timeContainer.appendChild(self.amPM);
    }
    return self.timeContainer;
  }
  function buildWeekdays() {
    if (!self.weekdayContainer)
      self.weekdayContainer = createElement("div", "flatpickr-weekdays");
    else
      clearNode(self.weekdayContainer);
    for (var i = self.config.showMonths; i--; ) {
      var container = createElement("div", "flatpickr-weekdaycontainer");
      self.weekdayContainer.appendChild(container);
    }
    updateWeekdays();
    return self.weekdayContainer;
  }
  function updateWeekdays() {
    if (!self.weekdayContainer) {
      return;
    }
    var firstDayOfWeek = self.l10n.firstDayOfWeek;
    var weekdays = __spreadArrays(self.l10n.weekdays.shorthand);
    if (firstDayOfWeek > 0 && firstDayOfWeek < weekdays.length) {
      weekdays = __spreadArrays(weekdays.splice(firstDayOfWeek, weekdays.length), weekdays.splice(0, firstDayOfWeek));
    }
    for (var i = self.config.showMonths; i--; ) {
      self.weekdayContainer.children[i].innerHTML = "\n      <span class='flatpickr-weekday'>\n        " + weekdays.join("</span><span class='flatpickr-weekday'>") + "\n      </span>\n      ";
    }
  }
  function buildWeeks() {
    self.calendarContainer.classList.add("hasWeeks");
    var weekWrapper = createElement("div", "flatpickr-weekwrapper");
    weekWrapper.appendChild(createElement("span", "flatpickr-weekday", self.l10n.weekAbbreviation));
    var weekNumbers = createElement("div", "flatpickr-weeks");
    weekWrapper.appendChild(weekNumbers);
    return {
      weekWrapper,
      weekNumbers
    };
  }
  function changeMonth(value, isOffset) {
    if (isOffset === void 0) {
      isOffset = true;
    }
    var delta = isOffset ? value : value - self.currentMonth;
    if (delta < 0 && self._hidePrevMonthArrow === true || delta > 0 && self._hideNextMonthArrow === true)
      return;
    self.currentMonth += delta;
    if (self.currentMonth < 0 || self.currentMonth > 11) {
      self.currentYear += self.currentMonth > 11 ? 1 : -1;
      self.currentMonth = (self.currentMonth + 12) % 12;
      triggerEvent("onYearChange");
      buildMonthSwitch();
    }
    buildDays();
    triggerEvent("onMonthChange");
    updateNavigationCurrentMonth();
  }
  function clear(triggerChangeEvent, toInitial) {
    if (triggerChangeEvent === void 0) {
      triggerChangeEvent = true;
    }
    if (toInitial === void 0) {
      toInitial = true;
    }
    self.input.value = "";
    if (self.altInput !== void 0)
      self.altInput.value = "";
    if (self.mobileInput !== void 0)
      self.mobileInput.value = "";
    self.selectedDates = [];
    self.latestSelectedDateObj = void 0;
    if (toInitial === true) {
      self.currentYear = self._initialDate.getFullYear();
      self.currentMonth = self._initialDate.getMonth();
    }
    if (self.config.enableTime === true) {
      var _a = getDefaultHours(self.config), hours = _a.hours, minutes = _a.minutes, seconds = _a.seconds;
      setHours(hours, minutes, seconds);
    }
    self.redraw();
    if (triggerChangeEvent)
      triggerEvent("onChange");
  }
  function close() {
    self.isOpen = false;
    if (!self.isMobile) {
      if (self.calendarContainer !== void 0) {
        self.calendarContainer.classList.remove("open");
      }
      if (self._input !== void 0) {
        self._input.classList.remove("active");
      }
    }
    triggerEvent("onClose");
  }
  function destroy() {
    if (self.config !== void 0)
      triggerEvent("onDestroy");
    for (var i = self._handlers.length; i--; ) {
      self._handlers[i].remove();
    }
    self._handlers = [];
    if (self.mobileInput) {
      if (self.mobileInput.parentNode)
        self.mobileInput.parentNode.removeChild(self.mobileInput);
      self.mobileInput = void 0;
    } else if (self.calendarContainer && self.calendarContainer.parentNode) {
      if (self.config.static && self.calendarContainer.parentNode) {
        var wrapper = self.calendarContainer.parentNode;
        wrapper.lastChild && wrapper.removeChild(wrapper.lastChild);
        if (wrapper.parentNode) {
          while (wrapper.firstChild)
            wrapper.parentNode.insertBefore(wrapper.firstChild, wrapper);
          wrapper.parentNode.removeChild(wrapper);
        }
      } else
        self.calendarContainer.parentNode.removeChild(self.calendarContainer);
    }
    if (self.altInput) {
      self.input.type = "text";
      if (self.altInput.parentNode)
        self.altInput.parentNode.removeChild(self.altInput);
      delete self.altInput;
    }
    if (self.input) {
      self.input.type = self.input._type;
      self.input.classList.remove("flatpickr-input");
      self.input.removeAttribute("readonly");
    }
    [
      "_showTimeInput",
      "latestSelectedDateObj",
      "_hideNextMonthArrow",
      "_hidePrevMonthArrow",
      "__hideNextMonthArrow",
      "__hidePrevMonthArrow",
      "isMobile",
      "isOpen",
      "selectedDateElem",
      "minDateHasTime",
      "maxDateHasTime",
      "days",
      "daysContainer",
      "_input",
      "_positionElement",
      "innerContainer",
      "rContainer",
      "monthNav",
      "todayDateElem",
      "calendarContainer",
      "weekdayContainer",
      "prevMonthNav",
      "nextMonthNav",
      "monthsDropdownContainer",
      "currentMonthElement",
      "currentYearElement",
      "navigationCurrentMonth",
      "selectedDateElem",
      "config"
    ].forEach(function(k) {
      try {
        delete self[k];
      } catch (_) {
      }
    });
  }
  function isCalendarElem(elem) {
    return self.calendarContainer.contains(elem);
  }
  function documentClick(e) {
    if (self.isOpen && !self.config.inline) {
      var eventTarget_1 = getEventTarget(e);
      var isCalendarElement = isCalendarElem(eventTarget_1);
      var isInput = eventTarget_1 === self.input || eventTarget_1 === self.altInput || self.element.contains(eventTarget_1) || e.path && e.path.indexOf && (~e.path.indexOf(self.input) || ~e.path.indexOf(self.altInput));
      var lostFocus = !isInput && !isCalendarElement && !isCalendarElem(e.relatedTarget);
      var isIgnored = !self.config.ignoredFocusElements.some(function(elem) {
        return elem.contains(eventTarget_1);
      });
      if (lostFocus && isIgnored) {
        if (self.config.allowInput) {
          self.setDate(self._input.value, false, self.config.altInput ? self.config.altFormat : self.config.dateFormat);
        }
        if (self.timeContainer !== void 0 && self.minuteElement !== void 0 && self.hourElement !== void 0 && self.input.value !== "" && self.input.value !== void 0) {
          updateTime();
        }
        self.close();
        if (self.config && self.config.mode === "range" && self.selectedDates.length === 1)
          self.clear(false);
      }
    }
  }
  function changeYear(newYear) {
    if (!newYear || self.config.minDate && newYear < self.config.minDate.getFullYear() || self.config.maxDate && newYear > self.config.maxDate.getFullYear())
      return;
    var newYearNum = newYear, isNewYear = self.currentYear !== newYearNum;
    self.currentYear = newYearNum || self.currentYear;
    if (self.config.maxDate && self.currentYear === self.config.maxDate.getFullYear()) {
      self.currentMonth = Math.min(self.config.maxDate.getMonth(), self.currentMonth);
    } else if (self.config.minDate && self.currentYear === self.config.minDate.getFullYear()) {
      self.currentMonth = Math.max(self.config.minDate.getMonth(), self.currentMonth);
    }
    if (isNewYear) {
      self.redraw();
      triggerEvent("onYearChange");
      buildMonthSwitch();
    }
  }
  function isEnabled(date, timeless) {
    var _a;
    if (timeless === void 0) {
      timeless = true;
    }
    var dateToCheck = self.parseDate(date, void 0, timeless);
    if (self.config.minDate && dateToCheck && compareDates(dateToCheck, self.config.minDate, timeless !== void 0 ? timeless : !self.minDateHasTime) < 0 || self.config.maxDate && dateToCheck && compareDates(dateToCheck, self.config.maxDate, timeless !== void 0 ? timeless : !self.maxDateHasTime) > 0)
      return false;
    if (!self.config.enable && self.config.disable.length === 0)
      return true;
    if (dateToCheck === void 0)
      return false;
    var bool = !!self.config.enable, array = (_a = self.config.enable) !== null && _a !== void 0 ? _a : self.config.disable;
    for (var i = 0, d = void 0; i < array.length; i++) {
      d = array[i];
      if (typeof d === "function" && d(dateToCheck))
        return bool;
      else if (d instanceof Date && dateToCheck !== void 0 && d.getTime() === dateToCheck.getTime())
        return bool;
      else if (typeof d === "string") {
        var parsed = self.parseDate(d, void 0, true);
        return parsed && parsed.getTime() === dateToCheck.getTime() ? bool : !bool;
      } else if (typeof d === "object" && dateToCheck !== void 0 && d.from && d.to && dateToCheck.getTime() >= d.from.getTime() && dateToCheck.getTime() <= d.to.getTime())
        return bool;
    }
    return !bool;
  }
  function isInView(elem) {
    if (self.daysContainer !== void 0)
      return elem.className.indexOf("hidden") === -1 && elem.className.indexOf("flatpickr-disabled") === -1 && self.daysContainer.contains(elem);
    return false;
  }
  function onBlur(e) {
    var isInput = e.target === self._input;
    var valueChanged = self._input.value.trimEnd() !== getDateStr();
    if (isInput && valueChanged && !(e.relatedTarget && isCalendarElem(e.relatedTarget))) {
      self.setDate(self._input.value, true, e.target === self.altInput ? self.config.altFormat : self.config.dateFormat);
    }
  }
  function onKeyDown(e) {
    var eventTarget = getEventTarget(e);
    var isInput = self.config.wrap ? element.contains(eventTarget) : eventTarget === self._input;
    var allowInput = self.config.allowInput;
    var allowKeydown = self.isOpen && (!allowInput || !isInput);
    var allowInlineKeydown = self.config.inline && isInput && !allowInput;
    if (e.keyCode === 13 && isInput) {
      if (allowInput) {
        self.setDate(self._input.value, true, eventTarget === self.altInput ? self.config.altFormat : self.config.dateFormat);
        self.close();
        return eventTarget.blur();
      } else {
        self.open();
      }
    } else if (isCalendarElem(eventTarget) || allowKeydown || allowInlineKeydown) {
      var isTimeObj = !!self.timeContainer && self.timeContainer.contains(eventTarget);
      switch (e.keyCode) {
        case 13:
          if (isTimeObj) {
            e.preventDefault();
            updateTime();
            focusAndClose();
          } else
            selectDate(e);
          break;
        case 27:
          e.preventDefault();
          focusAndClose();
          break;
        case 8:
        case 46:
          if (isInput && !self.config.allowInput) {
            e.preventDefault();
            self.clear();
          }
          break;
        case 37:
        case 39:
          if (!isTimeObj && !isInput) {
            e.preventDefault();
            var activeElement = getClosestActiveElement();
            if (self.daysContainer !== void 0 && (allowInput === false || activeElement && isInView(activeElement))) {
              var delta_1 = e.keyCode === 39 ? 1 : -1;
              if (!e.ctrlKey)
                focusOnDay(void 0, delta_1);
              else {
                e.stopPropagation();
                changeMonth(delta_1);
                focusOnDay(getFirstAvailableDay(1), 0);
              }
            }
          } else if (self.hourElement)
            self.hourElement.focus();
          break;
        case 38:
        case 40:
          e.preventDefault();
          var delta = e.keyCode === 40 ? 1 : -1;
          if (self.daysContainer && eventTarget.$i !== void 0 || eventTarget === self.input || eventTarget === self.altInput) {
            if (e.ctrlKey) {
              e.stopPropagation();
              changeYear(self.currentYear - delta);
              focusOnDay(getFirstAvailableDay(1), 0);
            } else if (!isTimeObj)
              focusOnDay(void 0, delta * 7);
          } else if (eventTarget === self.currentYearElement) {
            changeYear(self.currentYear - delta);
          } else if (self.config.enableTime) {
            if (!isTimeObj && self.hourElement)
              self.hourElement.focus();
            updateTime(e);
            self._debouncedChange();
          }
          break;
        case 9:
          if (isTimeObj) {
            var elems = [
              self.hourElement,
              self.minuteElement,
              self.secondElement,
              self.amPM
            ].concat(self.pluginElements).filter(function(x) {
              return x;
            });
            var i = elems.indexOf(eventTarget);
            if (i !== -1) {
              var target = elems[i + (e.shiftKey ? -1 : 1)];
              e.preventDefault();
              (target || self._input).focus();
            }
          } else if (!self.config.noCalendar && self.daysContainer && self.daysContainer.contains(eventTarget) && e.shiftKey) {
            e.preventDefault();
            self._input.focus();
          }
          break;
        default:
          break;
      }
    }
    if (self.amPM !== void 0 && eventTarget === self.amPM) {
      switch (e.key) {
        case self.l10n.amPM[0].charAt(0):
        case self.l10n.amPM[0].charAt(0).toLowerCase():
          self.amPM.textContent = self.l10n.amPM[0];
          setHoursFromInputs();
          updateValue();
          break;
        case self.l10n.amPM[1].charAt(0):
        case self.l10n.amPM[1].charAt(0).toLowerCase():
          self.amPM.textContent = self.l10n.amPM[1];
          setHoursFromInputs();
          updateValue();
          break;
      }
    }
    if (isInput || isCalendarElem(eventTarget)) {
      triggerEvent("onKeyDown", e);
    }
  }
  function onMouseOver(elem, cellClass) {
    if (cellClass === void 0) {
      cellClass = "flatpickr-day";
    }
    if (self.selectedDates.length !== 1 || elem && (!elem.classList.contains(cellClass) || elem.classList.contains("flatpickr-disabled")))
      return;
    var hoverDate = elem ? elem.dateObj.getTime() : self.days.firstElementChild.dateObj.getTime(), initialDate = self.parseDate(self.selectedDates[0], void 0, true).getTime(), rangeStartDate = Math.min(hoverDate, self.selectedDates[0].getTime()), rangeEndDate = Math.max(hoverDate, self.selectedDates[0].getTime());
    var containsDisabled = false;
    var minRange = 0, maxRange = 0;
    for (var t = rangeStartDate; t < rangeEndDate; t += duration.DAY) {
      if (!isEnabled(new Date(t), true)) {
        containsDisabled = containsDisabled || t > rangeStartDate && t < rangeEndDate;
        if (t < initialDate && (!minRange || t > minRange))
          minRange = t;
        else if (t > initialDate && (!maxRange || t < maxRange))
          maxRange = t;
      }
    }
    var hoverableCells = Array.from(self.rContainer.querySelectorAll("*:nth-child(-n+" + self.config.showMonths + ") > ." + cellClass));
    hoverableCells.forEach(function(dayElem) {
      var date = dayElem.dateObj;
      var timestamp = date.getTime();
      var outOfRange = minRange > 0 && timestamp < minRange || maxRange > 0 && timestamp > maxRange;
      if (outOfRange) {
        dayElem.classList.add("notAllowed");
        ["inRange", "startRange", "endRange"].forEach(function(c) {
          dayElem.classList.remove(c);
        });
        return;
      } else if (containsDisabled && !outOfRange)
        return;
      ["startRange", "inRange", "endRange", "notAllowed"].forEach(function(c) {
        dayElem.classList.remove(c);
      });
      if (elem !== void 0) {
        elem.classList.add(hoverDate <= self.selectedDates[0].getTime() ? "startRange" : "endRange");
        if (initialDate < hoverDate && timestamp === initialDate)
          dayElem.classList.add("startRange");
        else if (initialDate > hoverDate && timestamp === initialDate)
          dayElem.classList.add("endRange");
        if (timestamp >= minRange && (maxRange === 0 || timestamp <= maxRange) && isBetween(timestamp, initialDate, hoverDate))
          dayElem.classList.add("inRange");
      }
    });
  }
  function onResize() {
    if (self.isOpen && !self.config.static && !self.config.inline)
      positionCalendar();
  }
  function open(e, positionElement) {
    if (positionElement === void 0) {
      positionElement = self._positionElement;
    }
    if (self.isMobile === true) {
      if (e) {
        e.preventDefault();
        var eventTarget = getEventTarget(e);
        if (eventTarget) {
          eventTarget.blur();
        }
      }
      if (self.mobileInput !== void 0) {
        self.mobileInput.focus();
        self.mobileInput.click();
      }
      triggerEvent("onOpen");
      return;
    } else if (self._input.disabled || self.config.inline) {
      return;
    }
    var wasOpen = self.isOpen;
    self.isOpen = true;
    if (!wasOpen) {
      self.calendarContainer.classList.add("open");
      self._input.classList.add("active");
      triggerEvent("onOpen");
      positionCalendar(positionElement);
    }
    if (self.config.enableTime === true && self.config.noCalendar === true) {
      if (self.config.allowInput === false && (e === void 0 || !self.timeContainer.contains(e.relatedTarget))) {
        setTimeout(function() {
          return self.hourElement.select();
        }, 50);
      }
    }
  }
  function minMaxDateSetter(type) {
    return function(date) {
      var dateObj = self.config["_" + type + "Date"] = self.parseDate(date, self.config.dateFormat);
      var inverseDateObj = self.config["_" + (type === "min" ? "max" : "min") + "Date"];
      if (dateObj !== void 0) {
        self[type === "min" ? "minDateHasTime" : "maxDateHasTime"] = dateObj.getHours() > 0 || dateObj.getMinutes() > 0 || dateObj.getSeconds() > 0;
      }
      if (self.selectedDates) {
        self.selectedDates = self.selectedDates.filter(function(d) {
          return isEnabled(d);
        });
        if (!self.selectedDates.length && type === "min")
          setHoursFromDate(dateObj);
        updateValue();
      }
      if (self.daysContainer) {
        redraw();
        if (dateObj !== void 0)
          self.currentYearElement[type] = dateObj.getFullYear().toString();
        else
          self.currentYearElement.removeAttribute(type);
        self.currentYearElement.disabled = !!inverseDateObj && dateObj !== void 0 && inverseDateObj.getFullYear() === dateObj.getFullYear();
      }
    };
  }
  function parseConfig() {
    var boolOpts = [
      "wrap",
      "weekNumbers",
      "allowInput",
      "allowInvalidPreload",
      "clickOpens",
      "time_24hr",
      "enableTime",
      "noCalendar",
      "altInput",
      "shorthandCurrentMonth",
      "inline",
      "static",
      "enableSeconds",
      "disableMobile"
    ];
    var userConfig = __assign(__assign({}, JSON.parse(JSON.stringify(element.dataset || {}))), instanceConfig);
    var formats2 = {};
    self.config.parseDate = userConfig.parseDate;
    self.config.formatDate = userConfig.formatDate;
    Object.defineProperty(self.config, "enable", {
      get: function() {
        return self.config._enable;
      },
      set: function(dates) {
        self.config._enable = parseDateRules(dates);
      }
    });
    Object.defineProperty(self.config, "disable", {
      get: function() {
        return self.config._disable;
      },
      set: function(dates) {
        self.config._disable = parseDateRules(dates);
      }
    });
    var timeMode = userConfig.mode === "time";
    if (!userConfig.dateFormat && (userConfig.enableTime || timeMode)) {
      var defaultDateFormat = flatpickr.defaultConfig.dateFormat || defaults.dateFormat;
      formats2.dateFormat = userConfig.noCalendar || timeMode ? "H:i" + (userConfig.enableSeconds ? ":S" : "") : defaultDateFormat + " H:i" + (userConfig.enableSeconds ? ":S" : "");
    }
    if (userConfig.altInput && (userConfig.enableTime || timeMode) && !userConfig.altFormat) {
      var defaultAltFormat = flatpickr.defaultConfig.altFormat || defaults.altFormat;
      formats2.altFormat = userConfig.noCalendar || timeMode ? "h:i" + (userConfig.enableSeconds ? ":S K" : " K") : defaultAltFormat + (" h:i" + (userConfig.enableSeconds ? ":S" : "") + " K");
    }
    Object.defineProperty(self.config, "minDate", {
      get: function() {
        return self.config._minDate;
      },
      set: minMaxDateSetter("min")
    });
    Object.defineProperty(self.config, "maxDate", {
      get: function() {
        return self.config._maxDate;
      },
      set: minMaxDateSetter("max")
    });
    var minMaxTimeSetter = function(type) {
      return function(val) {
        self.config[type === "min" ? "_minTime" : "_maxTime"] = self.parseDate(val, "H:i:S");
      };
    };
    Object.defineProperty(self.config, "minTime", {
      get: function() {
        return self.config._minTime;
      },
      set: minMaxTimeSetter("min")
    });
    Object.defineProperty(self.config, "maxTime", {
      get: function() {
        return self.config._maxTime;
      },
      set: minMaxTimeSetter("max")
    });
    if (userConfig.mode === "time") {
      self.config.noCalendar = true;
      self.config.enableTime = true;
    }
    Object.assign(self.config, formats2, userConfig);
    for (var i = 0; i < boolOpts.length; i++)
      self.config[boolOpts[i]] = self.config[boolOpts[i]] === true || self.config[boolOpts[i]] === "true";
    HOOKS.filter(function(hook) {
      return self.config[hook] !== void 0;
    }).forEach(function(hook) {
      self.config[hook] = arrayify(self.config[hook] || []).map(bindToInstance);
    });
    self.isMobile = !self.config.disableMobile && !self.config.inline && self.config.mode === "single" && !self.config.disable.length && !self.config.enable && !self.config.weekNumbers && /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
    for (var i = 0; i < self.config.plugins.length; i++) {
      var pluginConf = self.config.plugins[i](self) || {};
      for (var key in pluginConf) {
        if (HOOKS.indexOf(key) > -1) {
          self.config[key] = arrayify(pluginConf[key]).map(bindToInstance).concat(self.config[key]);
        } else if (typeof userConfig[key] === "undefined")
          self.config[key] = pluginConf[key];
      }
    }
    if (!userConfig.altInputClass) {
      self.config.altInputClass = getInputElem().className + " " + self.config.altInputClass;
    }
    triggerEvent("onParseConfig");
  }
  function getInputElem() {
    return self.config.wrap ? element.querySelector("[data-input]") : element;
  }
  function setupLocale() {
    if (typeof self.config.locale !== "object" && typeof flatpickr.l10ns[self.config.locale] === "undefined")
      self.config.errorHandler(new Error("flatpickr: invalid locale " + self.config.locale));
    self.l10n = __assign(__assign({}, flatpickr.l10ns.default), typeof self.config.locale === "object" ? self.config.locale : self.config.locale !== "default" ? flatpickr.l10ns[self.config.locale] : void 0);
    tokenRegex.D = "(" + self.l10n.weekdays.shorthand.join("|") + ")";
    tokenRegex.l = "(" + self.l10n.weekdays.longhand.join("|") + ")";
    tokenRegex.M = "(" + self.l10n.months.shorthand.join("|") + ")";
    tokenRegex.F = "(" + self.l10n.months.longhand.join("|") + ")";
    tokenRegex.K = "(" + self.l10n.amPM[0] + "|" + self.l10n.amPM[1] + "|" + self.l10n.amPM[0].toLowerCase() + "|" + self.l10n.amPM[1].toLowerCase() + ")";
    var userConfig = __assign(__assign({}, instanceConfig), JSON.parse(JSON.stringify(element.dataset || {})));
    if (userConfig.time_24hr === void 0 && flatpickr.defaultConfig.time_24hr === void 0) {
      self.config.time_24hr = self.l10n.time_24hr;
    }
    self.formatDate = createDateFormatter(self);
    self.parseDate = createDateParser({ config: self.config, l10n: self.l10n });
  }
  function positionCalendar(customPositionElement) {
    if (typeof self.config.position === "function") {
      return void self.config.position(self, customPositionElement);
    }
    if (self.calendarContainer === void 0)
      return;
    triggerEvent("onPreCalendarPosition");
    var positionElement = customPositionElement || self._positionElement;
    var calendarHeight = Array.prototype.reduce.call(self.calendarContainer.children, function(acc, child) {
      return acc + child.offsetHeight;
    }, 0), calendarWidth = self.calendarContainer.offsetWidth, configPos = self.config.position.split(" "), configPosVertical = configPos[0], configPosHorizontal = configPos.length > 1 ? configPos[1] : null, inputBounds = positionElement.getBoundingClientRect(), distanceFromBottom = window.innerHeight - inputBounds.bottom, showOnTop = configPosVertical === "above" || configPosVertical !== "below" && distanceFromBottom < calendarHeight && inputBounds.top > calendarHeight;
    var top2 = window.pageYOffset + inputBounds.top + (!showOnTop ? positionElement.offsetHeight + 2 : -calendarHeight - 2);
    toggleClass(self.calendarContainer, "arrowTop", !showOnTop);
    toggleClass(self.calendarContainer, "arrowBottom", showOnTop);
    if (self.config.inline)
      return;
    var left2 = window.pageXOffset + inputBounds.left;
    var isCenter = false;
    var isRight = false;
    if (configPosHorizontal === "center") {
      left2 -= (calendarWidth - inputBounds.width) / 2;
      isCenter = true;
    } else if (configPosHorizontal === "right") {
      left2 -= calendarWidth - inputBounds.width;
      isRight = true;
    }
    toggleClass(self.calendarContainer, "arrowLeft", !isCenter && !isRight);
    toggleClass(self.calendarContainer, "arrowCenter", isCenter);
    toggleClass(self.calendarContainer, "arrowRight", isRight);
    var right2 = window.document.body.offsetWidth - (window.pageXOffset + inputBounds.right);
    var rightMost = left2 + calendarWidth > window.document.body.offsetWidth;
    var centerMost = right2 + calendarWidth > window.document.body.offsetWidth;
    toggleClass(self.calendarContainer, "rightMost", rightMost);
    if (self.config.static)
      return;
    self.calendarContainer.style.top = top2 + "px";
    if (!rightMost) {
      self.calendarContainer.style.left = left2 + "px";
      self.calendarContainer.style.right = "auto";
    } else if (!centerMost) {
      self.calendarContainer.style.left = "auto";
      self.calendarContainer.style.right = right2 + "px";
    } else {
      var doc = getDocumentStyleSheet();
      if (doc === void 0)
        return;
      var bodyWidth = window.document.body.offsetWidth;
      var centerLeft = Math.max(0, bodyWidth / 2 - calendarWidth / 2);
      var centerBefore = ".flatpickr-calendar.centerMost:before";
      var centerAfter = ".flatpickr-calendar.centerMost:after";
      var centerIndex = doc.cssRules.length;
      var centerStyle = "{left:" + inputBounds.left + "px;right:auto;}";
      toggleClass(self.calendarContainer, "rightMost", false);
      toggleClass(self.calendarContainer, "centerMost", true);
      doc.insertRule(centerBefore + "," + centerAfter + centerStyle, centerIndex);
      self.calendarContainer.style.left = centerLeft + "px";
      self.calendarContainer.style.right = "auto";
    }
  }
  function getDocumentStyleSheet() {
    var editableSheet = null;
    for (var i = 0; i < document.styleSheets.length; i++) {
      var sheet = document.styleSheets[i];
      if (!sheet.cssRules)
        continue;
      try {
        sheet.cssRules;
      } catch (err) {
        continue;
      }
      editableSheet = sheet;
      break;
    }
    return editableSheet != null ? editableSheet : createStyleSheet();
  }
  function createStyleSheet() {
    var style = document.createElement("style");
    document.head.appendChild(style);
    return style.sheet;
  }
  function redraw() {
    if (self.config.noCalendar || self.isMobile)
      return;
    buildMonthSwitch();
    updateNavigationCurrentMonth();
    buildDays();
  }
  function focusAndClose() {
    self._input.focus();
    if (window.navigator.userAgent.indexOf("MSIE") !== -1 || navigator.msMaxTouchPoints !== void 0) {
      setTimeout(self.close, 0);
    } else {
      self.close();
    }
  }
  function selectDate(e) {
    e.preventDefault();
    e.stopPropagation();
    var isSelectable = function(day) {
      return day.classList && day.classList.contains("flatpickr-day") && !day.classList.contains("flatpickr-disabled") && !day.classList.contains("notAllowed");
    };
    var t = findParent(getEventTarget(e), isSelectable);
    if (t === void 0)
      return;
    var target = t;
    var selectedDate = self.latestSelectedDateObj = new Date(target.dateObj.getTime());
    var shouldChangeMonth = (selectedDate.getMonth() < self.currentMonth || selectedDate.getMonth() > self.currentMonth + self.config.showMonths - 1) && self.config.mode !== "range";
    self.selectedDateElem = target;
    if (self.config.mode === "single")
      self.selectedDates = [selectedDate];
    else if (self.config.mode === "multiple") {
      var selectedIndex = isDateSelected(selectedDate);
      if (selectedIndex)
        self.selectedDates.splice(parseInt(selectedIndex), 1);
      else
        self.selectedDates.push(selectedDate);
    } else if (self.config.mode === "range") {
      if (self.selectedDates.length === 2) {
        self.clear(false, false);
      }
      self.latestSelectedDateObj = selectedDate;
      self.selectedDates.push(selectedDate);
      if (compareDates(selectedDate, self.selectedDates[0], true) !== 0)
        self.selectedDates.sort(function(a, b) {
          return a.getTime() - b.getTime();
        });
    }
    setHoursFromInputs();
    if (shouldChangeMonth) {
      var isNewYear = self.currentYear !== selectedDate.getFullYear();
      self.currentYear = selectedDate.getFullYear();
      self.currentMonth = selectedDate.getMonth();
      if (isNewYear) {
        triggerEvent("onYearChange");
        buildMonthSwitch();
      }
      triggerEvent("onMonthChange");
    }
    updateNavigationCurrentMonth();
    buildDays();
    updateValue();
    if (!shouldChangeMonth && self.config.mode !== "range" && self.config.showMonths === 1)
      focusOnDayElem(target);
    else if (self.selectedDateElem !== void 0 && self.hourElement === void 0) {
      self.selectedDateElem && self.selectedDateElem.focus();
    }
    if (self.hourElement !== void 0)
      self.hourElement !== void 0 && self.hourElement.focus();
    if (self.config.closeOnSelect) {
      var single = self.config.mode === "single" && !self.config.enableTime;
      var range = self.config.mode === "range" && self.selectedDates.length === 2 && !self.config.enableTime;
      if (single || range) {
        focusAndClose();
      }
    }
    triggerChange();
  }
  var CALLBACKS = {
    locale: [setupLocale, updateWeekdays],
    showMonths: [buildMonths, setCalendarWidth, buildWeekdays],
    minDate: [jumpToDate],
    maxDate: [jumpToDate],
    positionElement: [updatePositionElement],
    clickOpens: [
      function() {
        if (self.config.clickOpens === true) {
          bind(self._input, "focus", self.open);
          bind(self._input, "click", self.open);
        } else {
          self._input.removeEventListener("focus", self.open);
          self._input.removeEventListener("click", self.open);
        }
      }
    ]
  };
  function set(option, value) {
    if (option !== null && typeof option === "object") {
      Object.assign(self.config, option);
      for (var key in option) {
        if (CALLBACKS[key] !== void 0)
          CALLBACKS[key].forEach(function(x) {
            return x();
          });
      }
    } else {
      self.config[option] = value;
      if (CALLBACKS[option] !== void 0)
        CALLBACKS[option].forEach(function(x) {
          return x();
        });
      else if (HOOKS.indexOf(option) > -1)
        self.config[option] = arrayify(value);
    }
    self.redraw();
    updateValue(true);
  }
  function setSelectedDate(inputDate, format2) {
    var dates = [];
    if (inputDate instanceof Array)
      dates = inputDate.map(function(d) {
        return self.parseDate(d, format2);
      });
    else if (inputDate instanceof Date || typeof inputDate === "number")
      dates = [self.parseDate(inputDate, format2)];
    else if (typeof inputDate === "string") {
      switch (self.config.mode) {
        case "single":
        case "time":
          dates = [self.parseDate(inputDate, format2)];
          break;
        case "multiple":
          dates = inputDate.split(self.config.conjunction).map(function(date) {
            return self.parseDate(date, format2);
          });
          break;
        case "range":
          dates = inputDate.split(self.l10n.rangeSeparator).map(function(date) {
            return self.parseDate(date, format2);
          });
          break;
        default:
          break;
      }
    } else
      self.config.errorHandler(new Error("Invalid date supplied: " + JSON.stringify(inputDate)));
    self.selectedDates = self.config.allowInvalidPreload ? dates : dates.filter(function(d) {
      return d instanceof Date && isEnabled(d, false);
    });
    if (self.config.mode === "range")
      self.selectedDates.sort(function(a, b) {
        return a.getTime() - b.getTime();
      });
  }
  function setDate(date, triggerChange2, format2) {
    if (triggerChange2 === void 0) {
      triggerChange2 = false;
    }
    if (format2 === void 0) {
      format2 = self.config.dateFormat;
    }
    if (date !== 0 && !date || date instanceof Array && date.length === 0)
      return self.clear(triggerChange2);
    setSelectedDate(date, format2);
    self.latestSelectedDateObj = self.selectedDates[self.selectedDates.length - 1];
    self.redraw();
    jumpToDate(void 0, triggerChange2);
    setHoursFromDate();
    if (self.selectedDates.length === 0) {
      self.clear(false);
    }
    updateValue(triggerChange2);
    if (triggerChange2)
      triggerEvent("onChange");
  }
  function parseDateRules(arr) {
    return arr.slice().map(function(rule) {
      if (typeof rule === "string" || typeof rule === "number" || rule instanceof Date) {
        return self.parseDate(rule, void 0, true);
      } else if (rule && typeof rule === "object" && rule.from && rule.to)
        return {
          from: self.parseDate(rule.from, void 0),
          to: self.parseDate(rule.to, void 0)
        };
      return rule;
    }).filter(function(x) {
      return x;
    });
  }
  function setupDates() {
    self.selectedDates = [];
    self.now = self.parseDate(self.config.now) || new Date();
    var preloadedDate = self.config.defaultDate || ((self.input.nodeName === "INPUT" || self.input.nodeName === "TEXTAREA") && self.input.placeholder && self.input.value === self.input.placeholder ? null : self.input.value);
    if (preloadedDate)
      setSelectedDate(preloadedDate, self.config.dateFormat);
    self._initialDate = self.selectedDates.length > 0 ? self.selectedDates[0] : self.config.minDate && self.config.minDate.getTime() > self.now.getTime() ? self.config.minDate : self.config.maxDate && self.config.maxDate.getTime() < self.now.getTime() ? self.config.maxDate : self.now;
    self.currentYear = self._initialDate.getFullYear();
    self.currentMonth = self._initialDate.getMonth();
    if (self.selectedDates.length > 0)
      self.latestSelectedDateObj = self.selectedDates[0];
    if (self.config.minTime !== void 0)
      self.config.minTime = self.parseDate(self.config.minTime, "H:i");
    if (self.config.maxTime !== void 0)
      self.config.maxTime = self.parseDate(self.config.maxTime, "H:i");
    self.minDateHasTime = !!self.config.minDate && (self.config.minDate.getHours() > 0 || self.config.minDate.getMinutes() > 0 || self.config.minDate.getSeconds() > 0);
    self.maxDateHasTime = !!self.config.maxDate && (self.config.maxDate.getHours() > 0 || self.config.maxDate.getMinutes() > 0 || self.config.maxDate.getSeconds() > 0);
  }
  function setupInputs() {
    self.input = getInputElem();
    if (!self.input) {
      self.config.errorHandler(new Error("Invalid input element specified"));
      return;
    }
    self.input._type = self.input.type;
    self.input.type = "text";
    self.input.classList.add("flatpickr-input");
    self._input = self.input;
    if (self.config.altInput) {
      self.altInput = createElement(self.input.nodeName, self.config.altInputClass);
      self._input = self.altInput;
      self.altInput.placeholder = self.input.placeholder;
      self.altInput.disabled = self.input.disabled;
      self.altInput.required = self.input.required;
      self.altInput.tabIndex = self.input.tabIndex;
      self.altInput.type = "text";
      self.input.setAttribute("type", "hidden");
      if (!self.config.static && self.input.parentNode)
        self.input.parentNode.insertBefore(self.altInput, self.input.nextSibling);
    }
    if (!self.config.allowInput)
      self._input.setAttribute("readonly", "readonly");
    updatePositionElement();
  }
  function updatePositionElement() {
    self._positionElement = self.config.positionElement || self._input;
  }
  function setupMobile() {
    var inputType = self.config.enableTime ? self.config.noCalendar ? "time" : "datetime-local" : "date";
    self.mobileInput = createElement("input", self.input.className + " flatpickr-mobile");
    self.mobileInput.tabIndex = 1;
    self.mobileInput.type = inputType;
    self.mobileInput.disabled = self.input.disabled;
    self.mobileInput.required = self.input.required;
    self.mobileInput.placeholder = self.input.placeholder;
    self.mobileFormatStr = inputType === "datetime-local" ? "Y-m-d\\TH:i:S" : inputType === "date" ? "Y-m-d" : "H:i:S";
    if (self.selectedDates.length > 0) {
      self.mobileInput.defaultValue = self.mobileInput.value = self.formatDate(self.selectedDates[0], self.mobileFormatStr);
    }
    if (self.config.minDate)
      self.mobileInput.min = self.formatDate(self.config.minDate, "Y-m-d");
    if (self.config.maxDate)
      self.mobileInput.max = self.formatDate(self.config.maxDate, "Y-m-d");
    if (self.input.getAttribute("step"))
      self.mobileInput.step = String(self.input.getAttribute("step"));
    self.input.type = "hidden";
    if (self.altInput !== void 0)
      self.altInput.type = "hidden";
    try {
      if (self.input.parentNode)
        self.input.parentNode.insertBefore(self.mobileInput, self.input.nextSibling);
    } catch (_a) {
    }
    bind(self.mobileInput, "change", function(e) {
      self.setDate(getEventTarget(e).value, false, self.mobileFormatStr);
      triggerEvent("onChange");
      triggerEvent("onClose");
    });
  }
  function toggle(e) {
    if (self.isOpen === true)
      return self.close();
    self.open(e);
  }
  function triggerEvent(event, data) {
    if (self.config === void 0)
      return;
    var hooks = self.config[event];
    if (hooks !== void 0 && hooks.length > 0) {
      for (var i = 0; hooks[i] && i < hooks.length; i++)
        hooks[i](self.selectedDates, self.input.value, self, data);
    }
    if (event === "onChange") {
      self.input.dispatchEvent(createEvent("change"));
      self.input.dispatchEvent(createEvent("input"));
    }
  }
  function createEvent(name) {
    var e = document.createEvent("Event");
    e.initEvent(name, true, true);
    return e;
  }
  function isDateSelected(date) {
    for (var i = 0; i < self.selectedDates.length; i++) {
      var selectedDate = self.selectedDates[i];
      if (selectedDate instanceof Date && compareDates(selectedDate, date) === 0)
        return "" + i;
    }
    return false;
  }
  function isDateInRange(date) {
    if (self.config.mode !== "range" || self.selectedDates.length < 2)
      return false;
    return compareDates(date, self.selectedDates[0]) >= 0 && compareDates(date, self.selectedDates[1]) <= 0;
  }
  function updateNavigationCurrentMonth() {
    if (self.config.noCalendar || self.isMobile || !self.monthNav)
      return;
    self.yearElements.forEach(function(yearElement, i) {
      var d = new Date(self.currentYear, self.currentMonth, 1);
      d.setMonth(self.currentMonth + i);
      if (self.config.showMonths > 1 || self.config.monthSelectorType === "static") {
        self.monthElements[i].textContent = monthToStr(d.getMonth(), self.config.shorthandCurrentMonth, self.l10n) + " ";
      } else {
        self.monthsDropdownContainer.value = d.getMonth().toString();
      }
      yearElement.value = d.getFullYear().toString();
    });
    self._hidePrevMonthArrow = self.config.minDate !== void 0 && (self.currentYear === self.config.minDate.getFullYear() ? self.currentMonth <= self.config.minDate.getMonth() : self.currentYear < self.config.minDate.getFullYear());
    self._hideNextMonthArrow = self.config.maxDate !== void 0 && (self.currentYear === self.config.maxDate.getFullYear() ? self.currentMonth + 1 > self.config.maxDate.getMonth() : self.currentYear > self.config.maxDate.getFullYear());
  }
  function getDateStr(specificFormat) {
    var format2 = specificFormat || (self.config.altInput ? self.config.altFormat : self.config.dateFormat);
    return self.selectedDates.map(function(dObj) {
      return self.formatDate(dObj, format2);
    }).filter(function(d, i, arr) {
      return self.config.mode !== "range" || self.config.enableTime || arr.indexOf(d) === i;
    }).join(self.config.mode !== "range" ? self.config.conjunction : self.l10n.rangeSeparator);
  }
  function updateValue(triggerChange2) {
    if (triggerChange2 === void 0) {
      triggerChange2 = true;
    }
    if (self.mobileInput !== void 0 && self.mobileFormatStr) {
      self.mobileInput.value = self.latestSelectedDateObj !== void 0 ? self.formatDate(self.latestSelectedDateObj, self.mobileFormatStr) : "";
    }
    self.input.value = getDateStr(self.config.dateFormat);
    if (self.altInput !== void 0) {
      self.altInput.value = getDateStr(self.config.altFormat);
    }
    if (triggerChange2 !== false)
      triggerEvent("onValueUpdate");
  }
  function onMonthNavClick(e) {
    var eventTarget = getEventTarget(e);
    var isPrevMonth = self.prevMonthNav.contains(eventTarget);
    var isNextMonth = self.nextMonthNav.contains(eventTarget);
    if (isPrevMonth || isNextMonth) {
      changeMonth(isPrevMonth ? -1 : 1);
    } else if (self.yearElements.indexOf(eventTarget) >= 0) {
      eventTarget.select();
    } else if (eventTarget.classList.contains("arrowUp")) {
      self.changeYear(self.currentYear + 1);
    } else if (eventTarget.classList.contains("arrowDown")) {
      self.changeYear(self.currentYear - 1);
    }
  }
  function timeWrapper(e) {
    e.preventDefault();
    var isKeyDown = e.type === "keydown", eventTarget = getEventTarget(e), input = eventTarget;
    if (self.amPM !== void 0 && eventTarget === self.amPM) {
      self.amPM.textContent = self.l10n.amPM[int(self.amPM.textContent === self.l10n.amPM[0])];
    }
    var min2 = parseFloat(input.getAttribute("min")), max2 = parseFloat(input.getAttribute("max")), step = parseFloat(input.getAttribute("step")), curValue = parseInt(input.value, 10), delta = e.delta || (isKeyDown ? e.which === 38 ? 1 : -1 : 0);
    var newValue = curValue + step * delta;
    if (typeof input.value !== "undefined" && input.value.length === 2) {
      var isHourElem = input === self.hourElement, isMinuteElem = input === self.minuteElement;
      if (newValue < min2) {
        newValue = max2 + newValue + int(!isHourElem) + (int(isHourElem) && int(!self.amPM));
        if (isMinuteElem)
          incrementNumInput(void 0, -1, self.hourElement);
      } else if (newValue > max2) {
        newValue = input === self.hourElement ? newValue - max2 - int(!self.amPM) : min2;
        if (isMinuteElem)
          incrementNumInput(void 0, 1, self.hourElement);
      }
      if (self.amPM && isHourElem && (step === 1 ? newValue + curValue === 23 : Math.abs(newValue - curValue) > step)) {
        self.amPM.textContent = self.l10n.amPM[int(self.amPM.textContent === self.l10n.amPM[0])];
      }
      input.value = pad(newValue);
    }
  }
  init();
  return self;
}
function _flatpickr(nodeList, config) {
  var nodes = Array.prototype.slice.call(nodeList).filter(function(x) {
    return x instanceof HTMLElement;
  });
  var instances = [];
  for (var i = 0; i < nodes.length; i++) {
    var node = nodes[i];
    try {
      if (node.getAttribute("data-fp-omit") !== null)
        continue;
      if (node._flatpickr !== void 0) {
        node._flatpickr.destroy();
        node._flatpickr = void 0;
      }
      node._flatpickr = FlatpickrInstance(node, config || {});
      instances.push(node._flatpickr);
    } catch (e) {
      console.error(e);
    }
  }
  return instances.length === 1 ? instances[0] : instances;
}
if (typeof HTMLElement !== "undefined" && typeof HTMLCollection !== "undefined" && typeof NodeList !== "undefined") {
  HTMLCollection.prototype.flatpickr = NodeList.prototype.flatpickr = function(config) {
    return _flatpickr(this, config);
  };
  HTMLElement.prototype.flatpickr = function(config) {
    return _flatpickr([this], config);
  };
}
var flatpickr = function(selector, config) {
  if (typeof selector === "string") {
    return _flatpickr(window.document.querySelectorAll(selector), config);
  } else if (selector instanceof Node) {
    return _flatpickr([selector], config);
  } else {
    return _flatpickr(selector, config);
  }
};
flatpickr.defaultConfig = {};
flatpickr.l10ns = {
  en: __assign({}, default_default),
  default: __assign({}, default_default)
};
flatpickr.localize = function(l10n) {
  flatpickr.l10ns.default = __assign(__assign({}, flatpickr.l10ns.default), l10n);
};
flatpickr.setDefaults = function(config) {
  flatpickr.defaultConfig = __assign(__assign({}, flatpickr.defaultConfig), config);
};
flatpickr.parseDate = createDateParser({});
flatpickr.formatDate = createDateFormatter({});
flatpickr.compareDates = compareDates;
if (typeof jQuery !== "undefined" && typeof jQuery.fn !== "undefined") {
  jQuery.fn.flatpickr = function(config) {
    return _flatpickr(this, config);
  };
}
Date.prototype.fp_incr = function(days) {
  return new Date(this.getFullYear(), this.getMonth(), this.getDate() + (typeof days === "string" ? parseInt(days, 10) : days));
};
if (typeof window !== "undefined") {
  window.flatpickr = flatpickr;
}
var esm_default = flatpickr;

// src/optionModals/fields/DateModal.ts
var DateModal = class extends import_obsidian24.Modal {
  constructor(plugin, file, field, initialValue, lineNumber = -1, inFrontmatter = false, after = false) {
    var _a, _b;
    super(plugin.app);
    this.plugin = plugin;
    this.file = file;
    this.field = field;
    this.initialValue = initialValue;
    this.lineNumber = lineNumber;
    this.inFrontmatter = inFrontmatter;
    this.after = after;
    this.pushNextInterval = false;
    this.initialValue = initialValue ? ((_a = initialValue.toString().replace(/^\[\[/g, "").replace(/\]\]$/g, "").split("|").first()) == null ? void 0 : _a.split("/").last()) || "" : "";
    this.insertAsLink = FieldManager2.stringToBoolean(this.field.options.defaultInsertAsLink || "false") || false;
    this.format = this.field.options.dateFormat || this.field.options.defaultDateFormat;
    this.dvApi = (_b = this.plugin.app.plugins.plugins["dataview"]) == null ? void 0 : _b.api;
    if (this.dvApi)
      this.dateManager = new FieldManager[this.field.type](this.plugin, this.field);
    this.value = this.initialValue;
  }
  onOpen() {
    const fieldContainer = this.contentEl.createDiv({ cls: "metadata-menu-modal-value" });
    this.buildFields(fieldContainer);
  }
  buildFields(parentContainer) {
    const dateFieldsContainer = parentContainer.createEl("div", { cls: "metadata-menu-modal-fields-container" });
    this.buildInputEl(dateFieldsContainer);
    this.errorField = dateFieldsContainer.createEl("div", { cls: "metadata-menu-modal-value-error-field" });
    this.errorField.hide();
    this.buildInsertAsLinkToggler(dateFieldsContainer);
    const saveBtnContainer = dateFieldsContainer.createEl("div", { cls: "metadata-menu-value-grid-footer" });
    const saveBtn = new import_obsidian24.ButtonComponent(saveBtnContainer);
    saveBtn.setIcon("checkmark");
    saveBtn.onClick((e) => __async(this, null, function* () {
      e.preventDefault();
      let newValue;
      if (this.plugin.app.plugins.enabledPlugins.has("nldates-obsidian")) {
        try {
          const nldates = this.plugin.app.plugins.plugins["nldates-obsidian"];
          newValue = nldates.parseDate(this.value).moment;
        } catch (error) {
          newValue = (0, import_obsidian25.moment)(this.value, this.format);
        }
      } else {
        newValue = (0, import_obsidian25.moment)(this.value, this.format);
      }
      if (newValue.isValid()) {
        const linkPath = this.plugin.app.metadataCache.getFirstLinkpathDest(this.field.options.linkPath || "" + newValue.format(this.format), this.file.path);
        const formattedValue = this.insertAsLink ? `[[${this.field.options.linkPath || ""}${newValue.format(this.format)}${linkPath ? "|" + linkPath.basename : ""}]]` : newValue.format(this.format);
        if (this.lineNumber == -1) {
          yield this.plugin.fileTaskManager.pushTask(() => {
            replaceValues(this.plugin, this.file, this.field.name, formattedValue);
          });
        } else {
          yield this.plugin.fileTaskManager.pushTask(() => {
            insertValues(this.plugin, this.file, this.field.name, formattedValue, this.lineNumber, this.inFrontmatter, this.after);
          });
        }
        ;
        if (this.nextIntervalField && this.pushNextInterval && this.nextShift) {
          yield this.plugin.fileTaskManager.pushTask(() => {
            replaceValues(this.plugin, this.file.path, this.nextIntervalField.name, this.nextShift);
          });
        }
        this.close();
      } else if (!this.value) {
        if (this.lineNumber == -1) {
          yield this.plugin.fileTaskManager.pushTask(() => {
            replaceValues(this.plugin, this.file, this.field.name, "");
          });
        } else {
          yield this.plugin.fileTaskManager.pushTask(() => {
            insertValues(this.plugin, this.file, this.field.name, "", this.lineNumber, this.inFrontmatter, this.after);
          });
        }
        ;
        this.close();
      } else {
        this.errorField.show();
        this.errorField.setText(`value must be a valid date`);
        this.inputEl.inputEl.addClass("is-invalid");
        return;
      }
    }));
  }
  buildInsertAsLinkToggler(container) {
    const togglerContainer = container.createDiv({ cls: "metadata-menu-toggler-with-label" });
    const togglerContainerLabel = togglerContainer.createDiv({
      cls: "metadata-menu-toggler-label"
    });
    togglerContainerLabel.setText("Insert as link");
    const toggleEl = new import_obsidian24.ToggleComponent(togglerContainer);
    toggleEl.setValue(FieldManager2.stringToBoolean(this.field.options.defaultInsertAsLink || "false"));
    toggleEl.onChange((value) => {
      this.insertAsLink = value;
    });
  }
  toggleButton(button, value) {
    button.setDisabled(!!value);
    if (value) {
      button.buttonEl.addClass("disabled");
    } else {
      button.buttonEl.removeClass("disabled");
    }
  }
  buildInputEl(container) {
    if (this.dateManager)
      [this.currentShift, this.nextIntervalField, this.nextShift] = this.dateManager.shiftDuration(this.file);
    const inputContainer = container.createDiv({ cls: "metadata-menu-dateinput-with-picker" });
    this.inputEl = new import_obsidian24.TextComponent(inputContainer);
    this.inputEl.inputEl.focus();
    this.inputEl.setPlaceholder(this.initialValue ? (0, import_obsidian25.moment)(this.initialValue, this.field.options.dateFormat).format(this.field.options.dateFormat) : "");
    this.inputEl.inputEl.addClass("metadata-menu-prompt-input");
    this.inputEl.onChange((value) => {
      this.inputEl.inputEl.removeClass("is-invalid");
      this.errorField.hide();
      this.errorField.setText("");
      this.value = value;
      this.toggleButton(shiftFromTodayBtn, value);
    });
    const calendarDisplayBtn = new import_obsidian24.ButtonComponent(inputContainer);
    calendarDisplayBtn.buttonEl.addClass("metadata-menu-modal-inline-btn");
    calendarDisplayBtn.setIcon(FieldIcon["Date" /* Date */]);
    calendarDisplayBtn.setTooltip("open date picker");
    const shiftFromTodayBtn = new import_obsidian24.ButtonComponent(inputContainer);
    shiftFromTodayBtn.buttonEl.addClass("metadata-menu-modal-inline-btn");
    shiftFromTodayBtn.setIcon("skip-forward");
    shiftFromTodayBtn.setTooltip(`Shift ${this.field.name} ${this.currentShift || "1 day"} ahead`);
    const datePickerContainer = container.createDiv({ cls: "metadata-menu-picker-container" });
    const datePicker = esm_default(datePickerContainer, {
      locale: {
        firstDayOfWeek: this.plugin.settings.firstDayOfWeek
      },
      defaultDate: "2022-09-22"
    });
    datePicker.config.onChange.push((value) => {
      const newDate = (0, import_obsidian25.moment)(value.toString()).format(this.format);
      this.inputEl.setValue(newDate);
      this.value = newDate;
      this.toggleButton(shiftFromTodayBtn, this.value);
    });
    calendarDisplayBtn.onClick((e) => {
      e.preventDefault();
      datePicker.setDate(datePicker.parseDate(this.inputEl.getValue()) || new Date());
      datePicker.open();
    });
    shiftFromTodayBtn.onClick((e) => __async(this, null, function* () {
      const currentDvDate = this.dvApi.date((0, import_obsidian25.moment)(this.initialValue, this.format).toISOString());
      const newDate = currentDvDate.plus(this.dvApi.duration(this.currentShift || "1 day"));
      const newValue = (0, import_obsidian25.moment)(newDate.toString()).format(this.format);
      this.inputEl.setValue(newValue);
      this.value = newValue;
      this.pushNextInterval = true;
      this.toggleButton(shiftFromTodayBtn, this.inputEl.getValue());
    }));
    if (!this.dvApi) {
      shiftFromTodayBtn.buttonEl.hide();
      shiftFromTodayBtn.setDisabled(true);
    }
  }
};

// src/commands/getField.ts
function getField(plugin, propertyName, fileClass) {
  const matchingSettings = plugin.settings.presetFields.filter((p) => p.name == propertyName);
  if (fileClass) {
    const fileClassAttributesWithName = fileClass.attributes.filter((attr) => attr.name == propertyName);
    if (fileClassAttributesWithName.length > 0) {
      const fileClassAttribute = fileClassAttributesWithName[0];
      if (fileClassAttribute.type) {
        return fileClassAttribute.getField();
      } else if (matchingSettings.length > 0) {
        return matchingSettings[0];
      }
      ;
    }
  } else if (matchingSettings.length > 0) {
    return matchingSettings[0];
  }
  ;
}

// src/fileClass/fileClassAttribute.ts
var FileClassAttribute = class {
  constructor(origin, name, type = "Input" /* Input */, options = []) {
    this.origin = origin;
    this.name = name;
    this.type = type;
    this.options = options;
  }
  getField() {
    var _a;
    let options = {};
    if (Array.isArray(this.options)) {
      (_a = this.options) == null ? void 0 : _a.forEach((option, index) => {
        options[index] = option;
      });
    } else {
      options = this.options;
    }
    return new Field_default(this.name, options, this.name, this.type);
  }
};

// src/fileClass/fileClass.ts
var import_obsidian26 = require("obsidian");

// src/utils/textUtils.ts
var capitalize = (s) => {
  return s && s[0].toUpperCase() + s.slice(1);
};

// src/utils/dataviewUtils.ts
function genuineKeys(dvFile) {
  const genuineKeys2 = [];
  Object.keys(dvFile).forEach((key) => {
    if (!genuineKeys2.map((k) => k.toLowerCase().replace(/\s/g, "-")).includes(key.toLowerCase().replace(/\s/g, "-"))) {
      genuineKeys2.push(key);
    } else {
      if (key !== key.toLowerCase().replace(/\s/g, "-")) {
        genuineKeys2[genuineKeys2.indexOf(key.toLowerCase().replace(/\s/g, "-"))] = key;
      }
    }
  });
  return genuineKeys2;
}

// src/fileClass/fileClass.ts
var FileClassManager = class {
  constructor(instance) {
    this.instance = instance;
  }
  all() {
    const filesWithFileClassName = this.instance.plugin.app.vault.getMarkdownFiles().filter((file) => {
      const cache = this.instance.plugin.app.metadataCache.getFileCache(file);
      const fileClassAlias = this.instance.plugin.settings.fileClassAlias;
      return (cache == null ? void 0 : cache.frontmatter) && Object.keys(cache.frontmatter).includes(fileClassAlias) && cache.frontmatter[fileClassAlias] == this.instance.name;
    });
    return filesWithFileClassName;
  }
  get(name) {
    const filesWithName = this.all().filter((file) => file.basename == name);
    if (filesWithName.length > 1) {
      const error = new Error("More than one value found");
      throw error;
    }
    if (filesWithName.length == 0) {
      const error = new Error("No file value found");
      throw error;
    }
    return filesWithName[0];
  }
  getPath(path) {
    const filesWithName = this.all().filter((file) => file.path == path);
    if (filesWithName.length > 1) {
      const error = new Error("More than one value found");
      throw error;
    }
    if (filesWithName.length == 0) {
      const error = new Error("No file value found");
      throw error;
    }
    return filesWithName[0];
  }
};
var FileClass = class {
  constructor(plugin, name) {
    this.plugin = plugin;
    this.name = name;
    this.objects = new FileClassManager(this);
    this.attributes = [];
  }
  getClassFile() {
    const filesClassPath = this.plugin.settings.classFilesPath;
    const file = this.plugin.app.vault.getAbstractFileByPath(`${filesClassPath}${this.name}.md`);
    if (file instanceof import_obsidian26.TFile && file.extension == "md") {
      return file;
    } else {
      const error = new Error(`no file named <${this.name}.md> in <${filesClassPath}> folder to match <${this.plugin.settings.fileClassAlias}: ${this.name}> in one of these notes`);
      throw error;
    }
  }
  getParentClass() {
    return;
  }
  getAttributes(excludeParents = false) {
    var _a, _b, _c, _d;
    try {
      const file = this.getClassFile();
      let parentAttributes = [];
      let errors = [];
      const parent = (_b = (_a = this.plugin.app.metadataCache.getFileCache(file)) == null ? void 0 : _a.frontmatter) == null ? void 0 : _b.extends;
      const excludedFields = (_d = (_c = this.plugin.app.metadataCache.getFileCache(file)) == null ? void 0 : _c.frontmatter) == null ? void 0 : _d.excludes;
      if (parent && !excludeParents) {
        try {
          const parentFileClass = FileClass.createFileClass(this.plugin, parent);
          parentFileClass.getAttributes();
          parentAttributes = Array.isArray(excludedFields) ? [...parentFileClass.attributes.filter((attr) => !excludedFields.includes(attr.name))] : [...parentFileClass.attributes];
        } catch (error) {
          errors.push(error);
        }
      }
      let attributes = [];
      const dataview = this.plugin.app.plugins.plugins["dataview"];
      if (dataview) {
        const dvFile = dataview.api.page(file.path);
        try {
          genuineKeys(dvFile).forEach((key) => {
            if (key !== "file") {
              const item = typeof dvFile[key] !== "string" ? JSON.stringify(dvFile[key]) : dvFile[key];
              try {
                const { type, options } = JSON.parse(item);
                const fieldType = FieldTypeLabelMapping[capitalize(type)];
                const attr = new FileClassAttribute(this.name, key, fieldType, options);
                attributes.push(attr);
              } catch (e) {
              }
            }
          });
        } catch (error) {
          throw error;
        }
      }
      this.attributes = parentAttributes.filter((attr) => !attributes.map((_attr) => _attr.name).includes(attr.name)).concat(attributes.filter((p) => {
        var _a2;
        return !Object.keys(((_a2 = this.plugin.app.metadataCache.getFileCache(file)) == null ? void 0 : _a2.frontmatter) || {}).includes(p.name);
      }));
      this.errors = errors;
    } catch (error) {
      throw error;
    }
  }
  updateAttribute(newType, newName, newOptions, attr) {
    return __async(this, null, function* () {
      const file = this.getClassFile();
      let result = yield this.plugin.app.vault.read(file);
      if (attr) {
        let newContent = [];
        result.split("\n").forEach((line) => {
          if (line.startsWith(attr.name)) {
            let settings = {};
            settings["type"] = newType;
            if (newOptions)
              settings["options"] = newOptions;
            newContent.push(`${newName}:: ${JSON.stringify(settings)}`);
          } else {
            newContent.push(line);
          }
        });
        this.plugin.app.vault.modify(file, newContent.join("\n"));
      } else {
        let settings = {};
        settings["type"] = newType;
        if (newOptions)
          settings["options"] = newOptions;
        result += `
${newName}:: ${JSON.stringify(settings)}`;
        yield this.plugin.app.vault.modify(file, result);
      }
    });
  }
  removeAttribute(attr) {
    return __async(this, null, function* () {
      const file = this.getClassFile();
      const result = yield this.plugin.app.vault.read(file);
      let newContent = [];
      result.split("\n").forEach((line) => {
        if (!line.startsWith(attr.name)) {
          newContent.push(line);
        }
      });
      yield this.plugin.app.vault.modify(file, newContent.join("\n"));
    });
  }
  static createFileClass(plugin, name, excludeParent = false) {
    const fileClass = new FileClass(plugin, name);
    fileClass.getAttributes(excludeParent);
    return fileClass;
  }
};

// src/fields/fieldManagers/DateField.ts
var DateField = class extends FieldManager2 {
  constructor(plugin, field) {
    super(plugin, field, "Date" /* Date */);
    this.defaultDateFormat = "YYYY-MM-DD";
  }
  addFieldOption(name, value, file, location) {
    var _a;
    const modal = new DateModal(this.plugin, file, this.field, value);
    modal.titleEl.setText(`Change date for <${name}>`);
    const dvApi = (_a = this.plugin.app.plugins.plugins.dataview) == null ? void 0 : _a.api;
    if (DateField.isMenu(location)) {
      location.addItem((item) => {
        item.setTitle(`Update <${name}>`);
        item.setIcon(FieldIcon["Date" /* Date */]);
        item.onClick(() => modal.open());
        item.setSection("metadata-menu.fields");
      });
      if (this.field.options.dateShiftInterval || this.field.options.nextShiftIntervalField && dvApi) {
        const p = dvApi.page(file.path);
        const fieldManager = new FieldManager[this.field.type](this.plugin, this.field);
        const [currentShift] = fieldManager.shiftDuration(file);
        location.addItem((item) => {
          item.setTitle(`Shift <${name}> ${currentShift} ahead`);
          item.setIcon("skip-forward");
          item.onClick(() => {
            this.shiftDate(dvApi, p, file);
          });
          item.setSection("metadata-menu.fields");
        });
      }
    } else if (DateField.isSuggest(location)) {
      location.options.push({
        id: `update_${name}`,
        actionLabel: `<span>Update <b>${name}</b></span>`,
        action: () => modal.open(),
        icon: FieldIcon["Date" /* Date */]
      });
      if (this.field.options.dateShiftInterval || this.field.options.nextShiftIntervalField && dvApi) {
        const p = dvApi.page(file.path);
        const fieldManager = new FieldManager[this.field.type](this.plugin, this.field);
        const [currentShift] = fieldManager.shiftDuration(file);
        location.options.push({
          id: `update_${name}`,
          actionLabel: `<span>Shift <b>${name}</b> ${currentShift} ahead</span>`,
          action: () => this.shiftDate(dvApi, p, file),
          icon: FieldIcon["Date" /* Date */]
        });
      }
    }
    ;
  }
  createAndOpenFieldModal(file, selectedFieldName, value, lineNumber, inFrontmatter, after) {
    const fieldModal = new DateModal(this.plugin, file, this.field, value || "", lineNumber, inFrontmatter, after);
    fieldModal.titleEl.setText(`Enter date for ${selectedFieldName}`);
    fieldModal.open();
  }
  createDateContainer(parentContainer) {
    if (!this.field.options.dateFormat)
      this.field.options.dateFormat = this.defaultDateFormat;
    if (!this.field.options.defaultInsertAsLink)
      this.field.options.defaultInsertAsLink = "false";
    const dateFormatContainer = parentContainer.createDiv();
    dateFormatContainer.createEl("span", { text: "Date format", cls: "metadata-menu-field-option" });
    const dateFormatInput = new import_obsidian27.TextComponent(dateFormatContainer);
    dateFormatInput.setValue(this.field.options.dateFormat);
    const dateExample = dateFormatContainer.createEl("span", { text: "", cls: "metadata-menu-field-option" });
    dateExample.setText(`example: ${(0, import_obsidian27.moment)().format(dateFormatInput.getValue())}`);
    dateFormatInput.onChange((value) => {
      this.field.options.dateFormat = value;
      dateExample.setText(`example: ${(0, import_obsidian27.moment)().format(value)}`);
    });
    const defaultInsertAsLinkContainer = parentContainer.createDiv();
    defaultInsertAsLinkContainer.createEl("span", { text: "Insert as link by default", cls: "metadata-menu-field-option" });
    const defaultInsertAsLink = new import_obsidian27.ToggleComponent(defaultInsertAsLinkContainer);
    defaultInsertAsLink.setValue(DateField.stringToBoolean(this.field.options.defaultInsertAsLink));
    defaultInsertAsLink.onChange((value) => {
      this.field.options.defaultInsertAsLink = value.toString();
    });
    const dateLinkPathContainer = parentContainer.createDiv();
    dateLinkPathContainer.createEl("span", { text: "Link path (optional)", cls: "metadata-menu-field-option" });
    const dateLinkPathInput = new import_obsidian27.TextComponent(dateLinkPathContainer);
    dateLinkPathInput.setValue(this.field.options.linkPath);
    dateLinkPathInput.onChange((value) => {
      this.field.options.linkPath = value.endsWith("/") ? value : value + "/";
    });
    const dateShiftIntervalContainer = parentContainer.createDiv();
    dateShiftIntervalContainer.createEl("span", { text: "Define a shift interval", cls: "metadata-menu-field-option" });
    const dateShiftInterval = new import_obsidian27.TextComponent(dateShiftIntervalContainer);
    dateShiftInterval.setPlaceholder("ex: 1 month 2 days");
    dateShiftInterval.setValue(this.field.options.dateShiftInterval);
    dateShiftInterval.onChange((value) => {
      if (!value) {
        delete this.field.options.dateShiftInterval;
      } else {
        this.field.options.dateShiftInterval = value.toString();
      }
    });
    const nextShiftIntervalFieldContainer = parentContainer.createDiv();
    nextShiftIntervalFieldContainer.createEl("span", {
      text: "Field containing shift intervals (has the priority over the Shift Interval above)",
      cls: "metadata-menu-field-option"
    });
    const nextShiftIntervalField = new import_obsidian27.TextComponent(nextShiftIntervalFieldContainer);
    nextShiftIntervalField.setValue(this.field.options.nextShiftIntervalField);
    nextShiftIntervalField.onChange((value) => {
      if (!value) {
        delete this.field.options.nextShiftIntervalField;
      } else {
        this.field.options.nextShiftIntervalField = value.toString();
      }
    });
  }
  createSettingContainer(parentContainer, plugin, location) {
    this.dateValidatorField = parentContainer.createDiv({ cls: "metadata-menu-number-options" });
    this.createDateContainer(this.dateValidatorField);
    this.dateValidatorField.createDiv({ cls: "metadata-menu-separator" }).createEl("hr");
  }
  shiftDate(dv, p, file) {
    return __async(this, null, function* () {
      const { dateFormat, defaultInsertAsLink, linkPath } = this.field.options;
      const fieldManager = new FieldManager[this.field.type](this.plugin, this.field);
      const [currentShift, nextIntervalField, nextShift] = fieldManager.shiftDuration(file);
      const dvDate = p[this.field.name];
      const currentDateValue = dv.value.isLink(dvDate) ? dvDate.path.split("/").last() : dv.value.isDate(dvDate) ? (0, import_obsidian27.moment)(dvDate.toJSDate()).format(dateFormat) : dvDate;
      const currentDvDate = dv.date((0, import_obsidian27.moment)(currentDateValue, dateFormat).toISOString());
      const newDate = currentDvDate.plus(dv.duration(currentShift || "1 day"));
      const newValue = (0, import_obsidian27.moment)(newDate.toString()).format(dateFormat);
      if (nextIntervalField && nextShift) {
        yield this.plugin.fileTaskManager.pushTask(() => {
          replaceValues(this.plugin, file.path, nextIntervalField.name, nextShift);
        });
      }
      const linkFile = this.plugin.app.metadataCache.getFirstLinkpathDest(linkPath || "" + newValue.format(dateFormat), file.path);
      const formattedValue = DateField.stringToBoolean(defaultInsertAsLink) ? `[[${linkPath || ""}${newValue}${linkFile ? "|" + linkFile.basename : ""}]]` : newValue;
      yield this.plugin.fileTaskManager.pushTask(() => {
        replaceValues(this.plugin, file.path, this.field.name, formattedValue);
      });
    });
  }
  createDvField(dv, p, fieldContainer, attrs) {
    var _a;
    const fieldValue = dv.el("span", p[this.field.name], attrs);
    const dateBtn = document.createElement("button");
    (0, import_obsidian27.setIcon)(dateBtn, FieldIcon["Date" /* Date */]);
    dateBtn.addClass("metadata-menu-dv-field-button");
    const spacer = document.createElement("div");
    if (this.field.options.dateShiftInterval || this.field.options.nextShiftIntervalField) {
      this.shiftBtn = document.createElement("button");
      (0, import_obsidian27.setIcon)(this.shiftBtn, "skip-forward");
      this.shiftBtn.addClass("metadata-menu-dv-field-button");
      spacer.setAttr("class", "metadata-menu-dv-field-double-spacer");
    } else {
      spacer.setAttr("class", "metadata-menu-dv-field-spacer");
    }
    const file = this.plugin.app.vault.getAbstractFileByPath(p.file.path);
    let fieldModal;
    if (file instanceof import_obsidian27.TFile && file.extension == "md") {
      if (p[this.field.name] && p[this.field.name].hasOwnProperty("path")) {
        const dateFile = this.plugin.app.vault.getAbstractFileByPath(p[this.field.name]);
        if (dateFile instanceof import_obsidian27.TFile && dateFile.extension == "md") {
          fieldModal = new DateModal(this.plugin, file, this.field, dateFile.name);
        } else {
          fieldModal = new DateModal(this.plugin, file, this.field, p[this.field.name].path.split("/").last().replace(".md", ""));
        }
      } else if (p[this.field.name]) {
        fieldModal = new DateModal(this.plugin, file, this.field, p[this.field.name]);
      } else {
        fieldModal = new DateModal(this.plugin, file, this.field, "");
      }
      if (this.shiftBtn)
        this.shiftBtn.onclick = () => {
          this.shiftDate(dv, p, file);
        };
    } else {
      throw Error("path doesn't correspond to a proper file");
    }
    fieldModal.onClose = () => {
      fieldModal.contentEl.innerHTML = "";
    };
    dateBtn.onclick = () => {
      fieldModal.open();
    };
    if (!((_a = attrs == null ? void 0 : attrs.options) == null ? void 0 : _a.alwaysOn)) {
      dateBtn.hide();
      if (this.shiftBtn)
        this.shiftBtn.hide();
      spacer.show();
      fieldContainer.onmouseover = () => {
        dateBtn.show();
        if (this.shiftBtn)
          this.shiftBtn.show();
        spacer.hide();
      };
      fieldContainer.onmouseout = () => {
        dateBtn.hide();
        if (this.shiftBtn)
          this.shiftBtn.hide();
        spacer.show();
      };
    }
    fieldContainer.appendChild(fieldValue);
    fieldContainer.appendChild(dateBtn);
    if (this.shiftBtn)
      fieldContainer.appendChild(this.shiftBtn);
    fieldContainer.appendChild(spacer);
  }
  getOptionsStr() {
    return this.field.options.dateFormat;
  }
  validateOptions() {
    return true;
  }
  validateValue(value) {
    var _a, _b;
    if (!value) {
      return true;
    } else {
      if (typeof value == "string") {
        return (0, import_obsidian27.moment)((_a = value.replace(/^\[\[/g, "").replace(/\]\]$/g, "").split("|").first()) == null ? void 0 : _a.split("/").last(), this.field.options.dateFormat).isValid();
      } else {
        return (0, import_obsidian27.moment)((_b = value.path.replace(/^\[\[/g, "").replace(/\]\]$/g, "").split("|").first()) == null ? void 0 : _b.split("/").last(), this.field.options.dateFormat).isValid();
      }
    }
  }
  shiftDuration(file) {
    var _a, _b;
    const dvApi = (_a = this.plugin.app.plugins.plugins.dataview) == null ? void 0 : _a.api;
    if (dvApi) {
      const interval = this.field.options.dateShiftInterval;
      const cycleIntervalField = this.field.options.nextShiftIntervalField;
      let fileClass;
      const frontmatter = (_b = this.plugin.app.metadataCache.getFileCache(file)) == null ? void 0 : _b.frontmatter;
      if (frontmatter) {
        const fileClassName = frontmatter[this.plugin.settings.fileClassAlias];
        let fileClass2;
        try {
          fileClass2 = fileClassName ? FileClass.createFileClass(this.plugin, fileClassName) : void 0;
        } catch (e) {
          fileClass2 = void 0;
        }
      }
      const cycle = getField(this.plugin, cycleIntervalField, fileClass);
      if (cycle) {
        const cycleManager = new FieldManager[cycle.type](this.plugin, cycle);
        const options = Object.entries(cycleManager.field.options);
        const currentValue = dvApi.page(file.path)[cycle.name];
        if (currentValue) {
          const currentValueString = options.filter((o) => dvApi.duration(o[1]) !== null).find((o) => dvApi.duration(o[1]).equals(currentValue));
          if (currentValueString) {
            const nextValue = cycleManager.nextOption(currentValueString[1]);
            return [currentValueString[1], cycle, nextValue];
          }
        }
        return [options[0][1], cycle, options[1][1] || options[0][1]];
      } else if (interval && dvApi.duration(interval)) {
        return [interval, void 0, void 0];
      }
    }
    return [void 0, void 0, void 0];
  }
};

// src/fields/fieldManagers/MultiFileField.ts
var import_obsidian29 = require("obsidian");

// src/optionModals/fields/MultiFileModal.ts
var import_obsidian28 = require("obsidian");
var MultiFileFuzzySuggester = class extends import_obsidian28.FuzzySuggestModal {
  constructor(plugin, file, field, initialValueObject, lineNumber = -1, inFrontmatter = false, after = false) {
    var _a;
    super(plugin.app);
    this.plugin = plugin;
    this.file = file;
    this.field = field;
    this.lineNumber = lineNumber;
    this.inFrontmatter = inFrontmatter;
    this.after = after;
    this.selectedFiles = [];
    const dvApi = (_a = this.plugin.app.plugins.plugins["dataview"]) == null ? void 0 : _a.api;
    if (dvApi) {
      const selectedValues = Array.isArray(initialValueObject) ? initialValueObject : [initialValueObject];
      selectedValues.forEach((value) => {
        if (dvApi.value.isLink(value)) {
          const file2 = this.plugin.app.vault.getAbstractFileByPath(value.path);
          if (file2 instanceof import_obsidian28.TFile)
            this.selectedFiles.push(file2);
        }
      });
    }
  }
  onOpen() {
    super.onOpen();
    this.containerEl.onkeydown = (e) => __async(this, null, function* () {
      if (e.key == "Enter" && e.altKey) {
        yield this.replaceValues();
        this.close();
      }
    });
    const buttonContainer = this.containerEl.createDiv({ cls: "metadata-menu-value-suggester-actions" });
    buttonContainer.createDiv({ cls: "metadata-menu-value-suggester-actions-spacer" });
    const infoContainer = buttonContainer.createDiv({ cls: "metadata-menu-value-suggester-info" });
    infoContainer.setText("Alt+Enter to save");
    const confirmButton = new import_obsidian28.ButtonComponent(buttonContainer);
    confirmButton.setIcon("checkmark");
    confirmButton.onClick(() => __async(this, null, function* () {
      yield this.replaceValues();
      this.close();
    }));
    confirmButton.buttonEl.addClass("metadata-menu-value-suggester-button");
    const cancelButton = new import_obsidian28.ButtonComponent(buttonContainer);
    cancelButton.setIcon("cross");
    cancelButton.onClick(() => {
      this.close();
    });
    cancelButton.buttonEl.addClass("metadata-menu-value-suggester-button");
    const clearButton = new import_obsidian28.ButtonComponent(buttonContainer);
    clearButton.setIcon("trash");
    clearButton.onClick(() => __async(this, null, function* () {
      yield this.clearValues();
      this.close();
    }));
    clearButton.buttonEl.addClass("metadata-menu-value-suggester-button");
    clearButton.buttonEl.addClass("danger");
    this.modalEl.appendChild(buttonContainer);
  }
  getItems() {
    try {
      const fileManager = new FieldManager[this.field.type](this.plugin, this.field);
      return fileManager.getFiles(this.file);
    } catch (error) {
      this.close();
      throw error;
    }
  }
  getItemText(item) {
    return item.basename;
  }
  replaceValues() {
    return __async(this, null, function* () {
      const result = this.selectedFiles.map((file) => {
        var _a;
        const dvApi = (_a = this.plugin.app.plugins.plugins.dataview) == null ? void 0 : _a.api;
        let alias = void 0;
        if (dvApi && this.field.options.customRendering) {
          alias = new Function("page", `return ${this.field.options.customRendering}`)(dvApi.page(file.path));
        }
        return FieldManager2.buildMarkDownLink(this.plugin, this.file, file.basename, alias);
      });
      if (this.lineNumber == -1) {
        yield this.plugin.fileTaskManager.pushTask(() => {
          replaceValues(this.plugin, this.file, this.field.name, result.join(", "));
        });
      } else {
        yield this.plugin.fileTaskManager.pushTask(() => {
          insertValues(this.plugin, this.file, this.field.name, result.join(", "), this.lineNumber, this.inFrontmatter, this.after);
        });
      }
      ;
    });
  }
  clearValues() {
    return __async(this, null, function* () {
      yield this.plugin.fileTaskManager.pushTask(() => {
        replaceValues(this.plugin, this.file, this.field.name, "");
      });
    });
  }
  renderSuggestion(value, el) {
    var _a;
    const dvApi = (_a = this.plugin.app.plugins.plugins.dataview) == null ? void 0 : _a.api;
    if (dvApi && this.field.options.customRendering) {
      const suggestionContainer = el.createDiv({ cls: "metadata-menu-suggester-item-with-alias" });
      const label = suggestionContainer.createDiv({ cls: "metadata-menu-suggester-item-with-alias-label" });
      label.setText(new Function("page", `return ${this.field.options.customRendering}`)(dvApi.page(value.item.path)));
      const filePath = suggestionContainer.createDiv({ cls: "metadata-menu-suggester-item-with-alias-filepath" });
      filePath.setText(value.item.path);
    } else {
      el.setText(value.item.basename);
    }
    el.addClass("metadata-menu-value-suggester-value-container");
    const spacer = this.containerEl.createDiv({ cls: "metadata-menu-value-suggester-value-container-spacer" });
    el.appendChild(spacer);
    if (this.selectedFiles.some((file) => file.path === value.item.path)) {
      el.addClass("metadata-menu-value-selected");
      const iconContainer = el.createDiv({ cls: "metadata-menu-command-suggest-icon" });
      (0, import_obsidian28.setIcon)(iconContainer, "check-circle");
    }
  }
  renderSelected() {
    const chooser = this.chooser;
    const suggestions = chooser.suggestions;
    const values = chooser.values;
    suggestions.forEach((s, i) => {
      if (this.selectedFiles.some((file) => file.path === values[i].item.path)) {
        s.addClass("metadata-menu-value-selected");
        if (s.querySelectorAll(".metadata-menu-command-suggest-icon").length == 0) {
          const iconContainer = s.createDiv({ cls: "metadata-menu-command-suggest-icon" });
          (0, import_obsidian28.setIcon)(iconContainer, "check-circle");
        }
      } else {
        s.removeClass("metadata-menu-value-selected");
        s.querySelectorAll(".metadata-menu-command-suggest-icon").forEach((icon) => icon.remove());
      }
    });
  }
  selectSuggestion(value, evt) {
    if (this.selectedFiles.includes(value.item)) {
      this.selectedFiles.remove(value.item);
    } else {
      this.selectedFiles.push(value.item);
    }
    this.renderSelected();
  }
  onChooseItem(item) {
    return __async(this, null, function* () {
    });
  }
};

// src/fields/fieldManagers/MultiFileField.ts
var MultiFileField = class extends FieldManager2 {
  constructor(plugin, field) {
    super(plugin, field, "MultiFile" /* MultiFile */);
    this.getFiles = (currentFile) => {
      const getResults = (api) => {
        try {
          return new Function("dv", "current", `return ${this.field.options.dvQueryString}`)(api, api.page(currentFile == null ? void 0 : currentFile.path));
        } catch (error) {
          new import_obsidian29.Notice(`Wrong query for field <${this.field.name}>
check your settings`, 3e3);
        }
      };
      const dataview = this.plugin.app.plugins.plugins["dataview"];
      if (this.field.options.dvQueryString && (dataview == null ? void 0 : dataview.settings.enableDataviewJs) && (dataview == null ? void 0 : dataview.settings.enableInlineDataviewJs)) {
        try {
          const filesPath = getResults(dataview.api).values.map((v) => v.file.path);
          return this.plugin.app.vault.getMarkdownFiles().filter((f) => filesPath.includes(f.path));
        } catch (error) {
          throw error;
        }
      } else {
        return this.plugin.app.vault.getMarkdownFiles();
      }
    };
  }
  static buildMarkDownLink(plugin, file, path) {
    const destFile = plugin.app.metadataCache.getFirstLinkpathDest(path, file.path);
    if (destFile) {
      return plugin.app.fileManager.generateMarkdownLink(destFile, file.path, void 0, destFile.basename);
    }
    return "";
  }
  addFieldOption(name, value, file, location) {
    const modal = new MultiFileFuzzySuggester(this.plugin, file, this.field, value);
    if (MultiFileField.isMenu(location)) {
      location.addItem((item) => {
        item.setTitle(`Update ${name}`);
        item.setIcon(FieldIcon["File" /* File */]);
        item.onClick(() => modal.open());
        item.setSection("metadata-menu.fields");
      });
    } else if (MultiFileField.isSuggest(location)) {
      location.options.push({
        id: `update_${name}`,
        actionLabel: `<span>Update <b>${name}</b></span>`,
        action: () => modal.open(),
        icon: FieldIcon["File" /* File */]
      });
    }
    ;
  }
  createAndOpenFieldModal(file, selectedFieldName, value, lineNumber, inFrontmatter, after) {
    const fieldModal = new MultiFileFuzzySuggester(this.plugin, file, this.field, value, lineNumber, inFrontmatter, after);
    fieldModal.titleEl.setText(`Enter value for ${selectedFieldName}`);
    fieldModal.open();
  }
  createDvField(dv, p, fieldContainer, attrs) {
    var _a;
    const fieldValue = dv.el("span", p[this.field.name], attrs);
    const searchBtn = document.createElement("button");
    (0, import_obsidian29.setIcon)(searchBtn, FieldIcon["File" /* File */]);
    searchBtn.addClass("metadata-menu-dv-field-button");
    const spacer = document.createElement("div");
    spacer.setAttr("class", "metadata-menu-dv-field-spacer");
    const file = this.plugin.app.vault.getAbstractFileByPath(p["file"]["path"]);
    let fieldModal;
    if (file instanceof import_obsidian29.TFile && file.extension == "md") {
      fieldModal = new MultiFileFuzzySuggester(this.plugin, file, this.field, p[this.field.name]);
    } else {
      throw Error("path doesn't correspond to a proper file");
    }
    searchBtn.onclick = () => {
      fieldModal.open();
    };
    if (!((_a = attrs == null ? void 0 : attrs.options) == null ? void 0 : _a.alwaysOn)) {
      searchBtn.hide();
      spacer.show();
      fieldContainer.onmouseover = () => {
        searchBtn.show();
        spacer.hide();
      };
      fieldContainer.onmouseout = () => {
        searchBtn.hide();
        spacer.show();
      };
    }
    fieldContainer.appendChild(fieldValue);
    fieldContainer.appendChild(searchBtn);
    fieldContainer.appendChild(spacer);
  }
  createFileContainer(parentContainer) {
    const dvQueryStringContainer = parentContainer.createDiv();
    dvQueryStringContainer.createEl("span", { text: "Dataview Query (optional)", cls: "metadata-menu-field-option" });
    this.dvQueryString = new import_obsidian29.TextAreaComponent(dvQueryStringContainer);
    this.dvQueryString.inputEl.cols = 50;
    this.dvQueryString.inputEl.rows = 4;
    this.dvQueryString.setValue(this.field.options.dvQueryString || "");
    this.dvQueryString.onChange((value) => {
      this.field.options.dvQueryString = value;
      FieldSettingsModal.removeValidationError(this.dvQueryString);
    });
    const customeRenderingContainer = parentContainer.createDiv();
    customeRenderingContainer.createEl("span", { text: "Alias", cls: "metadata-menu-field-option" });
    customeRenderingContainer.createEl("span", { text: "Personalise the rendering of your links' aliases with a function returning a string (<page> object is available)", cls: "metadata-menu-field-option-subtext" });
    customeRenderingContainer.createEl("code", {
      text: `function(page) { return <function using "page">; }`
    });
    const customRendering = new import_obsidian29.TextAreaComponent(customeRenderingContainer);
    customRendering.inputEl.cols = 50;
    customRendering.inputEl.rows = 4;
    customRendering.setValue(this.field.options.customRendering || "");
    customRendering.setPlaceholder('Javascript string, the "page" (dataview page type) variable is available\nexample 1: page.file.name\nexample 2: `${page.file.name} of gender ${page.gender}`');
    customRendering.onChange((value) => {
      this.field.options.customRendering = value;
      FieldSettingsModal.removeValidationError(customRendering);
    });
  }
  createSettingContainer(parentContainer, plugin, location) {
    this.fileValidatorField = parentContainer.createDiv({ cls: "metadata-menu-number-options" });
    this.createFileContainer(this.fileValidatorField);
    this.fileValidatorField.createDiv({ cls: "metadata-menu-separator" }).createEl("hr");
  }
  getOptionsStr() {
    return this.field.options.dvQueryString || "";
  }
  validateOptions() {
    return true;
  }
  validateValue(value) {
    let isValid = true;
    if (Array.isArray(value)) {
      value.forEach((link) => {
        const basename = link.path.trim().replace(/^\[\[/g, "").replace(/\]\]$/g, "");
        if (!this.getFiles().map((f) => f.basename).find((item) => item === basename))
          isValid = isValid && false;
      });
    } else {
      const basename = value.path.trim().replace(/^\[\[/g, "").replace(/\]\]$/g, "");
      if (!this.getFiles().map((f) => f.basename).find((item) => item === basename))
        isValid = isValid && false;
    }
    return isValid;
  }
};

// src/fields/fieldManagers/LookupField.ts
var import_obsidian30 = require("obsidian");
var LookupField = class extends FieldManager2 {
  constructor(plugin, field) {
    super(plugin, field, "Lookup" /* Lookup */);
  }
  addFieldOption(name, value, file, location) {
  }
  createAndOpenFieldModal(file, selectedFieldName, value, lineNumber, inFrontmatter, after) {
    return __async(this, null, function* () {
      if (lineNumber == -1) {
        yield this.plugin.fileTaskManager.pushTask(() => {
          replaceValues(this.plugin, file, this.field.name, "");
        });
      } else {
        yield this.plugin.fileTaskManager.pushTask(() => {
          insertValues(this.plugin, file, this.field.name, "", lineNumber, inFrontmatter, after);
        });
      }
      ;
    });
  }
  createDvField(dv, p, fieldContainer, attrs) {
  }
  displaySelectedOutputOptionContainer(optionContainers, value) {
    optionContainers.forEach((options_set) => {
      var _a, _b;
      if (options_set[0].includes(value)) {
        (_a = options_set[1]) == null ? void 0 : _a.show();
      } else {
        (_b = options_set[1]) == null ? void 0 : _b.hide();
      }
    });
  }
  displaySelectedOutputWarningContainer(optionWarningContainer, value) {
    ["LinksBulletList" /* LinksBulletList */.toString(), "CustomBulletList" /* CustomBulletList */.toString()].includes(value) ? optionWarningContainer.show() : optionWarningContainer.hide();
  }
  createLookupContainer(parentContainer) {
    const dvQueryStringContainer = parentContainer.createDiv();
    dvQueryStringContainer.createEl("span", { text: "Pages to look for in your vault (DataviewJS Query)", cls: "metadata-menu-field-option" });
    dvQueryStringContainer.createEl("span", { text: "DataviewJS query of the form `dv.pages(...)`", cls: "metadata-menu-field-option-subtext" });
    const dvQueryString = new import_obsidian30.TextAreaComponent(dvQueryStringContainer);
    dvQueryString.inputEl.cols = 50;
    dvQueryString.inputEl.rows = 4;
    dvQueryString.setValue(this.field.options.dvQueryString || "");
    dvQueryString.setPlaceholder("exampe: dv.pages('#student')");
    dvQueryString.onChange((value) => {
      this.field.options.dvQueryString = value;
      FieldSettingsModal.removeValidationError(dvQueryString);
    });
    const targetFieldContainer = parentContainer.createDiv();
    targetFieldContainer.createEl("span", { text: "Name of the related field", cls: "metadata-menu-field-option" });
    targetFieldContainer.createEl("span", { text: "field in the target pages that contains a link to the page where this lookup field is", cls: "metadata-menu-field-option-subtext" });
    const targetFieldName = new import_obsidian30.TextComponent(targetFieldContainer);
    targetFieldName.setValue(this.field.options.targetFieldName || "");
    targetFieldName.onChange((value) => {
      this.field.options.targetFieldName = value;
      FieldSettingsModal.removeValidationError(targetFieldName);
    });
    const outputTypeContainer = parentContainer.createDiv();
    this.field.options.outputType = this.field.options.outputType || "LinksList" /* LinksList */;
    outputTypeContainer.createEl("span", { text: "Type of output", cls: "metadata-menu-field-option" });
    const outputTypeList = new import_obsidian30.DropdownComponent(outputTypeContainer);
    Object.keys(Type).forEach((outputType) => {
      outputTypeList.addOption(outputType, Description[outputType]);
    });
    outputTypeList.setValue(this.field.options.outputType);
    const outputWarningContainer = parentContainer.createDiv();
    outputWarningContainer.createEl("p", {
      text: "Warning: this may override some lines under your list. There shouldn't be an extra manual item in the list that is automatically rendered by this field: it would be overriden after each field indexing",
      cls: "metadata-menu-field-option-warning"
    });
    const builtinOptionsContainer = parentContainer.createDiv();
    const builtinSummarizeFunctionContainer = builtinOptionsContainer.createDiv();
    this.field.options.builtinSummarizingFunction = this.field.options.builtinSummarizingFunction || Default.BuiltinSummarizing;
    builtinSummarizeFunctionContainer.createEl("span", { text: OptionLabel.BuiltinSummarizing, cls: "metadata-menu-field-option" });
    const builtinSummarizeFunctionList = new import_obsidian30.DropdownComponent(builtinSummarizeFunctionContainer);
    Object.keys(BuiltinSummarizing).forEach((builtinFunction2) => {
      builtinSummarizeFunctionList.addOption(builtinFunction2, BuiltinSummarizing[builtinFunction2]);
    });
    const builtinOptionsDescriptionContainer = builtinOptionsContainer.createDiv({ cls: "metadata-menu-field-option-subtext" });
    const builtinFunction = this.field.options.builtinSummarizingFunction;
    builtinOptionsDescriptionContainer.setText(BuiltinSummarizingFunctionDescription[builtinFunction].replace("{{summarizedFieldName}}", this.field.options.summarizedFieldName));
    builtinSummarizeFunctionList.setValue(this.field.options.builtinSummarizingFunction);
    builtinSummarizeFunctionList.onChange((value) => {
      this.field.options.builtinSummarizingFunction = value;
      builtinOptionsDescriptionContainer.setText(BuiltinSummarizingFunctionDescription[value].replace("{{summarizedFieldName}}", this.field.options.summarizedFieldName));
    });
    const summarizedFieldNameContainer = builtinOptionsContainer.createDiv();
    this.field.options.summarizedFieldName = this.field.options.summarizedFieldName;
    summarizedFieldNameContainer.createEl("span", { text: "Summarized field name", cls: "metadata-menu-field-option" });
    summarizedFieldNameContainer.createEl("span", { text: "Name of the field containing summarized value used for the summarizing function", cls: "metadata-menu-field-option-subtext" });
    const summarizedFieldName = new import_obsidian30.TextComponent(summarizedFieldNameContainer);
    summarizedFieldName.setValue(this.field.options.summarizedFieldName);
    summarizedFieldName.onChange((value) => {
      this.field.options.summarizedFieldName = value;
    });
    const outputRenderingFunctionContainer = parentContainer.createDiv();
    this.field.options.customListFunction = this.field.options.customListFunction || Default.CustomList;
    outputRenderingFunctionContainer.createEl("span", { text: OptionLabel.CustomList, cls: "metadata-menu-field-option" });
    outputRenderingFunctionContainer.createEl("code", { text: OptionSubLabel.CustomList, cls: "metadata-menu-field-option-subtext" });
    const outputRenderingFunction = new import_obsidian30.TextAreaComponent(outputRenderingFunctionContainer);
    outputRenderingFunction.setPlaceholder(Helper.CustomList);
    outputRenderingFunction.setValue(this.field.options.customListFunction);
    outputRenderingFunction.inputEl.cols = 65;
    outputRenderingFunction.inputEl.rows = 4;
    outputRenderingFunction.onChange((value) => {
      this.field.options.customListFunction = value;
    });
    const outputSummarizingFunctionContainer = parentContainer.createDiv();
    this.field.options.customSummarizingFunction = this.field.options.customSummarizingFunction || Default.CustomSummarizing;
    outputSummarizingFunctionContainer.createEl("span", { text: OptionLabel.CustomSummarizing, cls: "metadata-menu-field-option" });
    outputSummarizingFunctionContainer.createEl("code", { text: OptionSubLabel.CustomSummarizing, cls: "metadata-menu-field-option-subtext" });
    const outputSummarizingFunction = new import_obsidian30.TextAreaComponent(outputSummarizingFunctionContainer);
    outputSummarizingFunction.setPlaceholder(Helper.CustomSummarizing);
    outputSummarizingFunction.setValue(this.field.options.customSummarizingFunction);
    outputSummarizingFunction.inputEl.cols = 65;
    outputSummarizingFunction.inputEl.rows = 8;
    outputSummarizingFunction.onChange((value) => {
      this.field.options.customSummarizingFunction = value;
    });
    const optionContainers = [
      [["LinksList", "LinksBulletList"], void 0],
      [["BuiltinSummarizing"], builtinOptionsContainer],
      [["CustomList", "CustomBulletList"], outputRenderingFunctionContainer],
      [["CustomSummarizing"], outputSummarizingFunctionContainer]
    ];
    this.displaySelectedOutputOptionContainer(optionContainers, outputTypeList.getValue());
    this.displaySelectedOutputWarningContainer(outputWarningContainer, outputTypeList.getValue());
    outputTypeList.onChange((value) => {
      this.field.options.outputType = value;
      this.displaySelectedOutputOptionContainer(optionContainers, value);
      this.displaySelectedOutputWarningContainer(outputWarningContainer, value);
    });
  }
  createSettingContainer(parentContainer, plugin, location) {
    this.lookupValidatorField = parentContainer.createDiv({ cls: "metadata-menu-number-options" });
    this.createLookupContainer(this.lookupValidatorField);
    this.lookupValidatorField.createDiv({ cls: "metadata-menu-separator" }).createEl("hr");
  }
  getOptionsStr() {
    const shortDescription = ShortDescription[this.field.options.outputType];
    let complement = "";
    if (this.field.options.outputType === "BuiltinSummarizing" /* BuiltinSummarizing */) {
      complement = ` ${this.field.options.builtinSummarizingFunction}${this.field.options.builtinSummarizingFunction !== "CountAll" /* CountAll */ ? " " + this.field.options.summarizedFieldName : ""}`;
    }
    return shortDescription + complement;
  }
  validateOptions() {
    return true;
  }
};
function updateLookups(plugin, force_update = false, source = "") {
  return __async(this, null, function* () {
    var _a;
    const f = plugin.fieldIndex;
    let renderingErrors = [];
    for (let id of f.fileLookupFiles.keys()) {
      const [filePath, fieldName] = id.split("__related__");
      const tFile = plugin.app.vault.getAbstractFileByPath(filePath);
      if (tFile) {
        let newValue = "";
        const pages = f.fileLookupFiles.get(id);
        const field = (_a = f.filesFields.get(filePath)) == null ? void 0 : _a.find((field2) => field2.name == fieldName);
        switch (field == null ? void 0 : field.options.outputType) {
          case "LinksList" /* LinksList */:
          case "LinksBulletList" /* LinksBulletList */:
            {
              const newValuesArray = pages == null ? void 0 : pages.map((dvFile) => {
                return FieldManager2.buildMarkDownLink(plugin, tFile, dvFile.file.path);
              });
              newValue = (newValuesArray || []).join(", ");
            }
            break;
          case "CustomList" /* CustomList */:
          case "CustomBulletList" /* CustomBulletList */:
            {
              const renderingFunction = new Function("page", `return ${field.options.customListFunction}`);
              const newValuesArray = pages == null ? void 0 : pages.map((dvFile) => {
                try {
                  return renderingFunction(dvFile);
                } catch (e) {
                  if (!renderingErrors.includes(field.name))
                    renderingErrors.push(field.name);
                  return "";
                }
              });
              newValue = (newValuesArray || []).join(", ");
            }
            break;
          case "CustomSummarizing" /* CustomSummarizing */:
            {
              const customSummarizingFunction = field.options.customSummarizingFunction;
              const summarizingFunction = new Function("pages", customSummarizingFunction.replace(/\{\{summarizedFieldName\}\}/g, field.options.summarizedFieldName));
              try {
                newValue = summarizingFunction(pages).toString();
              } catch (e) {
                if (!renderingErrors.includes(field.name))
                  renderingErrors.push(field.name);
                newValue = "";
              }
            }
            break;
          case "BuiltinSummarizing" /* BuiltinSummarizing */:
            {
              const builtinFunction = field.options.builtinSummarizingFunction;
              const summarizingFunction = new Function("pages", BuiltinSummarizingFunction[builtinFunction].replace(/\{\{summarizedFieldName\}\}/g, field.options.summarizedFieldName));
              try {
                newValue = summarizingFunction(pages).toString();
              } catch (e) {
                if (!renderingErrors.includes(field.name))
                  renderingErrors.push(field.name);
                newValue = "";
              }
            }
            break;
          default:
            break;
        }
        const currentValue = f.fileLookupFieldLastValue.get(id);
        if (force_update || !currentValue && newValue !== "" || currentValue !== newValue) {
          const previousValuesCount = plugin.fieldIndex.previousFileLookupFilesValues.get(tFile.path + "__related__" + fieldName) || 0;
          yield plugin.fileTaskManager.pushTask(() => replaceValues(plugin, tFile, fieldName, newValue, previousValuesCount));
          f.fileLookupFieldLastValue.set(id, newValue);
        } else if (source !== "full Index") {
          plugin.fieldIndex.fileChanged = false;
        }
      }
    }
    if (renderingErrors.length)
      new import_obsidian30.Notice(`Those fields have incorrect output rendering functions:
${renderingErrors.join(",\n")}`);
  });
}
function resolveLookups(plugin, source = "") {
  var _a;
  const f = plugin.fieldIndex;
  Array.from(f.filesFields).forEach((value) => {
    const [filePath, fields] = value;
    const dvPage = f.dv.api.page(filePath);
    if (dvPage) {
      fields.filter((field) => field.type === "Lookup" /* Lookup */ && Object.keys(dvPage).includes(field.name)).forEach((lookupField) => {
        const queryRelatedDVFiles = new Function("dv", `return ${lookupField.options.dvQueryString}`)(f.dv.api).values;
        const fileRelatedDVFiles = queryRelatedDVFiles.filter((dvFile) => {
          const targetValue = dvFile[lookupField.options.targetFieldName];
          if (Array.isArray(targetValue)) {
            return targetValue.filter((v) => f.dv.api.value.isLink(v)).map((v) => v.path).includes(filePath);
          } else {
            return (targetValue == null ? void 0 : targetValue.path) === filePath;
          }
        });
        const existingFileLookupFields = f.fileLookupFiles.get(`${filePath}__related__${lookupField.name}`);
        f.fileLookupFiles.set(`${filePath}__related__${lookupField.name}`, fileRelatedDVFiles);
        f.previousFileLookupFilesValues.set(`${filePath}__related__${lookupField.name}`, (existingFileLookupFields || fileRelatedDVFiles).length);
        fileRelatedDVFiles.forEach((dvFile) => {
          const parents = f.fileLookupParents.get(dvFile.file.path) || [];
          if (!parents.includes(filePath))
            parents.push(filePath);
          f.fileLookupParents.set(dvFile.file.path, parents);
        });
      });
    }
  });
  for (let id of f.fileLookupFiles.keys()) {
    const [filePath, fieldName] = id.split("__related__");
    const dvPage = f.dv.api.page(filePath);
    if (dvPage === void 0) {
      for (const file in f.fileLookupParents.keys()) {
        const newParents = ((_a = f.fileLookupParents.get(file)) == null ? void 0 : _a.remove(filePath)) || [];
        f.fileLookupParents.set(file, newParents);
      }
      f.fileLookupFiles.delete(id);
      f.fileLookupFieldLastValue.delete(id);
      f.previousFileLookupFilesValues.delete(id);
    } else if (dvPage[fieldName] === void 0) {
      f.fileLookupFiles.delete(id);
      f.fileLookupFieldLastValue.delete(id);
      f.previousFileLookupFilesValues.delete(id);
    }
  }
}

// src/fields/fieldManagers/Managers.ts
var Managers = {
  Input: InputField,
  Boolean: BooleanField,
  Number: NumberField,
  Select: SelectField,
  Cycle: CycleField,
  Multi: MultiField,
  File: FileField,
  Date: DateField,
  MultiFile: MultiFileField,
  Lookup: LookupField
};
var Managers_default = Managers;

// src/types/fieldTypes.ts
var FieldTypeLabelMapping = {
  "Input": "Input" /* Input */,
  "Select": "Select" /* Select */,
  "Multi": "Multi" /* Multi */,
  "Cycle": "Cycle" /* Cycle */,
  "Boolean": "Boolean" /* Boolean */,
  "Number": "Number" /* Number */,
  "File": "File" /* File */,
  "MultiFile": "MultiFile" /* MultiFile */,
  "Date": "Date" /* Date */,
  "Lookup": "Lookup" /* Lookup */
};
var FieldTypeTagClass = {
  "Input": "single",
  "Select": "select",
  "Multi": "multi",
  "Cycle": "cycle",
  "Boolean": "boolean",
  "Number": "number",
  "File": "file",
  "MultiFile": "file",
  "Date": "date",
  "Lookup": "lookup"
};
var FieldTypeTooltip = {
  "Input": "Accept any value",
  "Select": "Accept a single value from a list",
  "Multi": "Accept multiple values from a list",
  "Cycle": "Cycle through values from a list",
  "Boolean": "Accept true of false",
  "Number": "Accept a number",
  "File": "Accept a link",
  "MultiFile": "Accept multiple links",
  "Date": "Accept a date",
  "Lookup": "Accept a lookup query"
};
var FieldManager = {
  "Input": Managers_default.Input,
  "Select": Managers_default.Select,
  "Multi": Managers_default.Multi,
  "Cycle": Managers_default.Cycle,
  "Boolean": Managers_default.Boolean,
  "Number": Managers_default.Number,
  "File": Managers_default.File,
  "MultiFile": Managers_default.MultiFile,
  "Date": Managers_default.Date,
  "Lookup": Managers_default.Lookup
};
var FieldIcon = {
  "Input": "pencil",
  "Select": "right-triangle",
  "Multi": "bullet-list",
  "Cycle": "switch",
  "Boolean": "checkmark",
  "Number": "plus-minus-glyph",
  "File": "link",
  "MultiFile": "link",
  "Date": "calendar-with-checkmark",
  "Lookup": "file-search"
};

// src/fields/Field.ts
var Field = class {
  constructor(name = "", options = {}, id = "", type = "Input" /* Input */) {
    this.name = name;
    this.options = options;
    this.id = id;
    this.type = type;
  }
  static copyProperty(target, source) {
    target.id = source.id;
    target.name = source.name;
    target.type = source.type;
    Object.keys(source.options).forEach((k) => {
      target.options[k] = source.options[k];
    });
    Object.keys(target.options).forEach((k) => {
      if (!Object.keys(source.options).includes(k)) {
        delete target.options[k];
      }
      ;
    });
  }
  static createDefault(name) {
    const field = new Field();
    field.type = "Input" /* Input */;
    field.name = name;
    return field;
  }
};
var Field_default = Field;

// src/components/FieldIndex.ts
var import_obsidian31 = require("obsidian");

// src/fileClass/FileClassQuery.ts
var FileClassQuery = class {
  constructor(name = "", id = "", query = "", fileClassName = "") {
    this.name = name;
    this.id = id;
    this.query = query;
    this.fileClassName = fileClassName;
  }
  getResults(api) {
    try {
      return new Function("dv", `return ${this.query}`)(api);
    } catch (error) {
      throw Error(`Wrong query for field <${this.name}>. Check your settings`);
    }
  }
  matchFile(file) {
    const dataview = app.plugins.plugins.dataview;
    if (this.query && (dataview == null ? void 0 : dataview.settings.enableDataviewJs) && (dataview == null ? void 0 : dataview.settings.enableInlineDataviewJs)) {
      try {
        const filesPath = this.getResults(dataview.api).values.map((v) => v.file.path);
        return filesPath.includes(file.path);
      } catch (error) {
        return false;
      }
    } else {
      return false;
    }
  }
  static copyProperty(target, source) {
    target.id = source.id;
    target.name = source.name;
    target.query = source.query;
    target.fileClassName = source.fileClassName;
  }
};
var FileClassQuery_default = FileClassQuery;

// src/components/FieldIndex.ts
var FieldIndex = class extends import_obsidian31.Component {
  constructor(plugin, cacheVersion, onChange) {
    super();
    this.plugin = plugin;
    this.cacheVersion = cacheVersion;
    this.onChange = onChange;
    this.fileChanged = false;
    this.dvReady = false;
    this.flushCache();
    this.fileLookupFiles = /* @__PURE__ */ new Map();
    this.fileLookupParents = /* @__PURE__ */ new Map();
    this.fileLookupFieldLastValue = /* @__PURE__ */ new Map();
    this.previousFileLookupFilesValues = /* @__PURE__ */ new Map();
    this.dv = this.plugin.app.plugins.plugins.dataview;
  }
  onload() {
    return __async(this, null, function* () {
      var _a;
      this.loadTime = Date.now();
      if ((_a = this.dv) == null ? void 0 : _a.api.index.initialized) {
        this.dv = this.plugin.app.plugins.plugins.dataview;
        this.lastRevision = this.dv.api.index.revision;
        this.dvReady = true;
        yield this.fullIndex("dv is running");
      }
      this.plugin.registerEvent(this.plugin.app.metadataCache.on("dataview:index-ready", () => __async(this, null, function* () {
        this.dv = this.plugin.app.plugins.plugins.dataview;
        this.dvReady = true;
        yield this.fullIndex("dv index", true);
        this.lastRevision = this.dv.api.index.revision;
      })));
      this.plugin.registerEvent(this.plugin.app.metadataCache.on("resolved", () => __async(this, null, function* () {
        var _a2;
        if (this.plugin.app.metadataCache.inProgressTaskCount === 0) {
          this.fileChanged = true;
          yield this.fullIndex("cache resolved");
          this.lastRevision = ((_a2 = this.dv) == null ? void 0 : _a2.api.index.revision) || 0;
        }
      })));
      this.plugin.registerEvent(this.plugin.app.metadataCache.on("dataview:metadata-change", (op, file) => __async(this, null, function* () {
        var _a2;
        if (op === "update" && this.plugin.app.metadataCache.fileCache[file.path].mtime >= this.loadTime && ((_a2 = this.dv) == null ? void 0 : _a2.api.index.revision) !== this.lastRevision && this.fileChanged && this.dvReady) {
          const classFilesPath = this.plugin.settings.classFilesPath;
          if (classFilesPath && file.path.includes(classFilesPath)) {
            this.fullIndex("fileClass changed");
          } else {
            this.resolveLookups();
            yield this.updateLookups(false, file.basename);
          }
          this.lastRevision = this.dv.api.index.revision;
        }
      })));
    });
  }
  flushCache() {
    this.fileClassesFields = /* @__PURE__ */ new Map();
    this.fieldsFromGlobalFileClass = [];
    this.filesFieldsFromFileClassQueries = /* @__PURE__ */ new Map();
    this.filesFieldsFromInnerFileClasses = /* @__PURE__ */ new Map();
    this.filesFields = /* @__PURE__ */ new Map();
    this.filesFileClass = /* @__PURE__ */ new Map();
    this.fileClassesPath = /* @__PURE__ */ new Map();
    this.fileClassesName = /* @__PURE__ */ new Map();
    this.filesFileClassName = /* @__PURE__ */ new Map();
    this.valuesListNotePathValues = /* @__PURE__ */ new Map();
  }
  fullIndex(event, force_update_lookups = false) {
    return __async(this, null, function* () {
      const start2 = Date.now();
      this.flushCache();
      this.getGlobalFileClass();
      this.getFileClasses();
      this.resolveFileClassQueries();
      this.getFilesFieldsFromFileClass();
      this.getFilesFields();
      yield this.getValuesListNotePathValues();
      this.resolveLookups();
      yield this.updateLookups(force_update_lookups, "full Index");
    });
  }
  resolveLookups() {
    resolveLookups(this.plugin);
  }
  updateLookups(force_update = false, source = "") {
    return __async(this, null, function* () {
      yield updateLookups(this.plugin, force_update, source);
    });
  }
  getValuesListNotePathValues() {
    return __async(this, null, function* () {
      this.fileClassesName.forEach((fileClass) => {
        fileClass.attributes.forEach((attr) => __async(this, null, function* () {
          if (typeof attr.options === "object" && !!attr.options["valuesListNotePath"]) {
            this.valuesListNotePathValues.set(attr.options.valuesListNotePath, yield FieldSetting.getValuesListFromNote(this.plugin, attr.options.valuesListNotePath));
          }
        }));
      });
      this.plugin.settings.presetFields.forEach((setting) => __async(this, null, function* () {
        if (setting.options.valuesListNotePath) {
          this.valuesListNotePathValues.set(setting.options.valuesListNotePath, yield FieldSetting.getValuesListFromNote(this.plugin, setting.options.valuesListNotePath));
        }
      }));
    });
  }
  getGlobalFileClass() {
    const globalFileClass = this.plugin.settings.globalFileClass;
    if (!globalFileClass) {
      this.fieldsFromGlobalFileClass = [];
    } else {
      try {
        this.fieldsFromGlobalFileClass = FileClass.createFileClass(this.plugin, globalFileClass).attributes.map((attr) => attr.getField());
      } catch (error) {
      }
    }
  }
  getFileClasses() {
    if (this.plugin.settings.classFilesPath) {
      this.plugin.app.vault.getMarkdownFiles().filter((f) => f.path.includes(this.plugin.settings.classFilesPath)).forEach((f) => {
        try {
          const fileClass = FileClass.createFileClass(this.plugin, f.basename);
          this.fileClassesFields.set(f.basename, fileClass.attributes.map((attr) => attr.getField()));
          this.fileClassesPath.set(f.path, fileClass);
          this.fileClassesName.set(fileClass.name, fileClass);
        } catch (e) {
        }
      });
    }
  }
  resolveFileClassQueries() {
    var _a;
    const dvApi = (_a = this.plugin.app.plugins.plugins.dataview) == null ? void 0 : _a.api;
    this.plugin.settings.fileClassQueries.forEach((sfcq) => {
      const fcq = new FileClassQuery_default(sfcq.name, sfcq.id, sfcq.query, sfcq.fileClassName);
      fcq.getResults(dvApi).forEach((result) => {
        if (this.fileClassesName.get(fcq.fileClassName)) {
          this.filesFileClass.set(result.file.path, this.fileClassesName.get(fcq.fileClassName));
          this.filesFileClassName.set(result.file.path, fcq.fileClassName);
        }
        const fileFileClassesFieldsFromQuery = this.fileClassesFields.get(fcq.fileClassName);
        if (fileFileClassesFieldsFromQuery)
          this.filesFieldsFromFileClassQueries.set(result.file.path, fileFileClassesFieldsFromQuery);
      });
    });
  }
  getFilesFieldsFromFileClass() {
    this.plugin.app.vault.getMarkdownFiles().filter((f) => !this.plugin.settings.classFilesPath || !f.path.includes(this.plugin.settings.classFilesPath)).forEach((f) => {
      var _a, _b;
      const fileFileClassName = (_b = (_a = this.plugin.app.metadataCache.getFileCache(f)) == null ? void 0 : _a.frontmatter) == null ? void 0 : _b[this.plugin.settings.fileClassAlias];
      if (fileFileClassName) {
        if (this.fileClassesName.get(fileFileClassName)) {
          this.filesFileClass.set(f.path, this.fileClassesName.get(fileFileClassName));
          this.filesFileClassName.set(f.path, fileFileClassName);
        }
        const fileClassesFieldsFromFile = this.fileClassesFields.get(fileFileClassName);
        if (fileClassesFieldsFromFile) {
          this.filesFieldsFromInnerFileClasses.set(f.path, fileClassesFieldsFromFile);
          return;
        }
        this.filesFieldsFromInnerFileClasses.set(f.path, []);
        return;
      }
      this.filesFieldsFromInnerFileClasses.set(f.path, []);
    });
  }
  getFilesFields() {
    this.plugin.app.vault.getMarkdownFiles().filter((f) => !this.plugin.settings.classFilesPath || !f.path.includes(this.plugin.settings.classFilesPath)).forEach((f) => {
      const fileFieldsFromInnerFileClasses = this.filesFieldsFromInnerFileClasses.get(f.path);
      if (fileFieldsFromInnerFileClasses == null ? void 0 : fileFieldsFromInnerFileClasses.length) {
        this.filesFields.set(f.path, fileFieldsFromInnerFileClasses);
        return;
      } else {
        const fileClassFromQuery = this.filesFieldsFromFileClassQueries.get(f.path);
        if (fileClassFromQuery) {
          this.filesFields.set(f.path, fileClassFromQuery);
        } else if (this.fieldsFromGlobalFileClass.length) {
          this.filesFields.set(f.path, this.fieldsFromGlobalFileClass);
          this.filesFileClassName.set(f.path, this.plugin.settings.globalFileClass);
        } else {
          this.filesFields.set(f.path, this.plugin.settings.presetFields);
          this.filesFileClassName.set(f.path, void 0);
        }
      }
    });
  }
};

// src/fileClass/FileClassAttributeModal.ts
var import_obsidian32 = require("obsidian");
var FileClassAttributeModal = class extends import_obsidian32.Modal {
  constructor(plugin, fileClass, attr) {
    super(plugin.app);
    this.plugin = plugin;
    this.fileClass = fileClass;
    this.attr = attr;
    this.initialField = new Field_default();
    if (this.attr) {
      this.field = attr.getField();
      Field_default.copyProperty(this.initialField, this.field);
    } else {
      this.field = new Field_default();
    }
    this.fieldManager = new FieldManager[this.field.type](this.plugin, this.field);
    this.nameInputContainer = this.contentEl.createDiv();
    this.typeSelectContainer = this.contentEl.createDiv({ cls: "metadata-menu-value-selector-container" });
    this.fieldOptionsContainer = this.contentEl.createDiv();
  }
  buildNameInputContainer() {
    this.nameInputContainer.setText("Name: ");
    this.nameInput = new import_obsidian32.TextComponent(this.nameInputContainer);
    this.attr ? this.nameInput.setValue(this.field.name) : this.nameInput.setPlaceholder("Type a name for this attribute");
    this.nameInput.inputEl.focus();
    this.nameInput.onChange((value) => {
      this.field.name = value;
      this.attrName.setText(`<${value}>`);
    });
    this.typeSelectContainer.createDiv({ cls: "metadata-menu-separator" }).createEl("hr");
  }
  buildTypeSelectContainer() {
    const typeSelectHeader = this.typeSelectContainer.createDiv();
    const attrLine = typeSelectHeader.createEl("div");
    this.attrName = attrLine.createEl("strong");
    this.attrName.setText(`<${this.field.name}>`);
    attrLine.append(" fields in files with:");
    String(`---
${this.plugin.settings.fileClassAlias}: ${this.fileClass.name}
...
---`).split("\n").forEach((line) => {
      typeSelectHeader.createEl("div", "yaml-metadata-menu-red").setText(line);
    });
    const typeSelectLabel = this.typeSelectContainer.createDiv({ cls: "metadata-menu-value-selector-inline-label" });
    typeSelectLabel.setText("will: ");
    const typeSelectDropDown = this.typeSelectContainer.createDiv({ cls: "metadata-menu-value-selector-toggler" });
    const typeSelect = new import_obsidian32.DropdownComponent(typeSelectDropDown);
    Object.keys(FieldTypeTooltip).forEach((key) => typeSelect.addOption(key, FieldTypeTooltip[key]));
    typeSelect.setValue(this.field.type);
    typeSelect.onChange((typeLabel) => {
      this.field = new Field_default();
      Field_default.copyProperty(this.field, this.initialField);
      this.field.name = this.nameInput.getValue();
      this.field.type = FieldTypeLabelMapping[typeLabel];
      if (this.field.type !== this.initialField.type && ![this.field.type, this.initialField.type].every((fieldType) => ["Multi" /* Multi */, "Select" /* Select */, "Cycle" /* Cycle */].includes(fieldType))) {
        this.field.options = {};
      }
      while (this.fieldOptionsContainer.firstChild) {
        this.fieldOptionsContainer.removeChild(this.fieldOptionsContainer.firstChild);
      }
      this.fieldManager = new FieldManager[this.field.type](this.plugin, this.field);
      this.fieldManager.createSettingContainer(this.fieldOptionsContainer, this.plugin, 1 /* FileClassAttributeSettings */);
    });
  }
  validateFields() {
    return this.fieldManager.validateName(this.nameInput, this.nameInput.inputEl) && this.fieldManager.validateOptions();
  }
  createSaveBtn(container) {
    const saveButton = new import_obsidian32.ButtonComponent(container);
    saveButton.setIcon("checkmark");
    saveButton.onClick(() => {
      let error = !this.validateFields();
      if (error) {
        new import_obsidian32.Notice("Fix errors before saving.");
        return;
      }
      ;
      this.fileClass.updateAttribute(this.field.type, this.field.name, this.field.options, this.attr);
      this.close();
    });
  }
  createRemovelBtn(container) {
    const removeButton = new import_obsidian32.ButtonComponent(container);
    removeButton.setIcon("trash");
    removeButton.onClick(() => {
      var _a;
      const confirmModal = new import_obsidian32.Modal(this.plugin.app);
      confirmModal.titleEl.setText("Please confirm");
      confirmModal.contentEl.createDiv().setText(`Do you really want to remove ${(_a = this.attr) == null ? void 0 : _a.name} attribute from ${this.fileClass.name}?`);
      const confirmFooter = confirmModal.contentEl.createDiv({ cls: "metadata-menu-value-grid-footer" });
      const confirmButton = new import_obsidian32.ButtonComponent(confirmFooter);
      confirmButton.setIcon("checkmark");
      confirmButton.onClick(() => {
        if (this.attr)
          this.fileClass.removeAttribute(this.attr);
        confirmModal.close();
        this.close();
      });
      const dismissButton = new import_obsidian32.ExtraButtonComponent(confirmFooter);
      dismissButton.setIcon("cross");
      dismissButton.onClick(() => this.close());
      confirmModal.open();
    });
  }
  createCancelBtn(container) {
    const cancelButton = new import_obsidian32.ExtraButtonComponent(container);
    cancelButton.setIcon("cross");
    cancelButton.onClick(() => this.close());
  }
  onOpen() {
    this.titleEl.setText(this.attr ? `Manage ${this.attr.name}` : `Create a new attribute for ${this.fileClass.name}`);
    this.buildNameInputContainer();
    this.buildTypeSelectContainer();
    this.fieldManager.createSettingContainer(this.fieldOptionsContainer, this.plugin, 1 /* FileClassAttributeSettings */);
    const footer = this.contentEl.createDiv({ cls: "metadata-menu-value-grid-footer" });
    this.createSaveBtn(footer);
    if (this.attr)
      this.createRemovelBtn(footer);
    this.createCancelBtn(footer);
  }
};

// src/commands/getValues.ts
var import_obsidian33 = require("obsidian");
function getValues(plugin, fileOrfilePath, attribute) {
  return __async(this, null, function* () {
    var _a;
    let file;
    if (fileOrfilePath instanceof import_obsidian33.TFile) {
      file = fileOrfilePath;
    } else {
      const _file = plugin.app.vault.getAbstractFileByPath(fileOrfilePath);
      if (_file instanceof import_obsidian33.TFile && _file.extension == "md") {
        file = _file;
      } else {
        throw Error("path doesn't correspond to a proper file");
      }
    }
    const content = (yield plugin.app.vault.cachedRead(file)).split("\n");
    const frontmatter = (_a = plugin.app.metadataCache.getFileCache(file)) == null ? void 0 : _a.frontmatter;
    const { position: { start: start2, end: end2 } } = frontmatter ? frontmatter : { position: { start: void 0, end: void 0 } };
    const result = [];
    content.map((line, i) => {
      if (start2 && end2 && i >= start2.line && i <= end2.line) {
        const regex = new RegExp(`${attribute}:(.*)`, "u");
        const r = line.match(regex);
        if (r && r.length > 0)
          result.push(r[1]);
      } else {
        const fullLineRegex2 = new RegExp(`^${inlineFieldRegex(attribute)}(?<values>[^\\]]*)`, "u");
        const fR = encodeLink(line).match(fullLineRegex2);
        if (fR == null ? void 0 : fR.groups) {
          result.push(decodeLink(fR.groups.values));
        }
        ;
        const inSentenceRegexBrackets2 = new RegExp(`\\[${inlineFieldRegex(attribute)}(?<values>[^\\]]+)?\\]`, "gu");
        const sRB = encodeLink(line).matchAll(inSentenceRegexBrackets2);
        let next = sRB.next();
        while (!next.done) {
          if (next.value.groups) {
            result.push(decodeLink(next.value.groups.values));
          }
          next = sRB.next();
        }
        const inSentenceRegexPar2 = new RegExp(`\\(${inlineFieldRegex(attribute)}(?<values>[^\\)]+)?\\)`, "gu");
        const sRP = encodeLink(line).matchAll(inSentenceRegexPar2);
        next = sRP.next();
        while (!next.done) {
          if (next.value.groups) {
            result.push(decodeLink(next.value.groups.values));
          }
          next = sRP.next();
        }
      }
    });
    return result;
  });
}

// src/optionModals/chooseSectionModal.ts
var import_obsidian34 = require("obsidian");
var chooseSectionModal = class extends import_obsidian34.Modal {
  constructor(plugin, file, fileClass, fieldName) {
    super(plugin.app);
    this.plugin = plugin;
    this.file = file;
    this.fileClass = fileClass;
    this.fieldName = fieldName;
  }
  onOpen() {
    return __async(this, null, function* () {
      var _a;
      const result = yield this.plugin.app.vault.read(this.file);
      this.titleEl.setText(`Add a ${this.fieldName ? "<" + this.fieldName + "> " : ""}field in "${this.file.basename.slice(0, 30)}${this.file.basename.length < 30 ? "..." : ""}" after:`);
      const selectEl = new import_obsidian34.DropdownComponent(this.contentEl);
      selectEl.selectEl.addClass("metadata-menu-field-add-section-select");
      selectEl.addOption("", "Select line");
      selectEl.addOption("top_0", "top");
      let foreHeadText = false;
      let frontmatterStart = false;
      let frontmatterEnd = false;
      let inFrontmatter = false;
      result.split("\n").forEach((line, lineNumber) => {
        if (line != "---" && !foreHeadText && !frontmatterStart) {
          foreHeadText = true;
        }
        ;
        if (line == "---" && !foreHeadText) {
          if (!frontmatterStart) {
            frontmatterStart = true;
            inFrontmatter = true;
          } else if (!frontmatterEnd) {
            frontmatterEnd = true;
            inFrontmatter = false;
          }
          ;
        }
        if (inFrontmatter) {
          selectEl.addOption(`frontmatter_${lineNumber}`, `${line.substring(0, 30)}${line.length > 30 ? "..." : ""}`);
        } else {
          selectEl.addOption(`body_${lineNumber}`, `${line.substring(0, 30)}${line.length > 30 ? "..." : ""}`);
        }
        ;
      });
      selectEl.selectEl.focus();
      selectEl.onChange(() => {
        const valueArray = selectEl.getValue().match(/(\w+)_(\d+)/);
        const position = valueArray && valueArray.length > 0 ? valueArray[1] : 0;
        const lineNumber = Number(valueArray && valueArray.length > 1 ? valueArray[2] : 0);
        const inFrontmatter2 = position == "frontmatter" ? true : false;
        const after = position == "top" ? false : true;
        FieldManager2.openFieldModal(this.plugin, this.file, this.fieldName, "", lineNumber, inFrontmatter2, after, this.fileClass);
        this.close();
      });
      if ((_a = this.plugin.app.metadataCache.getCache(this.file.path)) == null ? void 0 : _a.frontmatter) {
        const addToFrontMatterBtn = new import_obsidian34.ButtonComponent(this.contentEl);
        addToFrontMatterBtn.setClass("metadata-menu-field-add-frontmatter-btn");
        addToFrontMatterBtn.setButtonText("Add to frontmatter");
        addToFrontMatterBtn.onClick(() => {
          const lineNumber = this.plugin.app.metadataCache.getCache(this.file.path).frontmatter.position.end.line - 1;
          FieldManager2.openFieldModal(this.plugin, this.file, this.fieldName, "", lineNumber, true, false, this.fileClass);
          this.close();
        });
      }
    });
  }
};

// src/commands/fieldModifier.ts
var import_obsidian35 = require("obsidian");
function getQueryFileClassForFields(plugin, file) {
  let fileClassForFields = false;
  let fileClass;
  const fileClassQueries = plugin.settings.fileClassQueries.map((fcq) => fcq);
  while (!fileClassForFields && fileClassQueries.length > 0) {
    const fileClassQuery = new FileClassQuery_default();
    Object.assign(fileClassQuery, fileClassQueries.pop());
    if (fileClassQuery.matchFile(file)) {
      fileClassForFields = true;
      try {
        fileClass = FileClass.createFileClass(plugin, fileClassQuery.fileClassName);
      } catch (error) {
        fileClass = void 0;
      }
    }
  }
  return fileClass;
}
function buildAndOpenModal(plugin, file, fieldName, fileClass, attrs) {
  var _a, _b;
  if (((_a = attrs == null ? void 0 : attrs.options) == null ? void 0 : _a.inFrontmatter) && ((_b = plugin.app.metadataCache.getCache(file.path)) == null ? void 0 : _b.frontmatter)) {
    const lineNumber = plugin.app.metadataCache.getCache(file.path).frontmatter.position.end.line - 1;
    FieldManager2.openFieldModal(plugin, file, fieldName, "", lineNumber, true, false, fileClass);
  } else {
    new chooseSectionModal(plugin, file, fileClass, fieldName).open();
  }
}
function createDvField(plugin, dv, p, fieldContainer, fieldName, fileClass, attrs) {
  const field = getField(plugin, fieldName, fileClass);
  if (field == null ? void 0 : field.type) {
    const fieldManager = new FieldManager[field.type](plugin, field);
    fieldManager.createDvField(dv, p, fieldContainer, attrs);
  } else {
    const fieldManager = FieldManager2.createDefault(plugin, fieldName);
    fieldManager.createDvField(dv, p, fieldContainer, attrs);
  }
}
function fieldModifier(plugin, dv, p, fieldName, attrs) {
  var _a;
  const fieldContainer = dv.el("div", "");
  fieldContainer.setAttr("class", "metadata-menu-dv-field-container");
  if (p[fieldName] === void 0) {
    if (!((_a = attrs == null ? void 0 : attrs.options) == null ? void 0 : _a.showAddField)) {
      const emptyField = dv.el("span", null, attrs);
      fieldContainer.appendChild(emptyField);
    } else {
      const addFieldBtn = dv.el("button", attrs);
      (0, import_obsidian35.setIcon)(addFieldBtn, "plus-with-circle");
      addFieldBtn.addClass("metadata-menu-dv-field-button");
      addFieldBtn.addClass("isolated");
      addFieldBtn.onclick = () => __async(this, null, function* () {
        const file = plugin.app.vault.getAbstractFileByPath(p.file.path);
        if (file instanceof import_obsidian35.TFile && file.extension == "md") {
          const fileClassAlias = plugin.settings.fileClassAlias;
          const queryFileClass = getQueryFileClassForFields(plugin, file);
          if (p[fileClassAlias]) {
            const fileClassName = p[fileClassAlias];
            try {
              const fileClass = FileClass.createFileClass(plugin, fileClassName);
              buildAndOpenModal(plugin, file, fieldName, fileClass, attrs);
            } catch (error) {
            }
          } else if (queryFileClass) {
            buildAndOpenModal(plugin, file, fieldName, queryFileClass, attrs);
          } else if (plugin.settings.globalFileClass) {
            const fileClassName = plugin.settings.globalFileClass;
            try {
              const fileClass = FileClass.createFileClass(plugin, fileClassName);
              buildAndOpenModal(plugin, file, fieldName, fileClass, attrs);
            } catch (error) {
            }
          } else if (plugin.settings.presetFields.filter((attr) => attr.name == fieldName)) {
            const field = getField(plugin, fieldName);
            if (field == null ? void 0 : field.type) {
              buildAndOpenModal(plugin, file, fieldName, void 0, attrs);
            } else {
              new chooseSectionModal(plugin, file, void 0).open();
            }
          } else {
            new chooseSectionModal(plugin, file, void 0).open();
          }
        } else {
          throw Error("path doesn't correspond to a proper file");
        }
      });
      fieldContainer.appendChild(addFieldBtn);
    }
  } else {
    const fileClassAlias = plugin.settings.fileClassAlias;
    const file = plugin.app.vault.getAbstractFileByPath(p.file.path);
    if (file instanceof import_obsidian35.TFile && file.extension == "md") {
      const queryFileClass = getQueryFileClassForFields(plugin, file);
      if (p[fileClassAlias]) {
        const fileClassName = p[fileClassAlias] || plugin.settings.globalFileClass;
        try {
          const fileClass = FileClass.createFileClass(plugin, fileClassName);
          createDvField(plugin, dv, p, fieldContainer, fieldName, fileClass, attrs);
        } catch (error) {
        }
      } else if (queryFileClass) {
        createDvField(plugin, dv, p, fieldContainer, fieldName, queryFileClass, attrs);
      } else if (plugin.settings.globalFileClass) {
        const fileClassName = plugin.settings.globalFileClass;
        try {
          const fileClass = FileClass.createFileClass(plugin, fileClassName);
          createDvField(plugin, dv, p, fieldContainer, fieldName, fileClass, attrs);
        } catch (error) {
        }
      } else if (plugin.settings.presetFields.filter((attr) => attr.name == fieldName)) {
        createDvField(plugin, dv, p, fieldContainer, fieldName, void 0, attrs);
      } else {
        const fieldManager = FieldManager2.createDefault(plugin, fieldName);
        fieldManager.createDvField(dv, p, fieldContainer, attrs);
      }
    }
  }
  return fieldContainer;
}

// src/commands/fileFields.ts
var import_obsidian36 = require("obsidian");
var FieldInfo = class {
  constructor() {
    this.type = void 0;
    this.sourceType = void 0;
    this.fileClass = void 0;
    this.fileClassQuery = void 0;
    this.options = void 0;
    this.isValid = void 0;
    this.value = "";
    this.valuesListNotePath = void 0;
    this.unique = true;
  }
  setInfos(plugin, fieldName, value, fileClass, matchingFileClassQuery) {
    this.value = value;
    this.ignoreInMenu = plugin.settings.globallyIgnoredFields.includes(fieldName);
    if (fileClass) {
      const fileClassFields = fileClass.attributes.map((attr) => attr.name);
      if (fileClassFields.includes(fieldName)) {
        const field = getField(plugin, fieldName, fileClass);
        if (field) {
          const fieldManager = new FieldManager[field.type](plugin, field);
          this.isValid = fieldManager.validateValue(value);
          const attribute = fileClass.attributes.filter((a) => a.name === fieldName)[0];
          this.fileClass = attribute.origin;
          this.fileClassQuery = matchingFileClassQuery;
          this.type = attribute.type;
          this.options = attribute.options;
        }
      }
    } else if (plugin.settings.presetFields.map((f) => f.name).includes(fieldName)) {
      const field = getField(plugin, fieldName);
      if (field) {
        const fieldManager = new FieldManager[field.type](plugin, field);
        this.isValid = fieldManager.validateValue(value);
        this.type = field.type;
        this.options = field.options;
        this.sourceType = "settings";
      }
    }
  }
};
function fileFields(plugin, fileOrfilePath) {
  var _a;
  let file;
  if (fileOrfilePath instanceof import_obsidian36.TFile) {
    file = fileOrfilePath;
  } else {
    const _file = plugin.app.vault.getAbstractFileByPath(fileOrfilePath);
    if (_file instanceof import_obsidian36.TFile && _file.extension == "md") {
      file = _file;
    } else {
      throw Error("path doesn't correspond to a proper file");
    }
  }
  const frontmatter = (_a = plugin.app.metadataCache.getCache(file.path)) == null ? void 0 : _a.frontmatter;
  const fields = {};
  let fileClass;
  if (plugin.settings.globalFileClass) {
    try {
      fileClass = FileClass.createFileClass(plugin, plugin.settings.globalFileClass);
    } catch (error) {
      fileClass = void 0;
    }
  }
  const fileClassQueries = plugin.settings.fileClassQueries;
  let matchingFileClassQuery = void 0;
  if (fileClassQueries.length > 0) {
    while (!matchingFileClassQuery && fileClassQueries.length > 0) {
      const fileClassQuery = new FileClassQuery_default();
      Object.assign(fileClassQuery, fileClassQueries.pop());
      if (fileClassQuery.matchFile(file)) {
        try {
          fileClass = FileClass.createFileClass(plugin, fileClassQuery.fileClassName);
          matchingFileClassQuery = fileClassQuery.name;
        } catch (error) {
          matchingFileClassQuery = void 0;
        }
      }
    }
  }
  if (frontmatter) {
    const _b = frontmatter, { position } = _b, attributes = __objRest(_b, ["position"]);
    const fileClassAlias = plugin.settings.fileClassAlias;
    if (Object.keys(attributes).includes(fileClassAlias)) {
      const fileClassName = attributes[fileClassAlias];
      try {
        fileClass = FileClass.createFileClass(plugin, fileClassName);
        matchingFileClassQuery = void 0;
      } catch (error) {
        fileClass = void 0;
      }
    }
    Object.keys(attributes).forEach((key) => __async(this, null, function* () {
      const fieldInfo = new FieldInfo();
      fieldInfo.unique = !Object.keys(fields).includes(key);
      fields[key] = fieldInfo;
      yield fieldInfo.setInfos(plugin, key, attributes[key], fileClass);
    }));
  }
  const dataview = plugin.app.plugins.plugins.dataview;
  if (dataview) {
    const dvFile = dataview.api.page(file.path);
    try {
      genuineKeys(dvFile).forEach((key) => __async(this, null, function* () {
        if (key !== "file") {
          const fieldInfo = new FieldInfo();
          fieldInfo.unique = !Object.keys(fields).includes(key);
          fields[key] = fieldInfo;
          yield fieldInfo.setInfos(plugin, key, dvFile[key], fileClass, matchingFileClassQuery);
        }
      }));
    } catch (error) {
      throw error;
    }
  }
  return fields;
}

// src/MetadataMenuApi.ts
var MetadataMenuApi = class {
  constructor(plugin) {
    this.plugin = plugin;
  }
  make() {
    return {
      getValues: this.getValues(),
      replaceValues: this.replaceValues(),
      insertValues: this.insertValues(),
      fieldModifier: this.fieldModifier(),
      fileFields: this.fileFields()
    };
  }
  getValues() {
    return (fileOrFilePath, attribute) => __async(this, null, function* () {
      return getValues(this.plugin, fileOrFilePath, attribute);
    });
  }
  replaceValues() {
    return (fileOrFilePath, attribute, input) => __async(this, null, function* () {
      return yield this.plugin.fileTaskManager.pushTask(() => {
        replaceValues(this.plugin, fileOrFilePath, attribute, input);
      });
    });
  }
  insertValues() {
    return (fileOrFilePath, fieldName, value, lineNumber, inFrontmatter, after) => __async(this, null, function* () {
      return yield this.plugin.fileTaskManager.pushTask(() => {
        insertValues(this.plugin, fileOrFilePath, fieldName, value, lineNumber, inFrontmatter, after);
      });
    });
  }
  fieldModifier() {
    return (dv, p, fieldName, attrs) => fieldModifier(this.plugin, dv, p, fieldName, attrs);
  }
  fileFields() {
    return (fileOrFilePath) => __async(this, null, function* () {
      return fileFields(this.plugin, fileOrFilePath);
    });
  }
};

// src/options/FieldCommandSuggestModal.ts
var import_obsidian37 = require("obsidian");
var FieldCommandSuggestModal = class extends import_obsidian37.FuzzySuggestModal {
  constructor() {
    super(...arguments);
    this.options = [];
  }
  getItems() {
    return this.options;
  }
  getItemText(item) {
    return item.actionLabel;
  }
  onChooseItem(item, evt) {
    item.action();
  }
  renderSuggestion(item, el) {
    el.addClass("metadata-menu-command-suggest-item");
    const iconContainer = el.createDiv({ cls: "metadata-menu-command-suggest-icon" });
    item.item.icon ? (0, import_obsidian37.setIcon)(iconContainer, item.item.icon) : (0, import_obsidian37.setIcon)(iconContainer, "pencil");
    const actionLabel = el.createDiv({ cls: "metadata-menu-command-suggest-action-label" });
    actionLabel.innerHTML = item.item.actionLabel;
  }
};

// src/options/FileClassOptionsList.ts
function isMenu(location) {
  return location.addItem !== void 0;
}
function isInsertFieldCommand(location) {
  return location === "InsertFieldCommand";
}
function isSuggest(location) {
  return location.getItems !== void 0;
}
var FileClassOptionsList = class {
  constructor(plugin, file, location) {
    this.plugin = plugin;
    this.file = file;
    this.location = location;
    this.fileClass = this.plugin.fieldIndex.fileClassesPath.get(this.file.path);
  }
  createExtraOptionList(openAfterCreate = true) {
    if (isMenu(this.location)) {
      this.location.addSeparator();
    }
    ;
    if (isInsertFieldCommand(this.location) && this.fileClass) {
      const modal = new FileClassAttributeModal(this.plugin, this.fileClass);
      modal.open();
    } else if (isSuggest(this.location)) {
      this.buildFieldOptions();
      if (openAfterCreate)
        this.location.open();
    } else {
      this.buildFieldOptions();
    }
  }
  buildFieldOptions() {
    var _a;
    (_a = this.fileClass) == null ? void 0 : _a.attributes.forEach((attr) => {
      const modal = new FileClassAttributeModal(this.plugin, this.fileClass, attr);
      if (isMenu(this.location)) {
        this.location.addItem((item) => {
          item.setTitle(`${attr.name}`);
          item.setIcon("wrench");
          item.onClick(() => {
            modal.open();
          });
          item.setSection("metadata-menu-fileclass.fileclass-fields");
        });
      } else if (isSuggest(this.location)) {
        this.location.options.push({
          id: `update_${attr.name}`,
          actionLabel: `<span>${attr.name}</span>`,
          action: () => modal.open(),
          icon: "gear"
        });
      }
    });
    if (isMenu(this.location) && this.fileClass) {
      this.location.addItem((item) => {
        item.setTitle("Add new fileClass attribute");
        item.setIcon("plus-circle");
        item.onClick(() => {
          const modal = new FileClassAttributeModal(this.plugin, this.fileClass);
          modal.open();
        });
        item.setSection("metadata-menu-fileclass");
      });
    } else if (isSuggest(this.location) && this.fileClass) {
      const modal = new FileClassAttributeModal(this.plugin, this.fileClass);
      this.location.options.push({
        id: "add_fileClass_attribute",
        actionLabel: `<span>Insert an attribute for <b>${this.fileClass.name}</b> fileClass</span>`,
        action: () => {
          modal.open();
        },
        icon: "plus-circle"
      });
    }
  }
};

// src/options/linkContextMenu.ts
var import_obsidian39 = require("obsidian");

// src/options/OptionsList.ts
var import_obsidian38 = require("obsidian");
function isMenu2(location) {
  return location.addItem !== void 0;
}
function isInsertFieldCommand2(location) {
  return location === "InsertFieldCommand";
}
function isSuggest2(location) {
  return location.getItems !== void 0;
}
var OptionsList = class {
  constructor(plugin, file, location, includedFields) {
    this.plugin = plugin;
    this.file = file;
    this.location = location;
    this.includedFields = includedFields;
    this.fieldsFromIndex = {};
    this.file = file;
    this.location = location;
    this.attributes = {};
    this.includedFields = includedFields ? [this.plugin.settings.fileClassAlias, ...includedFields] : [this.plugin.settings.fileClassAlias];
    this.fileClass = this.plugin.fieldIndex.filesFileClass.get(this.file.path);
    this.getFieldsFromIndex();
    this.getFieldsValues();
  }
  getFieldsValues() {
    const dataview = this.plugin.app.plugins.plugins["dataview"];
    if (dataview) {
      const dvFile = dataview.api.page(this.file.path);
      try {
        genuineKeys(dvFile).forEach((key) => this.addAttribute(key, dvFile[key]));
      } catch (error) {
        throw error;
      }
    }
  }
  addAttribute(key, value) {
    const includedFields = this.includedFields.filter((f) => f !== this.plugin.settings.fileClassAlias);
    if (includedFields.length > 0) {
      if (this.includedFields.includes(key) && !this.plugin.settings.globallyIgnoredFields.includes(key)) {
        this.attributes[key] = value;
      }
    } else if (!this.plugin.settings.globallyIgnoredFields.includes(key)) {
      this.attributes[key] = value;
    }
  }
  getFieldsFromIndex() {
    const index = this.plugin.fieldIndex;
    const fields = index.filesFields.get(this.file.path);
    fields == null ? void 0 : fields.forEach((field) => this.fieldsFromIndex[field.name] = field);
  }
  createAndOpenFieldModal(fieldName) {
    const field = this.fieldsFromIndex[fieldName];
    if (field) {
      const fieldManager = new FieldManager[field.type](this.plugin, field);
      fieldManager.createAndOpenFieldModal(this.file, field.name, this.attributes[field.name]);
    } else {
      const defaultField = new Field_default(fieldName);
      defaultField.type = "Input" /* Input */;
      if (fieldName === this.plugin.settings.fileClassAlias) {
        this.buildFileClassFieldOptions(defaultField, this.attributes[fieldName]);
      } else if (this.location === "ManageAtCursorCommand") {
        const fieldManager = new Managers_default.Input(this.plugin, defaultField);
        fieldManager.createAndOpenFieldModal(this.file, fieldName, this.attributes[fieldName]);
      }
    }
  }
  createExtraOptionList(openAfterCreate = true) {
    if (isMenu2(this.location)) {
      this.location.addSeparator();
    }
    ;
    if (isInsertFieldCommand2(this.location)) {
      this.addFieldAtCurrentPositionOption();
    } else if (isSuggest2(this.location)) {
      this.buildFieldOptions();
      this.addFieldAtCurrentPositionOption();
      this.addSectionSelectModalOption();
      this.addFieldAtTheEndOfFrontmatterOption();
      if (this.fileClass) {
        const fieldCommandSuggestModal = new FieldCommandSuggestModal(this.plugin.app);
        const optionsList = new FileClassOptionsList(this.plugin, this.fileClass.getClassFile(), fieldCommandSuggestModal);
        optionsList.createExtraOptionList(false);
        this.location.options.push({
          id: "manage_fileClass_attributes",
          actionLabel: `<span>Manage <b>${this.fileClass.name}</b> fileClass fields</span>`,
          action: () => {
            fieldCommandSuggestModal.open();
          },
          icon: "wrench"
        });
      }
      if (openAfterCreate)
        this.location.open();
    } else if (isMenu2(this.location)) {
      this.buildFieldOptions();
      this.addSectionSelectModalOption();
      this.addFieldAtCurrentPositionOption();
      this.addFieldAtTheEndOfFrontmatterOption();
      if (this.fileClass) {
        const fileClassOptionsList = new FileClassOptionsList(this.plugin, this.fileClass.getClassFile(), this.location);
        fileClassOptionsList.createExtraOptionList(false);
      }
    }
  }
  buildFileClassFieldOptions(field, value) {
    const modal = new InputModal(this.plugin, this.file, field, value);
    modal.titleEl.setText(`Change Value for <${field.name}>`);
    if (isMenu2(this.location)) {
      this.location.addItem((item) => {
        item.setTitle(`Update ${field.name}`);
        item.setIcon("wrench");
        item.onClick(() => modal.open());
        item.setSection("metadata-menu");
      });
    } else if (isSuggest2(this.location)) {
      this.location.options.push({
        id: `update_${field.name}`,
        actionLabel: `<span>Update <b>${field.name}</b></span>`,
        action: () => modal.open(),
        icon: FieldIcon["Input" /* Input */]
      });
    }
    ;
  }
  buildFieldOptions() {
    Object.keys(this.attributes).forEach((key) => {
      const value = this.attributes[key];
      const field = this.fieldsFromIndex[key];
      if (field) {
        const fieldManager = new FieldManager[field.type](this.plugin, field);
        fieldManager.addFieldOption(key, value, this.file, this.location);
      } else if (key !== "file" && (isSuggest2(this.location) || isMenu2(this.location))) {
        const defaultField = new Field_default(key);
        defaultField.type = "Input" /* Input */;
        if (key === this.plugin.settings.fileClassAlias) {
          this.buildFileClassFieldOptions(defaultField, value);
        } else {
          const fieldManager = new Managers_default.Input(this.plugin, defaultField);
          fieldManager.addFieldOption(key, value || "", this.file, this.location);
        }
      }
    });
  }
  addSectionSelectModalOption() {
    const modal = new chooseSectionModal(this.plugin, this.file, this.fileClass);
    if (isMenu2(this.location)) {
      this.location.addItem((item) => {
        item.setIcon("enter");
        item.setTitle("Add field at section...");
        item.onClick((evt) => {
          modal.open();
        });
        item.setSection("metadata-menu");
      });
    } else if (isSuggest2(this.location)) {
      this.location.options.push({
        id: "add_field_at_section",
        actionLabel: "Add field at section...",
        action: () => modal.open(),
        icon: "enter"
      });
    }
    ;
  }
  addFieldAtTheEndOfFrontmatterOption() {
    var _a;
    if ((_a = this.plugin.app.metadataCache.getCache(this.file.path)) == null ? void 0 : _a.frontmatter) {
      const lineNumber = this.plugin.app.metadataCache.getCache(this.file.path).frontmatter.position.end.line - 1;
      if (isMenu2(this.location)) {
        this.location.addItem((item) => {
          item.setIcon("pin");
          item.setTitle("Add field in frontmatter");
          item.onClick((evt) => __async(this, null, function* () {
            FieldManager2.openFieldModal(this.plugin, this.file, void 0, "", lineNumber + 1, true, false);
          }));
          item.setSection("metadata-menu");
        });
      } else if (isSuggest2(this.location)) {
        this.location.options.push({
          id: "add_field_in_frontmatter",
          actionLabel: "Add a field in frontmatter...",
          action: () => FieldManager2.openFieldModal(this.plugin, this.file, void 0, "", lineNumber + 1, true, false, this.fileClass),
          icon: "pin"
        });
      }
    }
  }
  addFieldAtCurrentPositionOption() {
    var _a;
    const currentView = this.plugin.app.workspace.getActiveViewOfType(import_obsidian38.MarkdownView);
    const lineNumber = currentView == null ? void 0 : currentView.editor.getCursor().line;
    if (lineNumber !== void 0 && this.file.path == (currentView == null ? void 0 : currentView.file.path)) {
      let inFrontmatter = false;
      const frontmatter = (_a = this.plugin.app.metadataCache.getFileCache(this.file)) == null ? void 0 : _a.frontmatter;
      if (frontmatter) {
        const { position: { start: start2, end: end2 } } = frontmatter;
        if (lineNumber >= start2.line && lineNumber < end2.line)
          inFrontmatter = true;
      }
      if (isMenu2(this.location)) {
        this.location.addItem((item) => {
          item.setIcon("pin");
          item.setTitle("Add field at cursor");
          item.onClick((evt) => {
            FieldManager2.openFieldModal(this.plugin, this.file, void 0, "", lineNumber, inFrontmatter, false, this.fileClass);
          });
          item.setSection("metadata-menu");
        });
      } else if (isInsertFieldCommand2(this.location)) {
        FieldManager2.openFieldModal(this.plugin, this.file, void 0, "", lineNumber, inFrontmatter, false, this.fileClass);
      } else if (isSuggest2(this.location)) {
        this.location.options.push({
          id: "add_field_at_cursor",
          actionLabel: "Add field at cursor...",
          action: () => FieldManager2.openFieldModal(this.plugin, this.file, void 0, "", lineNumber, inFrontmatter, false, this.fileClass),
          icon: "pin"
        });
      }
      ;
    }
  }
};

// src/options/linkContextMenu.ts
var linkContextMenu = class {
  constructor(plugin) {
    this.plugin = plugin;
    this.createContextMenu();
  }
  buildOptions(file, menu, includedFields) {
    if (file instanceof import_obsidian39.TFile && file.extension === "md") {
      if (!import_obsidian39.Platform.isMobile && (0, import_obsidian39.requireApiVersion)("0.16.0")) {
        menu.setSectionSubmenu("metadata-menu.current_field", { title: "Current Field", icon: "pencil" });
        menu.setSectionSubmenu("metadata-menu.fields", { title: "Manage Fields", icon: "pencil" });
        menu.setSectionSubmenu("metadata-menu-fileclass.fileclass-fields", { title: "Manage Fileclass Fields", icon: "wrench" });
      }
      if (this.plugin.settings.displayFieldsInContextMenu) {
        if (file.parent.path + "/" == this.plugin.settings.classFilesPath) {
          const fileClassOptionsList = new FileClassOptionsList(this.plugin, file, menu);
          fileClassOptionsList.createExtraOptionList();
        } else {
          const optionsList = new OptionsList(this.plugin, file, menu, includedFields);
          optionsList.createExtraOptionList();
        }
        ;
      } else {
        menu.addItem((item) => {
          item.setIcon("list");
          item.setTitle("Field Options");
          item.onClick(() => {
            const fieldCommandSuggestModal = new FieldCommandSuggestModal(this.plugin.app);
            const optionsList = new OptionsList(this.plugin, file, fieldCommandSuggestModal);
            optionsList.createExtraOptionList();
          });
        });
      }
    }
    ;
  }
  createContextMenu() {
    this.plugin.registerEvent(this.plugin.app.workspace.on("file-menu", (menu, abstractFile, source) => {
      const file = this.plugin.app.vault.getAbstractFileByPath(abstractFile.path);
      this.buildOptions(file, menu);
    }));
    this.plugin.registerEvent(this.plugin.app.workspace.on("editor-menu", (menu, editor, view) => {
      var _a;
      const file = this.plugin.app.workspace.getActiveFile();
      const includedFields = [];
      const frontmatter = (_a = this.plugin.app.metadataCache.getFileCache(view.file)) == null ? void 0 : _a.frontmatter;
      if (frontmatter && editor.getCursor().line > frontmatter.position.start.line && editor.getCursor().line < frontmatter.position.end.line) {
        const attribute = frontMatterLineField(editor.getLine(editor.getCursor().line));
        if (attribute)
          includedFields.push(attribute);
      } else {
        getLineFields(editor.getLine(editor.getCursor().line)).forEach((field) => {
          if (editor.getCursor().ch <= field.index + field.length && editor.getCursor().ch >= field.index) {
            includedFields.push(field.attribute);
          }
        });
      }
      if (includedFields.length) {
        this.buildOptions(file, menu, includedFields);
      } else {
        this.buildOptions(file, menu);
      }
    }));
  }
};

// src/settings/MetadataMenuSettings.ts
var DEFAULT_SETTINGS = {
  presetFields: [],
  fileClassQueries: [],
  displayFieldsInContextMenu: true,
  globallyIgnoredFields: [],
  classFilesPath: null,
  isAutosuggestEnabled: true,
  fileClassAlias: "fileClass",
  settingsVersion: void 0,
  globalFileClass: void 0,
  firstDayOfWeek: 1
};

// src/settings/MetadataMenuSettingTab.ts
var import_obsidian43 = require("obsidian");

// src/suggester/FolderSuggester.ts
var import_obsidian40 = require("obsidian");
var FolderSuggest = class extends TextInputSuggest {
  constructor(plugin, inputEl) {
    super(inputEl);
    this.plugin = plugin;
    this.inputEl = inputEl;
  }
  getSuggestions(inputStr) {
    const abstractFiles = this.plugin.app.vault.getAllLoadedFiles();
    const folders = [];
    const lowerCaseInputStr = inputStr.toLowerCase();
    abstractFiles.forEach((folder) => {
      if (folder instanceof import_obsidian40.TFolder && folder.path.toLowerCase().contains(lowerCaseInputStr)) {
        folders.push(folder);
      }
    });
    return folders;
  }
  renderSuggestion(file, el) {
    el.setText(file.path);
  }
  selectSuggestion(file) {
    this.inputEl.value = file.path;
    this.inputEl.trigger("input");
    this.close();
  }
};

// src/settings/FileClassQuerySettingModal.ts
var import_obsidian42 = require("obsidian");

// src/settings/FileClassQuerySetting.ts
var import_obsidian41 = require("obsidian");
var FileClassQuerySetting = class extends import_obsidian41.Setting {
  constructor(containerEl, property, plugin) {
    super(containerEl);
    this.containerEl = containerEl;
    this.plugin = plugin;
    this.fileClassQuery = property;
    this.setTextContentWithname();
    this.addEditButton();
    this.addDeleteButton();
    this.addMoveUpButton();
  }
  setTextContentWithname() {
    this.infoEl.textContent = "";
    this.infoEl.addClass("metadata-menu-setting-item");
    const fileClassQueryContainer = this.infoEl.createDiv();
    const nameContainer = fileClassQueryContainer.createEl("div", "metadata-menu-setting-item-name");
    nameContainer.innerHTML = `<strong>${this.fileClassQuery.name}</strong>`;
    const fileClassNameContainer = fileClassQueryContainer.createEl("div");
    fileClassNameContainer.innerHTML = `<span>FileClass</span> : ${this.fileClassQuery.fileClassName}`;
    const queryContainer = fileClassQueryContainer.createEl("div");
    queryContainer.innerHTML = `<span>Query</span> : ${this.fileClassQuery.query}`;
  }
  addEditButton() {
    this.addButton((b) => {
      b.setIcon("pencil").setTooltip("Edit").onClick(() => {
        let modal = new FileClassQuerySettingsModal(this.plugin, this.containerEl, this, this.fileClassQuery);
        modal.open();
      });
    });
  }
  addDeleteButton() {
    this.addButton((b) => {
      b.setIcon("trash").setTooltip("Delete").onClick(() => {
        var _a;
        const currentExistingFileClassQuery = this.plugin.initialFileClassQueries.find((p) => p.id == this.fileClassQuery.id);
        if (currentExistingFileClassQuery) {
          this.plugin.initialFileClassQueries.remove(currentExistingFileClassQuery);
        }
        ;
        (_a = this.settingEl.parentElement) == null ? void 0 : _a.removeChild(this.settingEl);
        this.plugin.saveSettings();
      });
    });
  }
  addMoveUpButton() {
    this.addButton((b) => {
      b.setIcon("up-chevron-glyph").setTooltip("Move up (lower priority)").onClick(() => {
        const currentFileClassQueryIndex = this.plugin.initialFileClassQueries.map((fcq) => fcq.id).indexOf(this.fileClassQuery.id);
        if (currentFileClassQueryIndex > 0) {
          this.containerEl.insertBefore(this.settingEl, this.settingEl.previousElementSibling);
          this.plugin.initialFileClassQueries.splice(currentFileClassQueryIndex, 1);
          this.plugin.initialFileClassQueries.splice(currentFileClassQueryIndex - 1, 0, this.fileClassQuery);
          this.plugin.saveSettings();
        }
      });
    });
  }
};

// src/settings/FileClassQuerySettingModal.ts
var FileClassQuerySettingsModal = class extends import_obsidian42.Modal {
  constructor(plugin, parentSettingContainer, parentSetting, fileClassQuery) {
    super(plugin.app);
    this.plugin = plugin;
    this.parentSettingContainer = parentSettingContainer;
    this.parentSetting = parentSetting;
    this.saved = false;
    this.new = true;
    this.initialFileClassQuery = new FileClassQuery_default();
    if (fileClassQuery) {
      this.new = false;
      this.fileClassQuery = fileClassQuery;
      FileClassQuery_default.copyProperty(this.initialFileClassQuery, this.fileClassQuery);
    } else {
      let newId = 1;
      this.plugin.initialFileClassQueries.forEach((prop) => {
        if (parseInt(prop.id) && parseInt(prop.id) >= newId) {
          newId = parseInt(prop.id) + 1;
        }
        ;
      });
      this.fileClassQuery = new FileClassQuery_default();
      this.fileClassQuery.id = newId.toString();
      this.initialFileClassQuery.id = newId.toString();
    }
    ;
  }
  onOpen() {
    return __async(this, null, function* () {
      if (this.fileClassQuery.name == "") {
        this.titleEl.setText(`Select a fileClass and add an applicable query`);
      } else {
        this.titleEl.setText(`Manage ${this.fileClassQuery.name} settings`);
      }
      ;
      yield this.createForm();
    });
  }
  onClose() {
    Object.assign(this.fileClassQuery, this.initialFileClassQuery);
    if (!this.new && this.parentSetting) {
      this.parentSetting.setTextContentWithname();
    } else if (this.saved) {
      new FileClassQuerySetting(this.parentSettingContainer, this.fileClassQuery, this.plugin);
    }
    ;
  }
  createnameInputContainer(parentNode) {
    const fileClassQueryNameContainerLabel = parentNode.createDiv();
    fileClassQueryNameContainerLabel.setText(`FileClass Query Name:`);
    const input = new import_obsidian42.TextComponent(parentNode);
    const name = this.fileClassQuery.name;
    input.setValue(name);
    input.setPlaceholder("Name of this fileClass query");
    input.onChange((value) => {
      this.fileClassQuery.name = value;
      this.titleEl.setText(`Manage options for ${this.fileClassQuery.name}`);
    });
    return input;
  }
  createFileClassSelectorContainer(parentNode) {
    const FileClassSelectorContainerLabel = parentNode.createDiv();
    FileClassSelectorContainerLabel.setText(`Fileclass:`);
    const select = new import_obsidian42.DropdownComponent(parentNode);
    const fileClasses = this.plugin.app.vault.getFiles().filter((f) => this.plugin.settings.classFilesPath && f.path.startsWith(this.plugin.settings.classFilesPath));
    select.addOption("--Select a fileClass--", "--Select a fileClass--");
    fileClasses.forEach((fileClass) => select.addOption(fileClass.basename, fileClass.basename));
    if (this.fileClassQuery.fileClassName) {
      select.setValue(this.fileClassQuery.fileClassName);
    }
    select.onChange((value) => {
      if (value != "--Select a fileClass--") {
        this.fileClassQuery.fileClassName = value;
      } else {
        this.fileClassQuery.fileClassName = "";
      }
    });
  }
  createQueryInputContainer(parentNode) {
    const queryContainerLabel = parentNode.createDiv();
    queryContainerLabel.setText("dataviewJS query:");
    const queryStringInput = new import_obsidian42.TextAreaComponent(parentNode);
    queryStringInput.setValue(this.fileClassQuery.query);
    queryStringInput.onChange((value) => this.fileClassQuery.query = value);
  }
  createForm() {
    return __async(this, null, function* () {
      const div = this.contentEl.createDiv({ cls: "metadata-menu-prompt-div" });
      const mainDiv = div.createDiv({ cls: "metadata-menu-prompt-form" });
      const nameContainer = mainDiv.createDiv();
      this.createnameInputContainer(nameContainer);
      mainDiv.createDiv({ cls: "metadata-menu-separator" }).createEl("hr");
      const fileClassSelectContainer = mainDiv.createDiv();
      const footerEl = this.contentEl.createDiv();
      const footerButtons = new import_obsidian42.Setting(footerEl);
      footerButtons.addButton((b) => this.createSaveButton(b));
      footerButtons.addExtraButton((b) => this.createCancelButton(b));
      this.createFileClassSelectorContainer(fileClassSelectContainer);
      const fileClassQueryContainer = mainDiv.createDiv();
      this.createQueryInputContainer(fileClassQueryContainer);
    });
  }
  createSaveButton(b) {
    b.setTooltip("Save");
    b.setIcon("checkmark");
    b.onClick(() => __async(this, null, function* () {
      var _a;
      if (this.fileClassQuery.fileClassName && this.fileClassQuery.name && this.fileClassQuery.query) {
        this.saved = true;
        const currentExistingFileClassQuery = this.plugin.initialFileClassQueries.filter((p) => p.id == this.fileClassQuery.id)[0];
        if (currentExistingFileClassQuery) {
          FileClassQuery_default.copyProperty(currentExistingFileClassQuery, this.fileClassQuery);
        } else {
          this.plugin.initialFileClassQueries.push(this.fileClassQuery);
        }
        ;
        FileClassQuery_default.copyProperty(this.initialFileClassQuery, this.fileClassQuery);
        if (this.parentSetting)
          FileClassQuery_default.copyProperty(this.parentSetting.fileClassQuery, this.fileClassQuery);
        (_a = this.parentSetting) == null ? void 0 : _a.setTextContentWithname();
        this.plugin.saveSettings();
        this.close();
      }
    }));
    return b;
  }
  createCancelButton(b) {
    b.setIcon("cross").setTooltip("Cancel").onClick(() => {
      this.saved = false;
      if (this.initialFileClassQuery.name != "") {
        Object.assign(this.fileClassQuery, this.initialFileClassQuery);
      }
      ;
      this.close();
    });
    return b;
  }
};

// src/settings/MetadataMenuSettingTab.ts
var SettingsMigrationConfirmModal = class extends import_obsidian43.Modal {
  constructor(plugin, tab) {
    super(plugin.app);
    this.plugin = plugin;
    this.tab = tab;
  }
  onOpen() {
    this.titleEl.setText("Confirm");
    const body = this.contentEl.createDiv({
      cls: "modal-text-danger"
    });
    body.setText("This will erase current settings. Are you sure?");
    const confirmButton = new import_obsidian43.ButtonComponent(this.contentEl);
    confirmButton.setIcon("check");
    confirmButton.onClick(() => {
      if (this.plugin.app.plugins.plugins.hasOwnProperty("supercharged-links-obsidian")) {
        let settings = this.plugin.app.plugins.plugins["supercharged-links-obsidian"].settings;
        this.plugin.initialProperties = [];
        settings.presetFields.forEach((prop) => {
          const field = new Field_default();
          Object.assign(field, prop);
          this.plugin.initialProperties.push(field);
        });
        this.plugin.saveSettings();
        this.close();
      }
      ;
    });
  }
  onClose() {
    this.tab.display();
  }
};
var MetadataMenuSettingTab = class extends import_obsidian43.PluginSettingTab {
  constructor(plugin) {
    super(app, plugin);
    this.plugin = plugin;
  }
  display() {
    let { containerEl } = this;
    containerEl.empty();
    const globalSettings = containerEl.createEl("div");
    globalSettings.createEl("h4", { text: "Global settings", cls: "metadata-menu-setting-section-header" });
    globalSettings.createEl("div", {
      cls: "setting-item-description metadata-menu-setting-section-desc",
      text: "Global settings to apply to your whole vault"
    });
    new import_obsidian43.Setting(globalSettings).setName("Display field options in context menu").setDesc("Choose to show or hide fields options in the context menu of a link or a file").addToggle((toggle) => {
      toggle.setValue(this.plugin.settings.displayFieldsInContextMenu);
      toggle.onChange((value) => __async(this, null, function* () {
        this.plugin.settings.displayFieldsInContextMenu = value;
        yield this.plugin.saveSettings();
      }));
    });
    new import_obsidian43.Setting(globalSettings).setName("Globally ignored fields").setDesc("Fields to be ignored by the plugin when adding options to the context menu").addTextArea((text) => {
      text.setPlaceholder("Enter fields as string, comma separated").setValue(this.plugin.settings.globallyIgnoredFields.join(", ")).onChange((value) => __async(this, null, function* () {
        this.plugin.settings.globallyIgnoredFields = value.split(",").map((item) => item.trim());
        yield this.plugin.saveSettings();
      }));
      text.inputEl.rows = 6;
      text.inputEl.cols = 25;
    });
    new import_obsidian43.Setting(globalSettings).setName("First day of week").setDesc("For date fields, which day the date picker's week should start with").addDropdown((cb) => {
      for (let i = 0; i < 2; i++) {
        cb.addOption(i.toString(), (0, import_obsidian43.moment)().day(i).format("dddd"));
      }
      cb.setValue(this.plugin.settings.firstDayOfWeek.toString() || "1");
      cb.onChange((value) => __async(this, null, function* () {
        this.plugin.settings.firstDayOfWeek = parseInt(value);
        yield this.plugin.saveSettings();
      }));
    });
    const presetFieldsSettings = containerEl.createEl("div");
    const presetFieldsSettingHeaderContainer = presetFieldsSettings.createEl("div", { cls: "metadata-menu-setting-section-header-container" });
    const presetFieldsSettingHeaderTextContainer = presetFieldsSettingHeaderContainer.createEl("div", { cls: "metadata-menu-setting-section-header-text-container" });
    presetFieldsSettingHeaderTextContainer.createEl("h4", { text: "Preset Fields settings", cls: "metadata-menu-setting-section-header" });
    presetFieldsSettingHeaderTextContainer.createEl("div", {
      cls: "setting-item-description metadata-menu-setting-section-desc",
      text: "Manage globally predefined type and options for a field throughout your whole vault"
    });
    const presetFieldsSettingsContainerShowButtonContainer = presetFieldsSettingHeaderContainer.createEl("div", { cls: "setting-item-control" });
    const presetFieldsSettingsContainerShowButton = presetFieldsSettingsContainerShowButtonContainer.createEl("button");
    presetFieldsSettingsContainerShowButton.addClass("setting-item-control");
    const presetFieldsSettingsContainer = presetFieldsSettings.createEl("div");
    new import_obsidian43.Setting(presetFieldsSettingsContainer).setName("Add New Field Setting").setDesc("Add a new Frontmatter property for which you want preset options.").addButton((button) => {
      return button.setTooltip("Add New Property Manager").setButtonText("+").onClick(() => __async(this, null, function* () {
        let modal = new FieldSettingsModal(this.plugin, presetFieldsSettingsContainer);
        modal.open();
      }));
    });
    this.plugin.initialProperties.forEach((prop) => {
      const property = new Field_default();
      Object.assign(property, prop);
      new FieldSetting(presetFieldsSettingsContainer, property, this.plugin);
    });
    presetFieldsSettingsContainer.isShown() ? (0, import_obsidian43.setIcon)(presetFieldsSettingsContainerShowButton, "double-up-arrow-glyph") : (0, import_obsidian43.setIcon)(presetFieldsSettingsContainerShowButton, "double-down-arrow-glyph");
    presetFieldsSettingsContainerShowButton.onclick = () => {
      presetFieldsSettingsContainer.isShown() ? presetFieldsSettingsContainer.hide() : presetFieldsSettingsContainer.show();
      presetFieldsSettingsContainer.isShown() ? (0, import_obsidian43.setIcon)(presetFieldsSettingsContainerShowButton, "double-up-arrow-glyph") : (0, import_obsidian43.setIcon)(presetFieldsSettingsContainerShowButton, "double-down-arrow-glyph");
    };
    const classFilesSettings = containerEl.createEl("div");
    const classFilesSettingsHeaderContainer = classFilesSettings.createEl("div", { cls: "metadata-menu-setting-section-header-container" });
    const classFilesSettingsHeaderTextContainer = classFilesSettingsHeaderContainer.createEl("div", { cls: "metadata-menu-setting-section-header-text-container" });
    classFilesSettingsHeaderTextContainer.createEl("h4", { text: "FileClass settings", cls: "metadata-menu-setting-section-header" });
    classFilesSettingsHeaderTextContainer.createEl("div", {
      cls: "setting-item-description metadata-menu-setting-section-desc",
      text: "Manage fileClass folder and alias. When a note has a fielClass defined, fileClass field properties will override global preset fields settings for the same field name"
    });
    const classFilesSettingsContainerShowButtonContainer = classFilesSettingsHeaderContainer.createEl("div", { cls: "setting-item-control" });
    const classFilesSettingsContainerShowButton = classFilesSettingsContainerShowButtonContainer.createEl("button");
    classFilesSettingsContainerShowButton.addClass("setting-item-control");
    const classFilesSettingsContainer = classFilesSettings.createEl("div");
    new import_obsidian43.Setting(classFilesSettingsContainer).setName("class Files path").setDesc("Path to the files containing the authorized fields for a type of note").addSearch((cfs) => {
      new FolderSuggest(this.plugin, cfs.inputEl);
      cfs.setPlaceholder("Folder").setValue(this.plugin.settings.classFilesPath || "").onChange((new_folder) => {
        const newPath = new_folder.endsWith("/") || !new_folder ? new_folder : new_folder + "/";
        this.plugin.settings.classFilesPath = newPath || null;
        this.plugin.saveSettings();
      });
      cfs.containerEl.addClass("metadata-menu-setting-fileClass-search");
    });
    new import_obsidian43.Setting(classFilesSettingsContainer).setName("fileClass field alias").setDesc("Choose another name for fileClass field in frontmatter (example: Category, type, ...").addText((text) => {
      text.setValue(this.plugin.settings.fileClassAlias).onChange((value) => __async(this, null, function* () {
        this.plugin.settings.fileClassAlias = value || "fileClass";
        yield this.plugin.saveSettings();
      }));
    });
    new import_obsidian43.Setting(classFilesSettingsContainer).setName("global fileClass").setDesc("Choose one fileClass to be applicable to all files (even it is not present as a fileClass attribute in their frontmatter). This will override the preset Fields defined above").addSearch((cfs) => {
      new FileSuggest(cfs.inputEl, this.plugin, this.plugin.settings.classFilesPath || "");
      cfs.setPlaceholder("Global fileClass");
      cfs.setValue(this.plugin.settings.globalFileClass ? this.plugin.settings.classFilesPath + this.plugin.settings.globalFileClass + ".md" : "").onChange((newPath) => {
        var _a;
        this.plugin.settings.globalFileClass = newPath ? (_a = newPath.split("\\").pop().split("/").pop()) == null ? void 0 : _a.replace(".md", "") : "";
        this.plugin.saveSettings();
      });
      cfs.containerEl.addClass("metadata-menu-setting-fileClass-search");
    });
    const queryFileClassSettings = classFilesSettingsContainer.createEl("div");
    queryFileClassSettings.createEl("h4", { text: "Query based FileClass settings", cls: "metadata-menu-setting-section-header" });
    queryFileClassSettings.createEl("div", {
      cls: "setting-item-description metadata-menu-setting-section-desc",
      text: "Manage globally predefined type and options for a field matching this query"
    });
    new import_obsidian43.Setting(queryFileClassSettings).setName("Add New Query for fileClass").setDesc("Add a new query and a FileClass that will apply to files matching this query.").addButton((button) => {
      return button.setTooltip("Add New Property Manager").setButtonText("+").onClick(() => __async(this, null, function* () {
        let modal = new FileClassQuerySettingsModal(this.plugin, queryFileClassSettings);
        modal.open();
      }));
    });
    this.plugin.initialFileClassQueries.forEach((query) => {
      const fileClassQuery = new FileClassQuery_default();
      Object.assign(fileClassQuery, query);
      new FileClassQuerySetting(queryFileClassSettings, fileClassQuery, this.plugin);
    });
    classFilesSettingsContainer.isShown() ? (0, import_obsidian43.setIcon)(classFilesSettingsContainerShowButton, "double-up-arrow-glyph") : (0, import_obsidian43.setIcon)(classFilesSettingsContainerShowButton, "double-down-arrow-glyph");
    classFilesSettingsContainerShowButton.onclick = () => {
      classFilesSettingsContainer.isShown() ? classFilesSettingsContainer.hide() : classFilesSettingsContainer.show();
      classFilesSettingsContainer.isShown() ? (0, import_obsidian43.setIcon)(classFilesSettingsContainerShowButton, "double-up-arrow-glyph") : (0, import_obsidian43.setIcon)(classFilesSettingsContainerShowButton, "double-down-arrow-glyph");
    };
    const migrateSettings = containerEl.createEl("div");
    migrateSettings.createEl("h4", { text: "Migrate" });
    new import_obsidian43.Setting(migrateSettings).setName("Copy settings from supercharged links plugin").setDesc("Copy settings from supercharged links plugin").addButton((button) => {
      return button.setTooltip("Get settings from supercharged links").setButtonText("Copy").onClick(() => __async(this, null, function* () {
        let modal = new SettingsMigrationConfirmModal(this.plugin, this);
        modal.open();
      }));
    });
  }
};

// src/settings/migrateSetting.ts
var migrateSettingsV1toV2 = (plugin) => __async(void 0, null, function* () {
  const presetFields = plugin.settings.presetFields;
  presetFields.forEach((p) => {
    if (!Object.keys(p).contains("type")) {
      if (p.isMulti)
        p.type = "Multi" /* Multi */;
      else if (p.isCycle)
        p.type = "Cycle" /* Cycle */;
      else if (p.isBoolean)
        p.type = "Boolean" /* Boolean */;
      else if (p.options && Object.keys(p.options).length > 0)
        p.type = "Select" /* Select */;
      else
        p.type = "Input" /* Input */;
    }
    delete p.isMulti;
    delete p.isCycle;
    delete p.isBoolean;
    if (Object.getOwnPropertyDescriptor(p, "values") !== void 0) {
      Object.defineProperty(p, "options", Object.getOwnPropertyDescriptor(p, "values"));
      delete p["values"];
    }
  });
  plugin.settings.settingsVersion = 2;
  yield plugin.saveData(plugin.settings);
  console.log("Metadata menu settings migrated to version 2");
});
var migrateSettingsV2toV3 = (plugin) => __async(void 0, null, function* () {
  const presetFields = plugin.settings.presetFields;
  presetFields.forEach((p) => {
    if (["Select" /* Select */, "Multi" /* Multi */].includes(p.type)) {
      const currentOptionKeys = Object.keys(p.options);
      p.options.valuesList = {};
      currentOptionKeys.forEach((key) => p.options.valuesList[key] = p.options[key]);
      if (p.valuesListNotePath) {
        const selectType = "ValuesListNotePath" /* ValuesListNotePath */;
        p.options.sourceType = selectType;
        p.options[Key[selectType]];
      } else {
        p.options.sourceType = "ValuesList" /* ValuesList */;
      }
      p.options.valuesListNotePath = p.valuesListNotePath;
      currentOptionKeys.forEach((key) => delete p.options[key]);
      p.options.valuesFromDVQuery = "";
    }
    delete p.valuesListNotePath;
  });
  plugin.settings.settingsVersion = 3;
  yield plugin.saveData(plugin.settings);
  console.log("Metadata menu settings migrated to version 3");
});

// src/suggester/metadataSuggester.ts
var import_obsidian44 = require("obsidian");
var ValueSuggest = class extends import_obsidian44.EditorSuggest {
  constructor(plugin) {
    super(plugin.app);
    this.inFrontmatter = false;
    this.inFullLine = false;
    this.inSentence = false;
    this.didSelect = false;
    this.filterOption = (firstValues, lastValue, option) => {
      return !firstValues || !(firstValues == null ? void 0 : firstValues.contains(encodeLink(option))) && (!lastValue || !!lastValue && encodeLink(option).includes(lastValue));
    };
    this.plugin = plugin;
    this.setInstructions([{ command: "Shift", purpose: "put a space after::" }]);
    this.scope.register(["Shift"], "Enter", (evt) => {
      this.suggestions.useSelectedItem(evt);
      return false;
    });
  }
  onTrigger(cursor, editor, file) {
    var _a;
    if (this.didSelect) {
      this.didSelect = false;
      return null;
    }
    if (!this.plugin.settings.isAutosuggestEnabled) {
      return null;
    }
    ;
    const frontmatter = (_a = this.plugin.app.metadataCache.getFileCache(file)) == null ? void 0 : _a.frontmatter;
    const fullLine = editor.getLine(editor.getCursor().line);
    this.inFrontmatter = !!frontmatter && frontmatter.position.start.line < cursor.line && cursor.line < frontmatter.position.end.line;
    if (this.inFrontmatter) {
      const regex = new RegExp(`^${genericFieldRegex}:(?<values>.*)`, "u");
      if (!regex.test(fullLine))
        return null;
    } else if (getLineFields(fullLine).length === 0) {
      return null;
    }
    return {
      start: cursor,
      end: cursor,
      query: editor.getLine(cursor.line)
    };
  }
  getAlias(tFile) {
    var _a, _b;
    const dvApi = (_a = this.plugin.app.plugins.plugins.dataview) == null ? void 0 : _a.api;
    let alias = void 0;
    if (dvApi && ((_b = this.field) == null ? void 0 : _b.options.customRendering)) {
      alias = new Function("page", `return ${this.field.options.customRendering}`)(dvApi.page(tFile.path));
    }
    return alias;
  }
  getSuggestions(context) {
    return __async(this, null, function* () {
      const suggestions = yield this.getValueSuggestions(context);
      if (suggestions.length) {
        return suggestions;
      }
      return [];
    });
  }
  getValueSuggestions(context) {
    return __async(this, null, function* () {
      var _a, _b, _c, _d, _e;
      const lineNumber = context.start.line;
      const matchField = { attribute: void 0, values: "" };
      const dvApi = (_a = this.plugin.app.plugins.plugins.dataview) == null ? void 0 : _a.api;
      if (!this.inFrontmatter) {
        const lineFields = getLineFields(encodeLink(context.editor.getLine(lineNumber)));
        const position = context.editor.getCursor().ch;
        const activeLineField = lineFields.find((lineField) => lineField.index <= position && lineField.index + lineField.length >= position);
        if (activeLineField) {
          this.inSentence = activeLineField.index > 0;
          this.inFullLine = activeLineField.index === 0;
          matchField.attribute = activeLineField.attribute;
          matchField.values = activeLineField.values;
        }
      } else {
        const regex = new RegExp(`^${genericFieldRegex}:(?<values>.+)?`, "u");
        const regexResult = context.editor.getRange({ line: lineNumber, ch: 0 }, context.end).match(regex);
        if (regexResult == null ? void 0 : regexResult.groups) {
          matchField.attribute = regexResult.groups.attribute;
          matchField.values = regexResult.groups.values;
        }
      }
      ;
      if (matchField.attribute) {
        const fieldName = matchField.attribute;
        this.field = (_b = this.plugin.fieldIndex.filesFields.get(context.file.path)) == null ? void 0 : _b.find((f) => f.name === fieldName);
        const valuesList = (_c = matchField.values) == null ? void 0 : _c.replace(/^\[|^\s\[|^\(|^\s\(/, "").replace(/\]$|\)$/, "").split(",").map((o) => encodeLink(o.trim()));
        const lastValue = valuesList == null ? void 0 : valuesList.last();
        const firstValues = valuesList == null ? void 0 : valuesList.slice(0, -1);
        if (fieldName === "tags" && this.inFrontmatter) {
          return Object.keys(this.plugin.app.metadataCache.getTags()).filter((t) => lastValue ? t.contains(lastValue) : t).sort().map((tag) => Object({ value: tag.replace(/^#/, "") }));
        }
        if (this.field && ["Cycle" /* Cycle */, "Multi" /* Multi */, "Select" /* Select */].contains(this.field.type)) {
          const fieldManager = new FieldManager[this.field.type](this.plugin, this.field);
          return fieldManager.getOptionsList(dvApi.page((_d = this.context) == null ? void 0 : _d.file.path)).filter((option) => this.filterOption(firstValues, lastValue, option)).map((_value) => Object({ value: _value }));
        } else if (this.field && ["File" /* File */, "MultiFile" /* MultiFile */].includes(this.field.type)) {
          const fieldManager = new FieldManager[this.field.type](this.plugin, this.field);
          const files = fieldManager.getFiles((_e = this.context) == null ? void 0 : _e.file);
          if (lastValue) {
            return files.filter((f) => {
              var _a2;
              return f.basename.toLowerCase().includes(lastValue) || ((_a2 = this.getAlias(f)) == null ? void 0 : _a2.toLowerCase().includes(lastValue));
            }).map((f) => {
              return Object({ value: FileField.buildMarkDownLink(this.plugin, context.file, f.basename, this.getAlias(f)) });
            });
          } else {
            return files.map((f) => {
              var _a2;
              let alias = void 0;
              if (dvApi && ((_a2 = this.field) == null ? void 0 : _a2.options.customRendering)) {
                alias = new Function("page", `return ${this.field.options.customRendering}`)(dvApi.page(f.path));
              }
              return Object({ value: FileField.buildMarkDownLink(this.plugin, context.file, f.basename, alias) });
            });
          }
        } else {
          return [];
        }
      }
      ;
      return [];
    });
  }
  renderSuggestion(suggestion, el) {
    var _a;
    const [rawValue, alias] = suggestion.value.replace(/^\[\[/, "").replace(/\]\]$/, "").split("|");
    const targetFile = this.plugin.app.metadataCache.getFirstLinkpathDest(rawValue, this.context.file.path);
    const dvApi = (_a = this.plugin.app.plugins.plugins.dataview) == null ? void 0 : _a.api;
    if (dvApi && this.field && this.field.options.customRendering && targetFile) {
      if (alias) {
        const suggestionContainer = el.createDiv({ cls: "metadata-menu-suggester-item-with-alias" });
        const label = suggestionContainer.createDiv({ cls: "metadata-menu-suggester-item-with-alias-label" });
        label.setText(alias);
        const filePath = suggestionContainer.createDiv({ cls: "metadata-menu-suggester-item-with-alias-filepath" });
        filePath.setText(rawValue);
      } else {
        el.setText(new Function("page", `return ${this.field.options.customRendering}`)(dvApi.page(targetFile.path)));
      }
    } else {
      el.setText(rawValue);
    }
  }
  selectSuggestion(suggestion, event) {
    var _a;
    const activeView = this.plugin.app.workspace.getActiveViewOfType(import_obsidian44.MarkdownView);
    if (!activeView) {
      return;
    }
    ;
    const editor = activeView.editor;
    const activeLine = editor.getLine(this.context.start.line);
    if (this.inFrontmatter) {
      try {
        let parsedField = (0, import_obsidian44.parseYaml)(activeLine);
        let [attr, pastValues] = Object.entries(parsedField)[0];
        let newField;
        if (!pastValues) {
          newField = attr + ": " + suggestion.value;
        } else if (typeof pastValues == "string") {
          if (!pastValues.contains(",")) {
            newField = attr + ": " + suggestion.value;
          } else {
            newField = attr + ": [" + pastValues.split(",").map((o) => o.trim()).slice(0, -1).join(", ") + ", " + suggestion.value + "]";
          }
        } else if (Array.isArray(pastValues)) {
          if (activeLine.endsWith(",]") || activeLine.endsWith(", ]")) {
            newField = attr + ": [" + [...pastValues, suggestion.value].join(", ") + "]";
          } else {
            newField = attr + ": [" + [...pastValues.slice(0, -1), suggestion.value].join(", ") + "]";
          }
        } else {
          newField = attr + ": [" + [...pastValues].join(", ") + "]";
        }
        editor.replaceRange(newField, { line: this.context.start.line, ch: 0 }, { line: this.context.start.line, ch: activeLine.length });
        if (Array.isArray(pastValues) || typeof pastValues === "string" && pastValues.contains(",")) {
          editor.setCursor({ line: this.context.start.line, ch: newField.length - 1 });
        } else {
          editor.setCursor({ line: this.context.start.line, ch: newField.length });
        }
      } catch (error) {
        new import_obsidian44.Notice("Frontmatter wrongly formatted", 2e3);
        this.close();
        return;
      }
    } else if (this.inFullLine) {
      let cleanedLine = activeLine;
      while (![",", ":"].contains(cleanedLine.charAt(cleanedLine.length - 1))) {
        cleanedLine = cleanedLine.slice(0, -1);
      }
      editor.replaceRange(`${cleanedLine}${event.shiftKey ? " " : ""}` + suggestion.value, { line: this.context.start.line, ch: 0 }, this.context.end);
    } else if (this.inSentence) {
      const position = ((_a = this.context) == null ? void 0 : _a.editor.getCursor().ch) || 0;
      let beforeCursor = activeLine.slice(0, position);
      let afterCursor = activeLine.slice(position);
      let separatorPos = position;
      let currentValueLength = 0;
      while (!beforeCursor.endsWith("::") && !beforeCursor.endsWith(",") && beforeCursor.length) {
        separatorPos = separatorPos - 1;
        currentValueLength = currentValueLength + 1;
        beforeCursor = beforeCursor.slice(0, -1);
      }
      let nextBracketPos = position;
      while (!encodeLink(afterCursor).match("(\\]|\\)).*") && afterCursor.length) {
        nextBracketPos = nextBracketPos + 1;
        afterCursor = afterCursor.slice(nextBracketPos - position);
      }
      editor.replaceRange(suggestion.value, { line: this.context.start.line, ch: separatorPos }, { line: this.context.start.line, ch: nextBracketPos });
      editor.setCursor({ line: this.context.start.line, ch: nextBracketPos - currentValueLength + suggestion.value.length });
    }
    this.didSelect = true;
    this.close();
  }
};

// src/components/FileTaskManager.ts
var import_obsidian45 = require("obsidian");

// node_modules/uuid/dist/esm-browser/rng.js
var getRandomValues;
var rnds8 = new Uint8Array(16);
function rng() {
  if (!getRandomValues) {
    getRandomValues = typeof crypto !== "undefined" && crypto.getRandomValues && crypto.getRandomValues.bind(crypto);
    if (!getRandomValues) {
      throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");
    }
  }
  return getRandomValues(rnds8);
}

// node_modules/uuid/dist/esm-browser/stringify.js
var byteToHex = [];
for (let i = 0; i < 256; ++i) {
  byteToHex.push((i + 256).toString(16).slice(1));
}
function unsafeStringify(arr, offset2 = 0) {
  return (byteToHex[arr[offset2 + 0]] + byteToHex[arr[offset2 + 1]] + byteToHex[arr[offset2 + 2]] + byteToHex[arr[offset2 + 3]] + "-" + byteToHex[arr[offset2 + 4]] + byteToHex[arr[offset2 + 5]] + "-" + byteToHex[arr[offset2 + 6]] + byteToHex[arr[offset2 + 7]] + "-" + byteToHex[arr[offset2 + 8]] + byteToHex[arr[offset2 + 9]] + "-" + byteToHex[arr[offset2 + 10]] + byteToHex[arr[offset2 + 11]] + byteToHex[arr[offset2 + 12]] + byteToHex[arr[offset2 + 13]] + byteToHex[arr[offset2 + 14]] + byteToHex[arr[offset2 + 15]]).toLowerCase();
}

// node_modules/uuid/dist/esm-browser/native.js
var randomUUID = typeof crypto !== "undefined" && crypto.randomUUID && crypto.randomUUID.bind(crypto);
var native_default = {
  randomUUID
};

// node_modules/uuid/dist/esm-browser/v4.js
function v4(options, buf, offset2) {
  if (native_default.randomUUID && !buf && !options) {
    return native_default.randomUUID();
  }
  options = options || {};
  const rnds = options.random || (options.rng || rng)();
  rnds[6] = rnds[6] & 15 | 64;
  rnds[8] = rnds[8] & 63 | 128;
  if (buf) {
    offset2 = offset2 || 0;
    for (let i = 0; i < 16; ++i) {
      buf[offset2 + i] = rnds[i];
    }
    return buf;
  }
  return unsafeStringify(rnds);
}
var v4_default = v4;

// src/components/FileTaskManager.ts
var Task = class {
  constructor(fn2) {
    this.fn = fn2;
    this.status = "pending";
    this.id = v4_default();
  }
};
var FileTaskManager = class extends import_obsidian45.Component {
  constructor(plugin, cacheVersion, onChange) {
    super();
    this.plugin = plugin;
    this.cacheVersion = cacheVersion;
    this.onChange = onChange;
    this.queue = /* @__PURE__ */ new Map();
  }
  onload() {
    return __async(this, null, function* () {
      this.plugin.registerEvent(this.plugin.app.metadataCache.on("resolved", () => __async(this, null, function* () {
        yield this.executeNext();
      })));
    });
  }
  pushTask(fn2) {
    return __async(this, null, function* () {
      const task = new Task(fn2);
      this.queue.set(task.id, task);
      yield this.executeNext();
    });
  }
  executeNext() {
    return __async(this, null, function* () {
      const [firstTaskInQueueId, firstTaskInQueue] = [...this.queue][0] || [void 0, void 0];
      if (firstTaskInQueue && !this.plugin.app.metadataCache.inProgressTaskCount) {
        firstTaskInQueue.status = "ongoing";
        yield firstTaskInQueue.fn();
        firstTaskInQueue.status = "done";
        this.queue.delete(firstTaskInQueueId);
      } else if (this.plugin.app.metadataCache.inProgressTaskCount) {
      } else {
      }
    });
  }
};

// main.ts
var MetadataMenu = class extends import_obsidian46.Plugin {
  constructor() {
    super(...arguments);
    this.initialProperties = [];
    this.initialFileClassQueries = [];
  }
  onload() {
    return __async(this, null, function* () {
      console.log("Metadata Menu loaded");
      yield this.loadSettings();
      if (this.settings.settingsVersion === void 0)
        yield migrateSettingsV1toV2(this);
      if (this.settings.settingsVersion === 2)
        yield migrateSettingsV2toV3(this);
      this.fieldIndex = this.addChild(new FieldIndex(this, "1", () => {
      }));
      this.fileTaskManager = this.addChild(new FileTaskManager(this, "1", () => {
      }));
      this.settings.presetFields.forEach((prop) => {
        const property = new Field_default();
        Object.assign(property, prop);
        this.initialProperties.push(property);
      });
      this.settings.fileClassQueries.forEach((query) => {
        const fileClassQuery = new FileClassQuery_default();
        Object.assign(fileClassQuery, query);
        this.initialFileClassQueries.push(fileClassQuery);
      });
      this.addSettingTab(new MetadataMenuSettingTab(this));
      this.registerEditorSuggest(new ValueSuggest(this));
      this.api = new MetadataMenuApi(this).make();
      this.registerEvent(this.app.workspace.on("active-leaf-change", (leaf) => {
        const view = leaf == null ? void 0 : leaf.view;
        this.addCommands(view);
      }));
      this.addCommands(this.app.workspace.getActiveViewOfType(import_obsidian46.MarkdownView));
      new linkContextMenu(this);
    });
  }
  addFileClassAttributeOptions() {
    this.addCommand({
      id: "fileClassAttr_options",
      name: "fileClass attributes options",
      icon: "gear",
      checkCallback: (checking) => {
        const view = this.app.workspace.getActiveViewOfType(import_obsidian46.MarkdownView);
        if (checking) {
          return !!(view == null ? void 0 : view.file) && `${view.file.parent.path}/` == this.settings.classFilesPath;
        }
        const fieldCommandSuggestModal = new FieldCommandSuggestModal(this.app);
        const optionsList = new FileClassOptionsList(this, view.file, fieldCommandSuggestModal);
        optionsList.createExtraOptionList();
      }
    });
  }
  addInsertFileClassAttribute() {
    this.addCommand({
      id: "insert_fileClassAttr",
      name: "Insert a new fileClass attribute",
      icon: "list-plus",
      checkCallback: (checking) => {
        const view = this.app.workspace.getActiveViewOfType(import_obsidian46.MarkdownView);
        if (checking) {
          return !!(view == null ? void 0 : view.file) && `${view.file.parent.path}/` == this.settings.classFilesPath;
        }
        try {
          const fileClassAttributeModal = new FileClassAttributeModal(this, FileClass.createFileClass(this, view.file.basename));
          fileClassAttributeModal.open();
        } catch (error) {
          new import_obsidian46.Notice("This is not a valid fileClass");
        }
      }
    });
  }
  addInsertFieldAtPositionCommand() {
    this.addCommand({
      id: "insert_field_at_cursor",
      name: "insert field at cursor",
      icon: "list-plus",
      checkCallback: (checking) => {
        const view = this.app.workspace.getActiveViewOfType(import_obsidian46.MarkdownView);
        if (checking) {
          return !!((view == null ? void 0 : view.file) && view.file.parent.path + "/" !== this.settings.classFilesPath);
        }
        const optionsList = new OptionsList(this, view.file, "InsertFieldCommand");
        optionsList.createExtraOptionList();
      }
    });
  }
  addFieldCommand() {
    this.addCommand({
      id: "field_options",
      name: "field options",
      icon: "gear",
      checkCallback: (checking) => {
        const view = this.app.workspace.getActiveViewOfType(import_obsidian46.MarkdownView);
        if (checking) {
          return !!((view == null ? void 0 : view.file) && view.file.parent.path + "/" !== this.settings.classFilesPath);
        }
        const fieldCommandSuggestModal = new FieldCommandSuggestModal(this.app);
        const optionsList = new OptionsList(this, view.file, fieldCommandSuggestModal);
        optionsList.createExtraOptionList();
      }
    });
  }
  addManageFieldAtCursorCommand() {
    this.addCommand({
      id: "field_at_cursor_options",
      name: "Manage field at cursor",
      icon: "text-cursor-input",
      checkCallback: (checking) => {
        var _a;
        const view = this.app.workspace.getActiveViewOfType(import_obsidian46.MarkdownView);
        const editor = view == null ? void 0 : view.editor;
        if (checking) {
          const inFile = !!((view == null ? void 0 : view.file) && view.file.parent.path + "/" !== this.settings.classFilesPath);
          return inFile && editor !== void 0;
        }
        const optionsList = new OptionsList(this, view.file, "ManageAtCursorCommand");
        const frontmatter = (_a = this.app.metadataCache.getFileCache(view.file)) == null ? void 0 : _a.frontmatter;
        if (frontmatter && editor && editor.getCursor().line > frontmatter.position.start.line && editor.getCursor().line < frontmatter.position.end.line) {
          const attribute = frontMatterLineField(editor.getLine(editor.getCursor().line));
          if (attribute)
            optionsList.createAndOpenFieldModal(attribute);
        } else if (editor) {
          const { attribute, values } = getLineFields(editor.getLine(editor.getCursor().line)).find((field) => editor.getCursor().ch <= field.index + field.length && editor.getCursor().ch >= field.index) || {};
          if (attribute)
            optionsList.createAndOpenFieldModal(attribute);
        }
      }
    });
  }
  addUpdateLookups() {
    this.addCommand({
      id: "update_lookups",
      name: "Update lookup fields",
      icon: "file-search",
      checkCallback: (checking) => {
        if (checking)
          return true;
        this.fieldIndex.fullIndex("command", true);
      }
    });
  }
  addCommands(view) {
    if (view && view instanceof import_obsidian46.FileView) {
      const file = this.app.vault.getAbstractFileByPath(view.file.path);
      if (file instanceof import_obsidian46.TFile && file.extension === "md") {
        if (file.parent.path + "/" == this.settings.classFilesPath) {
          this.addFileClassAttributeOptions();
          this.addInsertFileClassAttribute();
        } else {
          this.addFieldCommand();
          this.addInsertFieldAtPositionCommand();
          this.addManageFieldAtCursorCommand();
        }
      }
    }
    this.addUpdateLookups();
  }
  loadSettings() {
    return __async(this, null, function* () {
      this.settings = Object.assign({}, DEFAULT_SETTINGS, yield this.loadData());
    });
  }
  saveSettings() {
    return __async(this, null, function* () {
      this.settings.presetFields = this.initialProperties;
      this.settings.fileClassQueries = this.initialFileClassQueries;
      yield this.saveData(this.settings);
      yield this.fieldIndex.fullIndex("setting", true);
    });
  }
  onunload() {
    console.log("Metadata Menu unloaded");
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsibWFpbi50cyIsICJzcmMvZmllbGRzL2ZpZWxkTWFuYWdlcnMvSW5wdXRGaWVsZC50cyIsICJzcmMvb3B0aW9uTW9kYWxzL2ZpZWxkcy9JbnB1dE1vZGFsLnRzIiwgInNyYy9jb21tYW5kcy9pbnNlcnRWYWx1ZXMudHMiLCAic3JjL2NvbW1hbmRzL3JlcGxhY2VWYWx1ZXMudHMiLCAic3JjL3R5cGVzL2xvb2t1cFR5cGVzLnRzIiwgInNyYy91dGlscy9saXN0LnRzIiwgInNyYy91dGlscy9wYXJzZXIudHMiLCAic3JjL2ZpZWxkcy9GaWVsZE1hbmFnZXIudHMiLCAic3JjL29wdGlvbk1vZGFscy9pbnNlcnRGaWVsZFN1Z2dlc3RNb2RhbC50cyIsICJzcmMvb3B0aW9uTW9kYWxzL2FkZE5ld0ZpZWxkTW9kYWwudHMiLCAic3JjL3NldHRpbmdzL0ZpZWxkU2V0dGluZ3NNb2RhbC50cyIsICJzcmMvc2V0dGluZ3MvRmllbGRTZXR0aW5nLnRzIiwgInNyYy9vcHRpb25Nb2RhbHMvZmllbGRzL0Jvb2xlYW5Nb2RhbC50cyIsICJzcmMvZmllbGRzL2ZpZWxkTWFuYWdlcnMvQm9vbGVhbkZpZWxkLnRzIiwgInNyYy9maWVsZHMvZmllbGRNYW5hZ2Vycy9OdW1iZXJGaWVsZC50cyIsICJzcmMvb3B0aW9uTW9kYWxzL2ZpZWxkcy9OdW1iZXJNb2RhbC50cyIsICJzcmMvZmllbGRzL2ZpZWxkTWFuYWdlcnMvU2VsZWN0RmllbGQudHMiLCAic3JjL29wdGlvbk1vZGFscy9maWVsZHMvU2VsZWN0TW9kYWwudHMiLCAic3JjL3R5cGVzL3NlbGVjdFZhbHVlc1NvdXJjZVR5cGVzLnRzIiwgInNyYy9maWVsZHMvZmllbGRNYW5hZ2Vycy9BYnN0cmFjdExpc3RCYXNlZEZpZWxkLnRzIiwgInNyYy9zdWdnZXN0ZXIvRmlsZVN1Z2dlc3Rlci50cyIsICJzcmMvc3VnZ2VzdGVyL3N1Z2dlc3QudHMiLCAibm9kZV9tb2R1bGVzL0Bwb3BwZXJqcy9jb3JlL2xpYi9lbnVtcy5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL2RvbS11dGlscy9nZXROb2RlTmFtZS5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL2RvbS11dGlscy9nZXRXaW5kb3cuanMiLCAibm9kZV9tb2R1bGVzL0Bwb3BwZXJqcy9jb3JlL2xpYi9kb20tdXRpbHMvaW5zdGFuY2VPZi5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL21vZGlmaWVycy9hcHBseVN0eWxlcy5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL3V0aWxzL2dldEJhc2VQbGFjZW1lbnQuanMiLCAibm9kZV9tb2R1bGVzL0Bwb3BwZXJqcy9jb3JlL2xpYi91dGlscy9tYXRoLmpzIiwgIm5vZGVfbW9kdWxlcy9AcG9wcGVyanMvY29yZS9saWIvZG9tLXV0aWxzL2dldEJvdW5kaW5nQ2xpZW50UmVjdC5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL2RvbS11dGlscy9nZXRMYXlvdXRSZWN0LmpzIiwgIm5vZGVfbW9kdWxlcy9AcG9wcGVyanMvY29yZS9saWIvZG9tLXV0aWxzL2NvbnRhaW5zLmpzIiwgIm5vZGVfbW9kdWxlcy9AcG9wcGVyanMvY29yZS9saWIvZG9tLXV0aWxzL2dldENvbXB1dGVkU3R5bGUuanMiLCAibm9kZV9tb2R1bGVzL0Bwb3BwZXJqcy9jb3JlL2xpYi9kb20tdXRpbHMvaXNUYWJsZUVsZW1lbnQuanMiLCAibm9kZV9tb2R1bGVzL0Bwb3BwZXJqcy9jb3JlL2xpYi9kb20tdXRpbHMvZ2V0RG9jdW1lbnRFbGVtZW50LmpzIiwgIm5vZGVfbW9kdWxlcy9AcG9wcGVyanMvY29yZS9saWIvZG9tLXV0aWxzL2dldFBhcmVudE5vZGUuanMiLCAibm9kZV9tb2R1bGVzL0Bwb3BwZXJqcy9jb3JlL2xpYi9kb20tdXRpbHMvZ2V0T2Zmc2V0UGFyZW50LmpzIiwgIm5vZGVfbW9kdWxlcy9AcG9wcGVyanMvY29yZS9saWIvdXRpbHMvZ2V0TWFpbkF4aXNGcm9tUGxhY2VtZW50LmpzIiwgIm5vZGVfbW9kdWxlcy9AcG9wcGVyanMvY29yZS9saWIvdXRpbHMvd2l0aGluLmpzIiwgIm5vZGVfbW9kdWxlcy9AcG9wcGVyanMvY29yZS9saWIvdXRpbHMvZ2V0RnJlc2hTaWRlT2JqZWN0LmpzIiwgIm5vZGVfbW9kdWxlcy9AcG9wcGVyanMvY29yZS9saWIvdXRpbHMvbWVyZ2VQYWRkaW5nT2JqZWN0LmpzIiwgIm5vZGVfbW9kdWxlcy9AcG9wcGVyanMvY29yZS9saWIvdXRpbHMvZXhwYW5kVG9IYXNoTWFwLmpzIiwgIm5vZGVfbW9kdWxlcy9AcG9wcGVyanMvY29yZS9saWIvbW9kaWZpZXJzL2Fycm93LmpzIiwgIm5vZGVfbW9kdWxlcy9AcG9wcGVyanMvY29yZS9saWIvdXRpbHMvZ2V0VmFyaWF0aW9uLmpzIiwgIm5vZGVfbW9kdWxlcy9AcG9wcGVyanMvY29yZS9saWIvbW9kaWZpZXJzL2NvbXB1dGVTdHlsZXMuanMiLCAibm9kZV9tb2R1bGVzL0Bwb3BwZXJqcy9jb3JlL2xpYi9tb2RpZmllcnMvZXZlbnRMaXN0ZW5lcnMuanMiLCAibm9kZV9tb2R1bGVzL0Bwb3BwZXJqcy9jb3JlL2xpYi91dGlscy9nZXRPcHBvc2l0ZVBsYWNlbWVudC5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL3V0aWxzL2dldE9wcG9zaXRlVmFyaWF0aW9uUGxhY2VtZW50LmpzIiwgIm5vZGVfbW9kdWxlcy9AcG9wcGVyanMvY29yZS9saWIvZG9tLXV0aWxzL2dldFdpbmRvd1Njcm9sbC5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL2RvbS11dGlscy9nZXRXaW5kb3dTY3JvbGxCYXJYLmpzIiwgIm5vZGVfbW9kdWxlcy9AcG9wcGVyanMvY29yZS9saWIvZG9tLXV0aWxzL2dldFZpZXdwb3J0UmVjdC5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL2RvbS11dGlscy9nZXREb2N1bWVudFJlY3QuanMiLCAibm9kZV9tb2R1bGVzL0Bwb3BwZXJqcy9jb3JlL2xpYi9kb20tdXRpbHMvaXNTY3JvbGxQYXJlbnQuanMiLCAibm9kZV9tb2R1bGVzL0Bwb3BwZXJqcy9jb3JlL2xpYi9kb20tdXRpbHMvZ2V0U2Nyb2xsUGFyZW50LmpzIiwgIm5vZGVfbW9kdWxlcy9AcG9wcGVyanMvY29yZS9saWIvZG9tLXV0aWxzL2xpc3RTY3JvbGxQYXJlbnRzLmpzIiwgIm5vZGVfbW9kdWxlcy9AcG9wcGVyanMvY29yZS9saWIvdXRpbHMvcmVjdFRvQ2xpZW50UmVjdC5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL2RvbS11dGlscy9nZXRDbGlwcGluZ1JlY3QuanMiLCAibm9kZV9tb2R1bGVzL0Bwb3BwZXJqcy9jb3JlL2xpYi91dGlscy9jb21wdXRlT2Zmc2V0cy5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL3V0aWxzL2RldGVjdE92ZXJmbG93LmpzIiwgIm5vZGVfbW9kdWxlcy9AcG9wcGVyanMvY29yZS9saWIvdXRpbHMvY29tcHV0ZUF1dG9QbGFjZW1lbnQuanMiLCAibm9kZV9tb2R1bGVzL0Bwb3BwZXJqcy9jb3JlL2xpYi9tb2RpZmllcnMvZmxpcC5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL21vZGlmaWVycy9oaWRlLmpzIiwgIm5vZGVfbW9kdWxlcy9AcG9wcGVyanMvY29yZS9saWIvbW9kaWZpZXJzL29mZnNldC5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL21vZGlmaWVycy9wb3BwZXJPZmZzZXRzLmpzIiwgIm5vZGVfbW9kdWxlcy9AcG9wcGVyanMvY29yZS9saWIvdXRpbHMvZ2V0QWx0QXhpcy5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL21vZGlmaWVycy9wcmV2ZW50T3ZlcmZsb3cuanMiLCAibm9kZV9tb2R1bGVzL0Bwb3BwZXJqcy9jb3JlL2xpYi9kb20tdXRpbHMvZ2V0SFRNTEVsZW1lbnRTY3JvbGwuanMiLCAibm9kZV9tb2R1bGVzL0Bwb3BwZXJqcy9jb3JlL2xpYi9kb20tdXRpbHMvZ2V0Tm9kZVNjcm9sbC5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL2RvbS11dGlscy9nZXRDb21wb3NpdGVSZWN0LmpzIiwgIm5vZGVfbW9kdWxlcy9AcG9wcGVyanMvY29yZS9saWIvdXRpbHMvb3JkZXJNb2RpZmllcnMuanMiLCAibm9kZV9tb2R1bGVzL0Bwb3BwZXJqcy9jb3JlL2xpYi91dGlscy9kZWJvdW5jZS5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL3V0aWxzL2Zvcm1hdC5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL3V0aWxzL3ZhbGlkYXRlTW9kaWZpZXJzLmpzIiwgIm5vZGVfbW9kdWxlcy9AcG9wcGVyanMvY29yZS9saWIvdXRpbHMvdW5pcXVlQnkuanMiLCAibm9kZV9tb2R1bGVzL0Bwb3BwZXJqcy9jb3JlL2xpYi91dGlscy9tZXJnZUJ5TmFtZS5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL2NyZWF0ZVBvcHBlci5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL3BvcHBlci5qcyIsICJzcmMvdXRpbHMvZmlsZVV0aWxzLnRzIiwgInNyYy9maWVsZHMvZmllbGRNYW5hZ2Vycy9DeWNsZUZpZWxkLnRzIiwgInNyYy9maWVsZHMvZmllbGRNYW5hZ2Vycy9NdWx0aUZpZWxkLnRzIiwgInNyYy9vcHRpb25Nb2RhbHMvZmllbGRzL011bHRpU2VsZWN0TW9kYWwudHMiLCAic3JjL2ZpZWxkcy9maWVsZE1hbmFnZXJzL0ZpbGVGaWVsZC50cyIsICJzcmMvb3B0aW9uTW9kYWxzL2ZpZWxkcy9TaW5nbGVGaWxlTW9kYWwudHMiLCAic3JjL2ZpZWxkcy9maWVsZE1hbmFnZXJzL0RhdGVGaWVsZC50cyIsICJzcmMvb3B0aW9uTW9kYWxzL2ZpZWxkcy9EYXRlTW9kYWwudHMiLCAibm9kZV9tb2R1bGVzL2ZsYXRwaWNrci9kaXN0L2VzbS90eXBlcy9vcHRpb25zLmpzIiwgIm5vZGVfbW9kdWxlcy9mbGF0cGlja3IvZGlzdC9lc20vbDEwbi9kZWZhdWx0LmpzIiwgIm5vZGVfbW9kdWxlcy9mbGF0cGlja3IvZGlzdC9lc20vdXRpbHMvaW5kZXguanMiLCAibm9kZV9tb2R1bGVzL2ZsYXRwaWNrci9kaXN0L2VzbS91dGlscy9kb20uanMiLCAibm9kZV9tb2R1bGVzL2ZsYXRwaWNrci9kaXN0L2VzbS91dGlscy9mb3JtYXR0aW5nLmpzIiwgIm5vZGVfbW9kdWxlcy9mbGF0cGlja3IvZGlzdC9lc20vdXRpbHMvZGF0ZXMuanMiLCAibm9kZV9tb2R1bGVzL2ZsYXRwaWNrci9kaXN0L2VzbS91dGlscy9wb2x5ZmlsbHMuanMiLCAibm9kZV9tb2R1bGVzL2ZsYXRwaWNrci9kaXN0L2VzbS9pbmRleC5qcyIsICJzcmMvY29tbWFuZHMvZ2V0RmllbGQudHMiLCAic3JjL2ZpbGVDbGFzcy9maWxlQ2xhc3NBdHRyaWJ1dGUudHMiLCAic3JjL2ZpbGVDbGFzcy9maWxlQ2xhc3MudHMiLCAic3JjL3V0aWxzL3RleHRVdGlscy50cyIsICJzcmMvdXRpbHMvZGF0YXZpZXdVdGlscy50cyIsICJzcmMvZmllbGRzL2ZpZWxkTWFuYWdlcnMvTXVsdGlGaWxlRmllbGQudHMiLCAic3JjL29wdGlvbk1vZGFscy9maWVsZHMvTXVsdGlGaWxlTW9kYWwudHMiLCAic3JjL2ZpZWxkcy9maWVsZE1hbmFnZXJzL0xvb2t1cEZpZWxkLnRzIiwgInNyYy9maWVsZHMvZmllbGRNYW5hZ2Vycy9NYW5hZ2Vycy50cyIsICJzcmMvdHlwZXMvZmllbGRUeXBlcy50cyIsICJzcmMvZmllbGRzL0ZpZWxkLnRzIiwgInNyYy9jb21wb25lbnRzL0ZpZWxkSW5kZXgudHMiLCAic3JjL2ZpbGVDbGFzcy9GaWxlQ2xhc3NRdWVyeS50cyIsICJzcmMvZmlsZUNsYXNzL0ZpbGVDbGFzc0F0dHJpYnV0ZU1vZGFsLnRzIiwgInNyYy9jb21tYW5kcy9nZXRWYWx1ZXMudHMiLCAic3JjL29wdGlvbk1vZGFscy9jaG9vc2VTZWN0aW9uTW9kYWwudHMiLCAic3JjL2NvbW1hbmRzL2ZpZWxkTW9kaWZpZXIudHMiLCAic3JjL2NvbW1hbmRzL2ZpbGVGaWVsZHMudHMiLCAic3JjL01ldGFkYXRhTWVudUFwaS50cyIsICJzcmMvb3B0aW9ucy9GaWVsZENvbW1hbmRTdWdnZXN0TW9kYWwudHMiLCAic3JjL29wdGlvbnMvRmlsZUNsYXNzT3B0aW9uc0xpc3QudHMiLCAic3JjL29wdGlvbnMvbGlua0NvbnRleHRNZW51LnRzIiwgInNyYy9vcHRpb25zL09wdGlvbnNMaXN0LnRzIiwgInNyYy9zZXR0aW5ncy9NZXRhZGF0YU1lbnVTZXR0aW5ncy50cyIsICJzcmMvc2V0dGluZ3MvTWV0YWRhdGFNZW51U2V0dGluZ1RhYi50cyIsICJzcmMvc3VnZ2VzdGVyL0ZvbGRlclN1Z2dlc3Rlci50cyIsICJzcmMvc2V0dGluZ3MvRmlsZUNsYXNzUXVlcnlTZXR0aW5nTW9kYWwudHMiLCAic3JjL3NldHRpbmdzL0ZpbGVDbGFzc1F1ZXJ5U2V0dGluZy50cyIsICJzcmMvc2V0dGluZ3MvbWlncmF0ZVNldHRpbmcudHMiLCAic3JjL3N1Z2dlc3Rlci9tZXRhZGF0YVN1Z2dlc3Rlci50cyIsICJzcmMvY29tcG9uZW50cy9GaWxlVGFza01hbmFnZXIudHMiLCAibm9kZV9tb2R1bGVzL3V1aWQvZGlzdC9lc20tYnJvd3Nlci9ybmcuanMiLCAibm9kZV9tb2R1bGVzL3V1aWQvZGlzdC9lc20tYnJvd3Nlci9zdHJpbmdpZnkuanMiLCAibm9kZV9tb2R1bGVzL3V1aWQvZGlzdC9lc20tYnJvd3Nlci9uYXRpdmUuanMiLCAibm9kZV9tb2R1bGVzL3V1aWQvZGlzdC9lc20tYnJvd3Nlci92NC5qcyJdLAogICJzb3VyY2VzQ29udGVudCI6IFsiaW1wb3J0IHsgRmlsZVZpZXcsIE1hcmtkb3duVmlldywgTm90aWNlLCBQbHVnaW4sIFRGaWxlLCBWaWV3IH0gZnJvbSAnb2JzaWRpYW4nO1xuaW1wb3J0IEZpZWxkIGZyb20gJ3NyYy9maWVsZHMvRmllbGQnO1xuaW1wb3J0IEZpZWxkSW5kZXggZnJvbSAnc3JjL2NvbXBvbmVudHMvRmllbGRJbmRleCc7XG5pbXBvcnQgeyBGaWxlQ2xhc3MgfSBmcm9tICdzcmMvZmlsZUNsYXNzL2ZpbGVDbGFzcyc7XG5pbXBvcnQgeyBGaWxlQ2xhc3NBdHRyaWJ1dGVNb2RhbCB9IGZyb20gJ3NyYy9maWxlQ2xhc3MvRmlsZUNsYXNzQXR0cmlidXRlTW9kYWwnO1xuaW1wb3J0IEZpbGVDbGFzc1F1ZXJ5IGZyb20gJ3NyYy9maWxlQ2xhc3MvRmlsZUNsYXNzUXVlcnknO1xuaW1wb3J0IHR5cGUgeyBJTWV0YWRhdGFNZW51QXBpIH0gZnJvbSAnc3JjL01ldGFkYXRhTWVudUFwaSc7XG5pbXBvcnQgeyBNZXRhZGF0YU1lbnVBcGkgfSBmcm9tICdzcmMvTWV0YWRhdGFNZW51QXBpJztcbmltcG9ydCBGaWVsZENvbW1hbmRTdWdnZXN0TW9kYWwgZnJvbSAnc3JjL29wdGlvbnMvRmllbGRDb21tYW5kU3VnZ2VzdE1vZGFsJztcbmltcG9ydCBGaWxlQ2xhc3NPcHRpb25zTGlzdCBmcm9tICdzcmMvb3B0aW9ucy9GaWxlQ2xhc3NPcHRpb25zTGlzdCc7XG5pbXBvcnQgbGlua0NvbnRleHRNZW51IGZyb20gXCJzcmMvb3B0aW9ucy9saW5rQ29udGV4dE1lbnVcIjtcbmltcG9ydCBPcHRpb25zTGlzdCBmcm9tICdzcmMvb3B0aW9ucy9PcHRpb25zTGlzdCc7XG5pbXBvcnQgeyBERUZBVUxUX1NFVFRJTkdTLCBNZXRhZGF0YU1lbnVTZXR0aW5ncyB9IGZyb20gXCJzcmMvc2V0dGluZ3MvTWV0YWRhdGFNZW51U2V0dGluZ3NcIjtcbmltcG9ydCBNZXRhZGF0YU1lbnVTZXR0aW5nVGFiIGZyb20gXCJzcmMvc2V0dGluZ3MvTWV0YWRhdGFNZW51U2V0dGluZ1RhYlwiO1xuaW1wb3J0ICogYXMgU2V0dGluZ3NNaWdyYXRpb24gZnJvbSAnc3JjL3NldHRpbmdzL21pZ3JhdGVTZXR0aW5nJztcbmltcG9ydCBWYWx1ZVN1Z2dlc3QgZnJvbSBcInNyYy9zdWdnZXN0ZXIvbWV0YWRhdGFTdWdnZXN0ZXJcIjtcbmltcG9ydCB7IGZyb250TWF0dGVyTGluZUZpZWxkLCBnZXRMaW5lRmllbGRzIH0gZnJvbSAnc3JjL3V0aWxzL3BhcnNlcic7XG5pbXBvcnQgeyBGaWxlVGFza01hbmFnZXIgfSBmcm9tICdzcmMvY29tcG9uZW50cy9GaWxlVGFza01hbmFnZXInO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBNZXRhZGF0YU1lbnUgZXh0ZW5kcyBQbHVnaW4ge1xuXHRwdWJsaWMgYXBpOiBJTWV0YWRhdGFNZW51QXBpO1xuXHRwdWJsaWMgc2V0dGluZ3M6IE1ldGFkYXRhTWVudVNldHRpbmdzO1xuXHRwdWJsaWMgaW5pdGlhbFByb3BlcnRpZXM6IEFycmF5PEZpZWxkPiA9IFtdO1xuXHRwdWJsaWMgaW5pdGlhbEZpbGVDbGFzc1F1ZXJpZXM6IEFycmF5PEZpbGVDbGFzc1F1ZXJ5PiA9IFtdO1xuXHRwdWJsaWMgc2V0dGluZ1RhYjogTWV0YWRhdGFNZW51U2V0dGluZ1RhYjtcblx0cHVibGljIGZpZWxkSW5kZXg6IEZpZWxkSW5kZXg7XG5cdHB1YmxpYyBmaWxlVGFza01hbmFnZXI6IEZpbGVUYXNrTWFuYWdlclxuXG5cdGFzeW5jIG9ubG9hZCgpOiBQcm9taXNlPHZvaWQ+IHtcblx0XHRjb25zb2xlLmxvZygnTWV0YWRhdGEgTWVudSBsb2FkZWQnKTtcblx0XHRhd2FpdCB0aGlzLmxvYWRTZXR0aW5ncygpO1xuXHRcdGlmICh0aGlzLnNldHRpbmdzLnNldHRpbmdzVmVyc2lvbiA9PT0gdW5kZWZpbmVkKSBhd2FpdCBTZXR0aW5nc01pZ3JhdGlvbi5taWdyYXRlU2V0dGluZ3NWMXRvVjIodGhpcylcblx0XHRpZiAodGhpcy5zZXR0aW5ncy5zZXR0aW5nc1ZlcnNpb24gPT09IDIpIGF3YWl0IFNldHRpbmdzTWlncmF0aW9uLm1pZ3JhdGVTZXR0aW5nc1YydG9WMyh0aGlzKVxuXG5cblx0XHR0aGlzLmZpZWxkSW5kZXggPSB0aGlzLmFkZENoaWxkKG5ldyBGaWVsZEluZGV4KHRoaXMsIFwiMVwiLCAoKSA9PiB7IH0pKVxuXHRcdHRoaXMuZmlsZVRhc2tNYW5hZ2VyID0gdGhpcy5hZGRDaGlsZChuZXcgRmlsZVRhc2tNYW5hZ2VyKHRoaXMsIFwiMVwiLCAoKSA9PiB7IH0pKVxuXG5cdFx0dGhpcy5zZXR0aW5ncy5wcmVzZXRGaWVsZHMuZm9yRWFjaChwcm9wID0+IHtcblx0XHRcdGNvbnN0IHByb3BlcnR5ID0gbmV3IEZpZWxkKCk7XG5cdFx0XHRPYmplY3QuYXNzaWduKHByb3BlcnR5LCBwcm9wKTtcblx0XHRcdHRoaXMuaW5pdGlhbFByb3BlcnRpZXMucHVzaChwcm9wZXJ0eSk7XG5cdFx0fSk7XG5cblx0XHR0aGlzLnNldHRpbmdzLmZpbGVDbGFzc1F1ZXJpZXMuZm9yRWFjaChxdWVyeSA9PiB7XG5cdFx0XHRjb25zdCBmaWxlQ2xhc3NRdWVyeSA9IG5ldyBGaWxlQ2xhc3NRdWVyeSgpO1xuXHRcdFx0T2JqZWN0LmFzc2lnbihmaWxlQ2xhc3NRdWVyeSwgcXVlcnkpO1xuXHRcdFx0dGhpcy5pbml0aWFsRmlsZUNsYXNzUXVlcmllcy5wdXNoKGZpbGVDbGFzc1F1ZXJ5KTtcblx0XHR9KVxuXG5cdFx0dGhpcy5hZGRTZXR0aW5nVGFiKG5ldyBNZXRhZGF0YU1lbnVTZXR0aW5nVGFiKHRoaXMpKTtcblxuXHRcdHRoaXMucmVnaXN0ZXJFZGl0b3JTdWdnZXN0KG5ldyBWYWx1ZVN1Z2dlc3QodGhpcykpO1xuXHRcdHRoaXMuYXBpID0gbmV3IE1ldGFkYXRhTWVudUFwaSh0aGlzKS5tYWtlKCk7XG5cblx0XHR0aGlzLnJlZ2lzdGVyRXZlbnQoXG5cdFx0XHR0aGlzLmFwcC53b3Jrc3BhY2Uub24oJ2FjdGl2ZS1sZWFmLWNoYW5nZScsIChsZWFmKSA9PiB7XG5cdFx0XHRcdGNvbnN0IHZpZXcgPSBsZWFmPy52aWV3XG5cdFx0XHRcdHRoaXMuYWRkQ29tbWFuZHModmlldylcblx0XHRcdH0pXG5cdFx0KVxuXG5cdFx0dGhpcy5hZGRDb21tYW5kcyh0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlVmlld09mVHlwZShNYXJrZG93blZpZXcpKVxuXG5cdFx0bmV3IGxpbmtDb250ZXh0TWVudSh0aGlzKTtcblx0fTtcblxuXHRwcml2YXRlIGFkZEZpbGVDbGFzc0F0dHJpYnV0ZU9wdGlvbnMoKSB7XG5cdFx0dGhpcy5hZGRDb21tYW5kKHtcblx0XHRcdGlkOiBcImZpbGVDbGFzc0F0dHJfb3B0aW9uc1wiLFxuXHRcdFx0bmFtZTogXCJmaWxlQ2xhc3MgYXR0cmlidXRlcyBvcHRpb25zXCIsXG5cdFx0XHRpY29uOiBcImdlYXJcIixcblx0XHRcdGNoZWNrQ2FsbGJhY2s6IChjaGVja2luZzogYm9vbGVhbikgPT4ge1xuXHRcdFx0XHRjb25zdCB2aWV3ID0gdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZVZpZXdPZlR5cGUoTWFya2Rvd25WaWV3KVxuXHRcdFx0XHRpZiAoY2hlY2tpbmcpIHtcblx0XHRcdFx0XHRyZXR1cm4gISEodmlldz8uZmlsZSkgJiYgYCR7dmlldy5maWxlLnBhcmVudC5wYXRofS9gID09IHRoaXMuc2V0dGluZ3MuY2xhc3NGaWxlc1BhdGhcblx0XHRcdFx0fVxuXHRcdFx0XHRjb25zdCBmaWVsZENvbW1hbmRTdWdnZXN0TW9kYWwgPSBuZXcgRmllbGRDb21tYW5kU3VnZ2VzdE1vZGFsKHRoaXMuYXBwKVxuXHRcdFx0XHRjb25zdCBvcHRpb25zTGlzdCA9IG5ldyBGaWxlQ2xhc3NPcHRpb25zTGlzdCh0aGlzLCB2aWV3IS5maWxlLCBmaWVsZENvbW1hbmRTdWdnZXN0TW9kYWwpO1xuXHRcdFx0XHRvcHRpb25zTGlzdC5jcmVhdGVFeHRyYU9wdGlvbkxpc3QoKTtcblx0XHRcdH0sXG5cdFx0fSk7XG5cdH1cblxuXHRwcml2YXRlIGFkZEluc2VydEZpbGVDbGFzc0F0dHJpYnV0ZSgpIHtcblx0XHR0aGlzLmFkZENvbW1hbmQoe1xuXHRcdFx0aWQ6IFwiaW5zZXJ0X2ZpbGVDbGFzc0F0dHJcIixcblx0XHRcdG5hbWU6IFwiSW5zZXJ0IGEgbmV3IGZpbGVDbGFzcyBhdHRyaWJ1dGVcIixcblx0XHRcdGljb246IFwibGlzdC1wbHVzXCIsXG5cdFx0XHRjaGVja0NhbGxiYWNrOiAoY2hlY2tpbmc6IGJvb2xlYW4pID0+IHtcblx0XHRcdFx0Y29uc3QgdmlldyA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVWaWV3T2ZUeXBlKE1hcmtkb3duVmlldylcblx0XHRcdFx0aWYgKGNoZWNraW5nKSB7XG5cdFx0XHRcdFx0cmV0dXJuICEhKHZpZXc/LmZpbGUpICYmIGAke3ZpZXcuZmlsZS5wYXJlbnQucGF0aH0vYCA9PSB0aGlzLnNldHRpbmdzLmNsYXNzRmlsZXNQYXRoXG5cdFx0XHRcdH1cblx0XHRcdFx0dHJ5IHtcblx0XHRcdFx0XHRjb25zdCBmaWxlQ2xhc3NBdHRyaWJ1dGVNb2RhbCA9IG5ldyBGaWxlQ2xhc3NBdHRyaWJ1dGVNb2RhbCh0aGlzLCBGaWxlQ2xhc3MuY3JlYXRlRmlsZUNsYXNzKHRoaXMsIHZpZXchLmZpbGUuYmFzZW5hbWUpKVxuXHRcdFx0XHRcdGZpbGVDbGFzc0F0dHJpYnV0ZU1vZGFsLm9wZW4oKVxuXHRcdFx0XHR9IGNhdGNoIChlcnJvcikge1xuXHRcdFx0XHRcdG5ldyBOb3RpY2UoXCJUaGlzIGlzIG5vdCBhIHZhbGlkIGZpbGVDbGFzc1wiKVxuXHRcdFx0XHR9XG5cdFx0XHR9LFxuXHRcdH0pO1xuXHR9XG5cblx0cHJpdmF0ZSBhZGRJbnNlcnRGaWVsZEF0UG9zaXRpb25Db21tYW5kKCkge1xuXHRcdHRoaXMuYWRkQ29tbWFuZCh7XG5cdFx0XHRpZDogXCJpbnNlcnRfZmllbGRfYXRfY3Vyc29yXCIsXG5cdFx0XHRuYW1lOiBcImluc2VydCBmaWVsZCBhdCBjdXJzb3JcIixcblx0XHRcdGljb246IFwibGlzdC1wbHVzXCIsXG5cdFx0XHRjaGVja0NhbGxiYWNrOiAoY2hlY2tpbmc6IGJvb2xlYW4pID0+IHtcblx0XHRcdFx0Y29uc3QgdmlldyA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVWaWV3T2ZUeXBlKE1hcmtkb3duVmlldylcblx0XHRcdFx0aWYgKGNoZWNraW5nKSB7XG5cdFx0XHRcdFx0cmV0dXJuICEhKHZpZXc/LmZpbGUgJiYgdmlldy5maWxlLnBhcmVudC5wYXRoICsgXCIvXCIgIT09IHRoaXMuc2V0dGluZ3MuY2xhc3NGaWxlc1BhdGgpXG5cdFx0XHRcdH1cblx0XHRcdFx0Y29uc3Qgb3B0aW9uc0xpc3QgPSBuZXcgT3B0aW9uc0xpc3QodGhpcywgdmlldyEuZmlsZSwgXCJJbnNlcnRGaWVsZENvbW1hbmRcIik7XG5cdFx0XHRcdG9wdGlvbnNMaXN0LmNyZWF0ZUV4dHJhT3B0aW9uTGlzdCgpO1xuXHRcdFx0fVxuXHRcdH0pXG5cdH1cblxuXHRwcml2YXRlIGFkZEZpZWxkQ29tbWFuZCgpIHtcblx0XHR0aGlzLmFkZENvbW1hbmQoe1xuXHRcdFx0aWQ6IFwiZmllbGRfb3B0aW9uc1wiLFxuXHRcdFx0bmFtZTogXCJmaWVsZCBvcHRpb25zXCIsXG5cdFx0XHRpY29uOiBcImdlYXJcIixcblx0XHRcdGNoZWNrQ2FsbGJhY2s6IChjaGVja2luZzogYm9vbGVhbikgPT4ge1xuXHRcdFx0XHRjb25zdCB2aWV3ID0gdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZVZpZXdPZlR5cGUoTWFya2Rvd25WaWV3KVxuXHRcdFx0XHRpZiAoY2hlY2tpbmcpIHtcblx0XHRcdFx0XHRyZXR1cm4gISEodmlldz8uZmlsZSAmJiB2aWV3LmZpbGUucGFyZW50LnBhdGggKyBcIi9cIiAhPT0gdGhpcy5zZXR0aW5ncy5jbGFzc0ZpbGVzUGF0aClcblx0XHRcdFx0fVxuXHRcdFx0XHRjb25zdCBmaWVsZENvbW1hbmRTdWdnZXN0TW9kYWwgPSBuZXcgRmllbGRDb21tYW5kU3VnZ2VzdE1vZGFsKHRoaXMuYXBwKVxuXHRcdFx0XHRjb25zdCBvcHRpb25zTGlzdCA9IG5ldyBPcHRpb25zTGlzdCh0aGlzLCB2aWV3IS5maWxlLCBmaWVsZENvbW1hbmRTdWdnZXN0TW9kYWwpO1xuXHRcdFx0XHRvcHRpb25zTGlzdC5jcmVhdGVFeHRyYU9wdGlvbkxpc3QoKTtcblx0XHRcdH0sXG5cdFx0fSk7XG5cdH1cblxuXHRwcml2YXRlIGFkZE1hbmFnZUZpZWxkQXRDdXJzb3JDb21tYW5kKCkge1xuXHRcdHRoaXMuYWRkQ29tbWFuZCh7XG5cdFx0XHRpZDogXCJmaWVsZF9hdF9jdXJzb3Jfb3B0aW9uc1wiLFxuXHRcdFx0bmFtZTogXCJNYW5hZ2UgZmllbGQgYXQgY3Vyc29yXCIsXG5cdFx0XHRpY29uOiBcInRleHQtY3Vyc29yLWlucHV0XCIsXG5cdFx0XHRjaGVja0NhbGxiYWNrOiAoY2hlY2tpbmc6IGJvb2xlYW4pID0+IHtcblx0XHRcdFx0Y29uc3QgdmlldyA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVWaWV3T2ZUeXBlKE1hcmtkb3duVmlldyk7XG5cdFx0XHRcdGNvbnN0IGVkaXRvciA9IHZpZXc/LmVkaXRvcjtcblx0XHRcdFx0aWYgKGNoZWNraW5nKSB7XG5cdFx0XHRcdFx0Y29uc3QgaW5GaWxlID0gISEodmlldz8uZmlsZSAmJiB2aWV3LmZpbGUucGFyZW50LnBhdGggKyBcIi9cIiAhPT0gdGhpcy5zZXR0aW5ncy5jbGFzc0ZpbGVzUGF0aClcblx0XHRcdFx0XHRyZXR1cm4gaW5GaWxlICYmIGVkaXRvciAhPT0gdW5kZWZpbmVkXG5cdFx0XHRcdH1cblx0XHRcdFx0Y29uc3Qgb3B0aW9uc0xpc3QgPSBuZXcgT3B0aW9uc0xpc3QodGhpcywgdmlldyEuZmlsZSwgXCJNYW5hZ2VBdEN1cnNvckNvbW1hbmRcIilcblx0XHRcdFx0Y29uc3QgZnJvbnRtYXR0ZXIgPSB0aGlzLmFwcC5tZXRhZGF0YUNhY2hlLmdldEZpbGVDYWNoZSh2aWV3IS5maWxlKT8uZnJvbnRtYXR0ZXI7XG5cdFx0XHRcdGlmIChmcm9udG1hdHRlciAmJiBlZGl0b3Jcblx0XHRcdFx0XHQmJiBlZGl0b3IuZ2V0Q3Vyc29yKCkubGluZSA+IGZyb250bWF0dGVyLnBvc2l0aW9uLnN0YXJ0LmxpbmVcblx0XHRcdFx0XHQmJiBlZGl0b3IuZ2V0Q3Vyc29yKCkubGluZSA8IGZyb250bWF0dGVyLnBvc2l0aW9uLmVuZC5saW5lKSB7XG5cdFx0XHRcdFx0Y29uc3QgYXR0cmlidXRlID0gZnJvbnRNYXR0ZXJMaW5lRmllbGQoZWRpdG9yLmdldExpbmUoZWRpdG9yLmdldEN1cnNvcigpLmxpbmUpKVxuXHRcdFx0XHRcdGlmIChhdHRyaWJ1dGUpIG9wdGlvbnNMaXN0LmNyZWF0ZUFuZE9wZW5GaWVsZE1vZGFsKGF0dHJpYnV0ZSlcblx0XHRcdFx0fSBlbHNlIGlmIChlZGl0b3IpIHtcblx0XHRcdFx0XHRjb25zdCB7IGF0dHJpYnV0ZSwgdmFsdWVzIH0gPSBnZXRMaW5lRmllbGRzKGVkaXRvci5nZXRMaW5lKGVkaXRvci5nZXRDdXJzb3IoKS5saW5lKSkuZmluZChmaWVsZCA9PlxuXHRcdFx0XHRcdFx0ZWRpdG9yLmdldEN1cnNvcigpLmNoIDw9IGZpZWxkLmluZGV4ICsgZmllbGQubGVuZ3RoXG5cdFx0XHRcdFx0XHQmJiBlZGl0b3IuZ2V0Q3Vyc29yKCkuY2ggPj0gZmllbGQuaW5kZXgpIHx8IHt9O1xuXHRcdFx0XHRcdGlmIChhdHRyaWJ1dGUpIG9wdGlvbnNMaXN0LmNyZWF0ZUFuZE9wZW5GaWVsZE1vZGFsKGF0dHJpYnV0ZSlcblx0XHRcdFx0fVxuXHRcdFx0fVxuXG5cdFx0fSlcblx0fVxuXG5cdHByaXZhdGUgYWRkVXBkYXRlTG9va3VwcygpIHtcblx0XHR0aGlzLmFkZENvbW1hbmQoe1xuXHRcdFx0aWQ6IFwidXBkYXRlX2xvb2t1cHNcIixcblx0XHRcdG5hbWU6IFwiVXBkYXRlIGxvb2t1cCBmaWVsZHNcIixcblx0XHRcdGljb246IFwiZmlsZS1zZWFyY2hcIixcblx0XHRcdGNoZWNrQ2FsbGJhY2s6IChjaGVja2luZzogYm9vbGVhbikgPT4ge1xuXHRcdFx0XHRpZiAoY2hlY2tpbmcpIHJldHVybiB0cnVlO1xuXHRcdFx0XHR0aGlzLmZpZWxkSW5kZXguZnVsbEluZGV4KFwiY29tbWFuZFwiLCB0cnVlKTtcblx0XHRcdH1cblx0XHR9KVxuXHR9XG5cblx0cHJpdmF0ZSBhZGRDb21tYW5kcyh2aWV3OiBWaWV3IHwgdW5kZWZpbmVkIHwgbnVsbCkge1xuXHRcdGlmICh2aWV3ICYmIHZpZXcgaW5zdGFuY2VvZiBGaWxlVmlldykge1xuXHRcdFx0Y29uc3QgZmlsZSA9IHRoaXMuYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aCh2aWV3LmZpbGUucGF0aClcblx0XHRcdGlmIChmaWxlIGluc3RhbmNlb2YgVEZpbGUgJiYgZmlsZS5leHRlbnNpb24gPT09ICdtZCcpIHtcblx0XHRcdFx0aWYgKGZpbGUucGFyZW50LnBhdGggKyBcIi9cIiA9PSB0aGlzLnNldHRpbmdzLmNsYXNzRmlsZXNQYXRoKSB7XG5cdFx0XHRcdFx0dGhpcy5hZGRGaWxlQ2xhc3NBdHRyaWJ1dGVPcHRpb25zKCk7XG5cdFx0XHRcdFx0dGhpcy5hZGRJbnNlcnRGaWxlQ2xhc3NBdHRyaWJ1dGUoKTtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHR0aGlzLmFkZEZpZWxkQ29tbWFuZCgpO1xuXHRcdFx0XHRcdHRoaXMuYWRkSW5zZXJ0RmllbGRBdFBvc2l0aW9uQ29tbWFuZCgpO1xuXHRcdFx0XHRcdHRoaXMuYWRkTWFuYWdlRmllbGRBdEN1cnNvckNvbW1hbmQoKVxuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXHRcdHRoaXMuYWRkVXBkYXRlTG9va3VwcygpXG5cdH1cblxuXHRhc3luYyBsb2FkU2V0dGluZ3MoKSB7XG5cdFx0dGhpcy5zZXR0aW5ncyA9IE9iamVjdC5hc3NpZ24oe30sIERFRkFVTFRfU0VUVElOR1MsIGF3YWl0IHRoaXMubG9hZERhdGEoKSk7XG5cdH07XG5cblxuXHRhc3luYyBzYXZlU2V0dGluZ3MoKSB7XG5cdFx0dGhpcy5zZXR0aW5ncy5wcmVzZXRGaWVsZHMgPSB0aGlzLmluaXRpYWxQcm9wZXJ0aWVzO1xuXHRcdHRoaXMuc2V0dGluZ3MuZmlsZUNsYXNzUXVlcmllcyA9IHRoaXMuaW5pdGlhbEZpbGVDbGFzc1F1ZXJpZXM7XG5cdFx0YXdhaXQgdGhpcy5zYXZlRGF0YSh0aGlzLnNldHRpbmdzKTtcblx0XHRhd2FpdCB0aGlzLmZpZWxkSW5kZXguZnVsbEluZGV4KFwic2V0dGluZ1wiLCB0cnVlKTtcblx0fTtcblxuXHRvbnVubG9hZCgpIHtcblx0XHRjb25zb2xlLmxvZygnTWV0YWRhdGEgTWVudSB1bmxvYWRlZCcpO1xuXHR9O1xufVxuIiwgImltcG9ydCBNZXRhZGF0YU1lbnUgZnJvbSBcIm1haW5cIjtcbmltcG9ydCB7IE1lbnUsIHNldEljb24sIFRleHRBcmVhQ29tcG9uZW50LCBURmlsZSB9IGZyb20gXCJvYnNpZGlhblwiO1xuaW1wb3J0IEZpZWxkQ29tbWFuZFN1Z2dlc3RNb2RhbCBmcm9tIFwic3JjL29wdGlvbnMvRmllbGRDb21tYW5kU3VnZ2VzdE1vZGFsXCI7XG5pbXBvcnQgSW5wdXRNb2RhbCBmcm9tIFwic3JjL29wdGlvbk1vZGFscy9maWVsZHMvSW5wdXRNb2RhbFwiO1xuaW1wb3J0IHsgRmllbGRJY29uLCBGaWVsZFR5cGUgfSBmcm9tIFwic3JjL3R5cGVzL2ZpZWxkVHlwZXNcIjtcbmltcG9ydCBGaWVsZCBmcm9tIFwiLi4vRmllbGRcIjtcbmltcG9ydCB7IEZpZWxkTWFuYWdlciB9IGZyb20gXCIuLi9GaWVsZE1hbmFnZXJcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgSW5wdXRGaWVsZCBleHRlbmRzIEZpZWxkTWFuYWdlciB7XG5cbiAgICBjb25zdHJ1Y3RvcihwbHVnaW46IE1ldGFkYXRhTWVudSwgZmllbGQ6IEZpZWxkKSB7XG4gICAgICAgIHN1cGVyKHBsdWdpbiwgZmllbGQsIEZpZWxkVHlwZS5JbnB1dClcbiAgICB9XG5cbiAgICBwdWJsaWMgZ2V0T3B0aW9uc1N0cigpOiBzdHJpbmcge1xuICAgICAgICByZXR1cm4gdGhpcy5maWVsZC5vcHRpb25zLnRlbXBsYXRlXG4gICAgfVxuXG4gICAgcHVibGljIGFkZEZpZWxkT3B0aW9uKG5hbWU6IHN0cmluZywgdmFsdWU6IHN0cmluZywgZmlsZTogVEZpbGUsIGxvY2F0aW9uOiBNZW51IHwgRmllbGRDb21tYW5kU3VnZ2VzdE1vZGFsKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IG1vZGFsID0gbmV3IElucHV0TW9kYWwodGhpcy5wbHVnaW4sIGZpbGUsIHRoaXMuZmllbGQsIHZhbHVlKTtcbiAgICAgICAgbW9kYWwudGl0bGVFbC5zZXRUZXh0KGBDaGFuZ2UgVmFsdWUgZm9yIDwke25hbWV9PmApO1xuICAgICAgICBpZiAoSW5wdXRGaWVsZC5pc01lbnUobG9jYXRpb24pKSB7XG4gICAgICAgICAgICBsb2NhdGlvbi5hZGRJdGVtKChpdGVtKSA9PiB7XG4gICAgICAgICAgICAgICAgaXRlbS5zZXRUaXRsZShgVXBkYXRlIDwke25hbWV9PmApO1xuICAgICAgICAgICAgICAgIGl0ZW0uc2V0SWNvbihGaWVsZEljb25bRmllbGRUeXBlLklucHV0XSk7XG4gICAgICAgICAgICAgICAgaXRlbS5vbkNsaWNrKCgpID0+IG1vZGFsLm9wZW4oKSk7XG4gICAgICAgICAgICAgICAgaXRlbS5zZXRTZWN0aW9uKFwibWV0YWRhdGEtbWVudS5maWVsZHNcIik7XG4gICAgICAgICAgICB9KVxuICAgICAgICB9IGVsc2UgaWYgKElucHV0RmllbGQuaXNTdWdnZXN0KGxvY2F0aW9uKSkge1xuICAgICAgICAgICAgbG9jYXRpb24ub3B0aW9ucy5wdXNoKHtcbiAgICAgICAgICAgICAgICBpZDogYHVwZGF0ZV8ke25hbWV9YCxcbiAgICAgICAgICAgICAgICBhY3Rpb25MYWJlbDogYDxzcGFuPlVwZGF0ZSA8Yj4ke25hbWV9PC9iPjwvc3Bhbj5gLFxuICAgICAgICAgICAgICAgIGFjdGlvbjogKCkgPT4gbW9kYWwub3BlbigpLFxuICAgICAgICAgICAgICAgIGljb246IEZpZWxkSWNvbltGaWVsZFR5cGUuSW5wdXRdXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcbiAgICB9O1xuXG4gICAgcHVibGljIGNyZWF0ZVNldHRpbmdDb250YWluZXIocGFyZW50Q29udGFpbmVyOiBIVE1MRGl2RWxlbWVudCwgcGx1Z2luOiBNZXRhZGF0YU1lbnUpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgdGVtcGxhdGVDb250YWluZXIgPSBwYXJlbnRDb250YWluZXIuY3JlYXRlRGl2KCk7XG4gICAgICAgIHRlbXBsYXRlQ29udGFpbmVyLmNyZWF0ZUVsKFwic3BhblwiLCB7IHRleHQ6IFwiVGVtcGxhdGVcIiwgY2xzOiAnbWV0YWRhdGEtbWVudS1maWVsZC1vcHRpb24nIH0pXG4gICAgICAgIGNvbnN0IHRlbXBsYXRlVmFsdWUgPSBuZXcgVGV4dEFyZWFDb21wb25lbnQodGVtcGxhdGVDb250YWluZXIpXG4gICAgICAgIHRlbXBsYXRlVmFsdWUuaW5wdXRFbC5jb2xzID0gNTA7XG4gICAgICAgIHRlbXBsYXRlVmFsdWUuaW5wdXRFbC5yb3dzID0gNDtcbiAgICAgICAgdGVtcGxhdGVWYWx1ZS5zZXRWYWx1ZSh0aGlzLmZpZWxkLm9wdGlvbnMudGVtcGxhdGUgfHwgXCJcIilcbiAgICAgICAgdGVtcGxhdGVWYWx1ZS5vbkNoYW5nZSgodmFsdWU6IHN0cmluZykgPT4ge1xuICAgICAgICAgICAgdGhpcy5maWVsZC5vcHRpb25zLnRlbXBsYXRlID0gdmFsdWU7XG5cbiAgICAgICAgfSlcbiAgICB9XG5cbiAgICBwdWJsaWMgdmFsaWRhdGVPcHRpb25zKCk6IGJvb2xlYW4ge1xuICAgICAgICAvL2Fsd2F5cyB0cnVlIHNpbmNlIHRoZXJlIGFyZSBubyBvcHRpb25zXG4gICAgICAgIHJldHVybiB0cnVlXG4gICAgfVxuXG4gICAgcHVibGljIGNyZWF0ZUFuZE9wZW5GaWVsZE1vZGFsKGZpbGU6IFRGaWxlLCBzZWxlY3RlZEZpZWxkTmFtZTogc3RyaW5nLCB2YWx1ZT86IHN0cmluZywgbGluZU51bWJlcj86IG51bWJlciwgaW5Gcm9udG1hdHRlcj86IGJvb2xlYW4sIGFmdGVyPzogYm9vbGVhbik6IHZvaWQge1xuICAgICAgICBjb25zdCBmaWVsZE1vZGFsID0gbmV3IElucHV0TW9kYWwodGhpcy5wbHVnaW4sIGZpbGUsIHRoaXMuZmllbGQsIHZhbHVlIHx8IFwiXCIsIGxpbmVOdW1iZXIsIGluRnJvbnRtYXR0ZXIsIGFmdGVyKTtcbiAgICAgICAgZmllbGRNb2RhbC50aXRsZUVsLnNldFRleHQoYEVudGVyIHZhbHVlIGZvciAke3NlbGVjdGVkRmllbGROYW1lfWApO1xuICAgICAgICBmaWVsZE1vZGFsLm9wZW4oKTtcbiAgICB9XG5cbiAgICBwdWJsaWMgY3JlYXRlRHZGaWVsZChcbiAgICAgICAgZHY6IGFueSxcbiAgICAgICAgcDogYW55LFxuICAgICAgICBmaWVsZENvbnRhaW5lcjogSFRNTEVsZW1lbnQsXG4gICAgICAgIGF0dHJzPzogeyBjbHM/OiBzdHJpbmcsIGF0dHI/OiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+LCBvcHRpb25zPzogUmVjb3JkPHN0cmluZywgc3RyaW5nPiB9XG4gICAgKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IGZpZWxkVmFsdWUgPSBkdi5lbCgnc3BhbicsIHBbdGhpcy5maWVsZC5uYW1lXSwgYXR0cnMpXG4gICAgICAgIGNvbnN0IGlucHV0Q29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKVxuICAgICAgICBjb25zdCBpbnB1dCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJpbnB1dFwiKVxuICAgICAgICBpbnB1dC5zZXRBdHRyKFwiY2xhc3NcIiwgXCJtZXRhZGF0YS1tZW51LWR2LWlucHV0XCIpXG4gICAgICAgIGlucHV0Q29udGFpbmVyLmFwcGVuZENoaWxkKGlucHV0KVxuICAgICAgICBpbnB1dC52YWx1ZSA9IHBbdGhpcy5maWVsZC5uYW1lXVxuICAgICAgICAvKiBlbmQgc3BhY2VyICovXG4gICAgICAgIGNvbnN0IHNwYWNlciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIilcbiAgICAgICAgc3BhY2VyLnNldEF0dHIoXCJjbGFzc1wiLCBcIm1ldGFkYXRhLW1lbnUtZHYtZmllbGQtc3BhY2VyXCIpXG4gICAgICAgIC8qIGJ1dHRvbiB0byBkaXNwbGF5IGlucHV0ICovXG4gICAgICAgIGNvbnN0IGJ1dHRvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJidXR0b25cIilcbiAgICAgICAgc2V0SWNvbihidXR0b24sIEZpZWxkSWNvbltGaWVsZFR5cGUuSW5wdXRdKVxuICAgICAgICBidXR0b24uc2V0QXR0cignY2xhc3MnLCBcIm1ldGFkYXRhLW1lbnUtZHYtZmllbGQtYnV0dG9uXCIpXG4gICAgICAgIGlmICghYXR0cnM/Lm9wdGlvbnM/LmFsd2F5c09uKSB7XG4gICAgICAgICAgICBidXR0b24uaGlkZSgpXG4gICAgICAgICAgICBzcGFjZXIuc2hvdygpXG4gICAgICAgICAgICBmaWVsZENvbnRhaW5lci5vbm1vdXNlb3ZlciA9ICgpID0+IHtcbiAgICAgICAgICAgICAgICBidXR0b24uc2hvdygpXG4gICAgICAgICAgICAgICAgc3BhY2VyLmhpZGUoKVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZmllbGRDb250YWluZXIub25tb3VzZW91dCA9ICgpID0+IHtcbiAgICAgICAgICAgICAgICBidXR0b24uaGlkZSgpXG4gICAgICAgICAgICAgICAgc3BhY2VyLnNob3coKVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgdmFsaWRhdGVJY29uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImJ1dHRvblwiKVxuICAgICAgICBzZXRJY29uKHZhbGlkYXRlSWNvbiwgXCJjaGVja21hcmtcIilcbiAgICAgICAgdmFsaWRhdGVJY29uLnNldEF0dHIoXCJjbGFzc1wiLCBcIm1ldGFkYXRhLW1lbnUtZHYtZmllbGQtYnV0dG9uXCIpXG4gICAgICAgIHZhbGlkYXRlSWNvbi5vbmNsaWNrID0gKGUpID0+IHtcbiAgICAgICAgICAgIElucHV0RmllbGQucmVwbGFjZVZhbHVlcyh0aGlzLnBsdWdpbiwgcC5maWxlLnBhdGgsIHRoaXMuZmllbGQubmFtZSwgaW5wdXQudmFsdWUpO1xuICAgICAgICAgICAgZmllbGRDb250YWluZXIucmVtb3ZlQ2hpbGQoaW5wdXRDb250YWluZXIpXG4gICAgICAgIH1cbiAgICAgICAgaW5wdXRDb250YWluZXI/LmFwcGVuZENoaWxkKHZhbGlkYXRlSWNvbilcbiAgICAgICAgY29uc3QgY2FuY2VsSWNvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJidXR0b25cIilcbiAgICAgICAgY2FuY2VsSWNvbi5zZXRBdHRyKFwiY2xhc3NcIiwgXCJtZXRhZGF0YS1tZW51LWR2LWZpZWxkLWJ1dHRvblwiKVxuICAgICAgICBzZXRJY29uKGNhbmNlbEljb24sIFwiY3Jvc3NcIik7XG4gICAgICAgIGNhbmNlbEljb24ub25jbGljayA9IChlKSA9PiB7XG4gICAgICAgICAgICBmaWVsZENvbnRhaW5lci5yZW1vdmVDaGlsZChpbnB1dENvbnRhaW5lcilcbiAgICAgICAgICAgIGZpZWxkQ29udGFpbmVyLmFwcGVuZENoaWxkKGJ1dHRvbilcbiAgICAgICAgICAgIGZpZWxkQ29udGFpbmVyLmFwcGVuZENoaWxkKGZpZWxkVmFsdWUpXG4gICAgICAgICAgICBmaWVsZENvbnRhaW5lci5hcHBlbmRDaGlsZChzcGFjZXIpXG4gICAgICAgIH1cbiAgICAgICAgaW5wdXRDb250YWluZXIuYXBwZW5kQ2hpbGQoY2FuY2VsSWNvbilcbiAgICAgICAgaW5wdXQuZm9jdXMoKVxuXG4gICAgICAgIGlucHV0Lm9ua2V5ZG93biA9IChlKSA9PiB7XG4gICAgICAgICAgICBpZiAoZS5rZXkgPT09IFwiRW50ZXJcIikge1xuICAgICAgICAgICAgICAgIElucHV0RmllbGQucmVwbGFjZVZhbHVlcyh0aGlzLnBsdWdpbiwgcC5maWxlLnBhdGgsIHRoaXMuZmllbGQubmFtZSwgaW5wdXQudmFsdWUpO1xuICAgICAgICAgICAgICAgIGZpZWxkQ29udGFpbmVyLnJlbW92ZUNoaWxkKGlucHV0Q29udGFpbmVyKVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGUua2V5ID09PSAnRXNjYXBlJykge1xuICAgICAgICAgICAgICAgIGZpZWxkQ29udGFpbmVyLnJlbW92ZUNoaWxkKGlucHV0Q29udGFpbmVyKVxuICAgICAgICAgICAgICAgIGZpZWxkQ29udGFpbmVyLmFwcGVuZENoaWxkKGJ1dHRvbilcbiAgICAgICAgICAgICAgICBmaWVsZENvbnRhaW5lci5hcHBlbmRDaGlsZChmaWVsZFZhbHVlKVxuICAgICAgICAgICAgICAgIGZpZWxkQ29udGFpbmVyLmFwcGVuZENoaWxkKHNwYWNlcilcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICAvKiBidXR0b24gb24gY2xpY2sgOiByZW1vdmUgYnV0dG9uIGFuZCBmaWVsZCBhbmQgZGlzcGxheSBpbnB1dCBmaWVsZCovXG4gICAgICAgIGJ1dHRvbi5vbmNsaWNrID0gKGUpID0+IHtcbiAgICAgICAgICAgIGlmICh0aGlzLmZpZWxkLm9wdGlvbnMudGVtcGxhdGUpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBmaWxlID0gdGhpcy5wbHVnaW4uYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChwLmZpbGUucGF0aClcbiAgICAgICAgICAgICAgICBpZiAoZmlsZSBpbnN0YW5jZW9mIFRGaWxlICYmIGZpbGUuZXh0ZW5zaW9uID09PSAnbWQnKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGlucHV0TW9kYWwgPSBuZXcgSW5wdXRNb2RhbCh0aGlzLnBsdWdpbiwgZmlsZSwgdGhpcy5maWVsZCwgcFt0aGlzLmZpZWxkLm5hbWVdKTtcbiAgICAgICAgICAgICAgICAgICAgaW5wdXRNb2RhbC5vcGVuKCk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGZpZWxkQ29udGFpbmVyLnJlbW92ZUNoaWxkKGZpZWxkVmFsdWUpXG4gICAgICAgICAgICAgICAgZmllbGRDb250YWluZXIucmVtb3ZlQ2hpbGQoYnV0dG9uKVxuICAgICAgICAgICAgICAgIGZpZWxkQ29udGFpbmVyLnJlbW92ZUNoaWxkKHNwYWNlcilcbiAgICAgICAgICAgICAgICBmaWVsZENvbnRhaW5lci5hcHBlbmRDaGlsZChpbnB1dENvbnRhaW5lcilcbiAgICAgICAgICAgICAgICBpbnB1dC5mb2N1cygpXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgLyogaW5pdGlhbCBzdGF0ZSAqL1xuICAgICAgICBmaWVsZENvbnRhaW5lci5hcHBlbmRDaGlsZChidXR0b24pXG4gICAgICAgIGZpZWxkQ29udGFpbmVyLmFwcGVuZENoaWxkKGZpZWxkVmFsdWUpXG4gICAgICAgIGZpZWxkQ29udGFpbmVyLmFwcGVuZENoaWxkKHNwYWNlcilcbiAgICB9XG59IiwgImltcG9ydCBNZXRhZGF0YU1lbnUgZnJvbSBcIm1haW5cIjtcbmltcG9ydCB7IERyb3Bkb3duQ29tcG9uZW50LCBNb2RhbCwgc2V0SWNvbiwgVGV4dEFyZWFDb21wb25lbnQsIFRleHRDb21wb25lbnQsIFRGaWxlIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgeyBpbnNlcnRWYWx1ZXMgfSBmcm9tIFwic3JjL2NvbW1hbmRzL2luc2VydFZhbHVlc1wiO1xuaW1wb3J0IHsgcmVwbGFjZVZhbHVlcyB9IGZyb20gXCJzcmMvY29tbWFuZHMvcmVwbGFjZVZhbHVlc1wiO1xuaW1wb3J0IEZpZWxkIGZyb20gXCJzcmMvZmllbGRzL0ZpZWxkXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIElucHV0TW9kYWwgZXh0ZW5kcyBNb2RhbCB7XG4gICAgcHJpdmF0ZSB0ZW1wbGF0ZVZhbHVlczogUmVjb3JkPHN0cmluZywgc3RyaW5nPiA9IHt9O1xuICAgIHByaXZhdGUgcmVuZGVyZWRWYWx1ZTogVGV4dEFyZWFDb21wb25lbnQ7XG5cbiAgICBjb25zdHJ1Y3RvcihcbiAgICAgICAgcHJpdmF0ZSBwbHVnaW46IE1ldGFkYXRhTWVudSxcbiAgICAgICAgcHJpdmF0ZSBmaWxlOiBURmlsZSxcbiAgICAgICAgcHJpdmF0ZSBmaWVsZDogRmllbGQsXG4gICAgICAgIHByaXZhdGUgdmFsdWU6IHN0cmluZyxcbiAgICAgICAgcHJpdmF0ZSBsaW5lTnVtYmVyOiBudW1iZXIgPSAtMSxcbiAgICAgICAgcHJpdmF0ZSBpbkZyb250bWF0dGVyOiBib29sZWFuID0gZmFsc2UsXG4gICAgICAgIHByaXZhdGUgYWZ0ZXI6IGJvb2xlYW4gPSBmYWxzZVxuICAgICkgeyBzdXBlcihwbHVnaW4uYXBwKTsgfTtcblxuICAgIG9uT3BlbigpIHtcbiAgICAgICAgY29uc3QgaW5wdXREaXYgPSB0aGlzLmNvbnRlbnRFbC5jcmVhdGVEaXYoKTtcbiAgICAgICAgaWYgKHRoaXMuZmllbGQub3B0aW9ucy50ZW1wbGF0ZSkge1xuICAgICAgICAgICAgY29uc3QgdGVtcGxhdGVGaWVsZFJlZ2V4ID0gbmV3IFJlZ0V4cChgXFxcXHtcXFxceyg/PGZpZWxkPlteXFxcXH1dKz8pXFxcXH1cXFxcfWAsIFwiZ3VcIik7XG4gICAgICAgICAgICBjb25zdCB0RiA9IHRoaXMuZmllbGQub3B0aW9ucy50ZW1wbGF0ZS5tYXRjaEFsbCh0ZW1wbGF0ZUZpZWxkUmVnZXgpXG4gICAgICAgICAgICBsZXQgbmV4dCA9IHRGLm5leHQoKTtcbiAgICAgICAgICAgIHdoaWxlICghbmV4dC5kb25lKSB7XG4gICAgICAgICAgICAgICAgaWYgKG5leHQudmFsdWUuZ3JvdXBzKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHZhbHVlID0gbmV4dC52YWx1ZS5ncm91cHMuZmllbGRcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgW25hbWUsIG9wdGlvbnNTdHJpbmddID0gdmFsdWUuc3BsaXQoLzooLiopL3MpLm1hcCgodjogc3RyaW5nKSA9PiB2LnRyaW0oKSlcbiAgICAgICAgICAgICAgICAgICAgdGhpcy50ZW1wbGF0ZVZhbHVlc1tuYW1lXSA9IFwiXCI7XG4gICAgICAgICAgICAgICAgICAgIGlmIChvcHRpb25zU3RyaW5nKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBvcHRpb25zID0gSlNPTi5wYXJzZShvcHRpb25zU3RyaW5nKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYnVpbGRUZW1wbGF0ZVNlbGVjdEl0ZW0oaW5wdXREaXYsIG5hbWUsIG9wdGlvbnMpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5idWlsZFRlbXBsYXRlSW5wdXRJdGVtKGlucHV0RGl2LCBuYW1lKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBuZXh0ID0gdEYubmV4dCgpXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLmJ1aWxkUmVzdWx0UHJldmlldyhpbnB1dERpdik7XG4gICAgICAgICAgICB0aGlzLmJ1aWxkU2F2ZUJ0bihpbnB1dERpdik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLmJ1aWxkSW5wdXRFbChpbnB1dERpdik7XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgcHJpdmF0ZSByZW5kZXJWYWx1ZSgpIHtcbiAgICAgICAgbGV0IHJlbmRlcmVkU3RyaW5nID0gdGhpcy5maWVsZC5vcHRpb25zLnRlbXBsYXRlLnNsaWNlKClcbiAgICAgICAgT2JqZWN0LmtleXModGhpcy50ZW1wbGF0ZVZhbHVlcykuZm9yRWFjaChrID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGZpZWxkUmVnZXggPSBuZXcgUmVnRXhwKGBcXFxce1xcXFx7JHtrLnJlcGxhY2UoL1suKis/XiR7fSgpfFtcXF1cXFxcXS9nLCAnXFxcXCQmJyl9KDpbXlxcXFx9XSopP1xcXFx9XFxcXH1gLCBcInVcIilcbiAgICAgICAgICAgIHJlbmRlcmVkU3RyaW5nID0gcmVuZGVyZWRTdHJpbmcucmVwbGFjZShmaWVsZFJlZ2V4LCB0aGlzLnRlbXBsYXRlVmFsdWVzW2tdKVxuICAgICAgICB9KVxuXG4gICAgICAgIHRoaXMucmVuZGVyZWRWYWx1ZS5zZXRWYWx1ZShyZW5kZXJlZFN0cmluZylcbiAgICB9XG5cbiAgICBwcml2YXRlIGJ1aWxkVGVtcGxhdGVJbnB1dEl0ZW0oaW5wdXREaXY6IEhUTUxEaXZFbGVtZW50LCBuYW1lOiBzdHJpbmcpIHtcbiAgICAgICAgaW5wdXREaXYuY3JlYXRlRGl2KHsgdGV4dDogbmFtZSwgY2xzOiBcIm1ldGFkYXRhLW1lbnUtaW5wdXQtbGFiZWxcIiB9KTtcbiAgICAgICAgY29uc3QgaW5wdXRFbCA9IG5ldyBUZXh0Q29tcG9uZW50KGlucHV0RGl2KTtcbiAgICAgICAgaW5wdXRFbC5zZXRQbGFjZWhvbGRlcihgRW50ZXIgYSB2YWx1ZSBmb3IgJHtuYW1lfWApO1xuICAgICAgICBpbnB1dEVsLmlucHV0RWwuYWRkQ2xhc3MoXCJtZXRhZGF0YS1tZW51LXByb21wdC1pbnB1dFwiKTtcbiAgICAgICAgaW5wdXRFbC5vbkNoYW5nZSh2YWx1ZSA9PiB7XG4gICAgICAgICAgICB0aGlzLnRlbXBsYXRlVmFsdWVzW25hbWVdID0gdmFsdWU7XG4gICAgICAgICAgICB0aGlzLnJlbmRlclZhbHVlKCk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIHByaXZhdGUgYnVpbGRUZW1wbGF0ZVNlbGVjdEl0ZW0oaW5wdXREaXY6IEhUTUxEaXZFbGVtZW50LCBuYW1lOiBzdHJpbmcsIG9wdGlvbnM6IHN0cmluZ1tdKSB7XG4gICAgICAgIGlucHV0RGl2LmNyZWF0ZURpdih7IHRleHQ6IG5hbWUsIGNsczogXCJtZXRhZGF0YS1tZW51LWlucHV0LWxhYmVsXCIgfSk7XG4gICAgICAgIGNvbnN0IHNlbGVjdEVsID0gbmV3IERyb3Bkb3duQ29tcG9uZW50KGlucHV0RGl2KTtcbiAgICAgICAgc2VsZWN0RWwuYWRkT3B0aW9uKFwiXCIsIFwiLS1zZWxlY3QtLVwiKVxuICAgICAgICBvcHRpb25zLmZvckVhY2gobyA9PiBzZWxlY3RFbC5hZGRPcHRpb24obywgbykpO1xuICAgICAgICBzZWxlY3RFbC5vbkNoYW5nZSh2YWx1ZSA9PiB7XG4gICAgICAgICAgICB0aGlzLnRlbXBsYXRlVmFsdWVzW25hbWVdID0gdmFsdWU7XG4gICAgICAgICAgICB0aGlzLnJlbmRlclZhbHVlKCk7XG4gICAgICAgIH0pXG4gICAgfVxuXG4gICAgcHJpdmF0ZSBidWlsZFJlc3VsdFByZXZpZXcoaW5wdXREaXY6IEhUTUxEaXZFbGVtZW50KSB7XG4gICAgICAgIGlucHV0RGl2LmNyZWF0ZUVsKFwiaHJcIilcbiAgICAgICAgaW5wdXREaXYuY3JlYXRlRGl2KHsgdGV4dDogXCJSZXN1bHQgcHJldmlld1wiLCBjbHM6IFwibWV0YWRhdGEtbWVudS1pbnB1dC1sYWJlbFwiIH0pO1xuICAgICAgICBjb25zdCByZW5kZXJlZFZhbHVlQ29udGFpbmVyID0gaW5wdXREaXYuY3JlYXRlRGl2KCk7XG4gICAgICAgIHRoaXMucmVuZGVyZWRWYWx1ZSA9IG5ldyBUZXh0QXJlYUNvbXBvbmVudChyZW5kZXJlZFZhbHVlQ29udGFpbmVyKVxuICAgICAgICB0aGlzLnJlbmRlcmVkVmFsdWUuaW5wdXRFbC5hZGRDbGFzcyhcIm1ldGFkYXRhLW1lbnUtcHJvbXB0LWlucHV0XCIpO1xuICAgICAgICB0aGlzLnJlbmRlcmVkVmFsdWUuaW5wdXRFbC5yb3dzID0gMztcbiAgICAgICAgdGhpcy5yZW5kZXJlZFZhbHVlLnNldFZhbHVlKHRoaXMudmFsdWUpO1xuICAgIH1cblxuICAgIHByaXZhdGUgYnVpbGRTYXZlQnRuKGlucHV0RGl2OiBIVE1MRGl2RWxlbWVudCkge1xuICAgICAgICBpbnB1dERpdi5jcmVhdGVFbChcImhyXCIpXG4gICAgICAgIGNvbnN0IHNhdmVCdG5Db250YWluZXIgPSBpbnB1dERpdi5jcmVhdGVEaXYoeyBjbHM6IFwibWV0YWRhdGEtbWVudS10ZXh0YXJlYS1idXR0b25zXCIgfSlcbiAgICAgICAgY29uc3Qgc2F2ZUJ0biA9IHNhdmVCdG5Db250YWluZXIuY3JlYXRlRWwoXCJidXR0b25cIilcbiAgICAgICAgc2V0SWNvbihzYXZlQnRuLCBcImNoZWNrbWFya1wiKTtcbiAgICAgICAgc2F2ZUJ0bi5vbmNsaWNrID0gYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgbGV0IGlucHV0VmFsdWUgPSB0aGlzLnJlbmRlcmVkVmFsdWUuZ2V0VmFsdWUoKTtcbiAgICAgICAgICAgIGlmICh0aGlzLmxpbmVOdW1iZXIgPT0gLTEpIHtcbiAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5maWxlVGFza01hbmFnZXJcbiAgICAgICAgICAgICAgICAgICAgLnB1c2hUYXNrKCgpID0+IHsgcmVwbGFjZVZhbHVlcyh0aGlzLnBsdWdpbiwgdGhpcy5maWxlLCB0aGlzLmZpZWxkLm5hbWUsIGlucHV0VmFsdWUpIH0pO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5maWxlVGFza01hbmFnZXJcbiAgICAgICAgICAgICAgICAgICAgLnB1c2hUYXNrKCgpID0+IHsgaW5zZXJ0VmFsdWVzKHRoaXMucGx1Z2luLCB0aGlzLmZpbGUsIHRoaXMuZmllbGQubmFtZSwgaW5wdXRWYWx1ZSwgdGhpcy5saW5lTnVtYmVyLCB0aGlzLmluRnJvbnRtYXR0ZXIsIHRoaXMuYWZ0ZXIpIH0pO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHByaXZhdGUgYnVpbGRJbnB1dEVsKGlucHV0RGl2OiBIVE1MRGl2RWxlbWVudCk6IHZvaWQge1xuICAgICAgICBjb25zdCBmb3JtID0gaW5wdXREaXYuY3JlYXRlRWwoXCJmb3JtXCIpO1xuICAgICAgICBmb3JtLnR5cGUgPSBcInN1Ym1pdFwiO1xuXG4gICAgICAgIGNvbnN0IGlucHV0RWwgPSBuZXcgVGV4dENvbXBvbmVudChmb3JtKTtcbiAgICAgICAgaW5wdXRFbC5pbnB1dEVsLmZvY3VzKCk7XG5cbiAgICAgICAgaW5wdXRFbC5zZXRWYWx1ZShgJHt0aGlzLnZhbHVlfWApO1xuXG4gICAgICAgIGlucHV0RWwuaW5wdXRFbC5hZGRDbGFzcyhcIm1ldGFkYXRhLW1lbnUtcHJvbXB0LWlucHV0XCIpO1xuXG4gICAgICAgIGZvcm0ub25zdWJtaXQgPSBhc3luYyAoZTogRXZlbnQpID0+IHtcbiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgIGxldCBpbnB1dFZhbHVlID0gaW5wdXRFbC5nZXRWYWx1ZSgpO1xuICAgICAgICAgICAgaWYgKHRoaXMubGluZU51bWJlciA9PSAtMSkge1xuICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLmZpbGVUYXNrTWFuYWdlclxuICAgICAgICAgICAgICAgICAgICAucHVzaFRhc2soKCkgPT4geyByZXBsYWNlVmFsdWVzKHRoaXMucGx1Z2luLCB0aGlzLmZpbGUsIHRoaXMuZmllbGQubmFtZSwgaW5wdXRWYWx1ZSkgfSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLmZpbGVUYXNrTWFuYWdlclxuICAgICAgICAgICAgICAgICAgICAucHVzaFRhc2soKCkgPT4geyBpbnNlcnRWYWx1ZXModGhpcy5wbHVnaW4sIHRoaXMuZmlsZSwgdGhpcy5maWVsZC5uYW1lLCBpbnB1dFZhbHVlLCB0aGlzLmxpbmVOdW1iZXIsIHRoaXMuaW5Gcm9udG1hdHRlciwgdGhpcy5hZnRlcikgfSk7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgICB9O1xuICAgIH07XG59OyIsICJpbXBvcnQgTWV0YWRhdGFNZW51IGZyb20gXCJtYWluXCI7XG5pbXBvcnQgeyBNYXJrZG93blZpZXcsIFRGaWxlIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBpbnNlcnRWYWx1ZXMoXG4gICAgcGx1Z2luOiBNZXRhZGF0YU1lbnUsXG4gICAgZmlsZU9yRmlsZVBhdGg6IFRGaWxlIHwgc3RyaW5nLFxuICAgIGZpZWxkTmFtZTogc3RyaW5nLFxuICAgIHZhbHVlOiBzdHJpbmcsXG4gICAgbGluZU51bWJlcj86IG51bWJlcixcbiAgICBpbkZyb250bWF0dGVyPzogYm9vbGVhbixcbiAgICBhZnRlcjogYm9vbGVhbiA9IHRydWVcbik6IFByb21pc2U8dm9pZD4ge1xuICAgIGxldCBmaWxlOiBURmlsZTtcbiAgICBpZiAoZmlsZU9yRmlsZVBhdGggaW5zdGFuY2VvZiBURmlsZSkge1xuICAgICAgICBmaWxlID0gZmlsZU9yRmlsZVBhdGg7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgY29uc3QgX2ZpbGUgPSBwbHVnaW4uYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChmaWxlT3JGaWxlUGF0aClcbiAgICAgICAgaWYgKF9maWxlIGluc3RhbmNlb2YgVEZpbGUgJiYgX2ZpbGUuZXh0ZW5zaW9uID09IFwibWRcIikge1xuICAgICAgICAgICAgZmlsZSA9IF9maWxlO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhyb3cgRXJyb3IoXCJwYXRoIGRvZXNuJ3QgY29ycmVzcG9uZCB0byBhIHByb3BlciBmaWxlXCIpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHBsdWdpbi5hcHAudmF1bHQucmVhZChmaWxlKVxuICAgIGxldCBuZXdDb250ZW50OiBzdHJpbmdbXSA9IFtdO1xuXG4gICAgcmVzdWx0LnNwbGl0KFwiXFxuXCIpLmZvckVhY2goKGxpbmUsIF9saW5lTnVtYmVyKSA9PiB7XG4gICAgICAgIGlmIChfbGluZU51bWJlciA9PSBsaW5lTnVtYmVyKSB7XG4gICAgICAgICAgICBpZiAoYWZ0ZXIpIG5ld0NvbnRlbnQucHVzaChsaW5lKTtcbiAgICAgICAgICAgIG5ld0NvbnRlbnQucHVzaChgJHtmaWVsZE5hbWV9JHtpbkZyb250bWF0dGVyID8gXCI6XCIgOiBcIjo6XCJ9ICR7dmFsdWV9YCk7XG4gICAgICAgICAgICBpZiAoIWFmdGVyKSBuZXdDb250ZW50LnB1c2gobGluZSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBuZXdDb250ZW50LnB1c2gobGluZSk7XG4gICAgICAgIH1cbiAgICB9KTtcblxuICAgIGF3YWl0IHBsdWdpbi5hcHAudmF1bHQubW9kaWZ5KGZpbGUsIG5ld0NvbnRlbnQuam9pbignXFxuJykpO1xuICAgIGNvbnN0IGVkaXRvciA9IHBsdWdpbi5hcHAud29ya3NwYWNlLmdldEFjdGl2ZVZpZXdPZlR5cGUoTWFya2Rvd25WaWV3KT8uZWRpdG9yXG4gICAgaWYgKGVkaXRvcikge1xuICAgICAgICBjb25zdCBsaW5lTnVtYmVyID0gZWRpdG9yLmdldEN1cnNvcigpLmxpbmVcbiAgICAgICAgZWRpdG9yLnNldEN1cnNvcih7IGxpbmU6IGVkaXRvci5nZXRDdXJzb3IoKS5saW5lLCBjaDogZWRpdG9yLmdldExpbmUobGluZU51bWJlcikubGVuZ3RoIH0pXG4gICAgfVxufSIsICJpbXBvcnQgTWV0YWRhdGFNZW51IGZyb20gXCJtYWluXCI7XG5pbXBvcnQgeyBNYXJrZG93blZpZXcsIFRGaWxlIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgKiBhcyBMb29rdXAgZnJvbSBcInNyYy90eXBlcy9sb29rdXBUeXBlc1wiO1xuaW1wb3J0IHsgRmllbGRUeXBlIH0gZnJvbSBcInNyYy90eXBlcy9maWVsZFR5cGVzXCI7XG5pbXBvcnQgeyBnZXRMaXN0Qm91bmRzIH0gZnJvbSBcInNyYy91dGlscy9saXN0XCI7XG5pbXBvcnQgeyBmaWVsZENvbXBvbmVudHMsIGlubGluZUZpZWxkUmVnZXgsIGVuY29kZUxpbmssIGRlY29kZUxpbmsgfSBmcm9tIFwic3JjL3V0aWxzL3BhcnNlclwiO1xuXG5jb25zdCBlbnVtIExvY2F0aW9uIHtcbiAgICAnZnVsbExpbmUnID0gJ2Z1bGxMaW5lJyxcbiAgICAnYnJhY2tldHMnID0gJ2JyYWNrZXRzJyxcbiAgICAncGFyZW50aGVzaXMnID0gJ3BhcmVudGhlc2lzJ1xufVxuXG5jb25zdCBMb2NhdGlvbldyYXBwZXI6IFJlY29yZDxrZXlvZiB0eXBlb2YgTG9jYXRpb24sIHsgc3RhcnQ6IFwiXCIgfCBcIltcIiB8IFwiKFwiLCBlbmQ6IFwiXCIgfCBcIl1cIiB8IFwiKVwiIH0+ID0ge1xuICAgIFwiZnVsbExpbmVcIjogeyBzdGFydDogXCJcIiwgZW5kOiBcIlwiIH0sXG4gICAgXCJicmFja2V0c1wiOiB7IHN0YXJ0OiBcIltcIiwgZW5kOiBcIl1cIiB9LFxuICAgIFwicGFyZW50aGVzaXNcIjogeyBzdGFydDogXCIoXCIsIGVuZDogXCIpXCIgfVxufVxuXG50eXBlIEZpZWxkUmVwbGFjZSA9IHtcbiAgICBvbGRGaWVsZDogc3RyaW5nLFxuICAgIG5ld0ZpZWxkOiBzdHJpbmcsXG59XG5cbmV4cG9ydCBjb25zdCBtYXRjaElubGluZUZpZWxkcyA9IChyZWdleDogUmVnRXhwLCBsaW5lOiBzdHJpbmcsIGF0dHJpYnV0ZTogc3RyaW5nLCBpbnB1dDogc3RyaW5nLCBsb2NhdGlvbjoga2V5b2YgdHlwZW9mIExvY2F0aW9uID0gXCJmdWxsTGluZVwiKTogRmllbGRSZXBsYWNlW10gPT4ge1xuICAgIGNvbnN0IHNSID0gbGluZS5tYXRjaEFsbChyZWdleCk7XG4gICAgbGV0IG5leHQgPSBzUi5uZXh0KCk7XG4gICAgY29uc3QgbmV3RmllbGRzOiBGaWVsZFJlcGxhY2VbXSA9IFtdO1xuICAgIHdoaWxlICghbmV4dC5kb25lKSB7XG4gICAgICAgIGNvbnN0IG1hdGNoID0gbmV4dC52YWx1ZTtcbiAgICAgICAgaWYgKG1hdGNoLmdyb3VwcyAmJiBPYmplY3Qua2V5cyhtYXRjaC5ncm91cHMpLmV2ZXJ5KGogPT4gZmllbGRDb21wb25lbnRzLmluY2x1ZGVzKGopKSkge1xuICAgICAgICAgICAgY29uc3QgeyBpbkxpc3QsIGluUXVvdGUsIHN0YXJ0U3R5bGUsIGVuZFN0eWxlLCBiZWZvcmVTZXBhcmF0b3JTcGFjZXIsIGFmdGVyU2VwYXJhdG9yU3BhY2VyLCB2YWx1ZXMgfSA9IG1hdGNoLmdyb3Vwc1xuICAgICAgICAgICAgY29uc3QgaW5wdXRBcnJheSA9IGlucHV0ID8gaW5wdXQucmVwbGFjZSgvKFxcLFxccyspL2csICcsJykuc3BsaXQoJywnKSA6IFtcIlwiXTtcbiAgICAgICAgICAgIGNvbnN0IG5ld1ZhbHVlID0gaW5wdXRBcnJheS5sZW5ndGggPT0gMSA/IGlucHV0QXJyYXlbMF0gOiBgJHtpbnB1dEFycmF5LmpvaW4oJywgJyl9YDtcbiAgICAgICAgICAgIGNvbnN0IHN0YXJ0ID0gTG9jYXRpb25XcmFwcGVyW2xvY2F0aW9uXS5zdGFydDtcbiAgICAgICAgICAgIGNvbnN0IGVuZCA9IExvY2F0aW9uV3JhcHBlcltsb2NhdGlvbl0uZW5kO1xuICAgICAgICAgICAgbmV3RmllbGRzLnB1c2goe1xuICAgICAgICAgICAgICAgIG9sZEZpZWxkOiBtYXRjaFswXSxcbiAgICAgICAgICAgICAgICBuZXdGaWVsZDogYCR7aW5RdW90ZSB8fCBcIlwifSR7c3RhcnR9JHtpbkxpc3QgfHwgXCJcIn0ke3N0YXJ0U3R5bGV9JHthdHRyaWJ1dGV9JHtlbmRTdHlsZX0ke2JlZm9yZVNlcGFyYXRvclNwYWNlcn06OiR7YWZ0ZXJTZXBhcmF0b3JTcGFjZXJ9JHtuZXdWYWx1ZX0ke2VuZH1gLFxuICAgICAgICAgICAgfSlcbiAgICAgICAgfVxuICAgICAgICBuZXh0ID0gc1IubmV4dCgpXG4gICAgfVxuICAgIHJldHVybiBuZXdGaWVsZHNcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHJlcGxhY2VWYWx1ZXMoXG4gICAgcGx1Z2luOiBNZXRhZGF0YU1lbnUsXG4gICAgZmlsZU9yRmlsZVBhdGg6IFRGaWxlIHwgc3RyaW5nLFxuICAgIGF0dHJpYnV0ZTogc3RyaW5nLFxuICAgIGlucHV0OiBzdHJpbmcsXG4gICAgcHJldmlvdXNJdGVtc0NvdW50OiBudW1iZXIgPSAwXG4pOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBsZXQgZmlsZTogVEZpbGU7XG4gICAgaWYgKGZpbGVPckZpbGVQYXRoIGluc3RhbmNlb2YgVEZpbGUpIHtcbiAgICAgICAgZmlsZSA9IGZpbGVPckZpbGVQYXRoO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbnN0IF9maWxlID0gcGx1Z2luLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgoZmlsZU9yRmlsZVBhdGgpXG4gICAgICAgIGlmIChfZmlsZSBpbnN0YW5jZW9mIFRGaWxlICYmIF9maWxlLmV4dGVuc2lvbiA9PSBcIm1kXCIpIHtcbiAgICAgICAgICAgIGZpbGUgPSBfZmlsZTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRocm93IEVycm9yKFwicGF0aCBkb2Vzbid0IGNvcnJlc3BvbmQgdG8gYSBwcm9wZXIgZmlsZVwiKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBjb25zdCBjb250ZW50ID0gKGF3YWl0IHBsdWdpbi5hcHAudmF1bHQuY2FjaGVkUmVhZChmaWxlKSkuc3BsaXQoJ1xcbicpO1xuICAgIGNvbnN0IGZyb250bWF0dGVyID0gcGx1Z2luLmFwcC5tZXRhZGF0YUNhY2hlLmdldEZpbGVDYWNoZShmaWxlKT8uZnJvbnRtYXR0ZXI7XG4gICAgLy9maXJzdCBsb29rIGZvciBsb29rdXAgbGlzdHNcblxuICAgIGNvbnN0IHNraXBwZWRMaW5lczogbnVtYmVyW10gPSBbXVxuXG4gICAgY29uc3QgeyBwb3NpdGlvbjogeyBzdGFydCwgZW5kIH0gfSA9IGZyb250bWF0dGVyID8gZnJvbnRtYXR0ZXIgOiB7IHBvc2l0aW9uOiB7IHN0YXJ0OiB1bmRlZmluZWQsIGVuZDogdW5kZWZpbmVkIH0gfTtcbiAgICBjb25zdCBuZXdDb250ZW50ID0gY29udGVudC5tYXAoKGxpbmUsIGkpID0+IHtcbiAgICAgICAgaWYgKHN0YXJ0ICYmIGVuZCAmJiBpID49IHN0YXJ0LmxpbmUgJiYgaSA8PSBlbmQubGluZSkge1xuICAgICAgICAgICAgY29uc3QgcmVnZXggPSBuZXcgUmVnRXhwKGBeJHthdHRyaWJ1dGV9OmAsICd1Jyk7XG4gICAgICAgICAgICBjb25zdCByID0gbGluZS5tYXRjaChyZWdleCk7XG4gICAgICAgICAgICBpZiAociAmJiByLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICBjb25zdCBpbnB1dEFycmF5ID0gaW5wdXQgPyBpbnB1dC5yZXBsYWNlKC8oXFwsXFxzKykvZywgJywnKS5zcGxpdCgnLCcpIDogW1wiXCJdO1xuICAgICAgICAgICAgICAgIGNvbnN0IG5ld1ZhbHVlID0gaW5wdXRBcnJheS5sZW5ndGggPT0gMSA/IGlucHV0QXJyYXlbMF0gOiBgWyR7aW5wdXRBcnJheS5qb2luKCcsICcpfV1gO1xuICAgICAgICAgICAgICAgIHJldHVybiBgJHthdHRyaWJ1dGV9OiAke25ld1ZhbHVlfWA7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldHVybiBsaW5lO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29uc3QgZW5jb2RlZElucHV0ID0gZW5jb2RlTGluayhpbnB1dClcbiAgICAgICAgICAgIGxldCBlbmNvZGVkTGluZSA9IGVuY29kZUxpbmsobGluZSlcbiAgICAgICAgICAgIGNvbnN0IGZ1bGxMaW5lUmVnZXggPSBuZXcgUmVnRXhwKGBeJHtpbmxpbmVGaWVsZFJlZ2V4KGF0dHJpYnV0ZSl9KD88dmFsdWVzPlteXFxcXF1dKilgLCBcInVcIik7XG4gICAgICAgICAgICBjb25zdCBmUiA9IGVuY29kZWRMaW5lLm1hdGNoKGZ1bGxMaW5lUmVnZXgpO1xuICAgICAgICAgICAgaWYgKGZSPy5ncm91cHMgJiYgT2JqZWN0LmtleXMoZlIuZ3JvdXBzKS5ldmVyeShqID0+IGZpZWxkQ29tcG9uZW50cy5pbmNsdWRlcyhqKSkpIHtcbiAgICAgICAgICAgICAgICAvL2NoZWNrIGlmIHRoaXMgZmllbGQgaXMgYSBsb29rdXAgYW5kIGdldCBsaXN0IGJvdW5kYXJpZXNcbiAgICAgICAgICAgICAgICBjb25zdCBmaWVsZCA9IHBsdWdpbi5maWVsZEluZGV4LmZpbGVzRmllbGRzLmdldChmaWxlLnBhdGgpPy5maW5kKGYgPT4gZi5uYW1lID09PSBhdHRyaWJ1dGUpXG4gICAgICAgICAgICAgICAgaWYgKGZpZWxkPy50eXBlID09PSBGaWVsZFR5cGUuTG9va3VwKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhwcmV2aW91c0l0ZW1zQ291bnQpXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGJvdW5kcyA9IGdldExpc3RCb3VuZHMocGx1Z2luLCBmaWxlLCBpKVxuICAgICAgICAgICAgICAgICAgICBpZiAoYm91bmRzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB7IHN0YXJ0LCBlbmQgfSA9IGJvdW5kcztcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGogPSBzdGFydCArIDE7IGogPCBzdGFydCArIHByZXZpb3VzSXRlbXNDb3VudCArIDEgJiYgaiA8IGVuZCArIDE7IGorKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNraXBwZWRMaW5lcy5wdXNoKGopXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY29uc3QgeyBpbkxpc3QsIGluUXVvdGUsIHN0YXJ0U3R5bGUsIGVuZFN0eWxlLCBiZWZvcmVTZXBhcmF0b3JTcGFjZXIsIGFmdGVyU2VwYXJhdG9yU3BhY2VyLCB2YWx1ZXMgfSA9IGZSLmdyb3Vwc1xuICAgICAgICAgICAgICAgIGNvbnN0IGlucHV0QXJyYXkgPSBpbnB1dCA/IGlucHV0LnJlcGxhY2UoLyhcXCxcXHMrKS9nLCAnLCcpLnNwbGl0KCcsJykuc29ydCgpIDogW107XG4gICAgICAgICAgICAgICAgbGV0IG5ld1ZhbHVlOiBzdHJpbmc7XG4gICAgICAgICAgICAgICAgaWYgKGZpZWxkPy50eXBlID09PSBGaWVsZFR5cGUuTG9va3VwICYmIExvb2t1cC5idWxsZXRMaXN0TG9va3VwVHlwZXMuaW5jbHVkZXMoZmllbGQ/Lm9wdGlvbnMub3V0cHV0VHlwZSBhcyBMb29rdXAuVHlwZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgbmV3VmFsdWUgPSBpbnB1dEFycmF5Lmxlbmd0aCA9PSAxID8gXCJcXG4tIFwiICsgaW5wdXRBcnJheVswXSA6IGAke2lucHV0QXJyYXkubGVuZ3RoID4gMCA/IFwiXFxuXCIgOiBcIlwifSR7aW5wdXRBcnJheS5tYXAoaXRlbSA9PiBcIi0gXCIgKyBpdGVtKS5qb2luKCdcXG4nKX1gO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIG5ld1ZhbHVlID0gaW5wdXRBcnJheS5sZW5ndGggPT0gMSA/IGlucHV0QXJyYXlbMF0gOiBgJHtpbnB1dEFycmF5LmpvaW4oJywgJyl9YDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIGAke2luUXVvdGUgfHwgXCJcIn0ke2luTGlzdCB8fCBcIlwifSR7c3RhcnRTdHlsZX0ke2F0dHJpYnV0ZX0ke2VuZFN0eWxlfSR7YmVmb3JlU2VwYXJhdG9yU3BhY2VyfTo6JHthZnRlclNlcGFyYXRvclNwYWNlcn0ke25ld1ZhbHVlfWA7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGNvbnN0IG5ld0ZpZWxkczogRmllbGRSZXBsYWNlW10gPSBbXTtcbiAgICAgICAgICAgICAgICBjb25zdCBpblNlbnRlbmNlUmVnZXhCcmFja2V0cyA9IG5ldyBSZWdFeHAoYFxcXFxbJHtpbmxpbmVGaWVsZFJlZ2V4KGF0dHJpYnV0ZSl9KD88dmFsdWVzPlteXFxcXF1dKyk/XFxcXF1gLCBcImd1XCIpO1xuICAgICAgICAgICAgICAgIGNvbnN0IGluU2VudGVuY2VSZWdleFBhciA9IG5ldyBSZWdFeHAoYFxcXFwoJHtpbmxpbmVGaWVsZFJlZ2V4KGF0dHJpYnV0ZSl9KD88dmFsdWVzPlteXFxcXCldKyk/XFxcXClgLCBcImd1XCIpO1xuICAgICAgICAgICAgICAgIG5ld0ZpZWxkcy5wdXNoKC4uLm1hdGNoSW5saW5lRmllbGRzKGluU2VudGVuY2VSZWdleEJyYWNrZXRzLCBlbmNvZGVkTGluZSwgYXR0cmlidXRlLCBlbmNvZGVkSW5wdXQsIExvY2F0aW9uLmJyYWNrZXRzKSlcbiAgICAgICAgICAgICAgICBuZXdGaWVsZHMucHVzaCguLi5tYXRjaElubGluZUZpZWxkcyhpblNlbnRlbmNlUmVnZXhQYXIsIGVuY29kZWRMaW5lLCBhdHRyaWJ1dGUsIGVuY29kZWRJbnB1dCwgTG9jYXRpb24ucGFyZW50aGVzaXMpKVxuICAgICAgICAgICAgICAgIG5ld0ZpZWxkcy5mb3JFYWNoKGZpZWxkID0+IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZmllbGRSZWdleCA9IG5ldyBSZWdFeHAoZmllbGQub2xkRmllbGQucmVwbGFjZSgvWy4qKz9eJHt9KCl8W1xcXVxcXFxdL2csICdcXFxcJCYnKSwgXCJ1XCIpXG4gICAgICAgICAgICAgICAgICAgIGVuY29kZWRMaW5lID0gZW5jb2RlZExpbmUucmVwbGFjZShmaWVsZFJlZ2V4LCBmaWVsZC5uZXdGaWVsZCk7XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICByZXR1cm4gZGVjb2RlTGluayhlbmNvZGVkTGluZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9KTtcbiAgICBhd2FpdCBwbHVnaW4uYXBwLnZhdWx0Lm1vZGlmeShmaWxlLCBuZXdDb250ZW50LmZpbHRlcigobGluZSwgaSkgPT4gIXNraXBwZWRMaW5lcy5pbmNsdWRlcyhpKSkuam9pbignXFxuJykpO1xuICAgIGNvbnN0IGVkaXRvciA9IHBsdWdpbi5hcHAud29ya3NwYWNlLmdldEFjdGl2ZVZpZXdPZlR5cGUoTWFya2Rvd25WaWV3KT8uZWRpdG9yXG4gICAgaWYgKGVkaXRvcikge1xuICAgICAgICBjb25zdCBsaW5lTnVtYmVyID0gZWRpdG9yLmdldEN1cnNvcigpLmxpbmVcbiAgICAgICAgZWRpdG9yLnNldEN1cnNvcih7IGxpbmU6IGVkaXRvci5nZXRDdXJzb3IoKS5saW5lLCBjaDogZWRpdG9yLmdldExpbmUobGluZU51bWJlcikubGVuZ3RoIH0pXG4gICAgfVxufSIsICJleHBvcnQgZW51bSBCdWlsdGluU3VtbWFyaXppbmcge1xuICAgIFwiU3VtXCIgPSBcIlN1bVwiLFxuICAgIFwiQ291bnRcIiA9IFwiQ291bnRcIixcbiAgICBcIkNvdW50QWxsXCIgPSBcIkNvdW50QWxsXCIsXG4gICAgXCJBdmVyYWdlXCIgPSBcIkF2ZXJhZ2VcIixcbiAgICBcIk1heFwiID0gXCJNYXhcIixcbiAgICBcIk1pblwiID0gXCJNaW5cIlxufVxuXG5leHBvcnQgY29uc3QgQnVpbHRpblN1bW1hcml6aW5nRnVuY3Rpb25EZXNjcmlwdGlvbjogUmVjb3JkPGtleW9mIHR5cGVvZiBCdWlsdGluU3VtbWFyaXppbmcsIHN0cmluZz4gPSB7XG4gICAgXCJTdW1cIjogXCJSZXR1cm5zIHRoZSBzdW0gb2YgPHt7c3VtbWFyaXplZEZpZWxkTmFtZX19PiBmaWVsZHMgaW4gdGhlIHBhZ2VzIG1hdGNoaW5nIHRoZSBxdWVyeVwiLFxuICAgIFwiQ291bnRcIjogXCJDb3VudHMgYWxsIHBhZ2VzIG1hdGNoaW5nIHRoZSBxdWVyeSB3aGVyZSA8e3tzdW1tYXJpemVkRmllbGROYW1lfX0+IGlzIG5vbiBlbXB0eVwiLFxuICAgIFwiQ291bnRBbGxcIjogXCJDb3VudHMgYWxsIHBhZ2VzIG1hdGNoaW5nIHRoZSBxdWVyeSAoaW5jbHVkaW5nIGVtcHR5IGZpZWxkcylcIixcbiAgICBcIkF2ZXJhZ2VcIjogXCJSZXR1cm5zIHRoZSBhdmVyYWdlIHZhbHVlIG9mIDx7e3N1bW1hcml6ZWRGaWVsZE5hbWV9fT4gZmllbGRzIGluIHRoZSBwYWdlcyBtYXRjaGluZyB0aGUgcXVlcnlcIixcbiAgICBcIk1heFwiOiBcIlJldHVybnMgdGhlIG1heGltdW0gdmFsdWUgb2YgPHt7c3VtbWFyaXplZEZpZWxkTmFtZX19PiBmaWVsZHMgaW4gdGhlIHBhZ2VzIG1hdGNoaW5nIHRoZSBxdWVyeVwiLFxuICAgIFwiTWluXCI6IFwiUmV0dXJucyB0aGUgbWluaW11bSB2YWx1ZSBvZiA8e3tzdW1tYXJpemVkRmllbGROYW1lfX0+IGZpZWxkcyBpbiB0aGUgcGFnZXMgbWF0Y2hpbmcgdGhlIHF1ZXJ5XCIsXG59XG5cbmV4cG9ydCBjb25zdCBCdWlsdGluU3VtbWFyaXppbmdGdW5jdGlvbjogUmVjb3JkPGtleW9mIHR5cGVvZiBCdWlsdGluU3VtbWFyaXppbmcsIHN0cmluZz4gPSB7XG4gICAgXCJTdW1cIjogXCJjb25zdCBpPTA7Y29uc3Qgc3VtID0gcGFnZXMucmVkdWNlKChwLCBjKSA9PiBwICsgY1tcXFwie3tzdW1tYXJpemVkRmllbGROYW1lfX1cXFwiXSwgaSk7IHJldHVybiBzdW1cIixcbiAgICBcIkNvdW50QWxsXCI6IFwicmV0dXJuIHBhZ2VzLmxlbmd0aFwiLFxuICAgIFwiQ291bnRcIjogXCJyZXR1cm4gcGFnZXMuZmlsdGVyKHAgPT4gISFwW1xcXCJ7e3N1bW1hcml6ZWRGaWVsZE5hbWV9fVxcXCJdKS5sZW5ndGhcIixcbiAgICBcIkF2ZXJhZ2VcIjogXCJjb25zdCBpPTAuMDtjb25zdCBzdW0gPSBwYWdlcy5yZWR1Y2UoKHAsIGMpID0+IHAgKyBjW1xcXCJ7e3N1bW1hcml6ZWRGaWVsZE5hbWV9fVxcXCJdLCBpKTsgcmV0dXJuIHN1bSAvIHBhZ2VzLmxlbmd0aFwiLFxuICAgIFwiTWF4XCI6IFwicmV0dXJuIHBhZ2VzLnJlZHVjZSgocCxjKSA9PiBwW1xcXCJ7e3N1bW1hcml6ZWRGaWVsZE5hbWV9fVxcXCJdID49IGNbXFxcInt7c3VtbWFyaXplZEZpZWxkTmFtZX19XFxcIl0gPyBwIDogYylbXFxcInt7c3VtbWFyaXplZEZpZWxkTmFtZX19XFxcIl1cIixcbiAgICBcIk1pblwiOiBcInJldHVybiBwYWdlcy5yZWR1Y2UoKHAsYykgPT4gcFtcXFwie3tzdW1tYXJpemVkRmllbGROYW1lfX1cXFwiXSE9PW51bGwgJiYgcFtcXFwie3tzdW1tYXJpemVkRmllbGROYW1lfX1cXFwiXSA8PSBjW1xcXCJ7e3N1bW1hcml6ZWRGaWVsZE5hbWV9fVxcXCJdID8gcCA6IGMpW1xcXCJ7e3N1bW1hcml6ZWRGaWVsZE5hbWV9fVxcXCJdXCJcbn1cblxuZXhwb3J0IGVudW0gVHlwZSB7XG4gICAgXCJMaW5rc0xpc3RcIiA9IFwiTGlua3NMaXN0XCIsXG4gICAgXCJMaW5rc0J1bGxldExpc3RcIiA9IFwiTGlua3NCdWxsZXRMaXN0XCIsXG4gICAgXCJCdWlsdGluU3VtbWFyaXppbmdcIiA9IFwiQnVpbHRpblN1bW1hcml6aW5nXCIsXG4gICAgXCJDdXN0b21MaXN0XCIgPSBcIkN1c3RvbUxpc3RcIixcbiAgICBcIkN1c3RvbUJ1bGxldExpc3RcIiA9IFwiQ3VzdG9tQnVsbGV0TGlzdFwiLFxuICAgIFwiQ3VzdG9tU3VtbWFyaXppbmdcIiA9IFwiQ3VzdG9tU3VtbWFyaXppbmdcIlxufVxuXG5leHBvcnQgY29uc3QgU2hvcnREZXNjcmlwdGlvbjogUmVjb3JkPGtleW9mIHR5cGVvZiBUeXBlLCBzdHJpbmc+ID0ge1xuICAgIFwiTGlua3NMaXN0XCI6IFwiSW5saW5lIGxpc3Qgb2YgbGlua3NcIixcbiAgICBcIkxpbmtzQnVsbGV0TGlzdFwiOiBcIkJ1bGxldCBsaXN0IG9mIGxpbmtzXCIsXG4gICAgXCJCdWlsdGluU3VtbWFyaXppbmdcIjogXCJcIixcbiAgICBcIkN1c3RvbUxpc3RcIjogXCJJbmxpbmUgbGlzdCBvZiBjdXN0b21pemVkIGxpbmtzXCIsXG4gICAgXCJDdXN0b21CdWxsZXRMaXN0XCI6IFwiQnVsbGV0IGxpc3Qgb2YgY3VzdG9taXplZCBsaW5rc1wiLFxuICAgIFwiQ3VzdG9tU3VtbWFyaXppbmdcIjogXCJDdXN0b20gc3VtbWFyaXppbmcgZnVuY3Rpb25cIlxufVxuXG5leHBvcnQgY29uc3QgTWFwcGluZ0xhYmVsOiBSZWNvcmQ8a2V5b2YgdHlwZW9mIFR5cGUsIFR5cGU+ID0ge1xuICAgIFwiTGlua3NMaXN0XCI6IFR5cGUuTGlua3NMaXN0LFxuICAgIFwiTGlua3NCdWxsZXRMaXN0XCI6IFR5cGUuTGlua3NCdWxsZXRMaXN0LFxuICAgIFwiQnVpbHRpblN1bW1hcml6aW5nXCI6IFR5cGUuQnVpbHRpblN1bW1hcml6aW5nLFxuICAgIFwiQ3VzdG9tTGlzdFwiOiBUeXBlLkN1c3RvbUxpc3QsXG4gICAgXCJDdXN0b21CdWxsZXRMaXN0XCI6IFR5cGUuQ3VzdG9tQnVsbGV0TGlzdCxcbiAgICBcIkN1c3RvbVN1bW1hcml6aW5nXCI6IFR5cGUuQ3VzdG9tU3VtbWFyaXppbmdcbn1cblxuZXhwb3J0IGNvbnN0IERlc2NyaXB0aW9uOiBSZWNvcmQ8a2V5b2YgdHlwZW9mIFR5cGUsIHN0cmluZz4gPSB7XG4gICAgXCJMaW5rc0xpc3RcIjogXCJMaXN0IG9mIHJlbGF0ZWQgbGlua3MgZGlzcGxheWVkIGlubGluZVwiLFxuICAgIFwiTGlua3NCdWxsZXRMaXN0XCI6IFwiTGlzdCBvZiByZWxhdGVkIGxpbmtzIGRpc3BsYXllZCBiZWxvdyB0aGUgZmllbGRcIixcbiAgICBcIkJ1aWx0aW5TdW1tYXJpemluZ1wiOiBcIkJ1aWx0LWluIHN1bW1hcml6aW5nIGZ1bmN0aW9uXCIsXG4gICAgXCJDdXN0b21MaXN0XCI6IFwiQ3VzdG9tIGxpc3QgcmVuZGVyaW5nIGZ1bmN0aW9uIGRpc3BsYXllZCBpbmxpbmVcIixcbiAgICBcIkN1c3RvbUJ1bGxldExpc3RcIjogXCJDdXN0b20gbGlzdCByZW5kZXJpbmcgZnVuY3Rpb24gZGlzcGxheWVkIGJlbG93IHRoZSBmaWVsZFwiLFxuICAgIFwiQ3VzdG9tU3VtbWFyaXppbmdcIjogXCJDdXN0b20gc3VtbWFyaXppbmcgZnVuY3Rpb25cIlxufVxuXG5leHBvcnQgY29uc3QgT3B0aW9uTGFiZWw6IFJlY29yZDxrZXlvZiB0eXBlb2YgVHlwZSwgc3RyaW5nPiA9IHtcbiAgICBcIkxpbmtzTGlzdFwiOiBcIlwiLFxuICAgIFwiTGlua3NCdWxsZXRMaXN0XCI6IFwiXCIsXG4gICAgXCJCdWlsdGluU3VtbWFyaXppbmdcIjogXCJCdWlsdC1pbiBzdW1tYXJpemUgZnVuY3Rpb246XCIsXG4gICAgXCJDdXN0b21MaXN0XCI6IFwiUXVlcnkncyByZXN1bHRzJyBsaXN0J3MgcmVuZGVyaW5nIGZ1bmN0aW9uOlwiLFxuICAgIFwiQ3VzdG9tQnVsbGV0TGlzdFwiOiBcIlF1ZXJ5J3MgcmVzdWx0cycgbGlzdCdzIHJlbmRlcmluZyBmdW5jdGlvbjpcIixcbiAgICBcIkN1c3RvbVN1bW1hcml6aW5nXCI6IFwiUXVlcnkncyByZXN1bHRzJyBsaXN0J3Mgc3VtbWFyaXppbmcgZnVuY3Rpb246XCJcbn1cblxuXG5leHBvcnQgY29uc3QgT3B0aW9uU3ViTGFiZWw6IFJlY29yZDxrZXlvZiB0eXBlb2YgVHlwZSwgc3RyaW5nPiA9IHtcbiAgICBcIkxpbmtzTGlzdFwiOiBcIlwiLFxuICAgIFwiTGlua3NCdWxsZXRMaXN0XCI6IFwiXCIsXG4gICAgXCJCdWlsdGluU3VtbWFyaXppbmdcIjogXCJcIixcbiAgICBcIkN1c3RvbUxpc3RcIjogYGZ1bmN0aW9uKHBhZ2UpIHsgcmV0dXJuIDxmdW5jdGlvbiB1c2luZyBcInBhZ2VcIj47IH1gLFxuICAgIFwiQ3VzdG9tQnVsbGV0TGlzdFwiOiBgZnVuY3Rpb24ocGFnZSkgeyByZXR1cm4gPGZ1bmN0aW9uIHVzaW5nIFwicGFnZVwiPjsgfWAsXG4gICAgXCJDdXN0b21TdW1tYXJpemluZ1wiOiBgZnVuY3Rpb24ocGFnZSkgeyByZXR1cm4gPGZ1bmN0aW9uIHVzaW5nIFwicGFnZVwiPjsgfWBcbn1cblxuZXhwb3J0IGNvbnN0IEhlbHBlcjogUmVjb3JkPGtleW9mIHR5cGVvZiBUeXBlLCBzdHJpbmc+ID0ge1xuICAgIFwiTGlua3NMaXN0XCI6IFwiXCIsXG4gICAgXCJMaW5rc0J1bGxldExpc3RcIjogXCJcIixcbiAgICBcIkJ1aWx0aW5TdW1tYXJpemluZ1wiOiBcIlwiLFxuICAgIFwiQ3VzdG9tTGlzdFwiOiBcIkphdmFzY3JpcHQgc3RyaW5nLCBcIiArXG4gICAgICAgIFwidGhlIFxcXCJwYWdlXFxcIiAoZGF0YXZpZXcgcGFnZSB0eXBlKSB2YXJpYWJsZSBpcyBhdmFpbGFibGVcXG5cIiArXG4gICAgICAgIFwiZXhhbXBsZSAxOiBwYWdlLmZpbGUubmFtZVxcbmV4YW1wbGUgMjogYCR7cGFnZS5maWxlLm5hbWV9IG9mIGdlbmRlciAke3BhZ2UuZ2VuZGVyfWBcIixcbiAgICBcIkN1c3RvbUJ1bGxldExpc3RcIjogXCJKYXZhc2NyaXB0IHN0cmluZywgXCIgK1xuICAgICAgICBcInRoZSBcXFwicGFnZVxcXCIgKGRhdGF2aWV3IHBhZ2UgdHlwZSkgdmFyaWFibGUgaXMgYXZhaWxhYmxlXFxuXCIgK1xuICAgICAgICBcImV4YW1wbGUgMTogcGFnZS5maWxlLm5hbWVcXG5leGFtcGxlIDI6IGAke3BhZ2UuZmlsZS5uYW1lfSBvZiBnZW5kZXIgJHtwYWdlLmdlbmRlcn1gXCIsXG4gICAgXCJDdXN0b21TdW1tYXJpemluZ1wiOiBcIkphdmFzY3JpcHQgc3RyaW5nLCB0aGUgXFxcInBhZ2VzXFxcIiAoZGF0YXZpZXcgcGFnZXMgdHlwZSkgXCIgK1xuICAgICAgICBcInZhcmlhYmxlIGlzIGF2YWlsYWJsZVxcbmV4YW1wbGU6IFwiICtcbiAgICAgICAgXCJcXG5jb25zdCBpbml0aWFsVmFsdWUgPSAwO1xcbmNvbnN0IHN1bVdpdGhJbml0aWFsID0gcGFnZXMucmVkdWNlKFxcblwiICtcbiAgICAgICAgXCIgICAgKHByZXZpb3VzVmFsdWUsIGN1cnJlbnRWYWx1ZSkgPT4gcHJldmlvdXNWYWx1ZSArIGN1cnJlbnRWYWx1ZSxcXG5cIiArXG4gICAgICAgIFwiICAgIGluaXRpYWxWYWx1ZVxcbik7XFxucmV0dXJuIGAke3N1bVdpdGhJbml0aWFsfWBcXG5cIlxufVxuXG5leHBvcnQgY29uc3QgRGVmYXVsdDogUmVjb3JkPGtleW9mIHR5cGVvZiBUeXBlLCBzdHJpbmc+ID0ge1xuICAgIFwiTGlua3NMaXN0XCI6IFwiXCIsXG4gICAgXCJMaW5rc0J1bGxldExpc3RcIjogXCJcIixcbiAgICBcIkJ1aWx0aW5TdW1tYXJpemluZ1wiOiBCdWlsdGluU3VtbWFyaXppbmcuQ291bnQsXG4gICAgXCJDdXN0b21MaXN0XCI6IFwicGFnZS5maWxlLm5hbWVcIixcbiAgICBcIkN1c3RvbUJ1bGxldExpc3RcIjogXCJwYWdlLmZpbGUubmFtZVwiLFxuICAgIFwiQ3VzdG9tU3VtbWFyaXppbmdcIjogXCJyZXR1cm4gcGFnZXMubGVuZ3RoXCJcbn1cblxuZXhwb3J0IGNvbnN0IGJ1bGxldExpc3RMb29rdXBUeXBlcyA9IFtcbiAgICBUeXBlLkxpbmtzQnVsbGV0TGlzdCxcbiAgICBUeXBlLkN1c3RvbUJ1bGxldExpc3Rcbl0iLCAiaW1wb3J0IE1ldGFkYXRhTWVudSBmcm9tIFwibWFpblwiO1xuaW1wb3J0IHsgTGlzdEl0ZW1DYWNoZSwgVEZpbGUgfSBmcm9tIFwib2JzaWRpYW5cIjtcblxuZXhwb3J0IGZ1bmN0aW9uIGdldExpc3RCb3VuZHMocGx1Z2luOiBNZXRhZGF0YU1lbnUsIGZpbGU6IFRGaWxlLCBwYXJlbnQ6IG51bWJlcik6IHsgc3RhcnQ6IG51bWJlciwgZW5kOiBudW1iZXIgfSB8IHVuZGVmaW5lZCB7XG4gICAgY29uc3QgbGlzdEl0ZW1zOiBMaXN0SXRlbUNhY2hlW10gPSAocGx1Z2luLmFwcC5tZXRhZGF0YUNhY2hlLmdldEZpbGVDYWNoZShmaWxlKT8ubGlzdEl0ZW1zIHx8IFtdKVxuICAgIHJldHVybiBnZXRMaXN0Qm91bmRzRnJvbUxpc3RJdGVtQ2FjaGVMaXN0KGxpc3RJdGVtcywgcGFyZW50KVxufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0TGlzdEJvdW5kc0Zyb21MaXN0SXRlbUNhY2hlTGlzdChcbiAgICBsaXN0SXRlbXM6IExpc3RJdGVtQ2FjaGVbXSxcbiAgICBwYXJlbnQ6IG51bWJlclxuKTogeyBzdGFydDogbnVtYmVyLCBlbmQ6IG51bWJlciB9IHwgdW5kZWZpbmVkIHtcbiAgICBjb25zdCBzdWJQYXJlbnRzTGluZXMgPSBbLXBhcmVudCAtIDFdO1xuICAgIGxldCBzdGFydDogbnVtYmVyID0gcGFyZW50O1xuICAgIGxldCBlbmQ6IG51bWJlciA9IC0xO1xuICAgIGxldCBvdXRPZkxpc3Q6IGJvb2xlYW4gPSBmYWxzZTtcbiAgICBsaXN0SXRlbXNcbiAgICAgICAgLnNvcnQoKGEsIGIpID0+IGEucG9zaXRpb24uc3RhcnQubGluZSAtIGIucG9zaXRpb24uc3RhcnQubGluZSlcbiAgICAgICAgLmZvckVhY2gobGlzdEl0ZW0gPT4ge1xuICAgICAgICAgICAgaWYgKHN1YlBhcmVudHNMaW5lcy5pbmNsdWRlcyhsaXN0SXRlbS5wYXJlbnQpICYmICFvdXRPZkxpc3QpIHtcbiAgICAgICAgICAgICAgICBzdWJQYXJlbnRzTGluZXMucHVzaChsaXN0SXRlbS5wb3NpdGlvbi5zdGFydC5saW5lKTtcbiAgICAgICAgICAgICAgICBpZiAoc3RhcnQgPiBsaXN0SXRlbS5wb3NpdGlvbi5zdGFydC5saW5lKSBzdGFydCA9IGxpc3RJdGVtLnBvc2l0aW9uLnN0YXJ0LmxpbmU7XG4gICAgICAgICAgICAgICAgaWYgKGVuZCA8PSBsaXN0SXRlbS5wb3NpdGlvbi5lbmQubGluZSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAobGlzdEl0ZW0ucG9zaXRpb24uZW5kLmxpbmUgPT0gbGlzdEl0ZW0ucG9zaXRpb24uc3RhcnQubGluZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZW5kID0gbGlzdEl0ZW0ucG9zaXRpb24uZW5kLmxpbmU7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBlbmQgPSBsaXN0SXRlbS5wb3NpdGlvbi5zdGFydC5saW5lO1xuICAgICAgICAgICAgICAgICAgICAgICAgb3V0T2ZMaXN0ID0gdHJ1ZVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9KVxuICAgIGlmIChlbmQgPj0gMCkge1xuICAgICAgICAvL2NvbnNvbGUubG9nKHsgc3RhcnQ6IHN0YXJ0LCBlbmQ6IGVuZCB9KVxuICAgICAgICByZXR1cm4geyBzdGFydDogc3RhcnQsIGVuZDogZW5kIH1cbiAgICB9XG4gICAgcmV0dXJuXG59IiwgImV4cG9ydCBjb25zdCBmaWVsZENvbXBvbmVudHMgPSBbJ2luUXVvdGUnLCAnaW5MaXN0JywgJ3N0YXJ0U3R5bGUnLCAnYXR0cmlidXRlJywgJ2VuZFN0eWxlJywgJ2JlZm9yZVNlcGFyYXRvclNwYWNlcicsICdhZnRlclNlcGFyYXRvclNwYWNlcicsICd2YWx1ZXMnXVxuXG5leHBvcnQgY29uc3QgZ2VuZXJpY0ZpZWxkUmVnZXggPSBcIig/PGluUXVvdGU+XFw+KFxcXFxzKyk/KT8oPzxpbkxpc3Q+LSApPyg/PHN0YXJ0U3R5bGU+W19cXFxcKn5gXSopKD88YXR0cmlidXRlPlswLTlcXFxcd1xcXFxwe0xldHRlcn1cXFxccHtFbW9qaV9QcmVzZW50YXRpb259XVstMC05XFxcXHdcXFxccHtMZXR0ZXJ9XFxcXHB7RW1vamlfUHJlc2VudGF0aW9ufVxcXFxzXSopKD88ZW5kU3R5bGU+W19cXFxcKn5gXSopKD88YmVmb3JlU2VwYXJhdG9yU3BhY2VyPlxcXFxzKilcIjtcblxuZXhwb3J0IGNvbnN0IGlubGluZUZpZWxkUmVnZXggPSAoYXR0cmlidXRlOiBzdHJpbmcpID0+IGAoPzxpblF1b3RlPlxcPihcXFxccyspPyk/KD88aW5MaXN0Pi0gKT8oPzxzdGFydFN0eWxlPltfXFxcXCp+XFxgXSopKD88YXR0cmlidXRlPiR7YXR0cmlidXRlfSkoPzxlbmRTdHlsZT5bX1xcXFwqflxcYF0qKSg/PGJlZm9yZVNlcGFyYXRvclNwYWNlcj5cXFxccyopOjooPzxhZnRlclNlcGFyYXRvclNwYWNlcj5cXFxccyopYDtcblxuZXhwb3J0IGNvbnN0IGZ1bGxMaW5lUmVnZXggPSBuZXcgUmVnRXhwKGBeJHtnZW5lcmljRmllbGRSZWdleH06OlxcXFxzKig/PHZhbHVlcz4uKik/YCwgXCJ1XCIpO1xuXG5leHBvcnQgY29uc3QgaW5TZW50ZW5jZVJlZ2V4QnJhY2tldHMgPSBuZXcgUmVnRXhwKGBcXFxcWyR7Z2VuZXJpY0ZpZWxkUmVnZXh9OjpcXFxccyooPzx2YWx1ZXM+W15cXFxcXV0rKT9cXFxcXWAsIFwiZ3VcIik7XG5cbmV4cG9ydCBjb25zdCBpblNlbnRlbmNlUmVnZXhQYXIgPSBuZXcgUmVnRXhwKGBcXFxcKCR7Z2VuZXJpY0ZpZWxkUmVnZXh9OjpcXFxccyooPzx2YWx1ZXM+W15cXFxcKV0rKT9cXFxcKWAsIFwiZ3VcIik7XG5cbmV4cG9ydCBjb25zdCBlbmNvZGVMaW5rID0gKHZhbHVlOiBzdHJpbmcpOiBzdHJpbmcgPT4ge1xuICAgIC8qIHJlcGxhY2UgbGluayBicmFja2V0cyBieSBcImltcG9zc2libGVcIiBjb21iaW5hdGlvbiBvZiBjaGFyYWN0ZXJzIHNvIHRoYXQgdGhleSB3b24ndCBiZSBtaXhlZCB1cCB3aXRoIGluU2VudGVuY2UgZmllbGQgYnJhY2tldHMgd2hlbiBzZWFjaGluZyB3aXRoIHJlZ2V4Ki9cbiAgICByZXR1cm4gdmFsdWUgPyB2YWx1ZVxuICAgICAgICAucmVwbGFjZSgvXFxbXFxbL2csIFwiXHVEODNEXHVERDI3XHVEODNEXHVEQzAwXCIpXG4gICAgICAgIC5yZXBsYWNlKC9cXF1cXF0vZywgXCJcdUQ4M0RcdURDMTNcdUQ4M0RcdURENENcIikgOiB2YWx1ZVxufVxuXG5leHBvcnQgY29uc3QgZGVjb2RlTGluayA9ICh2YWx1ZTogc3RyaW5nKTogc3RyaW5nID0+IHtcbiAgICAvKiByZXBsYWNlIGxpbmsgYnJhY2tldHMgYnkgXCJpbXBvc3NpYmxlXCIgY29tYmluYXRpb24gb2YgY2hhcmFjdGVycyBzbyB0aGF0IHRoZXkgd29uJ3QgYmUgbWl4ZWQgdXAgd2l0aCBpblNlbnRlbmNlIGZpZWxkIGJyYWNrZXRzIHdoZW4gc2VhY2hpbmcgd2l0aCByZWdleCovXG4gICAgcmV0dXJuIHZhbHVlID8gdmFsdWVcbiAgICAgICAgLnJlcGxhY2UoL1x1RDgzRFx1REQyN1x1RDgzRFx1REMwMC9ndSwgXCJbW1wiKVxuICAgICAgICAucmVwbGFjZSgvXHVEODNEXHVEQzEzXHVEODNEXHVERDRDL2d1LCBcIl1dXCIpIDogdmFsdWVcbn1cblxuZXhwb3J0IGNvbnN0IGZyb250TWF0dGVyTGluZUZpZWxkID0gKGxpbmU6IHN0cmluZyk6IHN0cmluZyB8IHVuZGVmaW5lZCA9PiB7XG4gICAgY29uc3QgZnJvbnRNYXR0ZXJSZWdleCA9IG5ldyBSZWdFeHAoLyg/PGF0dHJpYnV0ZT5bMC05XFx3XFxwe0xldHRlcn1cXHB7RW1vamlfUHJlc2VudGF0aW9ufV1bLTAtOVxcd1xccHtMZXR0ZXJ9XFxwe0Vtb2ppX1ByZXNlbnRhdGlvbn1cXHNdKlteXFxzXSkoPzxiZWZvcmVTZXBhcmF0b3JTcGFjZXI+XFxzKik6KD88YWZ0ZXJTZXBhcmF0b3JTcGFjZXI+XFxzKikoPzx2YWx1ZXM+LiopL3UpXG4gICAgY29uc3QgZlIgPSBsaW5lLm1hdGNoKGZyb250TWF0dGVyUmVnZXgpO1xuXG4gICAgaWYgKGZSPy5ncm91cHMpIHtcbiAgICAgICAgY29uc3QgeyBhdHRyaWJ1dGUsIHZhbHVlcyB9ID0gZlI/Lmdyb3Vwc1xuICAgICAgICByZXR1cm4gYXR0cmlidXRlXG4gICAgfVxufVxuXG5leHBvcnQgY29uc3QgZ2V0TGluZUZpZWxkcyA9IChsaW5lOiBzdHJpbmcpOiB7IGF0dHJpYnV0ZTogc3RyaW5nLCB2YWx1ZXM6IHN0cmluZywgaW5kZXg6IG51bWJlciwgbGVuZ3RoOiBudW1iZXIgfVtdID0+IHtcbiAgICBjb25zdCBmaWVsZHM6IHsgYXR0cmlidXRlOiBzdHJpbmcsIHZhbHVlczogc3RyaW5nLCBpbmRleDogbnVtYmVyLCBsZW5ndGg6IG51bWJlciB9W10gPSBbXVxuICAgIGNvbnN0IGZSID0gbGluZS5tYXRjaChmdWxsTGluZVJlZ2V4KTtcbiAgICBpZiAoZlI/Lmdyb3Vwcykge1xuICAgICAgICBjb25zdCB7IGF0dHJpYnV0ZSwgdmFsdWVzIH0gPSBmUj8uZ3JvdXBzXG4gICAgICAgIGZpZWxkcy5wdXNoKHsgYXR0cmlidXRlLCB2YWx1ZXMsIGluZGV4OiAwLCBsZW5ndGg6IGxpbmUubGVuZ3RoIH0pXG4gICAgfSBlbHNlIHtcbiAgICAgICAgY29uc3Qgc1JCayA9IGVuY29kZUxpbmsobGluZSkubWF0Y2hBbGwoaW5TZW50ZW5jZVJlZ2V4QnJhY2tldHMpO1xuICAgICAgICBsZXQgbmV4dCA9IHNSQmsubmV4dCgpO1xuICAgICAgICB3aGlsZSAoIW5leHQuZG9uZSkge1xuICAgICAgICAgICAgaWYgKG5leHQudmFsdWUuZ3JvdXBzKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgeyBhdHRyaWJ1dGUsIHZhbHVlcyB9ID0gbmV4dC52YWx1ZS5ncm91cHM7XG4gICAgICAgICAgICAgICAgZmllbGRzLnB1c2goeyBhdHRyaWJ1dGUsIHZhbHVlczogZGVjb2RlTGluayh2YWx1ZXMpLCBpbmRleDogbmV4dC52YWx1ZS5pbmRleCB8fCAwLCBsZW5ndGg6IG5leHQudmFsdWVbMF0ubGVuZ3RoIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgbmV4dCA9IHNSQmsubmV4dCgpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHNSQmMgPSBlbmNvZGVMaW5rKGxpbmUpLm1hdGNoQWxsKGluU2VudGVuY2VSZWdleFBhcik7XG4gICAgICAgIG5leHQgPSBzUkJjLm5leHQoKTtcbiAgICAgICAgd2hpbGUgKCFuZXh0LmRvbmUpIHtcbiAgICAgICAgICAgIGlmIChuZXh0LnZhbHVlLmdyb3Vwcykge1xuICAgICAgICAgICAgICAgIGNvbnN0IHsgYXR0cmlidXRlLCB2YWx1ZXMgfSA9IG5leHQudmFsdWUuZ3JvdXBzO1xuICAgICAgICAgICAgICAgIGZpZWxkcy5wdXNoKHsgYXR0cmlidXRlLCB2YWx1ZXM6IGRlY29kZUxpbmsodmFsdWVzKSwgaW5kZXg6IG5leHQudmFsdWUuaW5kZXggfHwgMCwgbGVuZ3RoOiBuZXh0LnZhbHVlWzBdLmxlbmd0aCB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIG5leHQgPSBzUkJjLm5leHQoKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBmaWVsZHMuc29ydCgoYSwgYikgPT4ge1xuICAgICAgICBpZiAoYS5pbmRleCA8IGIuaW5kZXgpIHJldHVybiAtMTtcbiAgICAgICAgaWYgKGEuaW5kZXggPiBiLmluZGV4KSByZXR1cm4gMTtcbiAgICAgICAgcmV0dXJuIDBcbiAgICB9KVxuICAgIHJldHVybiBmaWVsZHNcbn0iLCAiaW1wb3J0IE1ldGFkYXRhTWVudSBmcm9tIFwibWFpblwiO1xuaW1wb3J0IHsgTWVudSwgVGV4dENvbXBvbmVudCwgVEZpbGUgfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCB7IHJlcGxhY2VWYWx1ZXMgfSBmcm9tIFwic3JjL2NvbW1hbmRzL3JlcGxhY2VWYWx1ZXNcIjtcbmltcG9ydCB7IEZpbGVDbGFzcyB9IGZyb20gXCJzcmMvZmlsZUNsYXNzL2ZpbGVDbGFzc1wiO1xuaW1wb3J0IEZDU00gZnJvbSBcInNyYy9vcHRpb25zL0ZpZWxkQ29tbWFuZFN1Z2dlc3RNb2RhbFwiO1xuaW1wb3J0IEluc2VydEZpZWxkU3VnZ2VzdE1vZGFsIGZyb20gXCJzcmMvb3B0aW9uTW9kYWxzL2luc2VydEZpZWxkU3VnZ2VzdE1vZGFsXCI7XG5pbXBvcnQgRmllbGRTZXR0aW5nc01vZGFsIGZyb20gXCJzcmMvc2V0dGluZ3MvRmllbGRTZXR0aW5nc01vZGFsXCI7XG5pbXBvcnQgeyBGaWVsZE1hbmFnZXIgYXMgRk0sIEZpZWxkVHlwZSB9IGZyb20gXCJzcmMvdHlwZXMvZmllbGRUeXBlc1wiO1xuaW1wb3J0IEZpZWxkIGZyb20gXCIuL0ZpZWxkXCI7XG5cbmV4cG9ydCBjb25zdCBlbnVtIFNldHRpbmdMb2NhdGlvbiB7XG4gICAgXCJQbHVnaW5TZXR0aW5nc1wiLFxuICAgIFwiRmlsZUNsYXNzQXR0cmlidXRlU2V0dGluZ3NcIlxufVxuXG5leHBvcnQgYWJzdHJhY3QgY2xhc3MgRmllbGRNYW5hZ2VyIHtcblxuICAgIGFic3RyYWN0IGFkZEZpZWxkT3B0aW9uKG5hbWU6IHN0cmluZywgdmFsdWU6IHN0cmluZywgZmlsZTogVEZpbGUsIGxvY2F0aW9uOiBNZW51IHwgRkNTTSk6IHZvaWQ7XG4gICAgYWJzdHJhY3QgdmFsaWRhdGVPcHRpb25zKCk6IGJvb2xlYW47XG4gICAgYWJzdHJhY3QgY3JlYXRlU2V0dGluZ0NvbnRhaW5lcihwYXJlbnRDb250YWluZXI6IEhUTUxEaXZFbGVtZW50LCBwbHVnaW46IE1ldGFkYXRhTWVudSwgbG9jYXRpb24/OiBTZXR0aW5nTG9jYXRpb24pOiB2b2lkO1xuICAgIGFic3RyYWN0IGNyZWF0ZUR2RmllbGQoXG4gICAgICAgIGR2OiBhbnksXG4gICAgICAgIHA6IGFueSxcbiAgICAgICAgZmllbGRDb250YWluZXI6IEhUTUxFbGVtZW50LFxuICAgICAgICBhdHRycz86IHtcbiAgICAgICAgICAgIGNscz86IHN0cmluZyxcbiAgICAgICAgICAgIGF0dHI/OiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+LFxuICAgICAgICAgICAgb3B0aW9ucz86IFJlY29yZDxzdHJpbmcsIHN0cmluZz5cbiAgICAgICAgfVxuICAgICk6IHZvaWRcbiAgICBhYnN0cmFjdCBnZXRPcHRpb25zU3RyKCk6IHN0cmluZztcbiAgICBhYnN0cmFjdCBjcmVhdGVBbmRPcGVuRmllbGRNb2RhbChmaWxlOiBURmlsZSwgc2VsZWN0ZWRGaWVsZE5hbWU6IHN0cmluZywgdmFsdWU/OiBzdHJpbmcsIGxpbmVOdW1iZXI/OiBudW1iZXIsIGluRnJvbnRtYXR0ZXI/OiBib29sZWFuLCBhZnRlcj86IGJvb2xlYW4pOiB2b2lkXG5cbiAgICBjb25zdHJ1Y3RvcihwdWJsaWMgcGx1Z2luOiBNZXRhZGF0YU1lbnUsIHB1YmxpYyBmaWVsZDogRmllbGQsIHB1YmxpYyB0eXBlOiBGaWVsZFR5cGUpIHtcbiAgICAgICAgaWYgKGZpZWxkLnR5cGUgIT09IHR5cGUpIHRocm93IEVycm9yKGBUaGlzIGZpZWxkIGlzIG5vdCBvZiB0eXBlICR7dHlwZX1gKVxuICAgIH1cblxuICAgIHN0YXRpYyBidWlsZE1hcmtEb3duTGluayhwbHVnaW46IE1ldGFkYXRhTWVudSwgZmlsZTogVEZpbGUsIHBhdGg6IHN0cmluZywgYWxpYXM/OiBzdHJpbmcpOiBzdHJpbmcge1xuICAgICAgICBjb25zdCBkZXN0RmlsZSA9IHBsdWdpbi5hcHAubWV0YWRhdGFDYWNoZS5nZXRGaXJzdExpbmtwYXRoRGVzdChwYXRoLCBmaWxlLnBhdGgpXG4gICAgICAgIGlmIChkZXN0RmlsZSkge1xuICAgICAgICAgICAgcmV0dXJuIHBsdWdpbi5hcHAuZmlsZU1hbmFnZXIuZ2VuZXJhdGVNYXJrZG93bkxpbmsoXG4gICAgICAgICAgICAgICAgZGVzdEZpbGUsXG4gICAgICAgICAgICAgICAgZmlsZS5wYXRoLFxuICAgICAgICAgICAgICAgIHVuZGVmaW5lZCxcbiAgICAgICAgICAgICAgICBhbGlhcyxcbiAgICAgICAgICAgIClcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gXCJcIlxuICAgIH1cblxuICAgIHB1YmxpYyB2YWxpZGF0ZU5hbWUodGV4dElucHV0OiBUZXh0Q29tcG9uZW50LCBpbnNlcnRBZnRlcjogRWxlbWVudCk6IGJvb2xlYW4ge1xuICAgICAgICBsZXQgZXJyb3IgPSBmYWxzZTtcbiAgICAgICAgaWYgKC9eWyM+LV0vLnRlc3QodGhpcy5maWVsZC5uYW1lKSkge1xuICAgICAgICAgICAgRmllbGRTZXR0aW5nc01vZGFsLnNldFZhbGlkYXRpb25FcnJvcihcbiAgICAgICAgICAgICAgICB0ZXh0SW5wdXQsIGluc2VydEFmdGVyLFxuICAgICAgICAgICAgICAgIFwiRmllbGQgbmFtZSBjYW5ub3Qgc3RhcnQgd2l0aCAjLCA+LCAtXCJcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICBlcnJvciA9IHRydWU7XG4gICAgICAgIH07XG4gICAgICAgIGlmICh0aGlzLmZpZWxkLm5hbWUgPT0gXCJcIikge1xuICAgICAgICAgICAgRmllbGRTZXR0aW5nc01vZGFsLnNldFZhbGlkYXRpb25FcnJvcihcbiAgICAgICAgICAgICAgICB0ZXh0SW5wdXQsIGluc2VydEFmdGVyLFxuICAgICAgICAgICAgICAgIFwiRmllbGQgbmFtZSBjYW4gbm90IGJlIEVtcHR5XCJcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICBlcnJvciA9IHRydWU7XG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiAhZXJyb3JcbiAgICB9XG5cbiAgICBwdWJsaWMgdmFsaWRhdGVWYWx1ZSh2YWx1ZTogc3RyaW5nKTogYm9vbGVhbiB7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cblxuICAgIHB1YmxpYyBzdGF0aWMgYXN5bmMgcmVwbGFjZVZhbHVlcyhwbHVnaW46IE1ldGFkYXRhTWVudSwgcGF0aDogc3RyaW5nLCBmaWVsZE5hbWU6IHN0cmluZywgdmFsdWU6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICBjb25zdCBmaWxlID0gcGx1Z2luLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgocGF0aClcbiAgICAgICAgaWYgKGZpbGUgaW5zdGFuY2VvZiBURmlsZSAmJiBmaWxlLmV4dGVuc2lvbiA9PSBcIm1kXCIpIHtcbiAgICAgICAgICAgIGF3YWl0IHBsdWdpbi5maWxlVGFza01hbmFnZXIucHVzaFRhc2soKCkgPT4geyByZXBsYWNlVmFsdWVzKHBsdWdpbiwgZmlsZSwgZmllbGROYW1lLCB2YWx1ZSkgfSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwdWJsaWMgc3RhdGljIGlzTWVudShsb2NhdGlvbjogTWVudSB8IFwiSW5zZXJ0RmllbGRDb21tYW5kXCIgfCBGQ1NNKTogbG9jYXRpb24gaXMgTWVudSB7XG4gICAgICAgIHJldHVybiAobG9jYXRpb24gYXMgTWVudSkuYWRkSXRlbSAhPT0gdW5kZWZpbmVkO1xuICAgIH07XG5cbiAgICBwdWJsaWMgc3RhdGljIGlzU3VnZ2VzdChsb2NhdGlvbjogTWVudSB8IFwiSW5zZXJ0RmllbGRDb21tYW5kXCIgfCBGQ1NNKTogbG9jYXRpb24gaXMgRkNTTSB7XG4gICAgICAgIHJldHVybiAobG9jYXRpb24gYXMgRkNTTSkuZ2V0SXRlbXMgIT09IHVuZGVmaW5lZDtcbiAgICB9O1xuXG4gICAgcHVibGljIHN0YXRpYyBpc0luc2VydEZpZWxkQ29tbWFuZChsb2NhdGlvbjogTWVudSB8IFwiSW5zZXJ0RmllbGRDb21tYW5kXCIgfCBGQ1NNKTogbG9jYXRpb24gaXMgXCJJbnNlcnRGaWVsZENvbW1hbmRcIiB7XG4gICAgICAgIHJldHVybiAobG9jYXRpb24gYXMgc3RyaW5nKSA9PT0gXCJJbnNlcnRGaWVsZENvbW1hbmRcIjtcbiAgICB9XG5cbiAgICBwdWJsaWMgc3RhdGljIGNyZWF0ZUFuZE9wZW5Nb2RhbChcbiAgICAgICAgcGx1Z2luOiBNZXRhZGF0YU1lbnUsXG4gICAgICAgIGZpbGU6IFRGaWxlLFxuICAgICAgICBmaWVsZE5hbWU6IHN0cmluZyxcbiAgICAgICAgZmllbGQ6IEZpZWxkIHwgdW5kZWZpbmVkLFxuICAgICAgICB2YWx1ZT86IHN0cmluZyxcbiAgICAgICAgbGluZU51bWJlcj86IG51bWJlcixcbiAgICAgICAgaW5Gcm9udG1hdHRlcj86IGJvb2xlYW4sXG4gICAgICAgIGFmdGVyPzogYm9vbGVhblxuICAgICk6IHZvaWQge1xuICAgICAgICBpZiAoZmllbGQpIHtcbiAgICAgICAgICAgIGNvbnN0IGZpZWxkTWFuYWdlciA9IG5ldyBGTVtmaWVsZC50eXBlXShwbHVnaW4sIGZpZWxkKTtcbiAgICAgICAgICAgIGZpZWxkTWFuYWdlci5jcmVhdGVBbmRPcGVuRmllbGRNb2RhbChmaWxlLCBmaWVsZE5hbWUsIHZhbHVlLCBsaW5lTnVtYmVyLCBpbkZyb250bWF0dGVyLCBhZnRlcik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjb25zdCBmaWVsZE1hbmFnZXIgPSBGaWVsZE1hbmFnZXIuY3JlYXRlRGVmYXVsdChwbHVnaW4sIGZpZWxkTmFtZSEpO1xuICAgICAgICAgICAgZmllbGRNYW5hZ2VyLmNyZWF0ZUFuZE9wZW5GaWVsZE1vZGFsKGZpbGUsIGZpZWxkTmFtZSEsIHZhbHVlLCBsaW5lTnVtYmVyLCBpbkZyb250bWF0dGVyLCBhZnRlcik7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwdWJsaWMgc3RhdGljIG9wZW5GaWVsZE1vZGFsKFxuICAgICAgICBwbHVnaW46IE1ldGFkYXRhTWVudSxcbiAgICAgICAgZmlsZTogVEZpbGUsXG4gICAgICAgIGZpZWxkTmFtZTogc3RyaW5nIHwgdW5kZWZpbmVkLFxuICAgICAgICB2YWx1ZTogc3RyaW5nLFxuICAgICAgICBsaW5lTnVtYmVyOiBudW1iZXIsXG4gICAgICAgIGluRnJvbnRtYXR0ZXI6IGJvb2xlYW4sXG4gICAgICAgIGFmdGVyOiBib29sZWFuLFxuICAgICAgICBmaWxlQ2xhc3M/OiBGaWxlQ2xhc3NcbiAgICApIHtcbiAgICAgICAgaWYgKCFmaWVsZE5hbWUpIHtcbiAgICAgICAgICAgIGNvbnN0IG1vZGFsID0gbmV3IEluc2VydEZpZWxkU3VnZ2VzdE1vZGFsKHBsdWdpbiwgZmlsZSwgbGluZU51bWJlciwgaW5Gcm9udG1hdHRlciwgYWZ0ZXIsIGZpbGVDbGFzcyk7XG4gICAgICAgICAgICBtb2RhbC5vcGVuKCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBpZiAoZmlsZUNsYXNzKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgZmlsZUNsYXNzQXR0cmlidXRlc1dpdGhOYW1lID0gZmlsZUNsYXNzLmF0dHJpYnV0ZXMuZmlsdGVyKGF0dHIgPT4gYXR0ci5uYW1lID09IGZpZWxkTmFtZSk7XG4gICAgICAgICAgICAgICAgbGV0IGZpZWxkOiBGaWVsZCB8IHVuZGVmaW5lZFxuICAgICAgICAgICAgICAgIGlmIChmaWxlQ2xhc3NBdHRyaWJ1dGVzV2l0aE5hbWUubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBmaWxlQ2xhc3NBdHRyaWJ1dGUgPSBmaWxlQ2xhc3NBdHRyaWJ1dGVzV2l0aE5hbWVbMF07XG4gICAgICAgICAgICAgICAgICAgIGZpZWxkID0gZmlsZUNsYXNzQXR0cmlidXRlLmdldEZpZWxkKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMuY3JlYXRlQW5kT3Blbk1vZGFsKHBsdWdpbiwgZmlsZSwgZmllbGROYW1lLCBmaWVsZCwgdmFsdWUsIGxpbmVOdW1iZXIsIGluRnJvbnRtYXR0ZXIsIGFmdGVyKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgY29uc3QgZmllbGQgPSBwbHVnaW4uc2V0dGluZ3MucHJlc2V0RmllbGRzLmZpbHRlcihfZmllbGQgPT4gX2ZpZWxkLm5hbWUgPT0gZmllbGROYW1lKVswXTtcbiAgICAgICAgICAgICAgICB0aGlzLmNyZWF0ZUFuZE9wZW5Nb2RhbChwbHVnaW4sIGZpbGUsIGZpZWxkTmFtZSwgZmllbGQsIHZhbHVlLCBsaW5lTnVtYmVyLCBpbkZyb250bWF0dGVyLCBhZnRlcik7XG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHVibGljIHN0YXRpYyBjcmVhdGVEZWZhdWx0KHBsdWdpbjogTWV0YWRhdGFNZW51LCBuYW1lOiBzdHJpbmcpOiBGaWVsZE1hbmFnZXIge1xuICAgICAgICBjb25zdCBmaWVsZCA9IEZpZWxkLmNyZWF0ZURlZmF1bHQobmFtZSk7XG4gICAgICAgIHJldHVybiBuZXcgRk1bZmllbGQudHlwZV0ocGx1Z2luLCBmaWVsZCk7XG4gICAgfVxuXG4gICAgcHVibGljIHN0YXRpYyBzdHJpbmdUb0Jvb2xlYW4odmFsdWU6IHN0cmluZyk6IGJvb2xlYW4ge1xuICAgICAgICBsZXQgdG9Cb29sZWFuVmFsdWU6IGJvb2xlYW4gPSBmYWxzZTtcbiAgICAgICAgaWYgKGlzQm9vbGVhbih2YWx1ZSkpIHtcbiAgICAgICAgICAgIHRvQm9vbGVhblZhbHVlID0gdmFsdWU7XG4gICAgICAgIH0gZWxzZSBpZiAoL3RydWUvaS50ZXN0KHZhbHVlKSkge1xuICAgICAgICAgICAgdG9Cb29sZWFuVmFsdWUgPSB0cnVlO1xuICAgICAgICB9IGVsc2UgaWYgKC9mYWxzZS9pLnRlc3QodmFsdWUpKSB7XG4gICAgICAgICAgICB0b0Jvb2xlYW5WYWx1ZSA9IGZhbHNlO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhyb3cgRXJyb3IoXCJ0aGlzIHZhbHVlIGlzIG5vdCBhIGJvb2xlYW5cIilcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIHRvQm9vbGVhblZhbHVlO1xuICAgIH1cbn0iLCAiaW1wb3J0IE1ldGFkYXRhTWVudSBmcm9tIFwibWFpblwiO1xuaW1wb3J0IHsgRnV6enlNYXRjaCwgRnV6enlTdWdnZXN0TW9kYWwsIHNldEljb24sIFRGaWxlIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgRmllbGQgZnJvbSBcInNyYy9maWVsZHMvRmllbGRcIjtcbmltcG9ydCB7IEZpbGVDbGFzcyB9IGZyb20gXCJzcmMvZmlsZUNsYXNzL2ZpbGVDbGFzc1wiO1xuaW1wb3J0IHsgRmllbGRJY29uLCBGaWVsZE1hbmFnZXIsIEZpZWxkVHlwZSwgRmllbGRUeXBlVGFnQ2xhc3MgfSBmcm9tIFwic3JjL3R5cGVzL2ZpZWxkVHlwZXNcIjtcbmltcG9ydCBhZGROZXdGaWVsZE1vZGFsIGZyb20gXCIuL2FkZE5ld0ZpZWxkTW9kYWxcIjtcblxuXG5pbnRlcmZhY2UgT3B0aW9uIHtcbiAgICBhY3Rpb25MYWJlbDogc3RyaW5nLFxuICAgIHR5cGU/OiBGaWVsZFR5cGVcbn1cblxuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBJbnNlcnRGaWVsZFN1Z2dlc3RNb2RhbCBleHRlbmRzIEZ1enp5U3VnZ2VzdE1vZGFsPE9wdGlvbj4ge1xuXG4gICAgY29uc3RydWN0b3IoXG4gICAgICAgIHByaXZhdGUgcGx1Z2luOiBNZXRhZGF0YU1lbnUsXG4gICAgICAgIHByaXZhdGUgZmlsZTogVEZpbGUsXG4gICAgICAgIHByaXZhdGUgbGluZU51bWJlcjogbnVtYmVyLFxuICAgICAgICBwcml2YXRlIGluRnJvbnRtYXR0ZXI6IGJvb2xlYW4sXG4gICAgICAgIHByaXZhdGUgYWZ0ZXI6IGJvb2xlYW4sXG4gICAgICAgIHByaXZhdGUgZmlsZUNsYXNzPzogRmlsZUNsYXNzXG4gICAgKSB7IHN1cGVyKHBsdWdpbi5hcHApOyB9O1xuXG4gICAgZ2V0SXRlbXMoKTogT3B0aW9uW10ge1xuICAgICAgICBpZiAodGhpcy5maWxlQ2xhc3MpIHtcbiAgICAgICAgICAgIHJldHVybiBbeyBhY3Rpb25MYWJlbDogJysrTmV3KysnIH1dXG4gICAgICAgICAgICAgICAgLmNvbmNhdCh0aGlzLmZpbGVDbGFzcy5hdHRyaWJ1dGVzLm1hcChhdHRyID0+IHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHsgYWN0aW9uTGFiZWw6IGF0dHIubmFtZSwgdHlwZTogYXR0ci50eXBlIH1cbiAgICAgICAgICAgICAgICB9KSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gW3sgYWN0aW9uTGFiZWw6ICcrK05ldysrJyB9XVxuICAgICAgICAgICAgICAgIC5jb25jYXQodGhpcy5wbHVnaW4uc2V0dGluZ3MucHJlc2V0RmllbGRzLm1hcChzZXR0aW5nID0+IHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHsgYWN0aW9uTGFiZWw6IHNldHRpbmcubmFtZSwgdHlwZTogc2V0dGluZy50eXBlIH1cbiAgICAgICAgICAgICAgICB9KSk7XG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgZ2V0SXRlbVRleHQoaXRlbTogT3B0aW9uKTogc3RyaW5nIHtcbiAgICAgICAgcmV0dXJuIGl0ZW0uYWN0aW9uTGFiZWw7XG4gICAgfVxuXG4gICAgcmVuZGVyU3VnZ2VzdGlvbihpdGVtOiBGdXp6eU1hdGNoPE9wdGlvbj4sIGVsOiBIVE1MRWxlbWVudCk6IHZvaWQge1xuICAgICAgICBlbC5hZGRDbGFzcyhcIm1ldGFkYXRhLW1lbnUtY29tbWFuZC1zdWdnZXN0LWl0ZW1cIilcbiAgICAgICAgY29uc3QgaWNvbkNvbnRhaW5lciA9IGVsLmNyZWF0ZURpdih7IGNsczogXCJtZXRhZGF0YS1tZW51LWNvbW1hbmQtc3VnZ2VzdC1pY29uXCIgfSlcbiAgICAgICAgaXRlbS5pdGVtLnR5cGUgPyBzZXRJY29uKGljb25Db250YWluZXIsIEZpZWxkSWNvbltpdGVtLml0ZW0udHlwZV0pIDogc2V0SWNvbihpY29uQ29udGFpbmVyLCBcInBsdXMtd2l0aC1jaXJjbGVcIilcbiAgICAgICAgZWwuY3JlYXRlRGl2KHsgdGV4dDogaXRlbS5pdGVtLmFjdGlvbkxhYmVsLCBjbHM6IFwibWV0YWRhdGEtbWVudS1jb21tYW5kLXN1Z2dlc3QtYWN0aW9uLWxhYmVsXCIgfSlcbiAgICAgICAgZWwuY3JlYXRlRGl2KHsgY2xzOiBcIm1ldGFkYXRhLW1lbnUtY29tbWFuZC1zdWdnZXN0LXNwYWNlclwiIH0pXG4gICAgICAgIGlmIChpdGVtLml0ZW0udHlwZSkge1xuICAgICAgICAgICAgY29uc3QgdHlwZUNvbnRhaW5lciA9IGVsLmNyZWF0ZUVsKFwiZGl2XCIpXG4gICAgICAgICAgICB0eXBlQ29udGFpbmVyLnNldEF0dHIoXCJjbGFzc1wiLCBgbWV0YWRhdGEtbWVudS1zZXR0aW5nLWl0ZW0taW5mby10eXBlICR7RmllbGRUeXBlVGFnQ2xhc3NbaXRlbS5pdGVtLnR5cGVdfWApXG4gICAgICAgICAgICB0eXBlQ29udGFpbmVyLnNldFRleHQoaXRlbS5pdGVtLnR5cGUpXG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBvbkNob29zZUl0ZW0oaXRlbTogT3B0aW9uLCBldnQ6IE1vdXNlRXZlbnQgfCBLZXlib2FyZEV2ZW50KTogdm9pZCB7XG4gICAgICAgIGlmIChpdGVtLmFjdGlvbkxhYmVsID09PSBcIisrTmV3KytcIikge1xuICAgICAgICAgICAgY29uc3QgbmV3RmllbGRNb2RhbCA9IG5ldyBhZGROZXdGaWVsZE1vZGFsKHRoaXMucGx1Z2luLCB0aGlzLmxpbmVOdW1iZXIsIHRoaXMuZmlsZSwgdGhpcy5pbkZyb250bWF0dGVyLCB0aGlzLmFmdGVyKTtcbiAgICAgICAgICAgIG5ld0ZpZWxkTW9kYWwub3BlbigpO1xuICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgICB9IGVsc2UgaWYgKHRoaXMuZmlsZUNsYXNzKSB7XG4gICAgICAgICAgICBjb25zdCBmaWxlQ2xhc3NBdHRyaWJ1dGVzV2l0aE5hbWUgPSB0aGlzLmZpbGVDbGFzcy5hdHRyaWJ1dGVzLmZpbHRlcihhdHRyID0+IGF0dHIubmFtZSA9PSBpdGVtLmFjdGlvbkxhYmVsKTtcbiAgICAgICAgICAgIGxldCBmaWVsZDogRmllbGQgfCB1bmRlZmluZWRcbiAgICAgICAgICAgIGxldCB0eXBlOiBGaWVsZFR5cGUgfCB1bmRlZmluZWRcbiAgICAgICAgICAgIGlmIChmaWxlQ2xhc3NBdHRyaWJ1dGVzV2l0aE5hbWUubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGZpbGVDbGFzc0F0dHJpYnV0ZSA9IGZpbGVDbGFzc0F0dHJpYnV0ZXNXaXRoTmFtZVswXTtcbiAgICAgICAgICAgICAgICBmaWVsZCA9IGZpbGVDbGFzc0F0dHJpYnV0ZS5nZXRGaWVsZCgpO1xuICAgICAgICAgICAgICAgIHR5cGUgPSBmaWxlQ2xhc3NBdHRyaWJ1dGUudHlwZVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGZpZWxkKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgZmllbGRNYW5hZ2VyID0gbmV3IEZpZWxkTWFuYWdlcltmaWVsZC50eXBlXSh0aGlzLnBsdWdpbiwgZmllbGQpO1xuICAgICAgICAgICAgICAgIGZpZWxkTWFuYWdlci5jcmVhdGVBbmRPcGVuRmllbGRNb2RhbCh0aGlzLmZpbGUsIGl0ZW0uYWN0aW9uTGFiZWwsIFwiXCIsIHRoaXMubGluZU51bWJlciwgdGhpcy5pbkZyb250bWF0dGVyLCB0aGlzLmFmdGVyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuY2xvc2UoKVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29uc3QgZmllbGQgPSB0aGlzLnBsdWdpbi5zZXR0aW5ncy5wcmVzZXRGaWVsZHMuZmlsdGVyKF9maWVsZCA9PiBfZmllbGQubmFtZSA9PSBpdGVtLmFjdGlvbkxhYmVsKVswXTtcbiAgICAgICAgICAgIGNvbnN0IGZpZWxkTWFuYWdlciA9IG5ldyBGaWVsZE1hbmFnZXJbZmllbGQudHlwZV0odGhpcy5wbHVnaW4sIGZpZWxkKTtcbiAgICAgICAgICAgIGZpZWxkTWFuYWdlci5jcmVhdGVBbmRPcGVuRmllbGRNb2RhbCh0aGlzLmZpbGUsIGl0ZW0uYWN0aW9uTGFiZWwsIFwiXCIsIHRoaXMubGluZU51bWJlciwgdGhpcy5pbkZyb250bWF0dGVyLCB0aGlzLmFmdGVyKTtcbiAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgICAgfTtcbiAgICB9XG59IiwgImltcG9ydCB7IE1vZGFsLCBUZXh0Q29tcG9uZW50LCBCdXR0b25Db21wb25lbnQsIEV4dHJhQnV0dG9uQ29tcG9uZW50LCBURmlsZSB9IGZyb20gXCJvYnNpZGlhblwiO1xuaW1wb3J0IE1ldGFkYXRhTWVudSBmcm9tIFwibWFpblwiO1xuaW1wb3J0IHsgaW5zZXJ0VmFsdWVzIH0gZnJvbSBcInNyYy9jb21tYW5kcy9pbnNlcnRWYWx1ZXNcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgYWRkTmV3RmllbGRNb2RhbCBleHRlbmRzIE1vZGFsIHtcblxuICAgIGNvbnN0cnVjdG9yKFxuICAgICAgICBwcml2YXRlIHBsdWdpbjogTWV0YWRhdGFNZW51LFxuICAgICAgICBwcml2YXRlIGxpbmVOdW1iZXI6IG51bWJlcixcbiAgICAgICAgcHJpdmF0ZSBmaWxlOiBURmlsZSxcbiAgICAgICAgcHJpdmF0ZSBpbkZyb250bWF0dGVyOiBib29sZWFuLFxuICAgICAgICBwcml2YXRlIGFmdGVyOiBib29sZWFuXG4gICAgKSB7IHN1cGVyKHBsdWdpbi5hcHApIH1cblxuICAgIG9uT3BlbigpIHtcbiAgICAgICAgdGhpcy50aXRsZUVsLnNldFRleHQoXCJJbnNlcnQgbmV3IGZpZWxkXCIpO1xuICAgICAgICBjb25zdCBhZGROZXdGaWVsZENvbnRhaW5lciA9IHRoaXMuY29udGVudEVsLmNyZWF0ZURpdigpO1xuICAgICAgICBjb25zdCBuYW1lSW5wdXRDb250YWluZXIgPSBhZGROZXdGaWVsZENvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IFwibWV0YWRhdGEtbWVudS1wcm9tcHQtY29udGFpbmVyXCIgfSk7XG4gICAgICAgIG5hbWVJbnB1dENvbnRhaW5lci5zZXRUZXh0KFwiRmllbGQgTmFtZTogXCIpO1xuICAgICAgICBjb25zdCBuYW1lSW5wdXRFbCA9IG5ldyBUZXh0Q29tcG9uZW50KG5hbWVJbnB1dENvbnRhaW5lcik7XG4gICAgICAgIG5hbWVJbnB1dEVsLmlucHV0RWwuYWRkQ2xhc3MoXCJtZXRhZGF0YS1tZW51LXByb21wdC1pbnB1dFwiKVxuICAgICAgICBuYW1lSW5wdXRFbC5zZXRQbGFjZWhvbGRlcihcIkZpZWxkIG5hbWVcIik7XG4gICAgICAgIGNvbnN0IHZhbHVlSW5wdXRDb250YWluZXIgPSBhZGROZXdGaWVsZENvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IFwibWV0YWRhdGEtbWVudS1wcm9tcHQtY29udGFpbmVyXCIgfSk7XG4gICAgICAgIHZhbHVlSW5wdXRDb250YWluZXIuc2V0VGV4dChcIkZpZWxkIHZhbHVlOiBcIik7XG4gICAgICAgIGNvbnN0IHZhbHVlSW5wdXRFbCA9IG5ldyBUZXh0Q29tcG9uZW50KHZhbHVlSW5wdXRDb250YWluZXIpO1xuICAgICAgICB2YWx1ZUlucHV0RWwuaW5wdXRFbC5hZGRDbGFzcyhcIm1ldGFkYXRhLW1lbnUtcHJvbXB0LWlucHV0XCIpXG4gICAgICAgIHZhbHVlSW5wdXRFbC5zZXRQbGFjZWhvbGRlcihcIkZpZWxkIHZhbHVlXCIpO1xuICAgICAgICBjb25zdCBmb290ZXJCdXR0b25zID0gdGhpcy5jb250ZW50RWwuY3JlYXRlRGl2KHtcbiAgICAgICAgICAgIGNsczogJ21ldGFkYXRhLW1lbnUtdGV4dGFyZWEtYnV0dG9ucydcbiAgICAgICAgfSk7XG4gICAgICAgIGNvbnN0IHNhdmVCdXR0b24gPSBuZXcgQnV0dG9uQ29tcG9uZW50KGZvb3RlckJ1dHRvbnMpO1xuICAgICAgICBzYXZlQnV0dG9uLnNldEljb24oXCJjaGVja21hcmtcIik7XG4gICAgICAgIHNhdmVCdXR0b24ub25DbGljayhhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5maWxlVGFza01hbmFnZXJcbiAgICAgICAgICAgICAgICAucHVzaFRhc2soKCkgPT4geyBpbnNlcnRWYWx1ZXModGhpcy5wbHVnaW4sIHRoaXMuZmlsZSwgbmFtZUlucHV0RWwuZ2V0VmFsdWUoKSwgdmFsdWVJbnB1dEVsLmdldFZhbHVlKCksIHRoaXMubGluZU51bWJlciwgdGhpcy5pbkZyb250bWF0dGVyLCB0aGlzLmFmdGVyKSB9KTtcbiAgICAgICAgICAgIHRoaXMuY2xvc2UoKVxuICAgICAgICB9KTtcbiAgICAgICAgY29uc3QgY2FuY2VsQnV0dG9uID0gbmV3IEV4dHJhQnV0dG9uQ29tcG9uZW50KGZvb3RlckJ1dHRvbnMpO1xuICAgICAgICBjYW5jZWxCdXR0b24uc2V0SWNvbihcImNyb3NzXCIpO1xuICAgICAgICBjYW5jZWxCdXR0b24ub25DbGljaygoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICAgIH0pO1xuXG5cbiAgICB9O1xufTsiLCAiaW1wb3J0IE1ldGFkYXRhTWVudSBmcm9tIFwibWFpblwiO1xuaW1wb3J0IHsgQnV0dG9uQ29tcG9uZW50LCBEcm9wZG93bkNvbXBvbmVudCwgRXh0cmFCdXR0b25Db21wb25lbnQsIE1vZGFsLCBOb3RpY2UsIFNldHRpbmcsIFRleHRDb21wb25lbnQsIFRleHRBcmVhQ29tcG9uZW50IH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgRmllbGQgZnJvbSBcInNyYy9maWVsZHMvRmllbGRcIjtcbmltcG9ydCBGaWVsZFNldHRpbmcgZnJvbSBcInNyYy9zZXR0aW5ncy9GaWVsZFNldHRpbmdcIjtcbmltcG9ydCB7IEZpZWxkTWFuYWdlciBhcyBGLCBTZXR0aW5nTG9jYXRpb24gfSBmcm9tIFwic3JjL2ZpZWxkcy9GaWVsZE1hbmFnZXJcIjtcbmltcG9ydCB7IEZpZWxkTWFuYWdlciwgRmllbGRUeXBlLCBGaWVsZFR5cGVMYWJlbE1hcHBpbmcsIEZpZWxkVHlwZVRvb2x0aXAgfSBmcm9tIFwic3JjL3R5cGVzL2ZpZWxkVHlwZXNcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgRmllbGRTZXR0aW5nc01vZGFsIGV4dGVuZHMgTW9kYWwge1xuICAgIHByaXZhdGUgbmFtZVByb21wdENvbXBvbmVudDogVGV4dENvbXBvbmVudDtcbiAgICBwcml2YXRlIHNhdmVkOiBib29sZWFuID0gZmFsc2U7XG4gICAgcHJpdmF0ZSBmaWVsZDogRmllbGQ7XG4gICAgcHJpdmF0ZSBpbml0aWFsRmllbGQ6IEZpZWxkO1xuICAgIHByaXZhdGUgbmV3OiBib29sZWFuID0gdHJ1ZTtcbiAgICBwcml2YXRlIGZpZWxkT3B0aW9uc0NvbnRhaW5lcjogSFRNTERpdkVsZW1lbnQ7XG4gICAgcHJpdmF0ZSBmaWVsZE1hbmFnZXI6IEY7XG5cbiAgICBjb25zdHJ1Y3RvcihcbiAgICAgICAgcHJpdmF0ZSBwbHVnaW46IE1ldGFkYXRhTWVudSxcbiAgICAgICAgcHJpdmF0ZSBwYXJlbnRTZXR0aW5nQ29udGFpbmVyOiBIVE1MRWxlbWVudCxcbiAgICAgICAgcHJpdmF0ZSBwYXJlbnRTZXR0aW5nPzogRmllbGRTZXR0aW5nLFxuICAgICAgICBmaWVsZD86IEZpZWxkXG4gICAgKSB7XG4gICAgICAgIHN1cGVyKHBsdWdpbi5hcHApO1xuICAgICAgICB0aGlzLmluaXRpYWxGaWVsZCA9IG5ldyBGaWVsZCgpO1xuICAgICAgICBpZiAoZmllbGQpIHtcbiAgICAgICAgICAgIHRoaXMubmV3ID0gZmFsc2U7XG4gICAgICAgICAgICB0aGlzLmZpZWxkID0gZmllbGQ7XG4gICAgICAgICAgICBGaWVsZC5jb3B5UHJvcGVydHkodGhpcy5pbml0aWFsRmllbGQsIHRoaXMuZmllbGQpXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBsZXQgbmV3SWQgPSAxO1xuICAgICAgICAgICAgdGhpcy5wbHVnaW4uaW5pdGlhbFByb3BlcnRpZXMuZm9yRWFjaChwcm9wID0+IHtcbiAgICAgICAgICAgICAgICBpZiAocGFyc2VJbnQocHJvcC5pZCkgJiYgcGFyc2VJbnQocHJvcC5pZCkgPj0gbmV3SWQpIHtcbiAgICAgICAgICAgICAgICAgICAgbmV3SWQgPSBwYXJzZUludChwcm9wLmlkKSArIDE7XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdGhpcy5maWVsZCA9IG5ldyBGaWVsZCgpO1xuICAgICAgICAgICAgdGhpcy5maWVsZC5pZCA9IG5ld0lkLnRvU3RyaW5nKCk7XG4gICAgICAgICAgICB0aGlzLmluaXRpYWxGaWVsZC5pZCA9IG5ld0lkLnRvU3RyaW5nKCk7XG4gICAgICAgIH07XG4gICAgICAgIHRoaXMuZmllbGRNYW5hZ2VyID0gbmV3IEZpZWxkTWFuYWdlclt0aGlzLmZpZWxkLnR5cGVdKHRoaXMucGx1Z2luLCB0aGlzLmZpZWxkKTtcbiAgICB9O1xuXG4gICAgYXN5bmMgb25PcGVuKCk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICBpZiAodGhpcy5maWVsZC5uYW1lID09IFwiXCIpIHtcbiAgICAgICAgICAgIHRoaXMudGl0bGVFbC5zZXRUZXh0KGBBZGQgYSBmaWVsZCBhbmQgZGVmaW5lIG9wdGlvbnNgKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMudGl0bGVFbC5zZXRUZXh0KGBNYW5hZ2Ugc2V0dGluZ3Mgb3B0aW9ucyBmb3IgJHt0aGlzLmZpZWxkLm5hbWV9YCk7XG4gICAgICAgIH07XG4gICAgICAgIGF3YWl0IHRoaXMuY3JlYXRlRm9ybSgpO1xuICAgIH07XG5cbiAgICBvbkNsb3NlKCk6IHZvaWQge1xuICAgICAgICBPYmplY3QuYXNzaWduKHRoaXMuZmllbGQsIHRoaXMuaW5pdGlhbEZpZWxkKTtcbiAgICAgICAgaWYgKCF0aGlzLm5ldyAmJiB0aGlzLnBhcmVudFNldHRpbmcpIHtcbiAgICAgICAgICAgIHRoaXMucGFyZW50U2V0dGluZy5zZXRUZXh0Q29udGVudFdpdGhuYW1lKClcbiAgICAgICAgfSBlbHNlIGlmICh0aGlzLnNhdmVkKSB7XG4gICAgICAgICAgICBuZXcgRmllbGRTZXR0aW5nKHRoaXMucGFyZW50U2V0dGluZ0NvbnRhaW5lciwgdGhpcy5maWVsZCwgdGhpcy5wbHVnaW4pO1xuICAgICAgICB9O1xuICAgIH07XG5cbiAgICBwcml2YXRlIGNyZWF0ZW5hbWVJbnB1dENvbnRhaW5lcihwYXJlbnROb2RlOiBIVE1MRGl2RWxlbWVudCk6IFRleHRDb21wb25lbnQge1xuICAgICAgICBjb25zdCBmaWVsZE5hbWVDb250YWluZXJMYWJlbCA9IHBhcmVudE5vZGUuY3JlYXRlRGl2KCk7XG4gICAgICAgIGZpZWxkTmFtZUNvbnRhaW5lckxhYmVsLnNldFRleHQoYEZpZWxkIE5hbWU6YCk7XG4gICAgICAgIGNvbnN0IGlucHV0ID0gbmV3IFRleHRDb21wb25lbnQocGFyZW50Tm9kZSk7XG4gICAgICAgIGNvbnN0IG5hbWUgPSB0aGlzLmZpZWxkLm5hbWU7XG4gICAgICAgIGlucHV0LnNldFZhbHVlKG5hbWUpO1xuICAgICAgICBpbnB1dC5zZXRQbGFjZWhvbGRlcihcIk5hbWUgb2YgdGhlIGZpZWxkXCIpO1xuICAgICAgICBpbnB1dC5vbkNoYW5nZSh2YWx1ZSA9PiB7XG4gICAgICAgICAgICB0aGlzLmZpZWxkLm5hbWUgPSB2YWx1ZTtcbiAgICAgICAgICAgIHRoaXMudGl0bGVFbC5zZXRUZXh0KGBNYW5hZ2UgcHJlZGVmaW5lZCBvcHRpb25zIGZvciAke3RoaXMuZmllbGQubmFtZX1gKTtcbiAgICAgICAgICAgIEZpZWxkU2V0dGluZ3NNb2RhbC5yZW1vdmVWYWxpZGF0aW9uRXJyb3IoaW5wdXQpO1xuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIGlucHV0O1xuICAgIH07XG5cbiAgICBwcml2YXRlIGNyZWF0ZVR5cGVTZWxlY3RvckNvbnRhaW5lcihwYXJlbnROb2RlOiBIVE1MRGl2RWxlbWVudCk6IHZvaWQge1xuICAgICAgICBjb25zdCB0eXBlU2VsZWN0b3JDb250YWluZXJMYWJlbCA9IHBhcmVudE5vZGUuY3JlYXRlRGl2KCk7XG4gICAgICAgIHR5cGVTZWxlY3RvckNvbnRhaW5lckxhYmVsLnNldFRleHQoYEZpZWxkIHR5cGU6YCk7XG4gICAgICAgIGNvbnN0IHNlbGVjdCA9IG5ldyBEcm9wZG93bkNvbXBvbmVudChwYXJlbnROb2RlKTtcbiAgICAgICAgT2JqZWN0LmtleXMoRmllbGRUeXBlTGFiZWxNYXBwaW5nKS5mb3JFYWNoKChmOiBrZXlvZiB0eXBlb2YgRmllbGRUeXBlKSA9PiBzZWxlY3QuYWRkT3B0aW9uKGYsIEZpZWxkVHlwZVRvb2x0aXBbZl0pKVxuICAgICAgICBpZiAodGhpcy5maWVsZC50eXBlKSB7XG4gICAgICAgICAgICBzZWxlY3Quc2V0VmFsdWUodGhpcy5maWVsZC50eXBlKVxuICAgICAgICB9XG4gICAgICAgIHNlbGVjdC5vbkNoYW5nZSgodHlwZUxhYmVsOiBrZXlvZiB0eXBlb2YgRmllbGRUeXBlKSA9PiB7XG4gICAgICAgICAgICB0aGlzLmZpZWxkID0gbmV3IEZpZWxkKCk7XG4gICAgICAgICAgICBGaWVsZC5jb3B5UHJvcGVydHkodGhpcy5maWVsZCwgdGhpcy5pbml0aWFsRmllbGQpO1xuICAgICAgICAgICAgdGhpcy5maWVsZC5uYW1lID0gdGhpcy5uYW1lUHJvbXB0Q29tcG9uZW50LmdldFZhbHVlKClcbiAgICAgICAgICAgIHRoaXMuZmllbGQudHlwZSA9IEZpZWxkVHlwZUxhYmVsTWFwcGluZ1t0eXBlTGFiZWxdO1xuICAgICAgICAgICAgaWYgKHRoaXMuZmllbGQudHlwZSAhPT0gdGhpcy5pbml0aWFsRmllbGQudHlwZSAmJlxuICAgICAgICAgICAgICAgICFbdGhpcy5maWVsZC50eXBlLCB0aGlzLmluaXRpYWxGaWVsZC50eXBlXS5ldmVyeShmaWVsZFR5cGUgPT5cbiAgICAgICAgICAgICAgICAgICAgW0ZpZWxkVHlwZS5NdWx0aSwgRmllbGRUeXBlLlNlbGVjdCwgRmllbGRUeXBlLkN5Y2xlXS5pbmNsdWRlcyhmaWVsZFR5cGUpXG4gICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5maWVsZC5vcHRpb25zID0ge31cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHdoaWxlICh0aGlzLmZpZWxkT3B0aW9uc0NvbnRhaW5lci5maXJzdENoaWxkKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5maWVsZE9wdGlvbnNDb250YWluZXIucmVtb3ZlQ2hpbGQodGhpcy5maWVsZE9wdGlvbnNDb250YWluZXIuZmlyc3RDaGlsZCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLmZpZWxkTWFuYWdlciA9IG5ldyBGaWVsZE1hbmFnZXJbdGhpcy5maWVsZC50eXBlXSh0aGlzLnBsdWdpbiwgdGhpcy5maWVsZClcbiAgICAgICAgICAgIHRoaXMuZmllbGRNYW5hZ2VyLmNyZWF0ZVNldHRpbmdDb250YWluZXIodGhpcy5maWVsZE9wdGlvbnNDb250YWluZXIsIHRoaXMucGx1Z2luLCBTZXR0aW5nTG9jYXRpb24uUGx1Z2luU2V0dGluZ3MpXG4gICAgICAgIH0pXG4gICAgfVxuXG4gICAgcHJpdmF0ZSBhc3luYyBjcmVhdGVGb3JtKCk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICBjb25zdCBkaXYgPSB0aGlzLmNvbnRlbnRFbC5jcmVhdGVEaXYoeyBjbHM6IFwibWV0YWRhdGEtbWVudS1wcm9tcHQtZGl2XCIgfSk7XG4gICAgICAgIGNvbnN0IG1haW5EaXYgPSBkaXYuY3JlYXRlRGl2KHsgY2xzOiBcIm1ldGFkYXRhLW1lbnUtcHJvbXB0LWZvcm1cIiB9KTtcblxuICAgICAgICAvKiBTZWN0aW9ucyAqL1xuICAgICAgICBjb25zdCBuYW1lQ29udGFpbmVyID0gbWFpbkRpdi5jcmVhdGVEaXYoKTtcbiAgICAgICAgdGhpcy5uYW1lUHJvbXB0Q29tcG9uZW50ID0gdGhpcy5jcmVhdGVuYW1lSW5wdXRDb250YWluZXIobmFtZUNvbnRhaW5lcik7XG4gICAgICAgIG1haW5EaXYuY3JlYXRlRGl2KHsgY2xzOiAnbWV0YWRhdGEtbWVudS1zZXBhcmF0b3InIH0pLmNyZWF0ZUVsKFwiaHJcIik7XG5cbiAgICAgICAgY29uc3QgdHlwZVNlbGVjdENvbnRhaW5lciA9IG1haW5EaXYuY3JlYXRlRGl2KClcbiAgICAgICAgdGhpcy5maWVsZE9wdGlvbnNDb250YWluZXIgPSBtYWluRGl2LmNyZWF0ZURpdigpXG5cbiAgICAgICAgLyogZm9vdGVyIGJ1dHRvbnMqL1xuICAgICAgICBjb25zdCBmb290ZXJFbCA9IHRoaXMuY29udGVudEVsLmNyZWF0ZURpdigpO1xuICAgICAgICBjb25zdCBmb290ZXJCdXR0b25zID0gbmV3IFNldHRpbmcoZm9vdGVyRWwpO1xuICAgICAgICBmb290ZXJCdXR0b25zLmFkZEJ1dHRvbigoYikgPT4gdGhpcy5jcmVhdGVTYXZlQnV0dG9uKGIpKTtcbiAgICAgICAgZm9vdGVyQnV0dG9ucy5hZGRFeHRyYUJ1dHRvbigoYikgPT4gdGhpcy5jcmVhdGVDYW5jZWxCdXR0b24oYikpO1xuXG4gICAgICAgIC8qIGluaXQgc3RhdGUgKi9cbiAgICAgICAgdGhpcy5jcmVhdGVUeXBlU2VsZWN0b3JDb250YWluZXIodHlwZVNlbGVjdENvbnRhaW5lcilcbiAgICAgICAgdGhpcy5maWVsZE1hbmFnZXIuY3JlYXRlU2V0dGluZ0NvbnRhaW5lcih0aGlzLmZpZWxkT3B0aW9uc0NvbnRhaW5lciwgdGhpcy5wbHVnaW4sIFNldHRpbmdMb2NhdGlvbi5QbHVnaW5TZXR0aW5ncylcbiAgICB9O1xuXG4gICAgcHJpdmF0ZSB2YWxpZGF0ZUZpZWxkcygpOiBib29sZWFuIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZmllbGRNYW5hZ2VyLnZhbGlkYXRlTmFtZShcbiAgICAgICAgICAgIHRoaXMubmFtZVByb21wdENvbXBvbmVudCxcbiAgICAgICAgICAgIHRoaXMubmFtZVByb21wdENvbXBvbmVudC5pbnB1dEVsXG4gICAgICAgICkgJiZcbiAgICAgICAgICAgIHRoaXMuZmllbGRNYW5hZ2VyLnZhbGlkYXRlT3B0aW9ucygpO1xuICAgIH1cblxuICAgIHByaXZhdGUgY3JlYXRlU2F2ZUJ1dHRvbihiOiBCdXR0b25Db21wb25lbnQpOiBCdXR0b25Db21wb25lbnQge1xuICAgICAgICBiLnNldFRvb2x0aXAoXCJTYXZlXCIpO1xuICAgICAgICBiLnNldEljb24oXCJjaGVja21hcmtcIik7XG4gICAgICAgIGIub25DbGljayhhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICBsZXQgZXJyb3IgPSAhdGhpcy52YWxpZGF0ZUZpZWxkcygpO1xuICAgICAgICAgICAgaWYgKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgbmV3IE5vdGljZShcIkZpeCBlcnJvcnMgYmVmb3JlIHNhdmluZy5cIik7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHRoaXMuc2F2ZWQgPSB0cnVlO1xuICAgICAgICAgICAgY29uc3QgY3VycmVudEV4aXN0aW5nRmllbGQgPSB0aGlzLnBsdWdpbi5pbml0aWFsUHJvcGVydGllcy5maWx0ZXIocCA9PiBwLmlkID09IHRoaXMuZmllbGQuaWQpWzBdO1xuICAgICAgICAgICAgaWYgKGN1cnJlbnRFeGlzdGluZ0ZpZWxkKSB7XG4gICAgICAgICAgICAgICAgRmllbGQuY29weVByb3BlcnR5KGN1cnJlbnRFeGlzdGluZ0ZpZWxkLCB0aGlzLmZpZWxkKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uaW5pdGlhbFByb3BlcnRpZXMucHVzaCh0aGlzLmZpZWxkKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBGaWVsZC5jb3B5UHJvcGVydHkodGhpcy5pbml0aWFsRmllbGQsIHRoaXMuZmllbGQpXG4gICAgICAgICAgICBpZiAodGhpcy5wYXJlbnRTZXR0aW5nKSBGaWVsZC5jb3B5UHJvcGVydHkodGhpcy5wYXJlbnRTZXR0aW5nLmZpZWxkLCB0aGlzLmZpZWxkKTtcbiAgICAgICAgICAgIHRoaXMucGFyZW50U2V0dGluZz8uc2V0VGV4dENvbnRlbnRXaXRobmFtZSgpXG4gICAgICAgICAgICB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBiO1xuICAgIH07XG5cbiAgICBwcml2YXRlIGNyZWF0ZUNhbmNlbEJ1dHRvbihiOiBFeHRyYUJ1dHRvbkNvbXBvbmVudCk6IEV4dHJhQnV0dG9uQ29tcG9uZW50IHtcbiAgICAgICAgYi5zZXRJY29uKFwiY3Jvc3NcIilcbiAgICAgICAgICAgIC5zZXRUb29sdGlwKFwiQ2FuY2VsXCIpXG4gICAgICAgICAgICAub25DbGljaygoKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5zYXZlZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIC8qIHJlc2V0IG9wdGlvbnMgZnJvbSBzZXR0aW5ncyAqL1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLmluaXRpYWxGaWVsZC5uYW1lICE9IFwiXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgT2JqZWN0LmFzc2lnbih0aGlzLmZpZWxkLCB0aGlzLmluaXRpYWxGaWVsZCk7XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIGI7XG4gICAgfTtcblxuICAgIC8qIHV0aWxzIGZ1bmN0aW9ucyAqL1xuXG4gICAgcHVibGljIHN0YXRpYyBzZXRWYWxpZGF0aW9uRXJyb3IodGV4dElucHV0OiBUZXh0Q29tcG9uZW50LCBpbnNlcnRBZnRlcjogRWxlbWVudCwgbWVzc2FnZT86IHN0cmluZykge1xuICAgICAgICB0ZXh0SW5wdXQuaW5wdXRFbC5hZGRDbGFzcyhcImlzLWludmFsaWRcIik7XG4gICAgICAgIGlmIChtZXNzYWdlICYmIHRleHRJbnB1dC5pbnB1dEVsLnBhcmVudEVsZW1lbnQ/Lmxhc3RFbGVtZW50Q2hpbGQpIHtcblxuICAgICAgICAgICAgbGV0IG1EaXYgPSB0ZXh0SW5wdXQuaW5wdXRFbC5wYXJlbnRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gICAgICAgICAgICAgICAgXCIuaW52YWxpZC1mZWVkYmFja1wiXG4gICAgICAgICAgICApIGFzIEhUTUxEaXZFbGVtZW50O1xuXG4gICAgICAgICAgICBpZiAoIW1EaXYpIHtcbiAgICAgICAgICAgICAgICBtRGl2ID0gY3JlYXRlRGl2KHsgY2xzOiBcImludmFsaWQtZmVlZGJhY2tcIiB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIG1EaXYuaW5uZXJUZXh0ID0gbWVzc2FnZTtcbiAgICAgICAgICAgIG1EaXYuaW5zZXJ0QWZ0ZXIoaW5zZXJ0QWZ0ZXIpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHB1YmxpYyBzdGF0aWMgcmVtb3ZlVmFsaWRhdGlvbkVycm9yKHRleHRJbnB1dDogVGV4dENvbXBvbmVudCB8IFRleHRBcmVhQ29tcG9uZW50KSB7XG4gICAgICAgIGlmICh0ZXh0SW5wdXQuaW5wdXRFbC5oYXNDbGFzcyhcImlzLWludmFsaWRcIikgJiYgdGV4dElucHV0LmlucHV0RWwucGFyZW50RWxlbWVudD8ubGFzdEVsZW1lbnRDaGlsZCkge1xuICAgICAgICAgICAgdGV4dElucHV0LmlucHV0RWwucmVtb3ZlQ2xhc3MoXCJpcy1pbnZhbGlkXCIpXG4gICAgICAgICAgICB0ZXh0SW5wdXQuaW5wdXRFbC5wYXJlbnRFbGVtZW50LnJlbW92ZUNoaWxkKFxuICAgICAgICAgICAgICAgIHRleHRJbnB1dC5pbnB1dEVsLnBhcmVudEVsZW1lbnQubGFzdEVsZW1lbnRDaGlsZFxuICAgICAgICAgICAgKTtcbiAgICAgICAgfTtcbiAgICB9O1xufTsiLCAiaW1wb3J0IHsgU2V0dGluZywgVEZpbGUgfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCBNZXRhZGF0YU1lbnUgZnJvbSBcIm1haW5cIjtcbmltcG9ydCBGaWVsZCBmcm9tIFwic3JjL2ZpZWxkcy9GaWVsZFwiO1xuaW1wb3J0IHsgRmllbGRNYW5hZ2VyLCBGaWVsZFR5cGVUYWdDbGFzcyB9IGZyb20gXCJzcmMvdHlwZXMvZmllbGRUeXBlc1wiO1xuaW1wb3J0IEZpZWxkU2V0dGluZ3NNb2RhbCBmcm9tIFwic3JjL3NldHRpbmdzL0ZpZWxkU2V0dGluZ3NNb2RhbFwiO1xuaW1wb3J0IHsgRmllbGRNYW5hZ2VyIGFzIEYgfSBmcm9tIFwic3JjL2ZpZWxkcy9GaWVsZE1hbmFnZXJcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgRmllbGRTZXR0aW5nIGV4dGVuZHMgU2V0dGluZyB7XG4gICAgcHJpdmF0ZSBmaWVsZE5hbWVDb250YWluZXI6IEhUTUxTcGFuRWxlbWVudDtcbiAgICBwcml2YXRlIHR5cGVDb250YWluZXI6IEhUTUxTcGFuRWxlbWVudDtcbiAgICBwcml2YXRlIGZpZWxkT3B0aW9uc0NvbnRhaW5lcjogSFRNTFNwYW5FbGVtZW50O1xuXG4gICAgY29uc3RydWN0b3IoXG4gICAgICAgIHByaXZhdGUgY29udGFpbmVyRWw6IEhUTUxFbGVtZW50LFxuICAgICAgICBwdWJsaWMgZmllbGQ6IEZpZWxkLFxuICAgICAgICBwcml2YXRlIHBsdWdpbjogTWV0YWRhdGFNZW51XG4gICAgKSB7XG4gICAgICAgIHN1cGVyKGNvbnRhaW5lckVsKTtcbiAgICAgICAgdGhpcy5zZXRUZXh0Q29udGVudFdpdGhuYW1lKCk7XG4gICAgICAgIHRoaXMuYWRkRWRpdEJ1dHRvbigpO1xuICAgICAgICB0aGlzLmFkZERlbGV0ZUJ1dHRvbigpO1xuICAgIH07XG5cbiAgICBwdWJsaWMgc2V0VGV4dENvbnRlbnRXaXRobmFtZSgpOiB2b2lkIHtcblxuICAgICAgICBjb25zdCBtYW5hZ2VyID0gbmV3IEZpZWxkTWFuYWdlclt0aGlzLmZpZWxkLnR5cGVdKHRoaXMucGx1Z2luLCB0aGlzLmZpZWxkKSBhcyBGO1xuICAgICAgICB0aGlzLmluZm9FbC50ZXh0Q29udGVudCA9IFwiXCI7XG4gICAgICAgIHRoaXMuaW5mb0VsLmFkZENsYXNzKFwibWV0YWRhdGEtbWVudS1zZXR0aW5nLWl0ZW1cIilcbiAgICAgICAgdGhpcy5maWVsZE5hbWVDb250YWluZXIgPSB0aGlzLmluZm9FbC5jcmVhdGVFbChcImRpdlwiLCBcIm1ldGFkYXRhLW1lbnUtc2V0dGluZy1pdGVtLW5hbWVcIilcbiAgICAgICAgdGhpcy5maWVsZE5hbWVDb250YWluZXIuc2V0VGV4dCh0aGlzLmZpZWxkLm5hbWUpXG4gICAgICAgIHRoaXMudHlwZUNvbnRhaW5lciA9IHRoaXMuaW5mb0VsLmNyZWF0ZUVsKFwiZGl2XCIpXG4gICAgICAgIHRoaXMudHlwZUNvbnRhaW5lci5zZXRBdHRyKFwiY2xhc3NcIiwgYG1ldGFkYXRhLW1lbnUtc2V0dGluZy1pdGVtLWluZm8tdHlwZSAke0ZpZWxkVHlwZVRhZ0NsYXNzW3RoaXMuZmllbGQudHlwZV19YClcbiAgICAgICAgdGhpcy50eXBlQ29udGFpbmVyLnNldFRleHQodGhpcy5maWVsZC50eXBlKVxuICAgICAgICB0aGlzLmZpZWxkT3B0aW9uc0NvbnRhaW5lciA9IHRoaXMuaW5mb0VsLmNyZWF0ZUVsKFwiZGl2XCIpXG4gICAgICAgIHRoaXMuZmllbGRPcHRpb25zQ29udGFpbmVyLnNldFRleHQoYCR7bWFuYWdlci5nZXRPcHRpb25zU3RyKCl9YClcbiAgICB9O1xuXG4gICAgcHJpdmF0ZSBhZGRFZGl0QnV0dG9uKCk6IHZvaWQge1xuICAgICAgICB0aGlzLmFkZEJ1dHRvbigoYikgPT4ge1xuICAgICAgICAgICAgYi5zZXRJY29uKFwicGVuY2lsXCIpXG4gICAgICAgICAgICAgICAgLnNldFRvb2x0aXAoXCJFZGl0XCIpXG4gICAgICAgICAgICAgICAgLm9uQ2xpY2soKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBsZXQgbW9kYWwgPSBuZXcgRmllbGRTZXR0aW5nc01vZGFsKHRoaXMucGx1Z2luLCB0aGlzLmNvbnRhaW5lckVsLCB0aGlzLCB0aGlzLmZpZWxkKTtcbiAgICAgICAgICAgICAgICAgICAgbW9kYWwub3BlbigpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9O1xuXG4gICAgcHJpdmF0ZSBhZGREZWxldGVCdXR0b24oKTogdm9pZCB7XG4gICAgICAgIHRoaXMuYWRkQnV0dG9uKChiKSA9PiB7XG4gICAgICAgICAgICBiLnNldEljb24oXCJ0cmFzaFwiKVxuICAgICAgICAgICAgICAgIC5zZXRUb29sdGlwKFwiRGVsZXRlXCIpXG4gICAgICAgICAgICAgICAgLm9uQ2xpY2soKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBjdXJyZW50RXhpc3RpbmdQcm9wZXJ0eSA9IHRoaXMucGx1Z2luLmluaXRpYWxQcm9wZXJ0aWVzLmZpbHRlcihwID0+IHAuaWQgPT0gdGhpcy5maWVsZC5pZClbMF07XG4gICAgICAgICAgICAgICAgICAgIGlmIChjdXJyZW50RXhpc3RpbmdQcm9wZXJ0eSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uaW5pdGlhbFByb3BlcnRpZXMucmVtb3ZlKGN1cnJlbnRFeGlzdGluZ1Byb3BlcnR5KTtcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXR0aW5nRWwucGFyZW50RWxlbWVudD8ucmVtb3ZlQ2hpbGQodGhpcy5zZXR0aW5nRWwpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfTtcblxuICAgIHB1YmxpYyBzdGF0aWMgYXN5bmMgZ2V0VmFsdWVzTGlzdEZyb21Ob3RlKHBsdWdpbjogTWV0YWRhdGFNZW51LCBub3RlUGF0aDogc3RyaW5nKTogUHJvbWlzZTxzdHJpbmdbXT4ge1xuICAgICAgICBsZXQgdmFsdWVzOiBBcnJheTxzdHJpbmc+ID0gW107XG4gICAgICAgIGNvbnN0IGZpbGUgPSBwbHVnaW4uYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChub3RlUGF0aCk7XG4gICAgICAgIGlmIChmaWxlIGluc3RhbmNlb2YgVEZpbGUgJiYgZmlsZS5leHRlbnNpb24gPT0gXCJtZFwiKSB7XG4gICAgICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBwbHVnaW4uYXBwLnZhdWx0LnJlYWQoZmlsZSlcbiAgICAgICAgICAgIHJlc3VsdC5zcGxpdCgnXFxuJykuZm9yRWFjaChsaW5lID0+IHtcbiAgICAgICAgICAgICAgICBpZiAoL14oLiopJC8udGVzdChsaW5lKSkge1xuICAgICAgICAgICAgICAgICAgICB2YWx1ZXMucHVzaChsaW5lLnRyaW0oKSk7XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIHZhbHVlcztcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBbXTtcbiAgICAgICAgfTtcbiAgICB9O1xufTsiLCAiaW1wb3J0IE1ldGFkYXRhTWVudSBmcm9tIFwibWFpblwiO1xuaW1wb3J0IHsgTW9kYWwsIFRvZ2dsZUNvbXBvbmVudCwgVEZpbGUsIEJ1dHRvbkNvbXBvbmVudCB9IGZyb20gXCJvYnNpZGlhblwiO1xuaW1wb3J0IHsgaW5zZXJ0VmFsdWVzIH0gZnJvbSBcInNyYy9jb21tYW5kcy9pbnNlcnRWYWx1ZXNcIjtcbmltcG9ydCB7IHJlcGxhY2VWYWx1ZXMgfSBmcm9tIFwic3JjL2NvbW1hbmRzL3JlcGxhY2VWYWx1ZXNcIjtcbmltcG9ydCBGaWVsZCBmcm9tIFwic3JjL2ZpZWxkcy9GaWVsZFwiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBCb29sZWFuTW9kYWwgZXh0ZW5kcyBNb2RhbCB7XG5cbiAgICBjb25zdHJ1Y3RvcihcbiAgICAgICAgcHJpdmF0ZSBwbHVnaW46IE1ldGFkYXRhTWVudSxcbiAgICAgICAgcHJpdmF0ZSBmaWxlOiBURmlsZSxcbiAgICAgICAgcHJpdmF0ZSBmaWVsZDogRmllbGQsXG4gICAgICAgIHByaXZhdGUgdmFsdWU6IGJvb2xlYW4sXG4gICAgICAgIHByaXZhdGUgbGluZU51bWJlcjogbnVtYmVyID0gLTEsXG4gICAgICAgIHByaXZhdGUgaW5Gcm9udG1hdHRlcjogYm9vbGVhbiA9IGZhbHNlLFxuICAgICAgICBwcml2YXRlIGFmdGVyOiBib29sZWFuID0gZmFsc2VcbiAgICApIHtcbiAgICAgICAgc3VwZXIocGx1Z2luLmFwcCk7XG4gICAgICAgIHRoaXMucGx1Z2luID0gcGx1Z2luO1xuICAgICAgICB0aGlzLmZpbGUgPSBmaWxlO1xuICAgICAgICB0aGlzLnZhbHVlID0gdmFsdWU7XG4gICAgICAgIHRoaXMubGluZU51bWJlciA9IGxpbmVOdW1iZXI7XG4gICAgICAgIHRoaXMuaW5Gcm9udG1hdHRlciA9IGluRnJvbnRtYXR0ZXI7XG4gICAgICAgIHRoaXMuYWZ0ZXIgPSBhZnRlcjtcbiAgICAgICAgdGhpcy5maWVsZCA9IGZpZWxkXG4gICAgfTtcblxuICAgIG9uT3BlbigpIHtcbiAgICAgICAgY29uc3QgaW5wdXREaXYgPSB0aGlzLmNvbnRlbnRFbC5jcmVhdGVEaXYoe1xuICAgICAgICAgICAgY2xzOiBcIm1ldGFkYXRhLW1lbnUtdG9nZ2xlclwiXG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLmJ1aWxkVG9nZ2xlRWwoaW5wdXREaXYpO1xuICAgIH07XG5cbiAgICBwcml2YXRlIGJ1aWxkVG9nZ2xlRWwoaW5wdXREaXY6IEhUTUxEaXZFbGVtZW50KTogdm9pZCB7XG4gICAgICAgIGNvbnN0IHRvZ2dsZUVsID0gbmV3IFRvZ2dsZUNvbXBvbmVudChpbnB1dERpdik7XG4gICAgICAgIGNvbnN0IGZvb3RlciA9IHRoaXMuY29udGVudEVsLmNyZWF0ZURpdih7IGNsczogXCJtZXRhZGF0YS1tZW51LXZhbHVlLWdyaWQtZm9vdGVyXCIgfSk7XG4gICAgICAgIGNvbnN0IHNhdmVCdXR0b24gPSBuZXcgQnV0dG9uQ29tcG9uZW50KGZvb3Rlcik7XG4gICAgICAgIHRvZ2dsZUVsLnNldFZhbHVlKHRoaXMudmFsdWUpO1xuICAgICAgICB0b2dnbGVFbC5vbkNoYW5nZSh2YWx1ZSA9PiB7XG4gICAgICAgICAgICB0aGlzLnZhbHVlID0gdmFsdWU7XG4gICAgICAgICAgICBzYXZlQnV0dG9uLmJ1dHRvbkVsLmZvY3VzKCk7XG4gICAgICAgIH0pXG4gICAgICAgIHNhdmVCdXR0b24uc2V0SWNvbihcImNoZWNrbWFya1wiKTtcbiAgICAgICAgc2F2ZUJ1dHRvbi5vbkNsaWNrKGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHZhbHVlID0gdGhpcy52YWx1ZS50b1N0cmluZygpXG4gICAgICAgICAgICBpZiAodGhpcy5saW5lTnVtYmVyID09IC0xKSB7XG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uZmlsZVRhc2tNYW5hZ2VyXG4gICAgICAgICAgICAgICAgICAgIC5wdXNoVGFzaygoKSA9PiB7IHJlcGxhY2VWYWx1ZXModGhpcy5wbHVnaW4sIHRoaXMuZmlsZSwgdGhpcy5maWVsZC5uYW1lLCB2YWx1ZSkgfSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLmZpbGVUYXNrTWFuYWdlclxuICAgICAgICAgICAgICAgICAgICAucHVzaFRhc2soKCkgPT4geyBpbnNlcnRWYWx1ZXModGhpcy5wbHVnaW4sIHRoaXMuZmlsZSwgdGhpcy5maWVsZC5uYW1lLCB2YWx1ZSwgdGhpcy5saW5lTnVtYmVyLCB0aGlzLmluRnJvbnRtYXR0ZXIsIHRoaXMuYWZ0ZXIpIH0pO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgICAgfSk7XG4gICAgfTtcbn07IiwgImltcG9ydCBNZXRhZGF0YU1lbnUgZnJvbSBcIm1haW5cIjtcbmltcG9ydCB7IE1lbnUsIFRGaWxlIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgeyByZXBsYWNlVmFsdWVzIH0gZnJvbSBcInNyYy9jb21tYW5kcy9yZXBsYWNlVmFsdWVzXCI7XG5pbXBvcnQgRmllbGRDb21tYW5kU3VnZ2VzdE1vZGFsIGZyb20gXCJzcmMvb3B0aW9ucy9GaWVsZENvbW1hbmRTdWdnZXN0TW9kYWxcIjtcbmltcG9ydCBCb29sZWFuTW9kYWwgZnJvbSBcInNyYy9vcHRpb25Nb2RhbHMvZmllbGRzL0Jvb2xlYW5Nb2RhbFwiO1xuaW1wb3J0IHsgRmllbGRUeXBlLCBGaWVsZEljb24gfSBmcm9tIFwic3JjL3R5cGVzL2ZpZWxkVHlwZXNcIjtcbmltcG9ydCBGaWVsZCBmcm9tIFwiLi4vRmllbGRcIjtcbmltcG9ydCB7IEZpZWxkTWFuYWdlciB9IGZyb20gXCIuLi9GaWVsZE1hbmFnZXJcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgQm9vbGVhbkZpZWxkIGV4dGVuZHMgRmllbGRNYW5hZ2VyIHtcblxuICAgIGNvbnN0cnVjdG9yKHBsdWdpbjogTWV0YWRhdGFNZW51LCBmaWVsZDogRmllbGQpIHtcbiAgICAgICAgc3VwZXIocGx1Z2luLCBmaWVsZCwgRmllbGRUeXBlLkJvb2xlYW4pXG4gICAgfVxuXG4gICAgcHVibGljIGFkZEZpZWxkT3B0aW9uKG5hbWU6IHN0cmluZywgdmFsdWU6IHN0cmluZywgZmlsZTogVEZpbGUsIGxvY2F0aW9uOiBNZW51IHwgRmllbGRDb21tYW5kU3VnZ2VzdE1vZGFsKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IGJWYWx1ZSA9IEJvb2xlYW5GaWVsZC5zdHJpbmdUb0Jvb2xlYW4odmFsdWUpO1xuICAgICAgICBpZiAoQm9vbGVhbkZpZWxkLmlzTWVudShsb2NhdGlvbikpIHtcbiAgICAgICAgICAgIGxvY2F0aW9uLmFkZEl0ZW0oKGl0ZW0pID0+IHtcbiAgICAgICAgICAgICAgICBpdGVtLnNldFRpdGxlKGA8JHtuYW1lfT4gJHtiVmFsdWUgPyBcIlx1MjcwNSBcdTI1QjcgXHUyNzRDXCIgOiBcIlx1Mjc0QyBcdTI1QjcgXHUyNzA1XCJ9YCk7XG4gICAgICAgICAgICAgICAgaXRlbS5zZXRJY29uKEZpZWxkSWNvbltGaWVsZFR5cGUuQm9vbGVhbl0pO1xuICAgICAgICAgICAgICAgIGl0ZW0ub25DbGljayhhc3luYyAoKSA9PiBhd2FpdCB0aGlzLnBsdWdpbi5maWxlVGFza01hbmFnZXJcbiAgICAgICAgICAgICAgICAgICAgLnB1c2hUYXNrKCgpID0+IHsgcmVwbGFjZVZhbHVlcyh0aGlzLnBsdWdpbiwgZmlsZSwgbmFtZSwgKCFiVmFsdWUpLnRvU3RyaW5nKCkpIH0pKTtcbiAgICAgICAgICAgICAgICBpdGVtLnNldFNlY3Rpb24oXCJtZXRhZGF0YS1tZW51LmZpZWxkc1wiKTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH0gZWxzZSBpZiAoQm9vbGVhbkZpZWxkLmlzU3VnZ2VzdChsb2NhdGlvbikpIHtcbiAgICAgICAgICAgIGxvY2F0aW9uLm9wdGlvbnMucHVzaCh7XG4gICAgICAgICAgICAgICAgaWQ6IGB1cGRhdGVfJHtuYW1lfWAsXG4gICAgICAgICAgICAgICAgYWN0aW9uTGFiZWw6IGA8c3Bhbj48Yj4ke25hbWV9PC9iPiAke2JWYWx1ZSA/IFwiXHUyNzA1IFx1MjVCNyBcdTI3NENcIiA6IFwiXHUyNzRDIFx1MjVCNyBcdTI3MDVcIn08L3NwYW4+YCxcbiAgICAgICAgICAgICAgICBhY3Rpb246IGFzeW5jICgpID0+IGF3YWl0IHRoaXMucGx1Z2luLmZpbGVUYXNrTWFuYWdlclxuICAgICAgICAgICAgICAgICAgICAucHVzaFRhc2soKCkgPT4geyByZXBsYWNlVmFsdWVzKHRoaXMucGx1Z2luLCBmaWxlLCBuYW1lLCAoIWJWYWx1ZSkudG9TdHJpbmcoKSkgfSksXG4gICAgICAgICAgICAgICAgaWNvbjogRmllbGRJY29uW0ZpZWxkVHlwZS5Cb29sZWFuXVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG4gICAgfTtcbiAgICBwdWJsaWMgZ2V0T3B0aW9uc1N0cigpOiBzdHJpbmcge1xuICAgICAgICByZXR1cm4gXCJcIlxuICAgIH1cblxuICAgIHB1YmxpYyBjcmVhdGVTZXR0aW5nQ29udGFpbmVyKHBhcmVudENvbnRhaW5lcjogSFRNTERpdkVsZW1lbnQsIHBsdWdpbjogTWV0YWRhdGFNZW51KTogdm9pZCB7XG4gICAgICAgIC8vbm8gbmVlZCBvZiBzZXR0aW5ncyBmb3IgYm9vbGVhbiBmaWVsZFxuICAgIH1cblxuICAgIHB1YmxpYyB2YWxpZGF0ZVZhbHVlKHZhbHVlOiBzdHJpbmcpOiBib29sZWFuIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IGJWYWx1ZSA9IEJvb2xlYW5GaWVsZC5zdHJpbmdUb0Jvb2xlYW4odmFsdWUpXG4gICAgICAgICAgICByZXR1cm4gaXNCb29sZWFuKGJWYWx1ZSlcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHVibGljIHZhbGlkYXRlT3B0aW9ucygpOiBib29sZWFuIHtcbiAgICAgICAgLy9hbHdheXMgdHJ1ZSBzaW5jZSB0aGVyZSBhcmUgbm8gb3B0aW9uc1xuICAgICAgICByZXR1cm4gdHJ1ZVxuICAgIH1cblxuICAgIHB1YmxpYyBjcmVhdGVBbmRPcGVuRmllbGRNb2RhbChmaWxlOiBURmlsZSwgc2VsZWN0ZWRGaWVsZE5hbWU6IHN0cmluZywgdmFsdWU/OiBzdHJpbmcsIGxpbmVOdW1iZXI/OiBudW1iZXIsIGluRnJvbnRtYXR0ZXI/OiBib29sZWFuLCBhZnRlcj86IGJvb2xlYW4pOiB2b2lkIHtcbiAgICAgICAgY29uc3QgYlZhbHVlID0gQm9vbGVhbkZpZWxkLnN0cmluZ1RvQm9vbGVhbih2YWx1ZSB8fCBcImZhbHNlXCIpO1xuICAgICAgICBjb25zdCBmaWVsZE1vZGFsID0gbmV3IEJvb2xlYW5Nb2RhbCh0aGlzLnBsdWdpbiwgZmlsZSwgdGhpcy5maWVsZCwgYlZhbHVlLCBsaW5lTnVtYmVyLCBpbkZyb250bWF0dGVyLCBhZnRlcilcbiAgICAgICAgZmllbGRNb2RhbC50aXRsZUVsLnNldFRleHQoYFNldCB2YWx1ZSBmb3IgJHtzZWxlY3RlZEZpZWxkTmFtZX1gKTtcbiAgICAgICAgZmllbGRNb2RhbC5vcGVuKCk7XG4gICAgfVxuXG4gICAgcHVibGljIGNyZWF0ZUR2RmllbGQoXG4gICAgICAgIGR2OiBhbnksXG4gICAgICAgIHA6IGFueSxcbiAgICAgICAgZmllbGRDb250YWluZXI6IEhUTUxFbGVtZW50LFxuICAgICAgICBhdHRycz86IHsgY2xzPzogc3RyaW5nLCBhdHRyPzogUmVjb3JkPHN0cmluZywgc3RyaW5nPiwgb3B0aW9ucz86IFJlY29yZDxzdHJpbmcsIHN0cmluZz4gfVxuICAgICk6IHZvaWQge1xuICAgICAgICBjb25zdCBjaGVja2JveDogSFRNTElucHV0RWxlbWVudCA9IGR2LmVsKFwiaW5wdXRcIiwgXCJcIiwgeyAuLi5hdHRycywgXCJ0eXBlXCI6IFwiY2hlY2tib3hcIiB9KVxuICAgICAgICBjaGVja2JveC5jaGVja2VkID0gcFt0aGlzLmZpZWxkLm5hbWVdXG4gICAgICAgIGZpZWxkQ29udGFpbmVyLmFwcGVuZENoaWxkKGNoZWNrYm94KVxuICAgICAgICBjaGVja2JveC5vbmNoYW5nZSA9ICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgQm9vbGVhbkZpZWxkLnJlcGxhY2VWYWx1ZXModGhpcy5wbHVnaW4sIHAuZmlsZS5wYXRoLCB0aGlzLmZpZWxkLm5hbWUsIGNoZWNrYm94LmNoZWNrZWQudG9TdHJpbmcoKSk7XG4gICAgICAgIH1cbiAgICB9XG59IiwgImltcG9ydCBNZXRhZGF0YU1lbnUgZnJvbSBcIm1haW5cIjtcbmltcG9ydCB7IE1lbnUsIHNldEljb24sIFRleHRDb21wb25lbnQsIFRGaWxlIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgeyByZXBsYWNlVmFsdWVzIH0gZnJvbSBcInNyYy9jb21tYW5kcy9yZXBsYWNlVmFsdWVzXCI7XG5pbXBvcnQgRmllbGRDb21tYW5kU3VnZ2VzdE1vZGFsIGZyb20gXCJzcmMvb3B0aW9ucy9GaWVsZENvbW1hbmRTdWdnZXN0TW9kYWxcIjtcbmltcG9ydCBOdW1iZXJ0TW9kYWwgZnJvbSBcInNyYy9vcHRpb25Nb2RhbHMvZmllbGRzL051bWJlck1vZGFsXCI7XG5pbXBvcnQgRmllbGRTZXR0aW5nc01vZGFsIGZyb20gXCJzcmMvc2V0dGluZ3MvRmllbGRTZXR0aW5nc01vZGFsXCI7XG5pbXBvcnQgeyBGaWVsZEljb24sIEZpZWxkVHlwZSB9IGZyb20gXCJzcmMvdHlwZXMvZmllbGRUeXBlc1wiO1xuaW1wb3J0IEZpZWxkIGZyb20gXCIuLi9GaWVsZFwiO1xuaW1wb3J0IHsgRmllbGRNYW5hZ2VyIH0gZnJvbSBcIi4uL0ZpZWxkTWFuYWdlclwiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBOdW1iZXJGaWVsZCBleHRlbmRzIEZpZWxkTWFuYWdlciB7XG5cbiAgICBwcml2YXRlIG51bWJlclZhbGlkYXRvckZpZWxkOiBIVE1MRGl2RWxlbWVudDtcbiAgICBwcml2YXRlIG51bWJlclN0ZXBWYWx1ZTogVGV4dENvbXBvbmVudDtcbiAgICBwcml2YXRlIG51bWJlck1pblZhbHVlOiBUZXh0Q29tcG9uZW50O1xuICAgIHByaXZhdGUgbnVtYmVyTWF4VmFsdWU6IFRleHRDb21wb25lbnQ7XG5cbiAgICBjb25zdHJ1Y3RvcihwbHVnaW46IE1ldGFkYXRhTWVudSwgZmllbGQ6IEZpZWxkKSB7XG4gICAgICAgIHN1cGVyKHBsdWdpbiwgZmllbGQsIEZpZWxkVHlwZS5OdW1iZXIpXG4gICAgfVxuXG4gICAgcHVibGljIGdldE9wdGlvbnNTdHIoKTogc3RyaW5nIHtcbiAgICAgICAgY29uc3Qgb3B0aW9uczogc3RyaW5nW10gPSBbXTtcbiAgICAgICAgT2JqZWN0LmtleXModGhpcy5maWVsZC5vcHRpb25zKS5mb3JFYWNoKChrKSA9PiB7IGlmICh0aGlzLmZpZWxkLm9wdGlvbnNba10pIG9wdGlvbnMucHVzaChgJHtrfTogJHt0aGlzLmZpZWxkLm9wdGlvbnNba119YCkgfSlcbiAgICAgICAgcmV0dXJuIG9wdGlvbnMuam9pbihcIiB8IFwiKVxuICAgIH1cblxuICAgIHB1YmxpYyBjYW5EZWNyZW1lbnQodmFsdWU6IHN0cmluZyk6IGJvb2xlYW4ge1xuICAgICAgICBjb25zdCB7IHN0ZXAsIG1pbiB9ID0gdGhpcy5maWVsZC5vcHRpb25zO1xuICAgICAgICBjb25zdCBmU3RlcCA9IHBhcnNlRmxvYXQoc3RlcCk7XG4gICAgICAgIGNvbnN0IGZNaW4gPSBwYXJzZUZsb2F0KG1pbik7XG4gICAgICAgIHJldHVybiAhKFxuICAgICAgICAgICAgaXNOYU4ocGFyc2VGbG9hdCh2YWx1ZSkpIHx8XG4gICAgICAgICAgICAhaXNOYU4oZk1pbikgJiZcbiAgICAgICAgICAgIChcbiAgICAgICAgICAgICAgICAhaXNOYU4oZlN0ZXApICYmIChcbiAgICAgICAgICAgICAgICAgICAgcGFyc2VGbG9hdCh2YWx1ZSkgLSBmU3RlcCA8IGZNaW4gfHxcbiAgICAgICAgICAgICAgICAgICAgcGFyc2VGbG9hdCh2YWx1ZSkgLSAxIDwgZk1pblxuICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgIClcbiAgICAgICAgKVxuICAgIH1cblxuICAgIHB1YmxpYyBjYW5JbmNyZW1lbnQodmFsdWU6IHN0cmluZyk6IGJvb2xlYW4ge1xuICAgICAgICBjb25zdCB7IHN0ZXAsIG1heCB9ID0gdGhpcy5maWVsZC5vcHRpb25zO1xuICAgICAgICBjb25zdCBmU3RlcCA9IHBhcnNlRmxvYXQoc3RlcCk7XG4gICAgICAgIGNvbnN0IGZNYXggPSBwYXJzZUZsb2F0KG1heCk7XG4gICAgICAgIHJldHVybiAhKFxuICAgICAgICAgICAgaXNOYU4ocGFyc2VGbG9hdCh2YWx1ZSkpIHx8XG4gICAgICAgICAgICAhaXNOYU4oZk1heCkgJiZcbiAgICAgICAgICAgIChcbiAgICAgICAgICAgICAgICAhaXNOYU4oZlN0ZXApICYmIChcbiAgICAgICAgICAgICAgICAgICAgcGFyc2VGbG9hdCh2YWx1ZSkgKyBmU3RlcCA+IGZNYXggfHxcbiAgICAgICAgICAgICAgICAgICAgcGFyc2VGbG9hdCh2YWx1ZSkgKyAxID4gZk1heFxuICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgIClcbiAgICAgICAgKVxuICAgIH1cblxuICAgIHB1YmxpYyB2YWxpZGF0ZVZhbHVlKHZhbHVlOiBzdHJpbmcpOiBib29sZWFuIHtcbiAgICAgICAgY29uc3QgeyBtaW4sIG1heCB9ID0gdGhpcy5maWVsZC5vcHRpb25zO1xuICAgICAgICBjb25zdCBmTWluID0gcGFyc2VGbG9hdChtaW4pO1xuICAgICAgICBjb25zdCBmTWF4ID0gcGFyc2VGbG9hdChtYXgpO1xuICAgICAgICBjb25zdCBmVmFsdWUgPSBwYXJzZUZsb2F0KHZhbHVlKTtcbiAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgICFpc05hTihmVmFsdWUpICYmIChpc05hTihmTWluKSB8fCBmVmFsdWUgPj0gZk1pbikgJiYgKGlzTmFOKGZNYXgpIHx8IGZWYWx1ZSA8PSBmTWF4KVxuICAgICAgICApXG4gICAgfVxuXG4gICAgcHVibGljIGFkZEZpZWxkT3B0aW9uKG5hbWU6IHN0cmluZywgdmFsdWU6IHN0cmluZywgZmlsZTogVEZpbGUsIGxvY2F0aW9uOiBNZW51IHwgRmllbGRDb21tYW5kU3VnZ2VzdE1vZGFsKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IG1vZGFsID0gbmV3IE51bWJlcnRNb2RhbCh0aGlzLnBsdWdpbiwgZmlsZSwgdGhpcy5maWVsZCwgdmFsdWUpO1xuICAgICAgICBtb2RhbC50aXRsZUVsLnNldFRleHQoYENoYW5nZSBWYWx1ZSBmb3IgPCR7bmFtZX0+YCk7XG4gICAgICAgIGlmIChOdW1iZXJGaWVsZC5pc01lbnUobG9jYXRpb24pKSB7XG4gICAgICAgICAgICBsb2NhdGlvbi5hZGRJdGVtKChpdGVtKSA9PiB7XG4gICAgICAgICAgICAgICAgaXRlbS5zZXRUaXRsZShgVXBkYXRlIDwke25hbWV9PmApO1xuICAgICAgICAgICAgICAgIGl0ZW0uc2V0SWNvbihGaWVsZEljb25bRmllbGRUeXBlLk51bWJlcl0pO1xuICAgICAgICAgICAgICAgIGl0ZW0ub25DbGljaygoKSA9PiBtb2RhbC5vcGVuKCkpO1xuICAgICAgICAgICAgICAgIGl0ZW0uc2V0U2VjdGlvbihcIm1ldGFkYXRhLW1lbnUuZmllbGRzXCIpO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIGNvbnN0IHsgbWluLCBtYXgsIHN0ZXAgfSA9IHRoaXMuZmllbGQub3B0aW9uc1xuXG4gICAgICAgICAgICBjb25zdCBmTWluID0gcGFyc2VGbG9hdChtaW4pXG4gICAgICAgICAgICBjb25zdCBmTWF4ID0gcGFyc2VGbG9hdChtYXgpXG4gICAgICAgICAgICBjb25zdCBmU3RlcCA9IHBhcnNlRmxvYXQoc3RlcClcbiAgICAgICAgICAgIGNvbnN0IGZWYWx1ZSA9IHBhcnNlRmxvYXQodmFsdWUpXG4gICAgICAgICAgICBpZiAoZlN0ZXApIHtcbiAgICAgICAgICAgICAgICBpZiAoIWlzTmFOKGZNaW4pICYmIGZWYWx1ZSAtIGZTdGVwID4gZk1pbilcbiAgICAgICAgICAgICAgICAgICAgbG9jYXRpb24uYWRkSXRlbSgoaXRlbSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgaXRlbS5zZXRJY29uKEZpZWxkSWNvbltGaWVsZFR5cGUuTnVtYmVyXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpdGVtLnNldFRpdGxlKGA8JHtuYW1lfT4gXHUyMTk4XHVGRTBGICR7ZlZhbHVlIC0gZlN0ZXB9YCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpdGVtLm9uQ2xpY2soYXN5bmMgKCkgPT4gYXdhaXQgdGhpcy5wbHVnaW4uZmlsZVRhc2tNYW5hZ2VyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnB1c2hUYXNrKCgpID0+IHsgcmVwbGFjZVZhbHVlcyh0aGlzLnBsdWdpbiwgZmlsZSwgbmFtZSwgKGZWYWx1ZSAtIGZTdGVwKS50b1N0cmluZygpKSB9KSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpdGVtLnNldFNlY3Rpb24oXCJtZXRhZGF0YS1tZW51LmZpZWxkc1wiKTtcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICBpZiAoIWlzTmFOKGZNYXgpICYmIGZWYWx1ZSArIGZTdGVwIDwgZk1heClcbiAgICAgICAgICAgICAgICAgICAgbG9jYXRpb24uYWRkSXRlbSgoaXRlbSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgaXRlbS5zZXRJY29uKEZpZWxkSWNvbltGaWVsZFR5cGUuTnVtYmVyXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpdGVtLnNldFRpdGxlKGA8JHtuYW1lfT4gXHUyMTk3XHVGRTBGICR7ZlZhbHVlICsgZlN0ZXB9YCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpdGVtLm9uQ2xpY2soYXN5bmMgKCkgPT4gYXdhaXQgdGhpcy5wbHVnaW4uZmlsZVRhc2tNYW5hZ2VyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnB1c2hUYXNrKCgpID0+IHsgcmVwbGFjZVZhbHVlcyh0aGlzLnBsdWdpbiwgZmlsZSwgbmFtZSwgKGZWYWx1ZSArIGZTdGVwKS50b1N0cmluZygpKSB9KSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpdGVtLnNldFNlY3Rpb24oXCJtZXRhZGF0YS1tZW51LmZpZWxkc1wiKTtcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIGlmIChOdW1iZXJGaWVsZC5pc1N1Z2dlc3QobG9jYXRpb24pKSB7XG4gICAgICAgICAgICBsb2NhdGlvbi5vcHRpb25zLnB1c2goe1xuICAgICAgICAgICAgICAgIGlkOiBgdXBkYXRlXyR7bmFtZX1gLFxuICAgICAgICAgICAgICAgIGFjdGlvbkxhYmVsOiBgPHNwYW4+VXBkYXRlIDxiPiR7bmFtZX08L2I+PC9zcGFuPmAsXG4gICAgICAgICAgICAgICAgYWN0aW9uOiAoKSA9PiBtb2RhbC5vcGVuKCksXG4gICAgICAgICAgICAgICAgaWNvbjogRmllbGRJY29uW0ZpZWxkVHlwZS5OdW1iZXJdXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcbiAgICB9O1xuXG4gICAgcHJpdmF0ZSBjcmVhdGVOdW1iZXJDb250YWluZXIocGFyZW50Q29udGFpbmVyOiBIVE1MRGl2RWxlbWVudCk6IHZvaWQge1xuICAgICAgICBjb25zdCBudW1iZXJTdGVwVmFsdWVDb250YWluZXIgPSBwYXJlbnRDb250YWluZXIuY3JlYXRlRGl2KCk7XG4gICAgICAgIG51bWJlclN0ZXBWYWx1ZUNvbnRhaW5lci5jcmVhdGVFbChcInNwYW5cIiwgeyB0ZXh0OiBcIlN0ZXAgKG9wdGlvbmFsKVwiLCBjbHM6ICdtZXRhZGF0YS1tZW51LWZpZWxkLW9wdGlvbicgfSlcbiAgICAgICAgdGhpcy5udW1iZXJTdGVwVmFsdWUgPSBuZXcgVGV4dENvbXBvbmVudChudW1iZXJTdGVwVmFsdWVDb250YWluZXIpXG4gICAgICAgIHRoaXMubnVtYmVyU3RlcFZhbHVlLnNldFZhbHVlKHRoaXMuZmllbGQub3B0aW9ucy5zdGVwIHx8IFwiXCIpXG5cbiAgICAgICAgY29uc3QgbnVtYmVyTWluVmFsdWVDb250YWluZXIgPSBwYXJlbnRDb250YWluZXIuY3JlYXRlRGl2KCk7XG4gICAgICAgIG51bWJlck1pblZhbHVlQ29udGFpbmVyLmNyZWF0ZUVsKFwic3BhblwiLCB7IHRleHQ6IFwiTWluIHZhbHVlIChvcHRpb25hbClcIiwgY2xzOiAnbWV0YWRhdGEtbWVudS1maWVsZC1vcHRpb24nIH0pXG4gICAgICAgIHRoaXMubnVtYmVyTWluVmFsdWUgPSBuZXcgVGV4dENvbXBvbmVudChudW1iZXJNaW5WYWx1ZUNvbnRhaW5lcilcbiAgICAgICAgdGhpcy5udW1iZXJNaW5WYWx1ZS5zZXRWYWx1ZSh0aGlzLmZpZWxkLm9wdGlvbnMubWluIHx8IFwiXCIpXG5cbiAgICAgICAgY29uc3QgbnVtYmVyTWF4VmFsdWVDb250YWluZXIgPSBwYXJlbnRDb250YWluZXIuY3JlYXRlRGl2KCk7XG4gICAgICAgIG51bWJlck1heFZhbHVlQ29udGFpbmVyLmNyZWF0ZUVsKFwic3BhblwiLCB7IHRleHQ6IFwiTWF4IHZhbHVlIChvcHRpb25hbClcIiwgY2xzOiAnbWV0YWRhdGEtbWVudS1maWVsZC1vcHRpb24nIH0pXG4gICAgICAgIHRoaXMubnVtYmVyTWF4VmFsdWUgPSBuZXcgVGV4dENvbXBvbmVudChudW1iZXJNYXhWYWx1ZUNvbnRhaW5lcilcbiAgICAgICAgdGhpcy5udW1iZXJNYXhWYWx1ZS5zZXRWYWx1ZSh0aGlzLmZpZWxkLm9wdGlvbnMubWF4IHx8IFwiXCIpXG4gICAgICAgIHRoaXMubnVtYmVyU3RlcFZhbHVlLm9uQ2hhbmdlKHZhbHVlID0+IHtcbiAgICAgICAgICAgIHRoaXMuZmllbGQub3B0aW9ucy5zdGVwID0gdmFsdWU7XG4gICAgICAgICAgICBGaWVsZFNldHRpbmdzTW9kYWwucmVtb3ZlVmFsaWRhdGlvbkVycm9yKHRoaXMubnVtYmVyU3RlcFZhbHVlKTtcbiAgICAgICAgfSlcbiAgICAgICAgdGhpcy5udW1iZXJNaW5WYWx1ZS5vbkNoYW5nZSh2YWx1ZSA9PiB7XG4gICAgICAgICAgICB0aGlzLmZpZWxkLm9wdGlvbnMubWluID0gdmFsdWU7XG4gICAgICAgICAgICBGaWVsZFNldHRpbmdzTW9kYWwucmVtb3ZlVmFsaWRhdGlvbkVycm9yKHRoaXMubnVtYmVyTWluVmFsdWUpO1xuICAgICAgICB9KVxuICAgICAgICB0aGlzLm51bWJlck1heFZhbHVlLm9uQ2hhbmdlKHZhbHVlID0+IHtcbiAgICAgICAgICAgIHRoaXMuZmllbGQub3B0aW9ucy5tYXggPSB2YWx1ZTtcbiAgICAgICAgICAgIEZpZWxkU2V0dGluZ3NNb2RhbC5yZW1vdmVWYWxpZGF0aW9uRXJyb3IodGhpcy5udW1iZXJNYXhWYWx1ZSk7XG4gICAgICAgIH0pXG4gICAgfVxuXG4gICAgcHVibGljIGNyZWF0ZVNldHRpbmdDb250YWluZXIocGFyZW50Q29udGFpbmVyOiBIVE1MRGl2RWxlbWVudCwgcGx1Z2luOiBNZXRhZGF0YU1lbnUpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5udW1iZXJWYWxpZGF0b3JGaWVsZCA9IHBhcmVudENvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IFwibWV0YWRhdGEtbWVudS1udW1iZXItb3B0aW9uc1wiIH0pXG4gICAgICAgIHRoaXMuY3JlYXRlTnVtYmVyQ29udGFpbmVyKHRoaXMubnVtYmVyVmFsaWRhdG9yRmllbGQpXG4gICAgICAgIHRoaXMubnVtYmVyVmFsaWRhdG9yRmllbGQuY3JlYXRlRGl2KHsgY2xzOiAnbWV0YWRhdGEtbWVudS1zZXBhcmF0b3InIH0pLmNyZWF0ZUVsKFwiaHJcIik7XG4gICAgfVxuXG4gICAgcHVibGljIHZhbGlkYXRlT3B0aW9ucygpOiBib29sZWFuIHtcbiAgICAgICAgbGV0IGVycm9yID0gZmFsc2VcbiAgICAgICAgaWYgKHRoaXMuZmllbGQub3B0aW9ucy5zdGVwICYmIGlzTmFOKHBhcnNlRmxvYXQodGhpcy5maWVsZC5vcHRpb25zLnN0ZXApKSkge1xuICAgICAgICAgICAgRmllbGRTZXR0aW5nc01vZGFsLnNldFZhbGlkYXRpb25FcnJvcihcbiAgICAgICAgICAgICAgICB0aGlzLm51bWJlclN0ZXBWYWx1ZSwgdGhpcy5udW1iZXJTdGVwVmFsdWUuaW5wdXRFbCxcbiAgICAgICAgICAgICAgICBcIlZhbHVlcyBtdXN0IGJlIG51bWVyaWMuXCJcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICBlcnJvciA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuZmllbGQub3B0aW9ucy5taW4gJiYgaXNOYU4ocGFyc2VGbG9hdCh0aGlzLmZpZWxkLm9wdGlvbnMubWluKSkpIHtcbiAgICAgICAgICAgIEZpZWxkU2V0dGluZ3NNb2RhbC5zZXRWYWxpZGF0aW9uRXJyb3IoXG4gICAgICAgICAgICAgICAgdGhpcy5udW1iZXJNaW5WYWx1ZSwgdGhpcy5udW1iZXJNaW5WYWx1ZS5pbnB1dEVsLFxuICAgICAgICAgICAgICAgIFwiVmFsdWVzIG11c3QgYmUgbnVtZXJpYy5cIlxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIGVycm9yID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5maWVsZC5vcHRpb25zLm1heCAmJiBpc05hTihwYXJzZUZsb2F0KHRoaXMuZmllbGQub3B0aW9ucy5tYXgpKSkge1xuICAgICAgICAgICAgRmllbGRTZXR0aW5nc01vZGFsLnNldFZhbGlkYXRpb25FcnJvcihcbiAgICAgICAgICAgICAgICB0aGlzLm51bWJlck1heFZhbHVlLCB0aGlzLm51bWJlck1heFZhbHVlLmlucHV0RWwsXG4gICAgICAgICAgICAgICAgXCJWYWx1ZXMgbXVzdCBiZSBudW1lcmljLlwiXG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgZXJyb3IgPSB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiAhZXJyb3JcbiAgICB9XG5cbiAgICBwdWJsaWMgY3JlYXRlQW5kT3BlbkZpZWxkTW9kYWwoZmlsZTogVEZpbGUsIHNlbGVjdGVkRmllbGROYW1lOiBzdHJpbmcsIHZhbHVlPzogc3RyaW5nLCBsaW5lTnVtYmVyPzogbnVtYmVyLCBpbkZyb250bWF0dGVyPzogYm9vbGVhbiwgYWZ0ZXI/OiBib29sZWFuKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IGZpZWxkTW9kYWwgPSBuZXcgTnVtYmVydE1vZGFsKHRoaXMucGx1Z2luLCBmaWxlLCB0aGlzLmZpZWxkLCB2YWx1ZSB8fCBcIlwiLCBsaW5lTnVtYmVyLCBpbkZyb250bWF0dGVyLCBhZnRlcik7XG4gICAgICAgIGZpZWxkTW9kYWwudGl0bGVFbC5zZXRUZXh0KGBFbnRlciB2YWx1ZSBmb3IgJHtzZWxlY3RlZEZpZWxkTmFtZX1gKTtcbiAgICAgICAgZmllbGRNb2RhbC5vcGVuKCk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSB0b2dnbGVEdkJ1dHRvbnMoZGVjcmVtZW50QnRuOiBIVE1MQnV0dG9uRWxlbWVudCwgaW5jcmVtZW50QnRuOiBIVE1MQnV0dG9uRWxlbWVudCwgdmFsdWU6IHN0cmluZykge1xuICAgICAgICBpZiAodGhpcy5jYW5EZWNyZW1lbnQodmFsdWUpKSB7XG4gICAgICAgICAgICBkZWNyZW1lbnRCdG4ucmVtb3ZlQ2xhc3MoJ2Rpc2FibGVkJyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBkZWNyZW1lbnRCdG4uYWRkQ2xhc3MoJ2Rpc2FibGVkJyk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuY2FuSW5jcmVtZW50KHZhbHVlKSkge1xuICAgICAgICAgICAgaW5jcmVtZW50QnRuLnJlbW92ZUNsYXNzKCdkaXNhYmxlZCcpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgaW5jcmVtZW50QnRuLmFkZENsYXNzKCdkaXNhYmxlZCcpOztcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHB1YmxpYyBjcmVhdGVEdkZpZWxkKFxuICAgICAgICBkdjogYW55LFxuICAgICAgICBwOiBhbnksXG4gICAgICAgIGZpZWxkQ29udGFpbmVyOiBIVE1MRWxlbWVudCxcbiAgICAgICAgYXR0cnM/OiB7IGNscz86IHN0cmluZywgYXR0cj86IFJlY29yZDxzdHJpbmcsIHN0cmluZz4sIG9wdGlvbnM/OiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+IH1cbiAgICApOiB2b2lkIHtcblxuICAgICAgICBjb25zdCBmaWVsZFZhbHVlID0gZHYuZWwoJ3NwYW4nLCBwW3RoaXMuZmllbGQubmFtZV0sIGF0dHJzKVxuICAgICAgICBjb25zdCBpbnB1dENvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gICAgICAgIGNvbnN0IGlucHV0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImlucHV0XCIpO1xuICAgICAgICBpbnB1dC5zZXRBdHRyKFwiY2xhc3NcIiwgXCJtZXRhZGF0YS1tZW51LWR2LWlucHV0XCIpO1xuICAgICAgICBpbnB1dENvbnRhaW5lci5hcHBlbmRDaGlsZChpbnB1dCk7XG4gICAgICAgIGlucHV0LnZhbHVlID0gcFt0aGlzLmZpZWxkLm5hbWVdO1xuICAgICAgICAvKiBlbmQgc3BhY2VyICovXG4gICAgICAgIGNvbnN0IHRyaXBsZVNwYWNlciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gICAgICAgIHRyaXBsZVNwYWNlci5zZXRBdHRyKFwiY2xhc3NcIiwgXCJtZXRhZGF0YS1tZW51LWR2LWZpZWxkLXRyaXBsZS1zcGFjZXJcIik7XG5cbiAgICAgICAgLyogYnV0dG9uIHRvIGRpc3BsYXkgaW5wdXQgKi9cbiAgICAgICAgY29uc3QgZWRpdEJ1dHRvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJidXR0b25cIik7XG4gICAgICAgIHNldEljb24oZWRpdEJ1dHRvbiwgRmllbGRJY29uW0ZpZWxkVHlwZS5OdW1iZXJdKTtcbiAgICAgICAgZWRpdEJ1dHRvbi5zZXRBdHRyKCdjbGFzcycsIFwibWV0YWRhdGEtbWVudS1kdi1maWVsZC1idXR0b25cIik7XG5cblxuICAgICAgICAvKiBidXR0b24gdG8gZGlzcGxheSBpbnB1dCAqL1xuICAgICAgICBjb25zdCBkZWNyZW1lbnRCdXR0b24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiYnV0dG9uXCIpO1xuICAgICAgICBzZXRJY29uKGRlY3JlbWVudEJ1dHRvbiwgXCJsZWZ0LWFycm93XCIpO1xuICAgICAgICBkZWNyZW1lbnRCdXR0b24uc2V0QXR0cignY2xhc3MnLCBcIm1ldGFkYXRhLW1lbnUtZHYtZmllbGQtYnV0dG9uXCIpO1xuXG5cbiAgICAgICAgLyogYnV0dG9uIHRvIGRpc3BsYXkgaW5wdXQgKi9cbiAgICAgICAgY29uc3QgaW5jcmVtZW50QnV0dG9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImJ1dHRvblwiKTtcbiAgICAgICAgc2V0SWNvbihpbmNyZW1lbnRCdXR0b24sIFwicmlnaHQtYXJyb3dcIilcbiAgICAgICAgaW5jcmVtZW50QnV0dG9uLnNldEF0dHIoJ2NsYXNzJywgXCJtZXRhZGF0YS1tZW51LWR2LWZpZWxkLWJ1dHRvblwiKTtcblxuICAgICAgICBpZiAoIWF0dHJzPy5vcHRpb25zPy5hbHdheXNPbikge1xuICAgICAgICAgICAgZWRpdEJ1dHRvbi5oaWRlKCk7XG4gICAgICAgICAgICBkZWNyZW1lbnRCdXR0b24uaGlkZSgpO1xuICAgICAgICAgICAgaW5jcmVtZW50QnV0dG9uLmhpZGUoKTtcbiAgICAgICAgICAgIHRyaXBsZVNwYWNlci5zaG93KCk7XG5cbiAgICAgICAgICAgIGZpZWxkQ29udGFpbmVyLm9ubW91c2VvdmVyID0gKCkgPT4ge1xuICAgICAgICAgICAgICAgIGVkaXRCdXR0b24uc2hvdygpO1xuICAgICAgICAgICAgICAgIGRlY3JlbWVudEJ1dHRvbi5zaG93KCk7XG4gICAgICAgICAgICAgICAgaW5jcmVtZW50QnV0dG9uLnNob3coKTtcbiAgICAgICAgICAgICAgICB0cmlwbGVTcGFjZXIuaGlkZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZmllbGRDb250YWluZXIub25tb3VzZW91dCA9ICgpID0+IHtcbiAgICAgICAgICAgICAgICBlZGl0QnV0dG9uLmhpZGUoKTtcbiAgICAgICAgICAgICAgICBkZWNyZW1lbnRCdXR0b24uaGlkZSgpO1xuICAgICAgICAgICAgICAgIGluY3JlbWVudEJ1dHRvbi5oaWRlKCk7XG4gICAgICAgICAgICAgICAgdHJpcGxlU3BhY2VyLnNob3coKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IHZhbGlkYXRlSWNvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJhXCIpXG4gICAgICAgIHNldEljb24odmFsaWRhdGVJY29uLCBcImNoZWNrbWFya1wiKVxuICAgICAgICB2YWxpZGF0ZUljb24uc2V0QXR0cihcImNsYXNzXCIsIFwibWV0YWRhdGEtbWVudS1kdi1maWVsZC1idXR0b25cIilcbiAgICAgICAgdmFsaWRhdGVJY29uLm9uY2xpY2sgPSBhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICBpZiAodGhpcy52YWxpZGF0ZVZhbHVlKGlucHV0LnZhbHVlKSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGZpbGUgPSB0aGlzLnBsdWdpbi5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKHAuZmlsZS5wYXRoKVxuICAgICAgICAgICAgICAgIGlmIChmaWxlIGluc3RhbmNlb2YgVEZpbGUgJiYgZmlsZS5leHRlbnNpb24gPT0gXCJtZFwiKSB7XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLmZpbGVUYXNrTWFuYWdlclxuICAgICAgICAgICAgICAgICAgICAgICAgLnB1c2hUYXNrKCgpID0+IHsgcmVwbGFjZVZhbHVlcyh0aGlzLnBsdWdpbiwgZmlsZSwgdGhpcy5maWVsZC5uYW1lLCBpbnB1dC52YWx1ZSkgfSk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMudG9nZ2xlRHZCdXR0b25zKGRlY3JlbWVudEJ1dHRvbiwgaW5jcmVtZW50QnV0dG9uLCBpbnB1dC52YWx1ZSlcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZmllbGRDb250YWluZXIucmVtb3ZlQ2hpbGQoaW5wdXRDb250YWluZXIpXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaW5wdXRDb250YWluZXI/LmFwcGVuZENoaWxkKHZhbGlkYXRlSWNvbilcbiAgICAgICAgY29uc3QgY2FuY2VsSWNvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJhXCIpXG4gICAgICAgIGNhbmNlbEljb24uc2V0QXR0cihcImNsYXNzXCIsIFwibWV0YWRhdGEtbWVudS1kdi1maWVsZC1idXR0b25cIilcbiAgICAgICAgc2V0SWNvbihjYW5jZWxJY29uLCBcImNyb3NzXCIpO1xuICAgICAgICBjYW5jZWxJY29uLm9uY2xpY2sgPSAoZSkgPT4ge1xuICAgICAgICAgICAgZmllbGRDb250YWluZXIucmVtb3ZlQ2hpbGQoaW5wdXRDb250YWluZXIpO1xuICAgICAgICAgICAgZmllbGRDb250YWluZXIuYXBwZW5kQ2hpbGQoZGVjcmVtZW50QnV0dG9uKTtcbiAgICAgICAgICAgIGZpZWxkQ29udGFpbmVyLmFwcGVuZENoaWxkKGZpZWxkVmFsdWUpO1xuICAgICAgICAgICAgZmllbGRDb250YWluZXIuYXBwZW5kQ2hpbGQoZWRpdEJ1dHRvbik7XG4gICAgICAgICAgICBmaWVsZENvbnRhaW5lci5hcHBlbmRDaGlsZChpbmNyZW1lbnRCdXR0b24pO1xuICAgICAgICAgICAgZmllbGRDb250YWluZXIuYXBwZW5kQ2hpbGQodHJpcGxlU3BhY2VyKTtcbiAgICAgICAgfVxuICAgICAgICBpbnB1dENvbnRhaW5lci5hcHBlbmRDaGlsZChjYW5jZWxJY29uKTtcbiAgICAgICAgaW5wdXQuZm9jdXMoKTtcblxuICAgICAgICBpbnB1dC5vbmtleXVwID0gKGUpID0+IHtcbiAgICAgICAgICAgIGlmICghdGhpcy52YWxpZGF0ZVZhbHVlKGlucHV0LnZhbHVlKSkge1xuICAgICAgICAgICAgICAgIGlucHV0LmFkZENsYXNzKCdpcy1pbnZhbGlkJyk7XG4gICAgICAgICAgICAgICAgdmFsaWRhdGVJY29uLmFkZENsYXNzKCdkaXNhYmxlZCcpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBpbnB1dC5yZW1vdmVDbGFzcygnaXMtaW52YWxpZCcpO1xuICAgICAgICAgICAgICAgIHZhbGlkYXRlSWNvbi5yZW1vdmVDbGFzcygnZGlzYWJsZWQnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGlucHV0Lm9ua2V5ZG93biA9IGFzeW5jIChlKSA9PiB7XG4gICAgICAgICAgICBpZiAoZS5rZXkgPT09IFwiRW50ZXJcIikge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLnZhbGlkYXRlVmFsdWUoaW5wdXQudmFsdWUpKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGZpbGUgPSB0aGlzLnBsdWdpbi5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKHAuZmlsZS5wYXRoKVxuICAgICAgICAgICAgICAgICAgICBpZiAoZmlsZSBpbnN0YW5jZW9mIFRGaWxlICYmIGZpbGUuZXh0ZW5zaW9uID09IFwibWRcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uZmlsZVRhc2tNYW5hZ2VyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnB1c2hUYXNrKCgpID0+IHsgcmVwbGFjZVZhbHVlcyh0aGlzLnBsdWdpbiwgZmlsZSwgdGhpcy5maWVsZC5uYW1lLCBpbnB1dC52YWx1ZSkgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnRvZ2dsZUR2QnV0dG9ucyhkZWNyZW1lbnRCdXR0b24sIGluY3JlbWVudEJ1dHRvbiwgaW5wdXQudmFsdWUpXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZmllbGRDb250YWluZXIucmVtb3ZlQ2hpbGQoaW5wdXRDb250YWluZXIpXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGUua2V5ID09PSAnRXNjYXBlJykge1xuICAgICAgICAgICAgICAgIGZpZWxkQ29udGFpbmVyLnJlbW92ZUNoaWxkKGlucHV0Q29udGFpbmVyKTtcbiAgICAgICAgICAgICAgICBmaWVsZENvbnRhaW5lci5hcHBlbmRDaGlsZChkZWNyZW1lbnRCdXR0b24pO1xuICAgICAgICAgICAgICAgIGZpZWxkQ29udGFpbmVyLmFwcGVuZENoaWxkKGZpZWxkVmFsdWUpO1xuICAgICAgICAgICAgICAgIGZpZWxkQ29udGFpbmVyLmFwcGVuZENoaWxkKGVkaXRCdXR0b24pO1xuICAgICAgICAgICAgICAgIGZpZWxkQ29udGFpbmVyLmFwcGVuZENoaWxkKGluY3JlbWVudEJ1dHRvbik7XG4gICAgICAgICAgICAgICAgZmllbGRDb250YWluZXIuYXBwZW5kQ2hpbGQodHJpcGxlU3BhY2VyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICAvKiBlZGl0QnV0dG9uIG9uIGNsaWNrIDogcmVtb3ZlIGJ1dHRvbiBhbmQgZmllbGQgYW5kIGRpc3BsYXkgaW5wdXQgZmllbGQqL1xuICAgICAgICBlZGl0QnV0dG9uLm9uY2xpY2sgPSAoKSA9PiB7XG4gICAgICAgICAgICBmaWVsZENvbnRhaW5lci5yZW1vdmVDaGlsZChmaWVsZFZhbHVlKTtcbiAgICAgICAgICAgIGZpZWxkQ29udGFpbmVyLnJlbW92ZUNoaWxkKGVkaXRCdXR0b24pO1xuICAgICAgICAgICAgZmllbGRDb250YWluZXIucmVtb3ZlQ2hpbGQoZGVjcmVtZW50QnV0dG9uKTtcbiAgICAgICAgICAgIGZpZWxkQ29udGFpbmVyLnJlbW92ZUNoaWxkKGluY3JlbWVudEJ1dHRvbik7XG4gICAgICAgICAgICBmaWVsZENvbnRhaW5lci5yZW1vdmVDaGlsZCh0cmlwbGVTcGFjZXIpO1xuICAgICAgICAgICAgZmllbGRDb250YWluZXIuYXBwZW5kQ2hpbGQoaW5wdXRDb250YWluZXIpO1xuICAgICAgICAgICAgaW5wdXQuZm9jdXMoKVxuICAgICAgICB9XG5cbiAgICAgICAgLyogZGVjcmVtZW50IGJ1dHRvbiBvbiBjbGljazogZGVjcmVtZW50IGJ5IHN0ZXAgb3IgYnkgMSAqL1xuICAgICAgICBkZWNyZW1lbnRCdXR0b24ub25jbGljayA9IGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIGlmICh0aGlzLmNhbkRlY3JlbWVudChwW3RoaXMuZmllbGQubmFtZV0pKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgeyBzdGVwIH0gPSB0aGlzLmZpZWxkLm9wdGlvbnM7XG4gICAgICAgICAgICAgICAgY29uc3QgZlN0ZXAgPSBwYXJzZUZsb2F0KHN0ZXApXG4gICAgICAgICAgICAgICAgY29uc3QgZmlsZSA9IHRoaXMucGx1Z2luLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgocFtcImZpbGVcIl1bXCJwYXRoXCJdKVxuICAgICAgICAgICAgICAgIGlmIChmaWxlIGluc3RhbmNlb2YgVEZpbGUgJiYgZmlsZS5leHRlbnNpb24gPT0gXCJtZFwiKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG5ld1ZhbHVlID0gKCEhZlN0ZXAgPyBwW3RoaXMuZmllbGQubmFtZV0gLSBmU3RlcCA6IHBbdGhpcy5maWVsZC5uYW1lXSAtIDEpLnRvU3RyaW5nKCk7XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLmZpbGVUYXNrTWFuYWdlclxuICAgICAgICAgICAgICAgICAgICAgICAgLnB1c2hUYXNrKCgpID0+IHsgcmVwbGFjZVZhbHVlcyh0aGlzLnBsdWdpbiwgZmlsZSwgdGhpcy5maWVsZC5uYW1lLCBuZXdWYWx1ZSkgfSk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMudG9nZ2xlRHZCdXR0b25zKGRlY3JlbWVudEJ1dHRvbiwgaW5jcmVtZW50QnV0dG9uLCBuZXdWYWx1ZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLyogaW5jcmVtZW50IGJ1dHRvbiBvbiBjbGljazogaW5jcmVtZW50IGJ5IHN0ZXAgb3IgYnkgMSAqL1xuICAgICAgICBpbmNyZW1lbnRCdXR0b24ub25jbGljayA9IGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIGlmICh0aGlzLmNhbkluY3JlbWVudChwW3RoaXMuZmllbGQubmFtZV0pKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgeyBzdGVwIH0gPSB0aGlzLmZpZWxkLm9wdGlvbnM7XG4gICAgICAgICAgICAgICAgY29uc3QgZlN0ZXAgPSBwYXJzZUZsb2F0KHN0ZXApXG4gICAgICAgICAgICAgICAgY29uc3QgZmlsZSA9IHRoaXMucGx1Z2luLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgocFtcImZpbGVcIl1bXCJwYXRoXCJdKVxuICAgICAgICAgICAgICAgIGlmIChmaWxlIGluc3RhbmNlb2YgVEZpbGUgJiYgZmlsZS5leHRlbnNpb24gPT0gXCJtZFwiKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG5ld1ZhbHVlID0gKCEhZlN0ZXAgPyBwW3RoaXMuZmllbGQubmFtZV0gKyBmU3RlcCA6IHBbdGhpcy5maWVsZC5uYW1lXSArIDEpLnRvU3RyaW5nKCk7XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLmZpbGVUYXNrTWFuYWdlclxuICAgICAgICAgICAgICAgICAgICAgICAgLnB1c2hUYXNrKCgpID0+IHsgcmVwbGFjZVZhbHVlcyh0aGlzLnBsdWdpbiwgZmlsZSwgdGhpcy5maWVsZC5uYW1lLCBuZXdWYWx1ZSkgfSk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMudG9nZ2xlRHZCdXR0b25zKGRlY3JlbWVudEJ1dHRvbiwgaW5jcmVtZW50QnV0dG9uLCBuZXdWYWx1ZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLyogaW5pdGlhbCBzdGF0ZSAqL1xuICAgICAgICBmaWVsZENvbnRhaW5lci5hcHBlbmRDaGlsZChkZWNyZW1lbnRCdXR0b24pO1xuICAgICAgICBmaWVsZENvbnRhaW5lci5hcHBlbmRDaGlsZChmaWVsZFZhbHVlKTtcbiAgICAgICAgZmllbGRDb250YWluZXIuYXBwZW5kQ2hpbGQoZWRpdEJ1dHRvbik7XG4gICAgICAgIGZpZWxkQ29udGFpbmVyLmFwcGVuZENoaWxkKGluY3JlbWVudEJ1dHRvbik7XG4gICAgICAgIGZpZWxkQ29udGFpbmVyLmFwcGVuZENoaWxkKHRyaXBsZVNwYWNlcik7XG4gICAgICAgIHRoaXMudG9nZ2xlRHZCdXR0b25zKGRlY3JlbWVudEJ1dHRvbiwgaW5jcmVtZW50QnV0dG9uLCBwW3RoaXMuZmllbGQubmFtZV0pO1xuICAgIH1cbn0iLCAiaW1wb3J0IE1ldGFkYXRhTWVudSBmcm9tIFwibWFpblwiO1xuaW1wb3J0IHsgTW9kYWwsIFRleHRDb21wb25lbnQsIFRGaWxlLCBCdXR0b25Db21wb25lbnQgfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCB7IGluc2VydFZhbHVlcyB9IGZyb20gXCJzcmMvY29tbWFuZHMvaW5zZXJ0VmFsdWVzXCI7XG5pbXBvcnQgeyByZXBsYWNlVmFsdWVzIH0gZnJvbSBcInNyYy9jb21tYW5kcy9yZXBsYWNlVmFsdWVzXCI7XG5pbXBvcnQgRmllbGQgZnJvbSBcInNyYy9maWVsZHMvRmllbGRcIjtcbmltcG9ydCBOdW1iZXJGaWVsZCBmcm9tIFwic3JjL2ZpZWxkcy9maWVsZE1hbmFnZXJzL051bWJlckZpZWxkXCI7XG5pbXBvcnQgeyBGaWVsZE1hbmFnZXIgfSBmcm9tIFwic3JjL3R5cGVzL2ZpZWxkVHlwZXNcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgTnVtYmVydE1vZGFsIGV4dGVuZHMgTW9kYWwge1xuXG4gICAgcHJpdmF0ZSBmaWVsZE1hbmFnZXI6IE51bWJlckZpZWxkO1xuXG4gICAgY29uc3RydWN0b3IoXG4gICAgICAgIHByaXZhdGUgcGx1Z2luOiBNZXRhZGF0YU1lbnUsXG4gICAgICAgIHByaXZhdGUgZmlsZTogVEZpbGUsXG4gICAgICAgIHByaXZhdGUgZmllbGQ6IEZpZWxkLFxuICAgICAgICBwcml2YXRlIHZhbHVlOiBzdHJpbmcsXG4gICAgICAgIHByaXZhdGUgbGluZU51bWJlcjogbnVtYmVyID0gLTEsXG4gICAgICAgIHByaXZhdGUgaW5Gcm9udG1hdHRlcjogYm9vbGVhbiA9IGZhbHNlLFxuICAgICAgICBwcml2YXRlIGFmdGVyOiBib29sZWFuID0gZmFsc2VcbiAgICApIHtcbiAgICAgICAgc3VwZXIocGx1Z2luLmFwcCk7XG4gICAgICAgIHRoaXMuZmllbGRNYW5hZ2VyID0gbmV3IEZpZWxkTWFuYWdlclt0aGlzLmZpZWxkLnR5cGVdKHRoaXMucGx1Z2luLCB0aGlzLmZpZWxkKVxuICAgIH07XG5cbiAgICBvbk9wZW4oKSB7XG4gICAgICAgIGNvbnN0IGlucHV0RGl2ID0gdGhpcy5jb250ZW50RWwuY3JlYXRlRGl2KCk7XG4gICAgICAgIHRoaXMuYnVpbGRJbnB1dEVsKGlucHV0RGl2KTtcbiAgICB9O1xuXG4gICAgcHJpdmF0ZSBkZWNyZW1lbnQoaW5wdXRFbDogVGV4dENvbXBvbmVudCk6IHZvaWQge1xuICAgICAgICBjb25zdCB7IHN0ZXAgfSA9IHRoaXMuZmllbGQub3B0aW9ucztcbiAgICAgICAgY29uc3QgZlN0ZXAgPSBwYXJzZUZsb2F0KHN0ZXApO1xuICAgICAgICBpZiAoIWlzTmFOKGZTdGVwKSkge1xuICAgICAgICAgICAgaW5wdXRFbC5zZXRWYWx1ZSgocGFyc2VGbG9hdChpbnB1dEVsLmdldFZhbHVlKCkpIC0gZlN0ZXApLnRvU3RyaW5nKCkpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgaW5wdXRFbC5zZXRWYWx1ZSgocGFyc2VGbG9hdChpbnB1dEVsLmdldFZhbHVlKCkpIC0gMSkudG9TdHJpbmcoKSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwcml2YXRlIGluY3JlbWVudChpbnB1dEVsOiBUZXh0Q29tcG9uZW50KTogdm9pZCB7XG4gICAgICAgIGNvbnN0IHsgc3RlcCB9ID0gdGhpcy5maWVsZC5vcHRpb25zXG4gICAgICAgIGNvbnN0IGZTdGVwID0gcGFyc2VGbG9hdChzdGVwKVxuICAgICAgICBpZiAoIWlzTmFOKGZTdGVwKSkge1xuICAgICAgICAgICAgaW5wdXRFbC5zZXRWYWx1ZSgocGFyc2VGbG9hdChpbnB1dEVsLmdldFZhbHVlKCkpICsgZlN0ZXApLnRvU3RyaW5nKCkpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgaW5wdXRFbC5zZXRWYWx1ZSgocGFyc2VGbG9hdChpbnB1dEVsLmdldFZhbHVlKCkpICsgMSkudG9TdHJpbmcoKSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwcml2YXRlIHRvZ2dsZUJ1dHRvbnNTdGF0ZShtaW51c0J0bjogQnV0dG9uQ29tcG9uZW50LCBwbHVzQnRuOiBCdXR0b25Db21wb25lbnQsIGlucHV0RWw6IFRleHRDb21wb25lbnQpOiB2b2lkIHtcbiAgICAgICAgbWludXNCdG4uc2V0RGlzYWJsZWQoIXRoaXMuZmllbGRNYW5hZ2VyLmNhbkRlY3JlbWVudChpbnB1dEVsLmdldFZhbHVlKCkpKTtcbiAgICAgICAgcGx1c0J0bi5zZXREaXNhYmxlZCghdGhpcy5maWVsZE1hbmFnZXIuY2FuSW5jcmVtZW50KGlucHV0RWwuZ2V0VmFsdWUoKSkpO1xuICAgICAgICBpZiAodGhpcy5maWVsZE1hbmFnZXIuY2FuRGVjcmVtZW50KGlucHV0RWwuZ2V0VmFsdWUoKSkpIHtcbiAgICAgICAgICAgIG1pbnVzQnRuLnNldEN0YSgpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgbWludXNCdG4ucmVtb3ZlQ3RhKCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuZmllbGRNYW5hZ2VyLmNhbkluY3JlbWVudChpbnB1dEVsLmdldFZhbHVlKCkpKSB7XG4gICAgICAgICAgICBwbHVzQnRuLnNldEN0YSgpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcGx1c0J0bi5yZW1vdmVDdGEoKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHByaXZhdGUgYnVpbGRJbnB1dEVsKGlucHV0RGl2OiBIVE1MRGl2RWxlbWVudCk6IHZvaWQge1xuICAgICAgICBjb25zdCB7IHN0ZXAgfSA9IHRoaXMuZmllbGQub3B0aW9uc1xuXG4gICAgICAgIGNvbnN0IGZvcm0gPSBpbnB1dERpdi5jcmVhdGVFbChcImZvcm1cIik7XG4gICAgICAgIGZvcm0udHlwZSA9IFwic3VibWl0XCI7XG5cbiAgICAgICAgY29uc3QgZmllbGRDb250YWluZXIgPSBmb3JtLmNyZWF0ZUVsKFwiZGl2XCIsIHsgY2xzOiBcIm1ldGFkYXRhLW1lbnUtbW9kYWwtdmFsdWUtd2l0aC1idG5cIiB9KVxuXG4gICAgICAgIGNvbnN0IGlucHV0RWwgPSBuZXcgVGV4dENvbXBvbmVudChmaWVsZENvbnRhaW5lcik7XG4gICAgICAgIGlucHV0RWwuaW5wdXRFbC5mb2N1cygpO1xuICAgICAgICBpbnB1dEVsLnNldFZhbHVlKGAke3RoaXMudmFsdWV9YCk7XG5cbiAgICAgICAgY29uc3QgbWludXNCdG4gPSBuZXcgQnV0dG9uQ29tcG9uZW50KGZpZWxkQ29udGFpbmVyKTtcbiAgICAgICAgbWludXNCdG4uc2V0QnV0dG9uVGV4dChgLSAkeyEhc3RlcCA/IHN0ZXAgOiAxfWApO1xuICAgICAgICBtaW51c0J0bi5zZXREaXNhYmxlZCghdGhpcy5maWVsZE1hbmFnZXIuY2FuRGVjcmVtZW50KGlucHV0RWwuZ2V0VmFsdWUoKSkpO1xuXG4gICAgICAgIGNvbnN0IHBsdXNCdG4gPSBuZXcgQnV0dG9uQ29tcG9uZW50KGZpZWxkQ29udGFpbmVyKTtcbiAgICAgICAgcGx1c0J0bi5zZXRCdXR0b25UZXh0KGArICR7ISFzdGVwID8gc3RlcCA6IDF9YCk7XG4gICAgICAgIHBsdXNCdG4uc2V0RGlzYWJsZWQoIXRoaXMuZmllbGRNYW5hZ2VyLmNhbkluY3JlbWVudChpbnB1dEVsLmdldFZhbHVlKCkpKTtcblxuICAgICAgICBjb25zdCBlcnJvckZpZWxkID0gZm9ybS5jcmVhdGVFbChcImRpdlwiLCB7IGNsczogXCJtZXRhZGF0YS1tZW51LW1vZGFsLXZhbHVlLXdpdGgtYnRuLWVycm9yLWZpZWxkXCIgfSlcbiAgICAgICAgZXJyb3JGaWVsZC5oaWRlKClcblxuICAgICAgICBjb25zdCBmb290ZXIgPSBmb3JtLmNyZWF0ZUVsKFwiZGl2XCIsIHsgY2xzOiBcIm1ldGFkYXRhLW1lbnUtdmFsdWUtZ3JpZC1mb290ZXJcIiB9KVxuXG4gICAgICAgIGNvbnN0IHZhbGlkYXRlQnRuID0gbmV3IEJ1dHRvbkNvbXBvbmVudChmb290ZXIpO1xuICAgICAgICB2YWxpZGF0ZUJ0bi5zZXRJY29uKFwiY2hlY2ttYXJrXCIpO1xuXG4gICAgICAgIGNvbnN0IGNhbmNlbEJ0biA9IG5ldyBCdXR0b25Db21wb25lbnQoZm9vdGVyKTtcbiAgICAgICAgY2FuY2VsQnRuLnNldEljb24oXCJjcm9zc1wiKTtcblxuXG4gICAgICAgIHRoaXMudG9nZ2xlQnV0dG9uc1N0YXRlKG1pbnVzQnRuLCBwbHVzQnRuLCBpbnB1dEVsKTtcblxuICAgICAgICAvL2V2ZW50IGhhbmRsZXJzXG4gICAgICAgIGlucHV0RWwub25DaGFuZ2UoKCkgPT4ge1xuICAgICAgICAgICAgaW5wdXRFbC5pbnB1dEVsLnJlbW92ZUNsYXNzKFwiaXMtaW52YWxpZFwiKVxuICAgICAgICAgICAgZXJyb3JGaWVsZC5oaWRlKCk7XG4gICAgICAgICAgICBlcnJvckZpZWxkLnNldFRleHQoXCJcIik7XG4gICAgICAgICAgICB0aGlzLnRvZ2dsZUJ1dHRvbnNTdGF0ZShtaW51c0J0biwgcGx1c0J0biwgaW5wdXRFbClcbiAgICAgICAgfSlcblxuICAgICAgICBwbHVzQnRuLm9uQ2xpY2soKGUpID0+IHtcbiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgIHRoaXMuaW5jcmVtZW50KGlucHV0RWwpO1xuICAgICAgICAgICAgdGhpcy50b2dnbGVCdXR0b25zU3RhdGUobWludXNCdG4sIHBsdXNCdG4sIGlucHV0RWwpO1xuICAgICAgICB9KVxuXG4gICAgICAgIG1pbnVzQnRuLm9uQ2xpY2soKGUpID0+IHtcbiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgIHRoaXMuZGVjcmVtZW50KGlucHV0RWwpO1xuICAgICAgICAgICAgdGhpcy50b2dnbGVCdXR0b25zU3RhdGUobWludXNCdG4sIHBsdXNCdG4sIGlucHV0RWwpO1xuICAgICAgICB9KVxuXG4gICAgICAgIGNhbmNlbEJ0bi5vbkNsaWNrKChlKSA9PiB7XG4gICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICB0aGlzLmNsb3NlKClcbiAgICAgICAgfSlcblxuICAgICAgICBmb3JtLm9uc3VibWl0ID0gYXN5bmMgKGU6IEV2ZW50KSA9PiB7XG4gICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICBsZXQgaW5wdXRWYWx1ZSA9IGlucHV0RWwuZ2V0VmFsdWUoKTtcbiAgICAgICAgICAgIGlmICghdGhpcy5maWVsZE1hbmFnZXIudmFsaWRhdGVWYWx1ZShpbnB1dFZhbHVlKSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IHsgbWluLCBtYXggfSA9IHRoaXMuZmllbGQub3B0aW9uc1xuICAgICAgICAgICAgICAgIGVycm9yRmllbGQuc2hvdygpO1xuICAgICAgICAgICAgICAgIGVycm9yRmllbGQuc2V0VGV4dChgdmFsdWUgbXVzdCBiZSBudW1lcmljJHttaW4gPyBcIiBhbmQgPj0gXCIgKyBtaW4gOiBcIlwifSAke21heCA/IFwiIGFuZCA8PSBcIiArIG1heCA6IFwiXCJ9YClcbiAgICAgICAgICAgICAgICBpbnB1dEVsLmlucHV0RWwuc2V0QXR0cihcImNsYXNzXCIsIFwiaXMtaW52YWxpZFwiKVxuICAgICAgICAgICAgICAgIHJldHVyblxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRoaXMubGluZU51bWJlciA9PSAtMSkge1xuICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLmZpbGVUYXNrTWFuYWdlclxuICAgICAgICAgICAgICAgICAgICAucHVzaFRhc2soKCkgPT4geyByZXBsYWNlVmFsdWVzKHRoaXMucGx1Z2luLCB0aGlzLmZpbGUsIHRoaXMuZmllbGQubmFtZSwgaW5wdXRWYWx1ZSkgfSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLmZpbGVUYXNrTWFuYWdlclxuICAgICAgICAgICAgICAgICAgICAucHVzaFRhc2soKCkgPT4geyBpbnNlcnRWYWx1ZXModGhpcy5wbHVnaW4sIHRoaXMuZmlsZSwgdGhpcy5maWVsZC5uYW1lLCBpbnB1dFZhbHVlLCB0aGlzLmxpbmVOdW1iZXIsIHRoaXMuaW5Gcm9udG1hdHRlciwgdGhpcy5hZnRlcikgfSk7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgICB9O1xuICAgIH07XG59OyIsICJpbXBvcnQgTWV0YWRhdGFNZW51IGZyb20gXCJtYWluXCI7XG5pbXBvcnQgeyBNZW51LCBzZXRJY29uLCBUZXh0Q29tcG9uZW50LCBURmlsZSB9IGZyb20gXCJvYnNpZGlhblwiO1xuaW1wb3J0IEZpZWxkQ29tbWFuZFN1Z2dlc3RNb2RhbCBmcm9tIFwic3JjL29wdGlvbnMvRmllbGRDb21tYW5kU3VnZ2VzdE1vZGFsXCI7XG5pbXBvcnQgU2VsZWN0TW9kYWwgZnJvbSBcInNyYy9vcHRpb25Nb2RhbHMvZmllbGRzL1NlbGVjdE1vZGFsXCI7XG5pbXBvcnQgeyBGaWVsZEljb24sIEZpZWxkVHlwZSB9IGZyb20gXCJzcmMvdHlwZXMvZmllbGRUeXBlc1wiO1xuaW1wb3J0IEZpZWxkIGZyb20gXCIuLi9GaWVsZFwiO1xuaW1wb3J0IEFic3RyYWN0TGlzdEJhc2VkRmllbGQgZnJvbSBcIi4vQWJzdHJhY3RMaXN0QmFzZWRGaWVsZFwiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBTZWxlY3RGaWVsZCBleHRlbmRzIEFic3RyYWN0TGlzdEJhc2VkRmllbGQge1xuXG4gICAgdmFsdWVzUHJvbXB0Q29tcG9uZW50czogQXJyYXk8VGV4dENvbXBvbmVudD4gPSBbXTtcblxuICAgIGNvbnN0cnVjdG9yKHBsdWdpbjogTWV0YWRhdGFNZW51LCBmaWVsZDogRmllbGQpIHtcbiAgICAgICAgc3VwZXIocGx1Z2luLCBmaWVsZCwgRmllbGRUeXBlLlNlbGVjdClcbiAgICB9XG5cbiAgICBwdWJsaWMgYWRkRmllbGRPcHRpb24obmFtZTogc3RyaW5nLCB2YWx1ZTogc3RyaW5nLCBmaWxlOiBURmlsZSwgbG9jYXRpb246IE1lbnUgfCBGaWVsZENvbW1hbmRTdWdnZXN0TW9kYWwpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgbW9kYWwgPSBuZXcgU2VsZWN0TW9kYWwodGhpcy5wbHVnaW4sIGZpbGUsIHZhbHVlLCB0aGlzLmZpZWxkKTtcbiAgICAgICAgbW9kYWwudGl0bGVFbC5zZXRUZXh0KFwiU2VsZWN0IHZhbHVlXCIpO1xuICAgICAgICBpZiAoU2VsZWN0RmllbGQuaXNNZW51KGxvY2F0aW9uKSkge1xuICAgICAgICAgICAgbG9jYXRpb24uYWRkSXRlbSgoaXRlbSkgPT4ge1xuICAgICAgICAgICAgICAgIGl0ZW0uc2V0VGl0bGUoYFVwZGF0ZSAke25hbWV9YCk7XG4gICAgICAgICAgICAgICAgaXRlbS5zZXRJY29uKEZpZWxkSWNvbltGaWVsZFR5cGUuU2VsZWN0XSk7XG4gICAgICAgICAgICAgICAgaXRlbS5vbkNsaWNrKCgpID0+IG1vZGFsLm9wZW4oKSk7XG4gICAgICAgICAgICAgICAgaXRlbS5zZXRTZWN0aW9uKFwibWV0YWRhdGEtbWVudS5maWVsZHNcIik7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSBlbHNlIGlmIChTZWxlY3RGaWVsZC5pc1N1Z2dlc3QobG9jYXRpb24pKSB7XG4gICAgICAgICAgICBsb2NhdGlvbi5vcHRpb25zLnB1c2goe1xuICAgICAgICAgICAgICAgIGlkOiBgdXBkYXRlXyR7bmFtZX1gLFxuICAgICAgICAgICAgICAgIGFjdGlvbkxhYmVsOiBgPHNwYW4+VXBkYXRlIDxiPiR7bmFtZX08L2I+PC9zcGFuPmAsXG4gICAgICAgICAgICAgICAgYWN0aW9uOiAoKSA9PiBtb2RhbC5vcGVuKCksXG4gICAgICAgICAgICAgICAgaWNvbjogRmllbGRJY29uW0ZpZWxkVHlwZS5TZWxlY3RdXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcbiAgICB9O1xuXG4gICAgcHVibGljIGNyZWF0ZUFuZE9wZW5GaWVsZE1vZGFsKGZpbGU6IFRGaWxlLCBzZWxlY3RlZEZpZWxkTmFtZTogc3RyaW5nLCB2YWx1ZT86IHN0cmluZywgbGluZU51bWJlcj86IG51bWJlciwgaW5Gcm9udG1hdHRlcj86IGJvb2xlYW4sIGFmdGVyPzogYm9vbGVhbik6IHZvaWQge1xuICAgICAgICBjb25zdCBmaWVsZE1vZGFsID0gbmV3IFNlbGVjdE1vZGFsKHRoaXMucGx1Z2luLCBmaWxlLCB2YWx1ZSB8fCBcIlwiLCB0aGlzLmZpZWxkLCBsaW5lTnVtYmVyLCBpbkZyb250bWF0dGVyLCBhZnRlcik7XG4gICAgICAgIGZpZWxkTW9kYWwudGl0bGVFbC5zZXRUZXh0KGBTZWxlY3Qgb3B0aW9uIGZvciAke3NlbGVjdGVkRmllbGROYW1lfWApO1xuICAgICAgICBmaWVsZE1vZGFsLm9wZW4oKTtcbiAgICB9XG5cbiAgICBwdWJsaWMgY3JlYXRlRHZGaWVsZChcbiAgICAgICAgZHY6IGFueSxcbiAgICAgICAgcDogYW55LFxuICAgICAgICBmaWVsZENvbnRhaW5lcjogSFRNTEVsZW1lbnQsXG4gICAgICAgIGF0dHJzPzogeyBjbHM/OiBzdHJpbmcsIGF0dHI/OiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+LCBvcHRpb25zPzogUmVjb3JkPHN0cmluZywgc3RyaW5nPiB9XG4gICAgKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IHZhbHVlQ29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTs7XG4gICAgICAgIGNvbnN0IHZhbHVlTGFiZWwgPSBkdi5lbChcInNwYW5cIiwgcFt0aGlzLmZpZWxkLm5hbWVdIHx8IFwiXCIpO1xuICAgICAgICB2YWx1ZUNvbnRhaW5lci5hcHBlbmRDaGlsZCh2YWx1ZUxhYmVsKTtcbiAgICAgICAgY29uc3QgZHJvcERvd25CdXR0b24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiYnV0dG9uXCIpO1xuICAgICAgICBzZXRJY29uKGRyb3BEb3duQnV0dG9uLCBcImRvd24tY2hldnJvbi1nbHlwaFwiKTtcbiAgICAgICAgZHJvcERvd25CdXR0b24uYWRkQ2xhc3MoXCJtZXRhZGF0YS1tZW51LWR2LWZpZWxkLWJ1dHRvblwiKTtcbiAgICAgICAgdmFsdWVDb250YWluZXIuYXBwZW5kQ2hpbGQoZHJvcERvd25CdXR0b24pO1xuXG5cbiAgICAgICAgY29uc3Qgc2VsZWN0Q29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgICAgICAgY29uc3Qgc2VsZWN0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInNlbGVjdFwiKTtcbiAgICAgICAgc2VsZWN0LnNldEF0dHIoXCJjbGFzc1wiLCBcIm1ldGFkYXRhLW1lbnUtZHYtc2VsZWN0XCIpO1xuICAgICAgICBzZWxlY3RDb250YWluZXIuYXBwZW5kQ2hpbGQoc2VsZWN0KTtcbiAgICAgICAgY29uc3QgZGlzbWlzc0J0biA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJidXR0b25cIik7XG4gICAgICAgIHNldEljb24oZGlzbWlzc0J0biwgXCJjcm9zc1wiKTtcbiAgICAgICAgZGlzbWlzc0J0bi5hZGRDbGFzcyhcIm1ldGFkYXRhLW1lbnUtZHYtZmllbGQtYnV0dG9uXCIpO1xuICAgICAgICBzZWxlY3RDb250YWluZXIuYXBwZW5kQ2hpbGQoZGlzbWlzc0J0bik7XG4gICAgICAgIGNvbnN0IG51bGxPcHRpb24gPSBuZXcgT3B0aW9uKFwiLS1zZWxlY3QtLVwiLCB1bmRlZmluZWQpO1xuICAgICAgICBzZWxlY3QuYWRkKG51bGxPcHRpb24pO1xuXG4gICAgICAgIGNvbnN0IHZhbHVlcyA9IHRoaXMuZ2V0T3B0aW9uc0xpc3QoKTtcbiAgICAgICAgdmFsdWVzLmZvckVhY2godiA9PiB7XG4gICAgICAgICAgICBjb25zdCB2YWx1ZSA9IG5ldyBPcHRpb24odiwgdilcbiAgICAgICAgICAgIGlmIChwW3RoaXMuZmllbGQubmFtZV0gPT09IHYgfHxcbiAgICAgICAgICAgICAgICBwW3RoaXMuZmllbGQubmFtZV0gJiZcbiAgICAgICAgICAgICAgICBPYmplY3Qua2V5cyhwW3RoaXMuZmllbGQubmFtZV0pLmluY2x1ZGVzKFwicGF0aFwiKSAmJlxuICAgICAgICAgICAgICAgIGBbWyR7cFt0aGlzLmZpZWxkLm5hbWVdLnBhdGgucmVwbGFjZShcIi5tZFwiLCBcIlwiKX1dXWAgPT09IHZcbiAgICAgICAgICAgICkge1xuICAgICAgICAgICAgICAgIHZhbHVlLnNlbGVjdGVkID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHNlbGVjdC5hZGQodmFsdWUpO1xuICAgICAgICAgICAgc2VsZWN0Lm9uY2hhbmdlID0gYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgICAgIGxldCBuZXdWYWx1ZSA9IFwiXCI7XG4gICAgICAgICAgICAgICAgaWYgKHNlbGVjdC52YWx1ZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIG5ld1ZhbHVlID0gc2VsZWN0LnZhbHVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBmaWVsZENvbnRhaW5lci5yZW1vdmVDaGlsZChzZWxlY3RDb250YWluZXIpXG4gICAgICAgICAgICAgICAgZmllbGRDb250YWluZXIuYXBwZW5kQ2hpbGQodmFsdWVDb250YWluZXIpXG4gICAgICAgICAgICAgICAgU2VsZWN0RmllbGQucmVwbGFjZVZhbHVlcyh0aGlzLnBsdWdpbiwgcC5maWxlLnBhdGgsIHRoaXMuZmllbGQubmFtZSwgbmV3VmFsdWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KVxuXG4gICAgICAgIGRyb3BEb3duQnV0dG9uLm9uY2xpY2sgPSAoKSA9PiB7XG4gICAgICAgICAgICBmaWVsZENvbnRhaW5lci5yZW1vdmVDaGlsZCh2YWx1ZUNvbnRhaW5lcik7XG4gICAgICAgICAgICBmaWVsZENvbnRhaW5lci5hcHBlbmRDaGlsZChzZWxlY3RDb250YWluZXIpO1xuICAgICAgICB9XG5cbiAgICAgICAgZGlzbWlzc0J0bi5vbmNsaWNrID0gKCkgPT4ge1xuICAgICAgICAgICAgZmllbGRDb250YWluZXIucmVtb3ZlQ2hpbGQoc2VsZWN0Q29udGFpbmVyKTtcbiAgICAgICAgICAgIGZpZWxkQ29udGFpbmVyLmFwcGVuZENoaWxkKHZhbHVlQ29udGFpbmVyKVxuICAgICAgICB9XG5cbiAgICAgICAgLyogaW5pdGlhbCBzdGF0ZSAqL1xuICAgICAgICBpZiAoIWF0dHJzPy5vcHRpb25zPy5hbHdheXNPbikge1xuICAgICAgICAgICAgZmllbGRDb250YWluZXIuYXBwZW5kQ2hpbGQodmFsdWVDb250YWluZXIpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgZmllbGRDb250YWluZXIuYXBwZW5kQ2hpbGQoc2VsZWN0Q29udGFpbmVyKTtcbiAgICAgICAgfVxuICAgIH1cbn0iLCAiaW1wb3J0IHsgVEZpbGUsIFN1Z2dlc3RNb2RhbCwgQnV0dG9uQ29tcG9uZW50IH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgRmllbGQgZnJvbSBcInNyYy9maWVsZHMvRmllbGRcIjtcbmltcG9ydCB7IHJlcGxhY2VWYWx1ZXMgfSBmcm9tIFwic3JjL2NvbW1hbmRzL3JlcGxhY2VWYWx1ZXNcIjtcbmltcG9ydCB7IGluc2VydFZhbHVlcyB9IGZyb20gXCJzcmMvY29tbWFuZHMvaW5zZXJ0VmFsdWVzXCI7XG5pbXBvcnQgTWV0YWRhdGFNZW51IGZyb20gXCJtYWluXCI7XG5pbXBvcnQgKiBhcyBzZWxlY3RWYWx1ZXNTb3VyY2UgZnJvbSBcInNyYy90eXBlcy9zZWxlY3RWYWx1ZXNTb3VyY2VUeXBlc1wiXG5pbXBvcnQgeyBGaWVsZE1hbmFnZXIgfSBmcm9tIFwic3JjL3R5cGVzL2ZpZWxkVHlwZXNcIjtcbmltcG9ydCBBYnN0cmFjdExpc3RCYXNlZEZpZWxkIGZyb20gXCJzcmMvZmllbGRzL2ZpZWxkTWFuYWdlcnMvQWJzdHJhY3RMaXN0QmFzZWRGaWVsZFwiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBWYWx1ZVN1Z2dlc3RNb2RhbCBleHRlbmRzIFN1Z2dlc3RNb2RhbDxzdHJpbmc+e1xuXG4gICAgcHJpdmF0ZSBhZGRCdXR0b246IEJ1dHRvbkNvbXBvbmVudDtcblxuICAgIGNvbnN0cnVjdG9yKFxuICAgICAgICBwcml2YXRlIHBsdWdpbjogTWV0YWRhdGFNZW51LFxuICAgICAgICBwcml2YXRlIGZpbGU6IFRGaWxlLFxuICAgICAgICBwcml2YXRlIHZhbHVlOiBzdHJpbmcsXG4gICAgICAgIHByaXZhdGUgZmllbGQ6IEZpZWxkLFxuICAgICAgICBwcml2YXRlIGxpbmVOdW1iZXI6IG51bWJlciA9IC0xLFxuICAgICAgICBwcml2YXRlIGluRnJvbnRtYXR0ZXI6IGJvb2xlYW4gPSBmYWxzZSxcbiAgICAgICAgcHJpdmF0ZSBhZnRlcjogYm9vbGVhbiA9IGZhbHNlXG4gICAgKSB7XG4gICAgICAgIHN1cGVyKHBsdWdpbi5hcHApO1xuICAgIH07XG5cbiAgICBhc3luYyBvbk9wZW4oKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIHN1cGVyLm9uT3BlbigpXG4gICAgICAgIGNvbnN0IGlucHV0Q29udGFpbmVyID0gdGhpcy5jb250YWluZXJFbC5jcmVhdGVEaXYoeyBjbHM6IFwibWV0YWRhdGEtbWVudS12YWx1ZS1zdWdnZXN0ZXItaW5wdXQtY29udGFpbmVyXCIgfSlcbiAgICAgICAgaW5wdXRDb250YWluZXIuYXBwZW5kQ2hpbGQodGhpcy5pbnB1dEVsKVxuICAgICAgICB0aGlzLmNvbnRhaW5lckVsLmZpbmQoXCIucHJvbXB0XCIpLnByZXBlbmQoaW5wdXRDb250YWluZXIpXG4gICAgICAgIGNvbnN0IGJ1dHRvbkNvbnRhaW5lciA9IHRoaXMuY29udGFpbmVyRWwuY3JlYXRlRGl2KHsgY2xzOiBcIm1ldGFkYXRhLW1lbnUtdmFsdWUtc3VnZ2VzdGVyLWFjdGlvbnNcIiB9KVxuICAgICAgICBidXR0b25Db250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcIm1ldGFkYXRhLW1lbnUtdmFsdWUtc3VnZ2VzdGVyLWFjdGlvbnMtc3BhY2VyXCIgfSlcbiAgICAgICAgY29uc3QgaW5mb0NvbnRhaW5lciA9IGJ1dHRvbkNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IFwibWV0YWRhdGEtbWVudS12YWx1ZS1zdWdnZXN0ZXItaW5mb1wiIH0pXG4gICAgICAgIGluZm9Db250YWluZXIuc2V0VGV4dChcIlNoaWZ0K0VudGVyIHRvIHNhdmVcIilcbiAgICAgICAgLy8gYWRkQnV0dG9uXG4gICAgICAgIHRoaXMuYWRkQnV0dG9uID0gbmV3IEJ1dHRvbkNvbXBvbmVudChpbnB1dENvbnRhaW5lcilcbiAgICAgICAgdGhpcy5hZGRCdXR0b24uc2V0SWNvbihcInBsdXNcIilcbiAgICAgICAgdGhpcy5hZGRCdXR0b24ub25DbGljaygoKSA9PiB0aGlzLmFkZE5ld1ZhbHVlVG9TZXR0aW5ncygpKVxuICAgICAgICB0aGlzLmFkZEJ1dHRvbi5idXR0b25FbC5hZGRDbGFzcyhcIm1ldGFkYXRhLW1lbnUtdmFsdWUtc3VnZ2VzdGVyLWJ1dHRvblwiKVxuICAgICAgICB0aGlzLmFkZEJ1dHRvbi5zZXRDdGEoKTtcbiAgICAgICAgdGhpcy5hZGRCdXR0b24uc2V0VG9vbHRpcChcIkFkZCB0aGlzIHZhbHVlIHRvIHRoaXMgZmllbGQgc2V0dGluZ3NcIilcbiAgICAgICAgdGhpcy5hZGRCdXR0b24uYnV0dG9uRWwuaGlkZSgpO1xuICAgICAgICAvL2NhbmNlbCBidXR0b25cbiAgICAgICAgY29uc3QgY2FuY2VsQnV0dG9uID0gbmV3IEJ1dHRvbkNvbXBvbmVudChidXR0b25Db250YWluZXIpXG4gICAgICAgIGNhbmNlbEJ1dHRvbi5zZXRJY29uKFwiY3Jvc3NcIilcbiAgICAgICAgY2FuY2VsQnV0dG9uLm9uQ2xpY2soKCkgPT4gdGhpcy5jbG9zZSgpKVxuICAgICAgICBjYW5jZWxCdXR0b24uYnV0dG9uRWwuYWRkQ2xhc3MoXCJtZXRhZGF0YS1tZW51LXZhbHVlLXN1Z2dlc3Rlci1idXR0b25cIilcbiAgICAgICAgY2FuY2VsQnV0dG9uLnNldFRvb2x0aXAoXCJDYW5jZWxcIilcbiAgICAgICAgLy9jbGVhciB2YWx1ZSBidXR0b25cbiAgICAgICAgY29uc3QgY2xlYXJCdXR0b24gPSBuZXcgQnV0dG9uQ29tcG9uZW50KGJ1dHRvbkNvbnRhaW5lcilcbiAgICAgICAgY2xlYXJCdXR0b24uc2V0SWNvbihcImVyYXNlclwiKVxuICAgICAgICBjbGVhckJ1dHRvbi5vbkNsaWNrKGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMuY2xlYXJWYWx1ZXMoKTtcbiAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgICAgfSlcbiAgICAgICAgY2xlYXJCdXR0b24uYnV0dG9uRWwuYWRkQ2xhc3MoXCJtZXRhZGF0YS1tZW51LXZhbHVlLXN1Z2dlc3Rlci1idXR0b25cIilcbiAgICAgICAgY2xlYXJCdXR0b24uYnV0dG9uRWwuYWRkQ2xhc3MoXCJkYW5nZXJcIilcbiAgICAgICAgY2xlYXJCdXR0b24uc2V0VG9vbHRpcChcIkNsZWFyIHRoZSBmaWVsZCB2YWx1ZVwiKVxuICAgICAgICB0aGlzLm1vZGFsRWwuYXBwZW5kQ2hpbGQoYnV0dG9uQ29udGFpbmVyKTtcbiAgICB9XG5cbiAgICBhc3luYyBhZGROZXdWYWx1ZVRvU2V0dGluZ3MoKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIGNvbnN0IG5ld1ZhbHVlID0gdGhpcy5pbnB1dEVsLnZhbHVlO1xuICAgICAgICBjb25zdCBmaWxlQ2xhc3NOYW1lID0gdGhpcy5wbHVnaW4uZmllbGRJbmRleC5maWxlc0ZpbGVDbGFzc05hbWUuZ2V0KHRoaXMuZmlsZS5wYXRoKVxuICAgICAgICBpZiAoZmlsZUNsYXNzTmFtZSkge1xuICAgICAgICAgICAgY29uc3QgZmlsZUNsYXNzID0gdGhpcy5wbHVnaW4uZmllbGRJbmRleC5maWxlQ2xhc3Nlc05hbWUuZ2V0KGZpbGVDbGFzc05hbWUpXG4gICAgICAgICAgICBjb25zdCBmaWxlQ2xhc3NBdHRyaWJ1dGUgPSBmaWxlQ2xhc3M/LmF0dHJpYnV0ZXMuZmluZChhdHRyID0+IGF0dHIubmFtZSA9PT0gdGhpcy5maWVsZC5uYW1lKVxuICAgICAgICAgICAgaWYgKGZpbGVDbGFzcyAmJiBmaWxlQ2xhc3NBdHRyaWJ1dGUpIHtcbiAgICAgICAgICAgICAgICBsZXQgbmV3T3B0aW9uczogc3RyaW5nW10gfCBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+O1xuICAgICAgICAgICAgICAgIGlmIChBcnJheS5pc0FycmF5KGZpbGVDbGFzc0F0dHJpYnV0ZS5vcHRpb25zKSkge1xuICAgICAgICAgICAgICAgICAgICBuZXdPcHRpb25zID0gWy4uLmZpbGVDbGFzc0F0dHJpYnV0ZS5vcHRpb25zLCBuZXdWYWx1ZV1cbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgZmlsZUNsYXNzLnVwZGF0ZUF0dHJpYnV0ZShmaWxlQ2xhc3NBdHRyaWJ1dGUudHlwZSwgZmlsZUNsYXNzQXR0cmlidXRlLm5hbWUsIG5ld09wdGlvbnMsIGZpbGVDbGFzc0F0dHJpYnV0ZSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChmaWxlQ2xhc3NBdHRyaWJ1dGUub3B0aW9ucy5zb3VyY2VUeXBlID09PSBzZWxlY3RWYWx1ZXNTb3VyY2UuVHlwZS5WYWx1ZXNMaXN0KSB7XG4gICAgICAgICAgICAgICAgICAgIG5ld09wdGlvbnMgPSBmaWxlQ2xhc3NBdHRyaWJ1dGUub3B0aW9ucy52YWx1ZXNMaXN0IGFzIFJlY29yZDxzdHJpbmcsIHN0cmluZz47XG4gICAgICAgICAgICAgICAgICAgIG5ld09wdGlvbnNbYCR7T2JqZWN0LmtleXMoZmlsZUNsYXNzQXR0cmlidXRlLm9wdGlvbnMudmFsdWVzTGlzdCkubGVuZ3RofWBdID0gbmV3VmFsdWVcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgZmlsZUNsYXNzLnVwZGF0ZUF0dHJpYnV0ZShmaWxlQ2xhc3NBdHRyaWJ1dGUudHlwZSwgZmlsZUNsYXNzQXR0cmlidXRlLm5hbWUsIG5ld09wdGlvbnMsIGZpbGVDbGFzc0F0dHJpYnV0ZSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChmaWxlQ2xhc3NBdHRyaWJ1dGUub3B0aW9ucy5zb3VyY2VUeXBlID09PSBzZWxlY3RWYWx1ZXNTb3VyY2UuVHlwZS5WYWx1ZXNMaXN0Tm90ZVBhdGgpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdmFsdWVzRmlsZSA9IHRoaXMucGx1Z2luLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgoZmlsZUNsYXNzQXR0cmlidXRlLm9wdGlvbnMudmFsdWVzTGlzdE5vdGVQYXRoKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHZhbHVlc0ZpbGUgaW5zdGFuY2VvZiBURmlsZSAmJiB2YWx1ZXNGaWxlLmV4dGVuc2lvbiA9PSBcIm1kXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMucGx1Z2luLmFwcC52YXVsdC5yZWFkKHZhbHVlc0ZpbGUpXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5hcHAudmF1bHQubW9kaWZ5KHZhbHVlc0ZpbGUsIGAke3Jlc3VsdH1cXG4ke25ld1ZhbHVlfWApO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgbmV3T3B0aW9ucyA9IGZpbGVDbGFzc0F0dHJpYnV0ZS5vcHRpb25zO1xuICAgICAgICAgICAgICAgICAgICBuZXdPcHRpb25zW2Ake09iamVjdC5rZXlzKGZpbGVDbGFzc0F0dHJpYnV0ZS5vcHRpb25zKS5sZW5ndGh9YF0gPSBuZXdWYWx1ZVxuICAgICAgICAgICAgICAgICAgICBhd2FpdCBmaWxlQ2xhc3MudXBkYXRlQXR0cmlidXRlKGZpbGVDbGFzc0F0dHJpYnV0ZS50eXBlLCBmaWxlQ2xhc3NBdHRyaWJ1dGUubmFtZSwgbmV3T3B0aW9ucywgZmlsZUNsYXNzQXR0cmlidXRlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjb25zdCBwcmVzZXRGaWVsZCA9IHRoaXMucGx1Z2luLnNldHRpbmdzLnByZXNldEZpZWxkcy5maW5kKGZpZWxkID0+IGZpZWxkLm5hbWUgPT09IHRoaXMuZmllbGQubmFtZSlcbiAgICAgICAgICAgIGlmIChwcmVzZXRGaWVsZD8ub3B0aW9ucy5zb3VyY2VUeXBlID09PSBzZWxlY3RWYWx1ZXNTb3VyY2UuVHlwZS5WYWx1ZXNMaXN0Tm90ZVBhdGgpIHtcbiAgICAgICAgICAgICAgICBjb25zdCB2YWx1ZXNGaWxlID0gdGhpcy5wbHVnaW4uYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChwcmVzZXRGaWVsZC5vcHRpb25zLnZhbHVlc0xpc3ROb3RlUGF0aClcbiAgICAgICAgICAgICAgICBpZiAodmFsdWVzRmlsZSBpbnN0YW5jZW9mIFRGaWxlICYmIHZhbHVlc0ZpbGUuZXh0ZW5zaW9uID09IFwibWRcIikge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLnBsdWdpbi5hcHAudmF1bHQucmVhZCh2YWx1ZXNGaWxlKVxuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5hcHAudmF1bHQubW9kaWZ5KHZhbHVlc0ZpbGUsIGAke3Jlc3VsdH1cXG4ke25ld1ZhbHVlfWApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSBpZiAocHJlc2V0RmllbGQ/Lm9wdGlvbnMuc291cmNlVHlwZSA9PT0gc2VsZWN0VmFsdWVzU291cmNlLlR5cGUuVmFsdWVzTGlzdCkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGN1cnJlbnRFeGlzdGluZ0ZpZWxkID0gdGhpcy5wbHVnaW4uaW5pdGlhbFByb3BlcnRpZXMuZmluZChwID0+IHAuaWQgPT0gdGhpcy5maWVsZC5pZCk7XG4gICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRFeGlzdGluZ0ZpZWxkKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHZhbHVlc0xpc3QgPSBjdXJyZW50RXhpc3RpbmdGaWVsZC5vcHRpb25zLnZhbHVlc0xpc3RcbiAgICAgICAgICAgICAgICAgICAgdmFsdWVzTGlzdFtgJHtPYmplY3Qua2V5cyh2YWx1ZXNMaXN0KS5sZW5ndGggKyAxfWBdID0gbmV3VmFsdWVcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgYXdhaXQgdGhpcy5zYXZlSXRlbShuZXdWYWx1ZSk7XG4gICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICB9XG5cbiAgICBhc3luYyBjbGVhclZhbHVlcygpIHtcbiAgICAgICAgaWYgKHRoaXMubGluZU51bWJlciA9PSAtMSkge1xuICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uZmlsZVRhc2tNYW5hZ2VyXG4gICAgICAgICAgICAgICAgLnB1c2hUYXNrKCgpID0+IHsgcmVwbGFjZVZhbHVlcyh0aGlzLnBsdWdpbiwgdGhpcy5maWxlLCB0aGlzLmZpZWxkLm5hbWUsIFwiXCIpIH0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uZmlsZVRhc2tNYW5hZ2VyXG4gICAgICAgICAgICAgICAgLnB1c2hUYXNrKCgpID0+IHsgaW5zZXJ0VmFsdWVzKHRoaXMucGx1Z2luLCB0aGlzLmZpbGUsIHRoaXMuZmllbGQubmFtZSwgXCJcIiwgdGhpcy5saW5lTnVtYmVyLCB0aGlzLmluRnJvbnRtYXR0ZXIsIHRoaXMuYWZ0ZXIpIH0pO1xuICAgICAgICB9O1xuICAgIH1cblxuICAgIGdldFN1Z2dlc3Rpb25zKHF1ZXJ5OiBzdHJpbmcpOiBzdHJpbmdbXSB7XG4gICAgICAgIGNvbnN0IGR2QXBpID0gdGhpcy5wbHVnaW4uYXBwLnBsdWdpbnMucGx1Z2lucy5kYXRhdmlldz8uYXBpXG4gICAgICAgIGxldCBkdkZpbGU6IGFueTtcbiAgICAgICAgaWYgKGR2QXBpKSBkdkZpbGUgPSBkdkFwaS5wYWdlKHRoaXMuZmlsZS5wYXRoKVxuICAgICAgICBjb25zdCBmaWVsZE1hbmFnZXIgPSBuZXcgRmllbGRNYW5hZ2VyW3RoaXMuZmllbGQudHlwZV0odGhpcy5wbHVnaW4sIHRoaXMuZmllbGQpIGFzIEFic3RyYWN0TGlzdEJhc2VkRmllbGRcbiAgICAgICAgY29uc3QgdmFsdWVzID0gZmllbGRNYW5hZ2VyLmdldE9wdGlvbnNMaXN0KGR2RmlsZSkuZmlsdGVyKG8gPT4gby50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKHF1ZXJ5LnRvTG93ZXJDYXNlKCkpKVxuICAgICAgICBpZiAodGhpcy5hZGRCdXR0b24pIHtcbiAgICAgICAgICAgICh2YWx1ZXMuc29tZShwID0+IHAgPT09IHF1ZXJ5KSB8fCB0aGlzLmZpZWxkLm9wdGlvbnMuc291cmNlVHlwZSA9PSBzZWxlY3RWYWx1ZXNTb3VyY2UuVHlwZS5WYWx1ZXNGcm9tRFZRdWVyeSB8fCAhcXVlcnkpID9cbiAgICAgICAgICAgICAgICB0aGlzLmFkZEJ1dHRvbi5idXR0b25FbC5oaWRlKCkgOlxuICAgICAgICAgICAgICAgIHRoaXMuYWRkQnV0dG9uLmJ1dHRvbkVsLnNob3coKTtcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIHZhbHVlc1xuICAgIH1cblxuICAgIHJlbmRlclN1Z2dlc3Rpb24odmFsdWU6IHN0cmluZywgZWw6IEhUTUxFbGVtZW50KSB7XG4gICAgICAgIGVsLnNldFRleHQodmFsdWUpXG4gICAgICAgIGlmICh2YWx1ZSA9PT0gdGhpcy52YWx1ZSkgZWwuYWRkQ2xhc3MoXCJtZXRhZGF0YS1tZW51LXZhbHVlLXNlbGVjdGVkXCIpXG4gICAgfVxuXG4gICAgcHJpdmF0ZSBhc3luYyBzYXZlSXRlbShpdGVtOiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgaWYgKHRoaXMubGluZU51bWJlciA9PSAtMSkge1xuICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uZmlsZVRhc2tNYW5hZ2VyXG4gICAgICAgICAgICAgICAgLnB1c2hUYXNrKCgpID0+IHsgcmVwbGFjZVZhbHVlcyh0aGlzLnBsdWdpbiwgdGhpcy5maWxlLCB0aGlzLmZpZWxkLm5hbWUsIGl0ZW0udG9TdHJpbmcoKSkgfSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5maWxlVGFza01hbmFnZXJcbiAgICAgICAgICAgICAgICAucHVzaFRhc2soKCkgPT4geyBpbnNlcnRWYWx1ZXModGhpcy5wbHVnaW4sIHRoaXMuZmlsZSwgdGhpcy5maWVsZC5uYW1lLCBpdGVtLnRvU3RyaW5nKCksIHRoaXMubGluZU51bWJlciwgdGhpcy5pbkZyb250bWF0dGVyLCB0aGlzLmFmdGVyKSB9KTtcbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICBhc3luYyBvbkNob29zZVN1Z2dlc3Rpb24oaXRlbTogc3RyaW5nLCBldnQ6IE1vdXNlRXZlbnQgfCBLZXlib2FyZEV2ZW50KSB7XG4gICAgICAgIHRoaXMuc2F2ZUl0ZW0oaXRlbSlcbiAgICB9XG59IiwgImV4cG9ydCBlbnVtIFR5cGUge1xuICAgIFwiVmFsdWVzTGlzdFwiID0gXCJWYWx1ZXNMaXN0XCIsXG4gICAgXCJWYWx1ZXNMaXN0Tm90ZVBhdGhcIiA9IFwiVmFsdWVzTGlzdE5vdGVQYXRoXCIsXG4gICAgXCJWYWx1ZXNGcm9tRFZRdWVyeVwiID0gXCJWYWx1ZXNGcm9tRFZRdWVyeVwiXG59XG5cbmV4cG9ydCBjb25zdCBLZXk6IFJlY29yZDxrZXlvZiB0eXBlb2YgVHlwZSwgc3RyaW5nPiA9IHtcbiAgICBcIlZhbHVlc0xpc3RcIjogXCJ2YWx1ZXNMaXN0XCIsXG4gICAgXCJWYWx1ZXNMaXN0Tm90ZVBhdGhcIjogXCJ2YWx1ZXNMaXN0Tm90ZVBhdGhcIixcbiAgICBcIlZhbHVlc0Zyb21EVlF1ZXJ5XCI6IFwidmFsdWVzRnJvbURWUXVlcnlcIlxufVxuXG5leHBvcnQgY29uc3QgdHlwZURpc3BsYXk6IFJlY29yZDxrZXlvZiB0eXBlb2YgVHlwZSwgc3RyaW5nPiA9IHtcbiAgICBcIlZhbHVlc0xpc3RcIjogXCJWYWx1ZXMgZGVmaW5lZCBpbiB0aGlzIHNldHRpbmdzXCIsXG4gICAgXCJWYWx1ZXNMaXN0Tm90ZVBhdGhcIjogXCJWYWx1ZXMgZnJvbSBhIG5vdGVcIixcbiAgICBcIlZhbHVlc0Zyb21EVlF1ZXJ5XCI6IFwiVmFsdWVzIHJldHVybmVkIGZyb20gYSBkYXRhdmlldyBxdWVyeVwiXG59IiwgImltcG9ydCB7IEZpZWxkVHlwZSB9IGZyb20gXCJzcmMvdHlwZXMvZmllbGRUeXBlc1wiO1xuaW1wb3J0IEZpZWxkIGZyb20gXCIuLi9GaWVsZFwiO1xuaW1wb3J0IHsgRmllbGRNYW5hZ2VyLCBTZXR0aW5nTG9jYXRpb24gfSBmcm9tIFwiLi4vRmllbGRNYW5hZ2VyXCI7XG5pbXBvcnQgeyBUZXh0Q29tcG9uZW50LCBCdXR0b25Db21wb25lbnQsIHNldEljb24sIERyb3Bkb3duQ29tcG9uZW50LCBUZXh0QXJlYUNvbXBvbmVudCB9IGZyb20gXCJvYnNpZGlhblwiO1xuaW1wb3J0IEZpZWxkU2V0dGluZ3NNb2RhbCBmcm9tIFwic3JjL3NldHRpbmdzL0ZpZWxkU2V0dGluZ3NNb2RhbFwiO1xuaW1wb3J0IE1ldGFkYXRhTWVudSBmcm9tIFwibWFpblwiO1xuaW1wb3J0IHsgRmlsZVN1Z2dlc3QgfSBmcm9tIFwic3JjL3N1Z2dlc3Rlci9GaWxlU3VnZ2VzdGVyXCI7XG5pbXBvcnQgKiBhcyBzZWxlY3RWYWx1ZXNTb3VyY2UgZnJvbSBcInNyYy90eXBlcy9zZWxlY3RWYWx1ZXNTb3VyY2VUeXBlc1wiXG5cbmV4cG9ydCBkZWZhdWx0IGFic3RyYWN0IGNsYXNzIEFic3RyYWN0TGlzdEJhc2VkRmllbGQgZXh0ZW5kcyBGaWVsZE1hbmFnZXIge1xuXG4gICAgYWJzdHJhY3QgdmFsdWVzUHJvbXB0Q29tcG9uZW50czogQXJyYXk8VGV4dENvbXBvbmVudD47XG5cbiAgICBjb25zdHJ1Y3RvcihwbHVnaW46IE1ldGFkYXRhTWVudSwgZmllbGQ6IEZpZWxkLCB0eXBlOiBGaWVsZFR5cGUpIHtcbiAgICAgICAgc3VwZXIocGx1Z2luLCBmaWVsZCwgdHlwZSlcbiAgICB9XG5cbiAgICAvL1NldHRpbmdzXG4gICAgcHJpdmF0ZSBzZXRWYWx1ZUxpc3RUZXh0KGhlYWRlcjogSFRNTERpdkVsZW1lbnQpOiB2b2lkIHtcbiAgICAgICAgaGVhZGVyLnNldFRleHQoYFByZXNldCBvcHRpb25zOiAke09iamVjdC52YWx1ZXModGhpcy5maWVsZC5vcHRpb25zLnZhbHVlc0xpc3QpLmpvaW4oJywgJyl9YCk7XG4gICAgfTtcblxuICAgIHByaXZhdGUgY3JlYXRlTGlzdE5vdGVQYXRoQ29udGFpbmVyKHBhcmVudE5vZGU6IEhUTUxEaXZFbGVtZW50LCBwbHVnaW46IE1ldGFkYXRhTWVudSk6IEhUTUxEaXZFbGVtZW50IHtcbiAgICAgICAgY29uc3QgdmFsdWVzTGlzdE5vdGVQYXRoQ29udGFpbmVyID0gcGFyZW50Tm9kZS5jcmVhdGVEaXYoe30pO1xuICAgICAgICBjb25zdCBsaXN0Tm90ZUNvbnRhaW5lckxhYmVsID0gdmFsdWVzTGlzdE5vdGVQYXRoQ29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJtZXRhZGF0YS1tZW51LXNldHRpbmctZmlsZUNsYXNzLXNlYXJjaFwiIH0pO1xuICAgICAgICBsaXN0Tm90ZUNvbnRhaW5lckxhYmVsLnNldFRleHQoYFBhdGggb2YgdGhlIG5vdGUgY29udGFpbmluZyB0aGUgdmFsdWVzOmApO1xuXG4gICAgICAgIGNvbnN0IGlucHV0ID0gbmV3IFRleHRDb21wb25lbnQodmFsdWVzTGlzdE5vdGVQYXRoQ29udGFpbmVyKTtcblxuICAgICAgICBuZXcgRmlsZVN1Z2dlc3QoXG4gICAgICAgICAgICBpbnB1dC5pbnB1dEVsLFxuICAgICAgICAgICAgcGx1Z2luLFxuICAgICAgICAgICAgXCIvXCJcbiAgICAgICAgKVxuICAgICAgICBjb25zdCBsaXN0Tm90ZVBhdGggPSB0aGlzLmZpZWxkLm9wdGlvbnMudmFsdWVzTGlzdE5vdGVQYXRoO1xuICAgICAgICBpbnB1dC5zZXRWYWx1ZShsaXN0Tm90ZVBhdGggfHwgXCJcIik7XG4gICAgICAgIGlucHV0LnNldFBsYWNlaG9sZGVyKFwiUGF0aC9vZi90aGUvbm90ZS5tZFwiKTtcbiAgICAgICAgaW5wdXQub25DaGFuZ2UodmFsdWUgPT4gdGhpcy5maWVsZC5vcHRpb25zLnZhbHVlc0xpc3ROb3RlUGF0aCA9IHZhbHVlKTtcbiAgICAgICAgcmV0dXJuIHZhbHVlc0xpc3ROb3RlUGF0aENvbnRhaW5lcjtcbiAgICB9XG5cbiAgICBwcml2YXRlIHJlbW92ZVByZXNldFZhbHVlKGtleTogc3RyaW5nKTogdm9pZCB7XG4gICAgICAgIGxldCBuZXdWYWx1ZXM6IFJlY29yZDxzdHJpbmcsIHN0cmluZz4gPSB7fTtcbiAgICAgICAgZm9yIChsZXQgX2tleSBpbiB0aGlzLmZpZWxkLm9wdGlvbnMudmFsdWVzTGlzdCkge1xuICAgICAgICAgICAgaWYgKGtleSAhPT0gX2tleSkge1xuICAgICAgICAgICAgICAgIG5ld1ZhbHVlc1tfa2V5XSA9IHRoaXMuZmllbGQub3B0aW9ucy52YWx1ZXNMaXN0W19rZXldO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5maWVsZC5vcHRpb25zLnZhbHVlc0xpc3QgPSBuZXdWYWx1ZXM7XG4gICAgfTtcblxuICAgIHByaXZhdGUgY3JlYXRlVmFsdWVzTGlzdENvbnRhaW5lcihwYXJlbnRDb250YWluZXI6IEhUTUxEaXZFbGVtZW50KTogSFRNTERpdkVsZW1lbnQge1xuICAgICAgICBjb25zdCBwcmVzZXRWYWx1ZXNGaWVsZHMgPSBwYXJlbnRDb250YWluZXIuY3JlYXRlRGl2KClcbiAgICAgICAgY29uc3QgdmFsdWVzTGlzdCA9IHByZXNldFZhbHVlc0ZpZWxkcy5jcmVhdGVEaXYoKTtcbiAgICAgICAgY29uc3QgdmFsdWVzTGlzdEhlYWRlciA9IHZhbHVlc0xpc3QuY3JlYXRlRGl2KHsgY2xzOiBcIm1ldGFkYXRhLW1lbnUtZmllbGQtb3B0aW9uXCIgfSk7XG4gICAgICAgIHZhbHVlc0xpc3RIZWFkZXIuY3JlYXRlRWwoXCJoMlwiKTtcbiAgICAgICAgdmFsdWVzTGlzdEhlYWRlci5zZXRUZXh0KGBQcmVzZXQgb3B0aW9uczogJHtPYmplY3QudmFsdWVzKHRoaXMuZmllbGQub3B0aW9ucy52YWx1ZXNMaXN0KS5qb2luKCcsICcpfWApO1xuICAgICAgICBjb25zdCB2YWx1ZXNMaXN0Qm9keSA9IHZhbHVlc0xpc3QuY3JlYXRlRGl2KCk7XG4gICAgICAgIE9iamVjdC5rZXlzKHRoaXMuZmllbGQub3B0aW9ucy52YWx1ZXNMaXN0KS5mb3JFYWNoKGtleSA9PiB7XG4gICAgICAgICAgICB0aGlzLnZhbHVlc1Byb21wdENvbXBvbmVudHMucHVzaCh0aGlzLmNyZWF0ZVZhbHVlQ29udGFpbmVyKHZhbHVlc0xpc3RCb2R5LCB2YWx1ZXNMaXN0SGVhZGVyLCBrZXkpKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuY3JlYXRlQWRkQnV0dG9uKHZhbHVlc0xpc3QsIHZhbHVlc0xpc3RCb2R5LCB2YWx1ZXNMaXN0SGVhZGVyKVxuICAgICAgICByZXR1cm4gcHJlc2V0VmFsdWVzRmllbGRzO1xuICAgIH1cblxuICAgIHByaXZhdGUgY3JlYXRlVmFsdWVDb250YWluZXIocGFyZW50Tm9kZTogSFRNTERpdkVsZW1lbnQsIGhlYWRlcjogSFRNTERpdkVsZW1lbnQsIGtleTogc3RyaW5nKTogVGV4dENvbXBvbmVudCB7XG4gICAgICAgIGNvbnN0IHZhbHVlcyA9IHRoaXMuZmllbGQub3B0aW9ucy52YWx1ZXNMaXN0IHx8IHt9O1xuICAgICAgICBjb25zdCBwcmVzZXRWYWx1ZSA9IHZhbHVlc1trZXldO1xuICAgICAgICBjb25zdCB2YWx1ZUNvbnRhaW5lciA9IHBhcmVudE5vZGUuY3JlYXRlRGl2KHtcbiAgICAgICAgICAgIGNsczogJ21ldGFkYXRhLW1lbnUtcHJvbXB0LWNvbnRhaW5lcicsXG4gICAgICAgIH0pO1xuICAgICAgICBjb25zdCBpbnB1dCA9IG5ldyBUZXh0Q29tcG9uZW50KHZhbHVlQ29udGFpbmVyKTtcbiAgICAgICAgdGhpcy52YWx1ZXNQcm9tcHRDb21wb25lbnRzLnB1c2goaW5wdXQpXG4gICAgICAgIGlucHV0LnNldFZhbHVlKHByZXNldFZhbHVlKTtcbiAgICAgICAgaW5wdXQub25DaGFuZ2UodmFsdWUgPT4ge1xuICAgICAgICAgICAgdGhpcy5maWVsZC5vcHRpb25zLnZhbHVlc0xpc3Rba2V5XSA9IHZhbHVlO1xuICAgICAgICAgICAgdGhpcy5zZXRWYWx1ZUxpc3RUZXh0KGhlYWRlcik7XG4gICAgICAgICAgICBGaWVsZFNldHRpbmdzTW9kYWwucmVtb3ZlVmFsaWRhdGlvbkVycm9yKGlucHV0KTtcbiAgICAgICAgfSk7XG4gICAgICAgIGNvbnN0IHZhbHVlUmVtb3ZlQnV0dG9uID0gbmV3IEJ1dHRvbkNvbXBvbmVudCh2YWx1ZUNvbnRhaW5lcik7XG4gICAgICAgIHZhbHVlUmVtb3ZlQnV0dG9uLnNldEljb24oXCJ0cmFzaFwiKVxuICAgICAgICAgICAgLm9uQ2xpY2soKGV2dDogTW91c2VFdmVudCkgPT4ge1xuICAgICAgICAgICAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdDtcbiAgICAgICAgICAgICAgICB0aGlzLnJlbW92ZVByZXNldFZhbHVlKGtleSk7XG4gICAgICAgICAgICAgICAgdGhpcy5zZXRWYWx1ZUxpc3RUZXh0KGhlYWRlcik7XG4gICAgICAgICAgICAgICAgcGFyZW50Tm9kZS5yZW1vdmVDaGlsZCh2YWx1ZUNvbnRhaW5lcik7XG4gICAgICAgICAgICAgICAgdGhpcy52YWx1ZXNQcm9tcHRDb21wb25lbnRzLnJlbW92ZShpbnB1dCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgaWYgKGtleSAhPSBPYmplY3Qua2V5cyh0aGlzLmZpZWxkLm9wdGlvbnMpWzBdKSB7XG4gICAgICAgICAgICBjb25zdCB2YWx1ZVVwZ3JhZGVCdXR0b24gPSBuZXcgQnV0dG9uQ29tcG9uZW50KHZhbHVlQ29udGFpbmVyKTtcbiAgICAgICAgICAgIHNldEljb24odmFsdWVVcGdyYWRlQnV0dG9uLmJ1dHRvbkVsLCBcInVwLWNoZXZyb24tZ2x5cGhcIik7XG4gICAgICAgICAgICB2YWx1ZVVwZ3JhZGVCdXR0b24ub25DbGljaygoZXZ0OiBNb3VzZUV2ZW50KSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgdGhpc1ZhbHVlID0gdmFsdWVzW2tleV07XG4gICAgICAgICAgICAgICAgY29uc3QgaW5wdXRJbmRleCA9IHRoaXMudmFsdWVzUHJvbXB0Q29tcG9uZW50cy5pbmRleE9mKGlucHV0KVxuICAgICAgICAgICAgICAgIGNvbnN0IHVwcGVyQ29tcG9uZW50ID0gaW5wdXRJbmRleCAhPT0gLTEgPyB0aGlzLnZhbHVlc1Byb21wdENvbXBvbmVudHNbaW5wdXRJbmRleCAtIDFdIDogdGhpcy52YWx1ZXNQcm9tcHRDb21wb25lbnRzLmxhc3QoKTtcbiAgICAgICAgICAgICAgICBpZiAodXBwZXJDb21wb25lbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdXBwZXJWYWx1ZSA9IHVwcGVyQ29tcG9uZW50LmlucHV0RWwudmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHVwcGVyS2V5ID0gT2JqZWN0LmtleXModmFsdWVzKS5maWx0ZXIoayA9PiB2YWx1ZXNba10gPT0gdXBwZXJWYWx1ZSlbMF07XG4gICAgICAgICAgICAgICAgICAgIGlmICh1cHBlcktleSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdXBwZXJDb21wb25lbnQuc2V0VmFsdWUodGhpc1ZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlc1t1cHBlcktleV0gPSB0aGlzVmFsdWU7XG4gICAgICAgICAgICAgICAgICAgICAgICBpbnB1dC5zZXRWYWx1ZSh1cHBlclZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlc1trZXldID0gdXBwZXJWYWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBpbnB1dDtcbiAgICB9O1xuXG4gICAgcHVibGljIHZhbGlkYXRlVmFsdWUodmFsdWU6IHN0cmluZyk6IGJvb2xlYW4ge1xuICAgICAgICBpZiAodGhpcy5maWVsZC5vcHRpb25zLnZhbHVlc0xpc3QgJiYgT2JqZWN0LnZhbHVlcyh0aGlzLmZpZWxkLm9wdGlvbnMudmFsdWVzTGlzdCkubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgaWYgKHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIE9iamVjdC52YWx1ZXModGhpcy5maWVsZC5vcHRpb25zKS5pbmNsdWRlcyh2YWx1ZS50cmltKCkpXG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgIH0gZWxzZSBpZiAodGhpcy5maWVsZC5vcHRpb25zLnZhbHVlc0xpc3ROb3RlUGF0aCkge1xuICAgICAgICAgICAgY29uc3QgbGlzdE5vdGVWYWx1ZXMgPSB0aGlzLnBsdWdpbi5maWVsZEluZGV4LnZhbHVlc0xpc3ROb3RlUGF0aFZhbHVlcy5nZXQodGhpcy5maWVsZC5vcHRpb25zLnZhbHVlc0xpc3ROb3RlUGF0aClcbiAgICAgICAgICAgIHJldHVybiBsaXN0Tm90ZVZhbHVlcyAhPT0gdW5kZWZpbmVkID8gbGlzdE5vdGVWYWx1ZXMuY29udGFpbnModmFsdWUudHJpbSgpKSA6IGZhbHNlXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2VcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHB1YmxpYyBnZXRPcHRpb25zU3RyKCk6IHN0cmluZyB7XG4gICAgICAgIHN3aXRjaCAodGhpcy5maWVsZC5vcHRpb25zLnNvdXJjZVR5cGUpIHtcbiAgICAgICAgICAgIGNhc2Ugc2VsZWN0VmFsdWVzU291cmNlLlR5cGUuVmFsdWVzTGlzdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gT2JqZWN0LnZhbHVlcyh0aGlzLmZpZWxkLm9wdGlvbnMudmFsdWVzTGlzdCkuam9pbihcIiwgXCIpO1xuICAgICAgICAgICAgY2FzZSBzZWxlY3RWYWx1ZXNTb3VyY2UuVHlwZS5WYWx1ZXNMaXN0Tm90ZVBhdGg6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuZmllbGQub3B0aW9ucy52YWx1ZXNMaXN0Tm90ZVBhdGhcbiAgICAgICAgICAgIGNhc2Ugc2VsZWN0VmFsdWVzU291cmNlLlR5cGUuVmFsdWVzRnJvbURWUXVlcnk6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuZmllbGQub3B0aW9ucy52YWx1ZXNGcm9tRFZRdWVyeVxuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gXCJcIlxuXG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwdWJsaWMgZ2V0T3B0aW9uc0xpc3QoZHZGaWxlOiBhbnkgPSB1bmRlZmluZWQpOiBzdHJpbmdbXSB7XG4gICAgICAgIGxldCB2YWx1ZXM6IHN0cmluZ1tdID0gW107XG4gICAgICAgIGlmIChBcnJheS5pc0FycmF5KHRoaXMuZmllbGQub3B0aW9ucykpIHtcbiAgICAgICAgICAgIHZhbHVlcyA9IHRoaXMuZmllbGQub3B0aW9ucztcbiAgICAgICAgfSBlbHNlIGlmICghdGhpcy5maWVsZC5vcHRpb25zLnNvdXJjZVR5cGUpIHtcbiAgICAgICAgICAgIHZhbHVlcyA9IE9iamVjdC52YWx1ZXModGhpcy5maWVsZC5vcHRpb25zKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHN3aXRjaCAodGhpcy5maWVsZC5vcHRpb25zLnNvdXJjZVR5cGUpIHtcbiAgICAgICAgICAgICAgICBjYXNlIHNlbGVjdFZhbHVlc1NvdXJjZS5UeXBlLlZhbHVlc0xpc3Q6XG4gICAgICAgICAgICAgICAgICAgIHZhbHVlcyA9IE9iamVjdC52YWx1ZXModGhpcy5maWVsZC5vcHRpb25zLnZhbHVlc0xpc3QpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIHNlbGVjdFZhbHVlc1NvdXJjZS5UeXBlLlZhbHVlc0xpc3ROb3RlUGF0aDpcbiAgICAgICAgICAgICAgICAgICAgdmFsdWVzID0gdGhpcy5wbHVnaW4uZmllbGRJbmRleC52YWx1ZXNMaXN0Tm90ZVBhdGhWYWx1ZXNcbiAgICAgICAgICAgICAgICAgICAgICAgIC5nZXQodGhpcy5maWVsZC5vcHRpb25zLnZhbHVlc0xpc3ROb3RlUGF0aCkgfHwgW107XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2Ugc2VsZWN0VmFsdWVzU291cmNlLlR5cGUuVmFsdWVzRnJvbURWUXVlcnk6XG4gICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGR2QXBpID0gdGhpcy5wbHVnaW4uYXBwLnBsdWdpbnMucGx1Z2lucy5kYXRhdmlldz8uYXBpXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZHZBcGkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZXMgPSBuZXcgRnVuY3Rpb24oXCJkdlwiLCBcImN1cnJlbnRcIiwgYHJldHVybiAke3RoaXMuZmllbGQub3B0aW9ucy52YWx1ZXNGcm9tRFZRdWVyeX1gKShkdkFwaSwgZHZGaWxlKVxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZXMgPSBbXVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgIHZhbHVlcyA9IFtdO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdmFsdWVzO1xuICAgIH1cblxuICAgIHB1YmxpYyB2YWxpZGF0ZU9wdGlvbnMoKTogYm9vbGVhbiB7XG4gICAgICAgIGxldCBlcnJvciA9IGZhbHNlO1xuICAgICAgICB0aGlzLnZhbHVlc1Byb21wdENvbXBvbmVudHMuZm9yRWFjaChpbnB1dCA9PiB7XG4gICAgICAgICAgICBpZiAoL1ssXS9ndS50ZXN0KGlucHV0LmlucHV0RWwudmFsdWUpICYmIGlucHV0LmlucHV0RWwucGFyZW50RWxlbWVudD8ubGFzdEVsZW1lbnRDaGlsZCkge1xuICAgICAgICAgICAgICAgIEZpZWxkU2V0dGluZ3NNb2RhbC5zZXRWYWxpZGF0aW9uRXJyb3IoXG4gICAgICAgICAgICAgICAgICAgIGlucHV0LCBpbnB1dC5pbnB1dEVsLnBhcmVudEVsZW1lbnQubGFzdEVsZW1lbnRDaGlsZCxcbiAgICAgICAgICAgICAgICAgICAgXCJWYWx1ZXMgY2Fubm90IGNvbnRhaW4gYSBjb21tYVwiXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICBlcnJvciA9IHRydWU7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgaWYgKGlucHV0LmlucHV0RWwudmFsdWUgPT0gXCJcIiAmJiBpbnB1dC5pbnB1dEVsLnBhcmVudEVsZW1lbnQ/Lmxhc3RFbGVtZW50Q2hpbGQpIHtcbiAgICAgICAgICAgICAgICBGaWVsZFNldHRpbmdzTW9kYWwuc2V0VmFsaWRhdGlvbkVycm9yKFxuICAgICAgICAgICAgICAgICAgICBpbnB1dCwgaW5wdXQuaW5wdXRFbC5wYXJlbnRFbGVtZW50Lmxhc3RFbGVtZW50Q2hpbGQsXG4gICAgICAgICAgICAgICAgICAgIFwiVmFsdWVzIGNhbid0IGJlIG51bGwuXCJcbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgIGVycm9yID0gdHJ1ZTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gIWVycm9yXG4gICAgfVxuXG4gICAgcHJpdmF0ZSBjcmVhdGVBZGRCdXR0b24odmFsdWVzTGlzdDogSFRNTERpdkVsZW1lbnQsIHZhbHVlc0xpc3RCb2R5OiBIVE1MRGl2RWxlbWVudCwgdmFsdWVzTGlzdEhlYWRlcjogSFRNTERpdkVsZW1lbnQpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgdmFsdWVzTGlzdEZvb3RlciA9IHZhbHVlc0xpc3QuY3JlYXRlRGl2KCk7XG4gICAgICAgIGNvbnN0IGFkZFZhbHVlID0gdmFsdWVzTGlzdEZvb3Rlci5jcmVhdGVFbCgnYnV0dG9uJyk7XG4gICAgICAgIGFkZFZhbHVlLnR5cGUgPSAnYnV0dG9uJztcbiAgICAgICAgYWRkVmFsdWUudGV4dENvbnRlbnQgPSAnQWRkJztcbiAgICAgICAgYWRkVmFsdWUub25DbGlja0V2ZW50KGFzeW5jIChldnQ6IE1vdXNlRXZlbnQpID0+IHtcbiAgICAgICAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdDtcblxuICAgICAgICAgICAgbGV0IG5ld0tleU51bWJlciA9IDE7XG4gICAgICAgICAgICBPYmplY3Qua2V5cyh0aGlzLmZpZWxkLm9wdGlvbnMudmFsdWVzTGlzdCkuZm9yRWFjaChrZXkgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChwYXJzZUludChrZXkpICYmIHBhcnNlSW50KGtleSkgPj0gbmV3S2V5TnVtYmVyKSB7XG4gICAgICAgICAgICAgICAgICAgIG5ld0tleU51bWJlciA9IHBhcnNlSW50KGtleSkgKyAxO1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGNvbnN0IG5ld0tleSA9IG5ld0tleU51bWJlci50b1N0cmluZygpO1xuICAgICAgICAgICAgdGhpcy5maWVsZC5vcHRpb25zLnZhbHVlc0xpc3RbbmV3S2V5XSA9IFwiXCI7XG4gICAgICAgICAgICB0aGlzLmNyZWF0ZVZhbHVlQ29udGFpbmVyKHZhbHVlc0xpc3RCb2R5LCB2YWx1ZXNMaXN0SGVhZGVyLCBuZXdLZXkpXG4gICAgICAgIH0pO1xuICAgICAgICB2YWx1ZXNMaXN0LmNyZWF0ZURpdih7IGNsczogJ21ldGFkYXRhLW1lbnUtc2VwYXJhdG9yJyB9KS5jcmVhdGVFbChcImhyXCIpO1xuICAgIH1cblxuICAgIHByaXZhdGUgY3JlYXRlVmFsdWVzRnJvbURWUXVlcnlDb250YWluZXIocGFyZW50Q29udGFpbmVyOiBIVE1MRGl2RWxlbWVudCk6IEhUTUxEaXZFbGVtZW50IHtcbiAgICAgICAgY29uc3QgdmFsdWVzRnJvbURWUXVlcnlDb250YWluZXIgPSBwYXJlbnRDb250YWluZXIuY3JlYXRlRGl2KHt9KVxuICAgICAgICB2YWx1ZXNGcm9tRFZRdWVyeUNvbnRhaW5lci5jcmVhdGVFbChcInNwYW5cIiwgeyB0ZXh0OiBcIkRhdGF2aWV3IGZ1bmN0aW9uXCIsIGNsczogXCJtZXRhZGF0YS1tZW51LWZpZWxkLW9wdGlvblwiIH0pO1xuICAgICAgICB2YWx1ZXNGcm9tRFZRdWVyeUNvbnRhaW5lci5jcmVhdGVFbChcInNwYW5cIiwgeyB0ZXh0OiBcIkRhdGF2aWV3IHF1ZXJ5IHJldHVybmluZyBhIGxpc3Qgb2Ygc3RyaW5nICg8ZHY+IG9iamVjdCBpcyBhdmFpbGFibGUpXCIsIGNsczogXCJtZXRhZGF0YS1tZW51LWZpZWxkLW9wdGlvbi1zdWJ0ZXh0XCIgfSk7XG4gICAgICAgIGNvbnN0IHZhbHVlc0Zyb21EVlF1ZXJ5ID0gbmV3IFRleHRBcmVhQ29tcG9uZW50KHZhbHVlc0Zyb21EVlF1ZXJ5Q29udGFpbmVyKTtcbiAgICAgICAgdmFsdWVzRnJvbURWUXVlcnkuaW5wdXRFbC5jb2xzID0gNjU7XG4gICAgICAgIHZhbHVlc0Zyb21EVlF1ZXJ5LmlucHV0RWwucm93cyA9IDg7XG4gICAgICAgIHZhbHVlc0Zyb21EVlF1ZXJ5LnNldFBsYWNlaG9sZGVyKFwiZXg6IGR2LnBhZ2VzKCcjc3R1ZGVudCcpLm1hcChwID0+IHAubmFtZSlcIilcbiAgICAgICAgdmFsdWVzRnJvbURWUXVlcnkuc2V0VmFsdWUodGhpcy5maWVsZC5vcHRpb25zLnZhbHVlc0Zyb21EVlF1ZXJ5IHx8IFwiXCIpO1xuICAgICAgICB2YWx1ZXNGcm9tRFZRdWVyeS5vbkNoYW5nZSgodmFsdWUpID0+IHtcbiAgICAgICAgICAgIHRoaXMuZmllbGQub3B0aW9ucy52YWx1ZXNGcm9tRFZRdWVyeSA9IHZhbHVlXG4gICAgICAgIH0pXG4gICAgICAgIHJldHVybiB2YWx1ZXNGcm9tRFZRdWVyeUNvbnRhaW5lcjtcbiAgICB9XG5cbiAgICBwcml2YXRlIGRpc3BsYXlTZWxlY3RlZFR5cGVDb250YWluZXIob3B0aW9uQ29udGFpbmVyczogUmVjb3JkPGtleW9mIHR5cGVvZiBzZWxlY3RWYWx1ZXNTb3VyY2UuVHlwZSwgSFRNTERpdkVsZW1lbnQ+LCB2YWx1ZToga2V5b2YgdHlwZW9mIHNlbGVjdFZhbHVlc1NvdXJjZS5UeXBlKSB7XG4gICAgICAgIE9iamVjdC5rZXlzKG9wdGlvbkNvbnRhaW5lcnMpLmZvckVhY2goKGtleToga2V5b2YgdHlwZW9mIHNlbGVjdFZhbHVlc1NvdXJjZS5UeXBlKSA9PiB7XG4gICAgICAgICAgICBpZiAoa2V5ID09PSB2YWx1ZSkge1xuICAgICAgICAgICAgICAgIG9wdGlvbkNvbnRhaW5lcnNba2V5XS5zaG93KClcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgb3B0aW9uQ29udGFpbmVyc1trZXldLmhpZGUoKVxuICAgICAgICAgICAgfVxuICAgICAgICB9KVxuICAgIH1cblxuICAgIHB1YmxpYyBjcmVhdGVTZXR0aW5nQ29udGFpbmVyKHBhcmVudENvbnRhaW5lcjogSFRNTERpdkVsZW1lbnQsIHBsdWdpbjogTWV0YWRhdGFNZW51LCBsb2NhdGlvbj86IFNldHRpbmdMb2NhdGlvbik6IHZvaWQge1xuICAgICAgICAvL3N0cnVjdHVyZTpcbiAgICAgICAgLy9zZWxlY3RldXIgZGUgdHlwZSBhdmVjIGRlZmF1dGwgc3VyIHZhbHVlc0xpc3RcbiAgICAgICAgLy92YWx1ZXNDb250YWluZXIgcXVpIGRpc3BsYXkgbGUgYm9uIGlucHV0IGVuIGZvbmN0aW9uIGRlIGxhIHZhbGV1ciBkZSB2YWx1ZXNUeXBlU2VsZWN0XG4gICAgICAgIGNvbnN0IHNvdXJjZVR5cGVDb250YWluZXIgPSBwYXJlbnRDb250YWluZXIuY3JlYXRlRGl2KCk7XG4gICAgICAgIHNvdXJjZVR5cGVDb250YWluZXIuY3JlYXRlRGl2KHsgdGV4dDogXCJTZWxlY3QgdGhlIHNvdXJjZSBvZiB2YWx1ZXMgZm9yIHRoaXMgZmllbGRcIiwgY2xzOiBcIm1ldGFkYXRhLW1lbnUtZmllbGQtb3B0aW9uXCIgfSlcbiAgICAgICAgY29uc3Qgc291cmNlVHlwZSA9IG5ldyBEcm9wZG93bkNvbXBvbmVudChzb3VyY2VUeXBlQ29udGFpbmVyKTtcbiAgICAgICAgLy9tYW5hZ2UgbmV3IGZpZWxkIGFuZCBmaWxlQ2xhc3MgbGVnYWN5IGZpZWxkXG4gICAgICAgIGlmICghdGhpcy5maWVsZC5vcHRpb25zLnNvdXJjZVR5cGUpIHtcbiAgICAgICAgICAgIC8vdGhpcyBpcyBhIG5ldyBmaWVsZCBvciBmaWxlQ2xhc3MgbGVnYWN5IGZpZWxkXG4gICAgICAgICAgICBpZiAodHlwZW9mIHRoaXMuZmllbGQub3B0aW9ucyA9PT0gXCJvYmplY3RcIiAmJiBPYmplY3Qua2V5cyh0aGlzLmZpZWxkLm9wdGlvbnMpLmV2ZXJ5KGtleSA9PiAhaXNOYU4ocGFyc2VJbnQoa2V5KSkpKSB7XG4gICAgICAgICAgICAgICAgLy90aGlzIGlzIGEgZmlsZUNsYXNzIGxlZ2FjeSBmaWVsZFxuICAgICAgICAgICAgICAgIGNvbnN0IHZhbHVlc0xpc3Q6IFJlY29yZDxzdHJpbmcsIHN0cmluZz4gPSB7fVxuICAgICAgICAgICAgICAgIE9iamVjdC5rZXlzKHRoaXMuZmllbGQub3B0aW9ucykuZm9yRWFjaCgoa2V5OiBzdHJpbmcpID0+IHZhbHVlc0xpc3Rba2V5XSA9IHRoaXMuZmllbGQub3B0aW9uc1trZXldKTtcbiAgICAgICAgICAgICAgICB0aGlzLmZpZWxkLm9wdGlvbnMgPSB7fVxuICAgICAgICAgICAgICAgIHRoaXMuZmllbGQub3B0aW9ucy52YWx1ZXNMaXN0ID0gdmFsdWVzTGlzdDtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5maWVsZC5vcHRpb25zID0ge31cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuZmllbGQub3B0aW9ucy5zb3VyY2VUeXBlID0gc2VsZWN0VmFsdWVzU291cmNlLlR5cGUuVmFsdWVzTGlzdDtcbiAgICAgICAgICAgIHRoaXMuZmllbGQub3B0aW9ucy52YWx1ZXNMaXN0Tm90ZVBhdGggPSBcIlwiO1xuICAgICAgICAgICAgdGhpcy5maWVsZC5vcHRpb25zLnZhbHVlc0Zyb21EVlF1ZXJ5ID0gXCJcIjtcbiAgICAgICAgfVxuICAgICAgICBPYmplY3Qua2V5cyhzZWxlY3RWYWx1ZXNTb3VyY2UuVHlwZSkuZm9yRWFjaCgob3B0aW9uOiBrZXlvZiB0eXBlb2Ygc2VsZWN0VmFsdWVzU291cmNlLlR5cGUpID0+IHNvdXJjZVR5cGUuYWRkT3B0aW9uKG9wdGlvbiwgc2VsZWN0VmFsdWVzU291cmNlLnR5cGVEaXNwbGF5W29wdGlvbl0pKVxuICAgICAgICBzb3VyY2VUeXBlLnNldFZhbHVlKHRoaXMuZmllbGQub3B0aW9ucy5zb3VyY2VUeXBlIHx8IHNlbGVjdFZhbHVlc1NvdXJjZS5UeXBlLlZhbHVlc0xpc3QpXG5cbiAgICAgICAgY29uc3QgdmFsdWVzTGlzdE5vdGVQYXRoQ29udGFpbmVyID0gdGhpcy5jcmVhdGVMaXN0Tm90ZVBhdGhDb250YWluZXIocGFyZW50Q29udGFpbmVyLCBwbHVnaW4pO1xuICAgICAgICBjb25zdCBwcmVzZXRWYWx1ZXNGaWVsZHNDb250YWluZXIgPSB0aGlzLmNyZWF0ZVZhbHVlc0xpc3RDb250YWluZXIocGFyZW50Q29udGFpbmVyKTtcbiAgICAgICAgY29uc3QgdmFsdWVzRnJvbURWUXVlcnlDb250YWluZXIgPSB0aGlzLmNyZWF0ZVZhbHVlc0Zyb21EVlF1ZXJ5Q29udGFpbmVyKHBhcmVudENvbnRhaW5lcik7XG5cbiAgICAgICAgY29uc3QgdmFsdWVzQ29udGFpbmVyczogUmVjb3JkPGtleW9mIHR5cGVvZiBzZWxlY3RWYWx1ZXNTb3VyY2UuVHlwZSwgSFRNTERpdkVsZW1lbnQ+ID0ge1xuICAgICAgICAgICAgXCJWYWx1ZXNMaXN0XCI6IHByZXNldFZhbHVlc0ZpZWxkc0NvbnRhaW5lcixcbiAgICAgICAgICAgIFwiVmFsdWVzTGlzdE5vdGVQYXRoXCI6IHZhbHVlc0xpc3ROb3RlUGF0aENvbnRhaW5lcixcbiAgICAgICAgICAgIFwiVmFsdWVzRnJvbURWUXVlcnlcIjogdmFsdWVzRnJvbURWUXVlcnlDb250YWluZXJcbiAgICAgICAgfVxuXG4gICAgICAgIHNvdXJjZVR5cGUub25DaGFuZ2UoKHZhbHVlOiBrZXlvZiB0eXBlb2Ygc2VsZWN0VmFsdWVzU291cmNlLlR5cGUpID0+IHtcbiAgICAgICAgICAgIHRoaXMuZmllbGQub3B0aW9ucy5zb3VyY2VUeXBlID0gdmFsdWU7XG4gICAgICAgICAgICB0aGlzLmRpc3BsYXlTZWxlY3RlZFR5cGVDb250YWluZXIodmFsdWVzQ29udGFpbmVycywgdmFsdWUpXG4gICAgICAgIH0pXG5cbiAgICAgICAgdGhpcy5kaXNwbGF5U2VsZWN0ZWRUeXBlQ29udGFpbmVyKHZhbHVlc0NvbnRhaW5lcnMsIHRoaXMuZmllbGQub3B0aW9ucy5zb3VyY2VUeXBlKVxuICAgIH1cblxuICAgIHB1YmxpYyBjcmVhdGVEdkZpZWxkKFxuICAgICAgICBkdjogYW55LFxuICAgICAgICBwOiBhbnksXG4gICAgICAgIGZpZWxkQ29udGFpbmVyOiBIVE1MRWxlbWVudCxcbiAgICAgICAgYXR0cnM/OiB7IGNscz86IHN0cmluZywgYXR0cj86IFJlY29yZDxzdHJpbmcsIHN0cmluZz4sIG9wdGlvbnM/OiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+IH1cbiAgICApOiB2b2lkIHtcbiAgICAgICAgY29uc3QgZmllbGRWYWx1ZSA9IGR2LmVsKFwic3BhblwiLCBwW3RoaXMuZmllbGQubmFtZV0pO1xuICAgICAgICBmaWVsZENvbnRhaW5lci5hcHBlbmRDaGlsZChmaWVsZFZhbHVlKTtcbiAgICB9XG59IiwgIi8vIENyZWRpdHMgZ28gdG8gTGlhbSdzIFBlcmlvZGljIE5vdGVzIFBsdWdpbjogaHR0cHM6Ly9naXRodWIuY29tL2xpYW1jYWluL29ic2lkaWFuLXBlcmlvZGljLW5vdGVzXG5cbmltcG9ydCB7IFRBYnN0cmFjdEZpbGUsIFRGaWxlIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgeyBUZXh0SW5wdXRTdWdnZXN0IH0gZnJvbSBcIi4vc3VnZ2VzdFwiO1xuaW1wb3J0IHsgZ2V0X3RmaWxlc19mcm9tX2ZvbGRlciB9IGZyb20gXCIuLi91dGlscy9maWxlVXRpbHNcIjtcbmltcG9ydCBNZXRhZGF0YU1lbnUgZnJvbSBcIm1haW5cIjtcblxuZXhwb3J0IGNsYXNzIEZpbGVTdWdnZXN0IGV4dGVuZHMgVGV4dElucHV0U3VnZ2VzdDxURmlsZT4ge1xuICAgIGNvbnN0cnVjdG9yKFxuICAgICAgICBwdWJsaWMgaW5wdXRFbDogSFRNTElucHV0RWxlbWVudCxcbiAgICAgICAgcHJpdmF0ZSBwbHVnaW46IE1ldGFkYXRhTWVudSxcbiAgICAgICAgcHVibGljIGZvbGRlcjogc3RyaW5nXG4gICAgKSB7XG4gICAgICAgIHN1cGVyKGlucHV0RWwpO1xuICAgICAgICB0aGlzLnBsdWdpbiA9IHBsdWdpblxuICAgIH1cblxuICAgIGdldFN1Z2dlc3Rpb25zKGlucHV0X3N0cjogc3RyaW5nKTogVEZpbGVbXSB7XG4gICAgICAgIGNvbnN0IGFsbF9maWxlcyA9IFtdXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBhbGxfZmlsZXMucHVzaCguLi5nZXRfdGZpbGVzX2Zyb21fZm9sZGVyKHRoaXMucGx1Z2luLCB0aGlzLmZvbGRlcikpXG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG5cbiAgICAgICAgfVxuICAgICAgICBjb25zdCBmaWxlczogVEZpbGVbXSA9IFtdO1xuICAgICAgICBjb25zdCBsb3dlcl9pbnB1dF9zdHIgPSBpbnB1dF9zdHIudG9Mb3dlckNhc2UoKTtcblxuICAgICAgICBhbGxfZmlsZXMuZm9yRWFjaCgoZmlsZTogVEFic3RyYWN0RmlsZSkgPT4ge1xuICAgICAgICAgICAgaWYgKFxuICAgICAgICAgICAgICAgIGZpbGUgaW5zdGFuY2VvZiBURmlsZSAmJlxuICAgICAgICAgICAgICAgIGZpbGUuZXh0ZW5zaW9uID09PSBcIm1kXCIgJiZcbiAgICAgICAgICAgICAgICBmaWxlLnBhdGgudG9Mb3dlckNhc2UoKS5jb250YWlucyhsb3dlcl9pbnB1dF9zdHIpXG4gICAgICAgICAgICApIHtcbiAgICAgICAgICAgICAgICBmaWxlcy5wdXNoKGZpbGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICByZXR1cm4gZmlsZXM7XG4gICAgfVxuXG4gICAgcmVuZGVyU3VnZ2VzdGlvbihmaWxlOiBURmlsZSwgZWw6IEhUTUxFbGVtZW50KTogdm9pZCB7XG4gICAgICAgIGVsLnNldFRleHQoZmlsZS5wYXRoKTtcbiAgICB9XG5cbiAgICBzZWxlY3RTdWdnZXN0aW9uKGZpbGU6IFRGaWxlKTogdm9pZCB7XG4gICAgICAgIHRoaXMuaW5wdXRFbC52YWx1ZSA9IGZpbGUucGF0aDtcbiAgICAgICAgdGhpcy5pbnB1dEVsLnRyaWdnZXIoXCJpbnB1dFwiKTtcbiAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgIH1cbn1cbiIsICIvLyBDcmVkaXRzIGdvIHRvIExpYW0ncyBQZXJpb2RpYyBOb3RlcyBQbHVnaW46IGh0dHBzOi8vZ2l0aHViLmNvbS9saWFtY2Fpbi9vYnNpZGlhbi1wZXJpb2RpYy1ub3Rlc1xuXG5pbXBvcnQgeyBJU3VnZ2VzdE93bmVyLCBTY29wZSB9IGZyb20gXCJvYnNpZGlhblwiO1xuaW1wb3J0IHsgY3JlYXRlUG9wcGVyLCBJbnN0YW5jZSBhcyBQb3BwZXJJbnN0YW5jZSB9IGZyb20gXCJAcG9wcGVyanMvY29yZVwiO1xuXG5jb25zdCB3cmFwQXJvdW5kID0gKHZhbHVlOiBudW1iZXIsIHNpemU6IG51bWJlcik6IG51bWJlciA9PiB7XG4gICAgcmV0dXJuICgodmFsdWUgJSBzaXplKSArIHNpemUpICUgc2l6ZTtcbn07XG5cbmNsYXNzIFN1Z2dlc3Q8VD4ge1xuICAgIHByaXZhdGUgdmFsdWVzOiBUW107XG4gICAgcHJpdmF0ZSBzdWdnZXN0aW9uczogSFRNTERpdkVsZW1lbnRbXTtcbiAgICBwcml2YXRlIHNlbGVjdGVkSXRlbTogbnVtYmVyO1xuXG4gICAgY29uc3RydWN0b3IoXG4gICAgICAgIHByaXZhdGUgb3duZXI6IElTdWdnZXN0T3duZXI8VD4sXG4gICAgICAgIHByaXZhdGUgY29udGFpbmVyRWw6IEhUTUxFbGVtZW50LFxuICAgICAgICBzY29wZTogU2NvcGVcbiAgICApIHtcblxuICAgICAgICBjb250YWluZXJFbC5vbihcbiAgICAgICAgICAgIFwiY2xpY2tcIixcbiAgICAgICAgICAgIFwiLnN1Z2dlc3Rpb24taXRlbVwiLFxuICAgICAgICAgICAgdGhpcy5vblN1Z2dlc3Rpb25DbGljay5iaW5kKHRoaXMpXG4gICAgICAgICk7XG4gICAgICAgIGNvbnRhaW5lckVsLm9uKFxuICAgICAgICAgICAgXCJtb3VzZW1vdmVcIixcbiAgICAgICAgICAgIFwiLnN1Z2dlc3Rpb24taXRlbVwiLFxuICAgICAgICAgICAgdGhpcy5vblN1Z2dlc3Rpb25Nb3VzZW92ZXIuYmluZCh0aGlzKVxuICAgICAgICApO1xuXG4gICAgICAgIHNjb3BlLnJlZ2lzdGVyKFtdLCBcIkFycm93VXBcIiwgKGV2ZW50KSA9PiB7XG4gICAgICAgICAgICBpZiAoIWV2ZW50LmlzQ29tcG9zaW5nKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zZXRTZWxlY3RlZEl0ZW0odGhpcy5zZWxlY3RlZEl0ZW0gLSAxLCB0cnVlKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHNjb3BlLnJlZ2lzdGVyKFtdLCBcIkFycm93RG93blwiLCAoZXZlbnQpID0+IHtcbiAgICAgICAgICAgIGlmICghZXZlbnQuaXNDb21wb3NpbmcpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNldFNlbGVjdGVkSXRlbSh0aGlzLnNlbGVjdGVkSXRlbSArIDEsIHRydWUpO1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgc2NvcGUucmVnaXN0ZXIoW10sIFwiRW50ZXJcIiwgKGV2ZW50KSA9PiB7XG4gICAgICAgICAgICBpZiAoIWV2ZW50LmlzQ29tcG9zaW5nKSB7XG4gICAgICAgICAgICAgICAgdGhpcy51c2VTZWxlY3RlZEl0ZW0oZXZlbnQpO1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgb25TdWdnZXN0aW9uQ2xpY2soZXZlbnQ6IE1vdXNlRXZlbnQsIGVsOiBIVE1MRGl2RWxlbWVudCk6IHZvaWQge1xuICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gICAgICAgIGNvbnN0IGl0ZW0gPSB0aGlzLnN1Z2dlc3Rpb25zLmluZGV4T2YoZWwpO1xuICAgICAgICB0aGlzLnNldFNlbGVjdGVkSXRlbShpdGVtLCBmYWxzZSk7XG4gICAgICAgIHRoaXMudXNlU2VsZWN0ZWRJdGVtKGV2ZW50KTtcbiAgICB9XG5cbiAgICBvblN1Z2dlc3Rpb25Nb3VzZW92ZXIoX2V2ZW50OiBNb3VzZUV2ZW50LCBlbDogSFRNTERpdkVsZW1lbnQpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgaXRlbSA9IHRoaXMuc3VnZ2VzdGlvbnMuaW5kZXhPZihlbCk7XG4gICAgICAgIHRoaXMuc2V0U2VsZWN0ZWRJdGVtKGl0ZW0sIGZhbHNlKTtcbiAgICB9XG5cbiAgICBzZXRTdWdnZXN0aW9ucyh2YWx1ZXM6IFRbXSkge1xuICAgICAgICB0aGlzLmNvbnRhaW5lckVsLmVtcHR5KCk7XG4gICAgICAgIGNvbnN0IHN1Z2dlc3Rpb25FbHM6IEhUTUxEaXZFbGVtZW50W10gPSBbXTtcblxuICAgICAgICB2YWx1ZXMuZm9yRWFjaCgodmFsdWUpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHN1Z2dlc3Rpb25FbCA9IHRoaXMuY29udGFpbmVyRWwuY3JlYXRlRGl2KFwic3VnZ2VzdGlvbi1pdGVtXCIpO1xuICAgICAgICAgICAgdGhpcy5vd25lci5yZW5kZXJTdWdnZXN0aW9uKHZhbHVlLCBzdWdnZXN0aW9uRWwpO1xuICAgICAgICAgICAgc3VnZ2VzdGlvbkVscy5wdXNoKHN1Z2dlc3Rpb25FbCk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRoaXMudmFsdWVzID0gdmFsdWVzO1xuICAgICAgICB0aGlzLnN1Z2dlc3Rpb25zID0gc3VnZ2VzdGlvbkVscztcbiAgICAgICAgdGhpcy5zZXRTZWxlY3RlZEl0ZW0oMCwgZmFsc2UpO1xuICAgIH1cblxuICAgIHVzZVNlbGVjdGVkSXRlbShldmVudDogTW91c2VFdmVudCB8IEtleWJvYXJkRXZlbnQpIHtcbiAgICAgICAgY29uc3QgY3VycmVudFZhbHVlID0gdGhpcy52YWx1ZXNbdGhpcy5zZWxlY3RlZEl0ZW1dO1xuICAgICAgICBpZiAoY3VycmVudFZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLm93bmVyLnNlbGVjdFN1Z2dlc3Rpb24oY3VycmVudFZhbHVlLCBldmVudCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBzZXRTZWxlY3RlZEl0ZW0oc2VsZWN0ZWRJbmRleDogbnVtYmVyLCBzY3JvbGxJbnRvVmlldzogYm9vbGVhbikge1xuICAgICAgICBjb25zdCBub3JtYWxpemVkSW5kZXggPSB3cmFwQXJvdW5kKFxuICAgICAgICAgICAgc2VsZWN0ZWRJbmRleCxcbiAgICAgICAgICAgIHRoaXMuc3VnZ2VzdGlvbnMubGVuZ3RoXG4gICAgICAgICk7XG4gICAgICAgIGNvbnN0IHByZXZTZWxlY3RlZFN1Z2dlc3Rpb24gPSB0aGlzLnN1Z2dlc3Rpb25zW3RoaXMuc2VsZWN0ZWRJdGVtXTtcbiAgICAgICAgY29uc3Qgc2VsZWN0ZWRTdWdnZXN0aW9uID0gdGhpcy5zdWdnZXN0aW9uc1tub3JtYWxpemVkSW5kZXhdO1xuXG4gICAgICAgIHByZXZTZWxlY3RlZFN1Z2dlc3Rpb24/LnJlbW92ZUNsYXNzKFwiaXMtc2VsZWN0ZWRcIik7XG4gICAgICAgIHNlbGVjdGVkU3VnZ2VzdGlvbj8uYWRkQ2xhc3MoXCJpcy1zZWxlY3RlZFwiKTtcblxuICAgICAgICB0aGlzLnNlbGVjdGVkSXRlbSA9IG5vcm1hbGl6ZWRJbmRleDtcblxuICAgICAgICBpZiAoc2Nyb2xsSW50b1ZpZXcpIHtcbiAgICAgICAgICAgIHNlbGVjdGVkU3VnZ2VzdGlvbi5zY3JvbGxJbnRvVmlldyhmYWxzZSk7XG4gICAgICAgIH1cbiAgICB9XG59XG5cbmV4cG9ydCBhYnN0cmFjdCBjbGFzcyBUZXh0SW5wdXRTdWdnZXN0PFQ+IGltcGxlbWVudHMgSVN1Z2dlc3RPd25lcjxUPiB7XG4gICAgcHJvdGVjdGVkIGlucHV0RWw6IEhUTUxJbnB1dEVsZW1lbnQgfCBIVE1MVGV4dEFyZWFFbGVtZW50O1xuXG4gICAgcHJpdmF0ZSBwb3BwZXI6IFBvcHBlckluc3RhbmNlO1xuICAgIHByaXZhdGUgc2NvcGU6IFNjb3BlO1xuICAgIHByaXZhdGUgc3VnZ2VzdEVsOiBIVE1MRWxlbWVudDtcbiAgICBwcml2YXRlIHN1Z2dlc3Q6IFN1Z2dlc3Q8VD47XG5cbiAgICBjb25zdHJ1Y3RvcihpbnB1dEVsOiBIVE1MSW5wdXRFbGVtZW50IHwgSFRNTFRleHRBcmVhRWxlbWVudCkge1xuICAgICAgICB0aGlzLmlucHV0RWwgPSBpbnB1dEVsO1xuICAgICAgICB0aGlzLnNjb3BlID0gbmV3IFNjb3BlKCk7XG5cbiAgICAgICAgdGhpcy5zdWdnZXN0RWwgPSBjcmVhdGVEaXYoXCJzdWdnZXN0aW9uLWNvbnRhaW5lclwiKTtcbiAgICAgICAgY29uc3Qgc3VnZ2VzdGlvbiA9IHRoaXMuc3VnZ2VzdEVsLmNyZWF0ZURpdihcInN1Z2dlc3Rpb25cIik7XG4gICAgICAgIHRoaXMuc3VnZ2VzdCA9IG5ldyBTdWdnZXN0KHRoaXMsIHN1Z2dlc3Rpb24sIHRoaXMuc2NvcGUpO1xuXG4gICAgICAgIHRoaXMuc2NvcGUucmVnaXN0ZXIoW10sIFwiRXNjYXBlXCIsIHRoaXMuY2xvc2UuYmluZCh0aGlzKSk7XG5cbiAgICAgICAgdGhpcy5pbnB1dEVsLmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCB0aGlzLm9uSW5wdXRDaGFuZ2VkLmJpbmQodGhpcykpO1xuICAgICAgICB0aGlzLmlucHV0RWwuYWRkRXZlbnRMaXN0ZW5lcihcImZvY3VzXCIsIHRoaXMub25JbnB1dENoYW5nZWQuYmluZCh0aGlzKSk7XG4gICAgICAgIHRoaXMuaW5wdXRFbC5hZGRFdmVudExpc3RlbmVyKFwiYmx1clwiLCB0aGlzLmNsb3NlLmJpbmQodGhpcykpO1xuICAgICAgICB0aGlzLnN1Z2dlc3RFbC5vbihcbiAgICAgICAgICAgIFwibW91c2Vkb3duXCIsXG4gICAgICAgICAgICBcIi5zdWdnZXN0aW9uLWNvbnRhaW5lclwiLFxuICAgICAgICAgICAgKGV2ZW50OiBNb3VzZUV2ZW50KSA9PiB7XG4gICAgICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgKTtcbiAgICB9XG5cbiAgICBvbklucHV0Q2hhbmdlZCgpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgaW5wdXRTdHIgPSB0aGlzLmlucHV0RWwudmFsdWU7XG4gICAgICAgIGNvbnN0IHN1Z2dlc3Rpb25zID0gdGhpcy5nZXRTdWdnZXN0aW9ucyhpbnB1dFN0cik7XG5cbiAgICAgICAgaWYgKCFzdWdnZXN0aW9ucykge1xuICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHN1Z2dlc3Rpb25zLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIHRoaXMuc3VnZ2VzdC5zZXRTdWdnZXN0aW9ucyhzdWdnZXN0aW9ucyk7XG4gICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxuICAgICAgICAgICAgdGhpcy5vcGVuKCg8YW55PmFwcCkuZG9tLmFwcENvbnRhaW5lckVsLCB0aGlzLmlucHV0RWwpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgb3Blbihjb250YWluZXI6IEhUTUxFbGVtZW50LCBpbnB1dEVsOiBIVE1MRWxlbWVudCk6IHZvaWQge1xuICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxuICAgICAgICAoPGFueT5hcHApLmtleW1hcC5wdXNoU2NvcGUodGhpcy5zY29wZSk7XG5cbiAgICAgICAgY29udGFpbmVyLmFwcGVuZENoaWxkKHRoaXMuc3VnZ2VzdEVsKTtcbiAgICAgICAgdGhpcy5wb3BwZXIgPSBjcmVhdGVQb3BwZXIoaW5wdXRFbCwgdGhpcy5zdWdnZXN0RWwsIHtcbiAgICAgICAgICAgIHBsYWNlbWVudDogXCJib3R0b20tc3RhcnRcIixcbiAgICAgICAgICAgIG1vZGlmaWVyczogW1xuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogXCJzYW1lV2lkdGhcIixcbiAgICAgICAgICAgICAgICAgICAgZW5hYmxlZDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgZm46ICh7IHN0YXRlLCBpbnN0YW5jZSB9KSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBOb3RlOiBwb3NpdGlvbmluZyBuZWVkcyB0byBiZSBjYWxjdWxhdGVkIHR3aWNlIC1cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGZpcnN0IHBhc3MgLSBwb3NpdGlvbmluZyBpdCBhY2NvcmRpbmcgdG8gdGhlIHdpZHRoIG9mIHRoZSBwb3BwZXJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHNlY29uZCBwYXNzIC0gcG9zaXRpb24gaXQgd2l0aCB0aGUgd2lkdGggYm91bmQgdG8gdGhlIHJlZmVyZW5jZSBlbGVtZW50XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyB3ZSBuZWVkIHRvIGVhcmx5IGV4aXQgdG8gYXZvaWQgYW4gaW5maW5pdGUgbG9vcFxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdGFyZ2V0V2lkdGggPSBgJHtzdGF0ZS5yZWN0cy5yZWZlcmVuY2Uud2lkdGh9cHhgO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHN0YXRlLnN0eWxlcy5wb3BwZXIud2lkdGggPT09IHRhcmdldFdpZHRoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGUuc3R5bGVzLnBvcHBlci53aWR0aCA9IHRhcmdldFdpZHRoO1xuICAgICAgICAgICAgICAgICAgICAgICAgaW5zdGFuY2UudXBkYXRlKCk7XG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHBoYXNlOiBcImJlZm9yZVdyaXRlXCIsXG4gICAgICAgICAgICAgICAgICAgIHJlcXVpcmVzOiBbXCJjb21wdXRlU3R5bGVzXCJdLFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBdLFxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBjbG9zZSgpOiB2b2lkIHtcbiAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcbiAgICAgICAgKDxhbnk+YXBwKS5rZXltYXAucG9wU2NvcGUodGhpcy5zY29wZSk7XG5cbiAgICAgICAgdGhpcy5zdWdnZXN0LnNldFN1Z2dlc3Rpb25zKFtdKTtcbiAgICAgICAgaWYgKHRoaXMucG9wcGVyKSB0aGlzLnBvcHBlci5kZXN0cm95KCk7XG4gICAgICAgIHRoaXMuc3VnZ2VzdEVsLmRldGFjaCgpO1xuICAgIH1cblxuICAgIGFic3RyYWN0IGdldFN1Z2dlc3Rpb25zKGlucHV0U3RyOiBzdHJpbmcpOiBUW107XG4gICAgYWJzdHJhY3QgcmVuZGVyU3VnZ2VzdGlvbihpdGVtOiBULCBlbDogSFRNTEVsZW1lbnQpOiB2b2lkO1xuICAgIGFic3RyYWN0IHNlbGVjdFN1Z2dlc3Rpb24oaXRlbTogVCk6IHZvaWQ7XG59XG4iLCAiZXhwb3J0IHZhciB0b3AgPSAndG9wJztcbmV4cG9ydCB2YXIgYm90dG9tID0gJ2JvdHRvbSc7XG5leHBvcnQgdmFyIHJpZ2h0ID0gJ3JpZ2h0JztcbmV4cG9ydCB2YXIgbGVmdCA9ICdsZWZ0JztcbmV4cG9ydCB2YXIgYXV0byA9ICdhdXRvJztcbmV4cG9ydCB2YXIgYmFzZVBsYWNlbWVudHMgPSBbdG9wLCBib3R0b20sIHJpZ2h0LCBsZWZ0XTtcbmV4cG9ydCB2YXIgc3RhcnQgPSAnc3RhcnQnO1xuZXhwb3J0IHZhciBlbmQgPSAnZW5kJztcbmV4cG9ydCB2YXIgY2xpcHBpbmdQYXJlbnRzID0gJ2NsaXBwaW5nUGFyZW50cyc7XG5leHBvcnQgdmFyIHZpZXdwb3J0ID0gJ3ZpZXdwb3J0JztcbmV4cG9ydCB2YXIgcG9wcGVyID0gJ3BvcHBlcic7XG5leHBvcnQgdmFyIHJlZmVyZW5jZSA9ICdyZWZlcmVuY2UnO1xuZXhwb3J0IHZhciB2YXJpYXRpb25QbGFjZW1lbnRzID0gLyojX19QVVJFX18qL2Jhc2VQbGFjZW1lbnRzLnJlZHVjZShmdW5jdGlvbiAoYWNjLCBwbGFjZW1lbnQpIHtcbiAgcmV0dXJuIGFjYy5jb25jYXQoW3BsYWNlbWVudCArIFwiLVwiICsgc3RhcnQsIHBsYWNlbWVudCArIFwiLVwiICsgZW5kXSk7XG59LCBbXSk7XG5leHBvcnQgdmFyIHBsYWNlbWVudHMgPSAvKiNfX1BVUkVfXyovW10uY29uY2F0KGJhc2VQbGFjZW1lbnRzLCBbYXV0b10pLnJlZHVjZShmdW5jdGlvbiAoYWNjLCBwbGFjZW1lbnQpIHtcbiAgcmV0dXJuIGFjYy5jb25jYXQoW3BsYWNlbWVudCwgcGxhY2VtZW50ICsgXCItXCIgKyBzdGFydCwgcGxhY2VtZW50ICsgXCItXCIgKyBlbmRdKTtcbn0sIFtdKTsgLy8gbW9kaWZpZXJzIHRoYXQgbmVlZCB0byByZWFkIHRoZSBET01cblxuZXhwb3J0IHZhciBiZWZvcmVSZWFkID0gJ2JlZm9yZVJlYWQnO1xuZXhwb3J0IHZhciByZWFkID0gJ3JlYWQnO1xuZXhwb3J0IHZhciBhZnRlclJlYWQgPSAnYWZ0ZXJSZWFkJzsgLy8gcHVyZS1sb2dpYyBtb2RpZmllcnNcblxuZXhwb3J0IHZhciBiZWZvcmVNYWluID0gJ2JlZm9yZU1haW4nO1xuZXhwb3J0IHZhciBtYWluID0gJ21haW4nO1xuZXhwb3J0IHZhciBhZnRlck1haW4gPSAnYWZ0ZXJNYWluJzsgLy8gbW9kaWZpZXIgd2l0aCB0aGUgcHVycG9zZSB0byB3cml0ZSB0byB0aGUgRE9NIChvciB3cml0ZSBpbnRvIGEgZnJhbWV3b3JrIHN0YXRlKVxuXG5leHBvcnQgdmFyIGJlZm9yZVdyaXRlID0gJ2JlZm9yZVdyaXRlJztcbmV4cG9ydCB2YXIgd3JpdGUgPSAnd3JpdGUnO1xuZXhwb3J0IHZhciBhZnRlcldyaXRlID0gJ2FmdGVyV3JpdGUnO1xuZXhwb3J0IHZhciBtb2RpZmllclBoYXNlcyA9IFtiZWZvcmVSZWFkLCByZWFkLCBhZnRlclJlYWQsIGJlZm9yZU1haW4sIG1haW4sIGFmdGVyTWFpbiwgYmVmb3JlV3JpdGUsIHdyaXRlLCBhZnRlcldyaXRlXTsiLCAiZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gZ2V0Tm9kZU5hbWUoZWxlbWVudCkge1xuICByZXR1cm4gZWxlbWVudCA/IChlbGVtZW50Lm5vZGVOYW1lIHx8ICcnKS50b0xvd2VyQ2FzZSgpIDogbnVsbDtcbn0iLCAiZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gZ2V0V2luZG93KG5vZGUpIHtcbiAgaWYgKG5vZGUgPT0gbnVsbCkge1xuICAgIHJldHVybiB3aW5kb3c7XG4gIH1cblxuICBpZiAobm9kZS50b1N0cmluZygpICE9PSAnW29iamVjdCBXaW5kb3ddJykge1xuICAgIHZhciBvd25lckRvY3VtZW50ID0gbm9kZS5vd25lckRvY3VtZW50O1xuICAgIHJldHVybiBvd25lckRvY3VtZW50ID8gb3duZXJEb2N1bWVudC5kZWZhdWx0VmlldyB8fCB3aW5kb3cgOiB3aW5kb3c7XG4gIH1cblxuICByZXR1cm4gbm9kZTtcbn0iLCAiaW1wb3J0IGdldFdpbmRvdyBmcm9tIFwiLi9nZXRXaW5kb3cuanNcIjtcblxuZnVuY3Rpb24gaXNFbGVtZW50KG5vZGUpIHtcbiAgdmFyIE93bkVsZW1lbnQgPSBnZXRXaW5kb3cobm9kZSkuRWxlbWVudDtcbiAgcmV0dXJuIG5vZGUgaW5zdGFuY2VvZiBPd25FbGVtZW50IHx8IG5vZGUgaW5zdGFuY2VvZiBFbGVtZW50O1xufVxuXG5mdW5jdGlvbiBpc0hUTUxFbGVtZW50KG5vZGUpIHtcbiAgdmFyIE93bkVsZW1lbnQgPSBnZXRXaW5kb3cobm9kZSkuSFRNTEVsZW1lbnQ7XG4gIHJldHVybiBub2RlIGluc3RhbmNlb2YgT3duRWxlbWVudCB8fCBub2RlIGluc3RhbmNlb2YgSFRNTEVsZW1lbnQ7XG59XG5cbmZ1bmN0aW9uIGlzU2hhZG93Um9vdChub2RlKSB7XG4gIC8vIElFIDExIGhhcyBubyBTaGFkb3dSb290XG4gIGlmICh0eXBlb2YgU2hhZG93Um9vdCA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cblxuICB2YXIgT3duRWxlbWVudCA9IGdldFdpbmRvdyhub2RlKS5TaGFkb3dSb290O1xuICByZXR1cm4gbm9kZSBpbnN0YW5jZW9mIE93bkVsZW1lbnQgfHwgbm9kZSBpbnN0YW5jZW9mIFNoYWRvd1Jvb3Q7XG59XG5cbmV4cG9ydCB7IGlzRWxlbWVudCwgaXNIVE1MRWxlbWVudCwgaXNTaGFkb3dSb290IH07IiwgImltcG9ydCBnZXROb2RlTmFtZSBmcm9tIFwiLi4vZG9tLXV0aWxzL2dldE5vZGVOYW1lLmpzXCI7XG5pbXBvcnQgeyBpc0hUTUxFbGVtZW50IH0gZnJvbSBcIi4uL2RvbS11dGlscy9pbnN0YW5jZU9mLmpzXCI7IC8vIFRoaXMgbW9kaWZpZXIgdGFrZXMgdGhlIHN0eWxlcyBwcmVwYXJlZCBieSB0aGUgYGNvbXB1dGVTdHlsZXNgIG1vZGlmaWVyXG4vLyBhbmQgYXBwbGllcyB0aGVtIHRvIHRoZSBIVE1MRWxlbWVudHMgc3VjaCBhcyBwb3BwZXIgYW5kIGFycm93XG5cbmZ1bmN0aW9uIGFwcGx5U3R5bGVzKF9yZWYpIHtcbiAgdmFyIHN0YXRlID0gX3JlZi5zdGF0ZTtcbiAgT2JqZWN0LmtleXMoc3RhdGUuZWxlbWVudHMpLmZvckVhY2goZnVuY3Rpb24gKG5hbWUpIHtcbiAgICB2YXIgc3R5bGUgPSBzdGF0ZS5zdHlsZXNbbmFtZV0gfHwge307XG4gICAgdmFyIGF0dHJpYnV0ZXMgPSBzdGF0ZS5hdHRyaWJ1dGVzW25hbWVdIHx8IHt9O1xuICAgIHZhciBlbGVtZW50ID0gc3RhdGUuZWxlbWVudHNbbmFtZV07IC8vIGFycm93IGlzIG9wdGlvbmFsICsgdmlydHVhbCBlbGVtZW50c1xuXG4gICAgaWYgKCFpc0hUTUxFbGVtZW50KGVsZW1lbnQpIHx8ICFnZXROb2RlTmFtZShlbGVtZW50KSkge1xuICAgICAgcmV0dXJuO1xuICAgIH0gLy8gRmxvdyBkb2Vzbid0IHN1cHBvcnQgdG8gZXh0ZW5kIHRoaXMgcHJvcGVydHksIGJ1dCBpdCdzIHRoZSBtb3N0XG4gICAgLy8gZWZmZWN0aXZlIHdheSB0byBhcHBseSBzdHlsZXMgdG8gYW4gSFRNTEVsZW1lbnRcbiAgICAvLyAkRmxvd0ZpeE1lW2Nhbm5vdC13cml0ZV1cblxuXG4gICAgT2JqZWN0LmFzc2lnbihlbGVtZW50LnN0eWxlLCBzdHlsZSk7XG4gICAgT2JqZWN0LmtleXMoYXR0cmlidXRlcykuZm9yRWFjaChmdW5jdGlvbiAobmFtZSkge1xuICAgICAgdmFyIHZhbHVlID0gYXR0cmlidXRlc1tuYW1lXTtcblxuICAgICAgaWYgKHZhbHVlID09PSBmYWxzZSkge1xuICAgICAgICBlbGVtZW50LnJlbW92ZUF0dHJpYnV0ZShuYW1lKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGVsZW1lbnQuc2V0QXR0cmlidXRlKG5hbWUsIHZhbHVlID09PSB0cnVlID8gJycgOiB2YWx1ZSk7XG4gICAgICB9XG4gICAgfSk7XG4gIH0pO1xufVxuXG5mdW5jdGlvbiBlZmZlY3QoX3JlZjIpIHtcbiAgdmFyIHN0YXRlID0gX3JlZjIuc3RhdGU7XG4gIHZhciBpbml0aWFsU3R5bGVzID0ge1xuICAgIHBvcHBlcjoge1xuICAgICAgcG9zaXRpb246IHN0YXRlLm9wdGlvbnMuc3RyYXRlZ3ksXG4gICAgICBsZWZ0OiAnMCcsXG4gICAgICB0b3A6ICcwJyxcbiAgICAgIG1hcmdpbjogJzAnXG4gICAgfSxcbiAgICBhcnJvdzoge1xuICAgICAgcG9zaXRpb246ICdhYnNvbHV0ZSdcbiAgICB9LFxuICAgIHJlZmVyZW5jZToge31cbiAgfTtcbiAgT2JqZWN0LmFzc2lnbihzdGF0ZS5lbGVtZW50cy5wb3BwZXIuc3R5bGUsIGluaXRpYWxTdHlsZXMucG9wcGVyKTtcbiAgc3RhdGUuc3R5bGVzID0gaW5pdGlhbFN0eWxlcztcblxuICBpZiAoc3RhdGUuZWxlbWVudHMuYXJyb3cpIHtcbiAgICBPYmplY3QuYXNzaWduKHN0YXRlLmVsZW1lbnRzLmFycm93LnN0eWxlLCBpbml0aWFsU3R5bGVzLmFycm93KTtcbiAgfVxuXG4gIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgT2JqZWN0LmtleXMoc3RhdGUuZWxlbWVudHMpLmZvckVhY2goZnVuY3Rpb24gKG5hbWUpIHtcbiAgICAgIHZhciBlbGVtZW50ID0gc3RhdGUuZWxlbWVudHNbbmFtZV07XG4gICAgICB2YXIgYXR0cmlidXRlcyA9IHN0YXRlLmF0dHJpYnV0ZXNbbmFtZV0gfHwge307XG4gICAgICB2YXIgc3R5bGVQcm9wZXJ0aWVzID0gT2JqZWN0LmtleXMoc3RhdGUuc3R5bGVzLmhhc093blByb3BlcnR5KG5hbWUpID8gc3RhdGUuc3R5bGVzW25hbWVdIDogaW5pdGlhbFN0eWxlc1tuYW1lXSk7IC8vIFNldCBhbGwgdmFsdWVzIHRvIGFuIGVtcHR5IHN0cmluZyB0byB1bnNldCB0aGVtXG5cbiAgICAgIHZhciBzdHlsZSA9IHN0eWxlUHJvcGVydGllcy5yZWR1Y2UoZnVuY3Rpb24gKHN0eWxlLCBwcm9wZXJ0eSkge1xuICAgICAgICBzdHlsZVtwcm9wZXJ0eV0gPSAnJztcbiAgICAgICAgcmV0dXJuIHN0eWxlO1xuICAgICAgfSwge30pOyAvLyBhcnJvdyBpcyBvcHRpb25hbCArIHZpcnR1YWwgZWxlbWVudHNcblxuICAgICAgaWYgKCFpc0hUTUxFbGVtZW50KGVsZW1lbnQpIHx8ICFnZXROb2RlTmFtZShlbGVtZW50KSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIE9iamVjdC5hc3NpZ24oZWxlbWVudC5zdHlsZSwgc3R5bGUpO1xuICAgICAgT2JqZWN0LmtleXMoYXR0cmlidXRlcykuZm9yRWFjaChmdW5jdGlvbiAoYXR0cmlidXRlKSB7XG4gICAgICAgIGVsZW1lbnQucmVtb3ZlQXR0cmlidXRlKGF0dHJpYnV0ZSk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfTtcbn0gLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGltcG9ydC9uby11bnVzZWQtbW9kdWxlc1xuXG5cbmV4cG9ydCBkZWZhdWx0IHtcbiAgbmFtZTogJ2FwcGx5U3R5bGVzJyxcbiAgZW5hYmxlZDogdHJ1ZSxcbiAgcGhhc2U6ICd3cml0ZScsXG4gIGZuOiBhcHBseVN0eWxlcyxcbiAgZWZmZWN0OiBlZmZlY3QsXG4gIHJlcXVpcmVzOiBbJ2NvbXB1dGVTdHlsZXMnXVxufTsiLCAiaW1wb3J0IHsgYXV0byB9IGZyb20gXCIuLi9lbnVtcy5qc1wiO1xuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gZ2V0QmFzZVBsYWNlbWVudChwbGFjZW1lbnQpIHtcbiAgcmV0dXJuIHBsYWNlbWVudC5zcGxpdCgnLScpWzBdO1xufSIsICJleHBvcnQgdmFyIG1heCA9IE1hdGgubWF4O1xuZXhwb3J0IHZhciBtaW4gPSBNYXRoLm1pbjtcbmV4cG9ydCB2YXIgcm91bmQgPSBNYXRoLnJvdW5kOyIsICJpbXBvcnQgeyBpc0hUTUxFbGVtZW50IH0gZnJvbSBcIi4vaW5zdGFuY2VPZi5qc1wiO1xuaW1wb3J0IHsgcm91bmQgfSBmcm9tIFwiLi4vdXRpbHMvbWF0aC5qc1wiO1xuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gZ2V0Qm91bmRpbmdDbGllbnRSZWN0KGVsZW1lbnQsIGluY2x1ZGVTY2FsZSkge1xuICBpZiAoaW5jbHVkZVNjYWxlID09PSB2b2lkIDApIHtcbiAgICBpbmNsdWRlU2NhbGUgPSBmYWxzZTtcbiAgfVxuXG4gIHZhciByZWN0ID0gZWxlbWVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgdmFyIHNjYWxlWCA9IDE7XG4gIHZhciBzY2FsZVkgPSAxO1xuXG4gIGlmIChpc0hUTUxFbGVtZW50KGVsZW1lbnQpICYmIGluY2x1ZGVTY2FsZSkge1xuICAgIHZhciBvZmZzZXRIZWlnaHQgPSBlbGVtZW50Lm9mZnNldEhlaWdodDtcbiAgICB2YXIgb2Zmc2V0V2lkdGggPSBlbGVtZW50Lm9mZnNldFdpZHRoOyAvLyBEbyBub3QgYXR0ZW1wdCB0byBkaXZpZGUgYnkgMCwgb3RoZXJ3aXNlIHdlIGdldCBgSW5maW5pdHlgIGFzIHNjYWxlXG4gICAgLy8gRmFsbGJhY2sgdG8gMSBpbiBjYXNlIGJvdGggdmFsdWVzIGFyZSBgMGBcblxuICAgIGlmIChvZmZzZXRXaWR0aCA+IDApIHtcbiAgICAgIHNjYWxlWCA9IHJvdW5kKHJlY3Qud2lkdGgpIC8gb2Zmc2V0V2lkdGggfHwgMTtcbiAgICB9XG5cbiAgICBpZiAob2Zmc2V0SGVpZ2h0ID4gMCkge1xuICAgICAgc2NhbGVZID0gcm91bmQocmVjdC5oZWlnaHQpIC8gb2Zmc2V0SGVpZ2h0IHx8IDE7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIHtcbiAgICB3aWR0aDogcmVjdC53aWR0aCAvIHNjYWxlWCxcbiAgICBoZWlnaHQ6IHJlY3QuaGVpZ2h0IC8gc2NhbGVZLFxuICAgIHRvcDogcmVjdC50b3AgLyBzY2FsZVksXG4gICAgcmlnaHQ6IHJlY3QucmlnaHQgLyBzY2FsZVgsXG4gICAgYm90dG9tOiByZWN0LmJvdHRvbSAvIHNjYWxlWSxcbiAgICBsZWZ0OiByZWN0LmxlZnQgLyBzY2FsZVgsXG4gICAgeDogcmVjdC5sZWZ0IC8gc2NhbGVYLFxuICAgIHk6IHJlY3QudG9wIC8gc2NhbGVZXG4gIH07XG59IiwgImltcG9ydCBnZXRCb3VuZGluZ0NsaWVudFJlY3QgZnJvbSBcIi4vZ2V0Qm91bmRpbmdDbGllbnRSZWN0LmpzXCI7IC8vIFJldHVybnMgdGhlIGxheW91dCByZWN0IG9mIGFuIGVsZW1lbnQgcmVsYXRpdmUgdG8gaXRzIG9mZnNldFBhcmVudC4gTGF5b3V0XG4vLyBtZWFucyBpdCBkb2Vzbid0IHRha2UgaW50byBhY2NvdW50IHRyYW5zZm9ybXMuXG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGdldExheW91dFJlY3QoZWxlbWVudCkge1xuICB2YXIgY2xpZW50UmVjdCA9IGdldEJvdW5kaW5nQ2xpZW50UmVjdChlbGVtZW50KTsgLy8gVXNlIHRoZSBjbGllbnRSZWN0IHNpemVzIGlmIGl0J3Mgbm90IGJlZW4gdHJhbnNmb3JtZWQuXG4gIC8vIEZpeGVzIGh0dHBzOi8vZ2l0aHViLmNvbS9wb3BwZXJqcy9wb3BwZXItY29yZS9pc3N1ZXMvMTIyM1xuXG4gIHZhciB3aWR0aCA9IGVsZW1lbnQub2Zmc2V0V2lkdGg7XG4gIHZhciBoZWlnaHQgPSBlbGVtZW50Lm9mZnNldEhlaWdodDtcblxuICBpZiAoTWF0aC5hYnMoY2xpZW50UmVjdC53aWR0aCAtIHdpZHRoKSA8PSAxKSB7XG4gICAgd2lkdGggPSBjbGllbnRSZWN0LndpZHRoO1xuICB9XG5cbiAgaWYgKE1hdGguYWJzKGNsaWVudFJlY3QuaGVpZ2h0IC0gaGVpZ2h0KSA8PSAxKSB7XG4gICAgaGVpZ2h0ID0gY2xpZW50UmVjdC5oZWlnaHQ7XG4gIH1cblxuICByZXR1cm4ge1xuICAgIHg6IGVsZW1lbnQub2Zmc2V0TGVmdCxcbiAgICB5OiBlbGVtZW50Lm9mZnNldFRvcCxcbiAgICB3aWR0aDogd2lkdGgsXG4gICAgaGVpZ2h0OiBoZWlnaHRcbiAgfTtcbn0iLCAiaW1wb3J0IHsgaXNTaGFkb3dSb290IH0gZnJvbSBcIi4vaW5zdGFuY2VPZi5qc1wiO1xuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gY29udGFpbnMocGFyZW50LCBjaGlsZCkge1xuICB2YXIgcm9vdE5vZGUgPSBjaGlsZC5nZXRSb290Tm9kZSAmJiBjaGlsZC5nZXRSb290Tm9kZSgpOyAvLyBGaXJzdCwgYXR0ZW1wdCB3aXRoIGZhc3RlciBuYXRpdmUgbWV0aG9kXG5cbiAgaWYgKHBhcmVudC5jb250YWlucyhjaGlsZCkpIHtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfSAvLyB0aGVuIGZhbGxiYWNrIHRvIGN1c3RvbSBpbXBsZW1lbnRhdGlvbiB3aXRoIFNoYWRvdyBET00gc3VwcG9ydFxuICBlbHNlIGlmIChyb290Tm9kZSAmJiBpc1NoYWRvd1Jvb3Qocm9vdE5vZGUpKSB7XG4gICAgICB2YXIgbmV4dCA9IGNoaWxkO1xuXG4gICAgICBkbyB7XG4gICAgICAgIGlmIChuZXh0ICYmIHBhcmVudC5pc1NhbWVOb2RlKG5leHQpKSB7XG4gICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH0gLy8gJEZsb3dGaXhNZVtwcm9wLW1pc3NpbmddOiBuZWVkIGEgYmV0dGVyIHdheSB0byBoYW5kbGUgdGhpcy4uLlxuXG5cbiAgICAgICAgbmV4dCA9IG5leHQucGFyZW50Tm9kZSB8fCBuZXh0Lmhvc3Q7XG4gICAgICB9IHdoaWxlIChuZXh0KTtcbiAgICB9IC8vIEdpdmUgdXAsIHRoZSByZXN1bHQgaXMgZmFsc2VcblxuXG4gIHJldHVybiBmYWxzZTtcbn0iLCAiaW1wb3J0IGdldFdpbmRvdyBmcm9tIFwiLi9nZXRXaW5kb3cuanNcIjtcbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGdldENvbXB1dGVkU3R5bGUoZWxlbWVudCkge1xuICByZXR1cm4gZ2V0V2luZG93KGVsZW1lbnQpLmdldENvbXB1dGVkU3R5bGUoZWxlbWVudCk7XG59IiwgImltcG9ydCBnZXROb2RlTmFtZSBmcm9tIFwiLi9nZXROb2RlTmFtZS5qc1wiO1xuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gaXNUYWJsZUVsZW1lbnQoZWxlbWVudCkge1xuICByZXR1cm4gWyd0YWJsZScsICd0ZCcsICd0aCddLmluZGV4T2YoZ2V0Tm9kZU5hbWUoZWxlbWVudCkpID49IDA7XG59IiwgImltcG9ydCB7IGlzRWxlbWVudCB9IGZyb20gXCIuL2luc3RhbmNlT2YuanNcIjtcbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGdldERvY3VtZW50RWxlbWVudChlbGVtZW50KSB7XG4gIC8vICRGbG93Rml4TWVbaW5jb21wYXRpYmxlLXJldHVybl06IGFzc3VtZSBib2R5IGlzIGFsd2F5cyBhdmFpbGFibGVcbiAgcmV0dXJuICgoaXNFbGVtZW50KGVsZW1lbnQpID8gZWxlbWVudC5vd25lckRvY3VtZW50IDogLy8gJEZsb3dGaXhNZVtwcm9wLW1pc3NpbmddXG4gIGVsZW1lbnQuZG9jdW1lbnQpIHx8IHdpbmRvdy5kb2N1bWVudCkuZG9jdW1lbnRFbGVtZW50O1xufSIsICJpbXBvcnQgZ2V0Tm9kZU5hbWUgZnJvbSBcIi4vZ2V0Tm9kZU5hbWUuanNcIjtcbmltcG9ydCBnZXREb2N1bWVudEVsZW1lbnQgZnJvbSBcIi4vZ2V0RG9jdW1lbnRFbGVtZW50LmpzXCI7XG5pbXBvcnQgeyBpc1NoYWRvd1Jvb3QgfSBmcm9tIFwiLi9pbnN0YW5jZU9mLmpzXCI7XG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBnZXRQYXJlbnROb2RlKGVsZW1lbnQpIHtcbiAgaWYgKGdldE5vZGVOYW1lKGVsZW1lbnQpID09PSAnaHRtbCcpIHtcbiAgICByZXR1cm4gZWxlbWVudDtcbiAgfVxuXG4gIHJldHVybiAoLy8gdGhpcyBpcyBhIHF1aWNrZXIgKGJ1dCBsZXNzIHR5cGUgc2FmZSkgd2F5IHRvIHNhdmUgcXVpdGUgc29tZSBieXRlcyBmcm9tIHRoZSBidW5kbGVcbiAgICAvLyAkRmxvd0ZpeE1lW2luY29tcGF0aWJsZS1yZXR1cm5dXG4gICAgLy8gJEZsb3dGaXhNZVtwcm9wLW1pc3NpbmddXG4gICAgZWxlbWVudC5hc3NpZ25lZFNsb3QgfHwgLy8gc3RlcCBpbnRvIHRoZSBzaGFkb3cgRE9NIG9mIHRoZSBwYXJlbnQgb2YgYSBzbG90dGVkIG5vZGVcbiAgICBlbGVtZW50LnBhcmVudE5vZGUgfHwgKCAvLyBET00gRWxlbWVudCBkZXRlY3RlZFxuICAgIGlzU2hhZG93Um9vdChlbGVtZW50KSA/IGVsZW1lbnQuaG9zdCA6IG51bGwpIHx8IC8vIFNoYWRvd1Jvb3QgZGV0ZWN0ZWRcbiAgICAvLyAkRmxvd0ZpeE1lW2luY29tcGF0aWJsZS1jYWxsXTogSFRNTEVsZW1lbnQgaXMgYSBOb2RlXG4gICAgZ2V0RG9jdW1lbnRFbGVtZW50KGVsZW1lbnQpIC8vIGZhbGxiYWNrXG5cbiAgKTtcbn0iLCAiaW1wb3J0IGdldFdpbmRvdyBmcm9tIFwiLi9nZXRXaW5kb3cuanNcIjtcbmltcG9ydCBnZXROb2RlTmFtZSBmcm9tIFwiLi9nZXROb2RlTmFtZS5qc1wiO1xuaW1wb3J0IGdldENvbXB1dGVkU3R5bGUgZnJvbSBcIi4vZ2V0Q29tcHV0ZWRTdHlsZS5qc1wiO1xuaW1wb3J0IHsgaXNIVE1MRWxlbWVudCwgaXNTaGFkb3dSb290IH0gZnJvbSBcIi4vaW5zdGFuY2VPZi5qc1wiO1xuaW1wb3J0IGlzVGFibGVFbGVtZW50IGZyb20gXCIuL2lzVGFibGVFbGVtZW50LmpzXCI7XG5pbXBvcnQgZ2V0UGFyZW50Tm9kZSBmcm9tIFwiLi9nZXRQYXJlbnROb2RlLmpzXCI7XG5cbmZ1bmN0aW9uIGdldFRydWVPZmZzZXRQYXJlbnQoZWxlbWVudCkge1xuICBpZiAoIWlzSFRNTEVsZW1lbnQoZWxlbWVudCkgfHwgLy8gaHR0cHM6Ly9naXRodWIuY29tL3BvcHBlcmpzL3BvcHBlci1jb3JlL2lzc3Vlcy84MzdcbiAgZ2V0Q29tcHV0ZWRTdHlsZShlbGVtZW50KS5wb3NpdGlvbiA9PT0gJ2ZpeGVkJykge1xuICAgIHJldHVybiBudWxsO1xuICB9XG5cbiAgcmV0dXJuIGVsZW1lbnQub2Zmc2V0UGFyZW50O1xufSAvLyBgLm9mZnNldFBhcmVudGAgcmVwb3J0cyBgbnVsbGAgZm9yIGZpeGVkIGVsZW1lbnRzLCB3aGlsZSBhYnNvbHV0ZSBlbGVtZW50c1xuLy8gcmV0dXJuIHRoZSBjb250YWluaW5nIGJsb2NrXG5cblxuZnVuY3Rpb24gZ2V0Q29udGFpbmluZ0Jsb2NrKGVsZW1lbnQpIHtcbiAgdmFyIGlzRmlyZWZveCA9IG5hdmlnYXRvci51c2VyQWdlbnQudG9Mb3dlckNhc2UoKS5pbmRleE9mKCdmaXJlZm94JykgIT09IC0xO1xuICB2YXIgaXNJRSA9IG5hdmlnYXRvci51c2VyQWdlbnQuaW5kZXhPZignVHJpZGVudCcpICE9PSAtMTtcblxuICBpZiAoaXNJRSAmJiBpc0hUTUxFbGVtZW50KGVsZW1lbnQpKSB7XG4gICAgLy8gSW4gSUUgOSwgMTAgYW5kIDExIGZpeGVkIGVsZW1lbnRzIGNvbnRhaW5pbmcgYmxvY2sgaXMgYWx3YXlzIGVzdGFibGlzaGVkIGJ5IHRoZSB2aWV3cG9ydFxuICAgIHZhciBlbGVtZW50Q3NzID0gZ2V0Q29tcHV0ZWRTdHlsZShlbGVtZW50KTtcblxuICAgIGlmIChlbGVtZW50Q3NzLnBvc2l0aW9uID09PSAnZml4ZWQnKSB7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gIH1cblxuICB2YXIgY3VycmVudE5vZGUgPSBnZXRQYXJlbnROb2RlKGVsZW1lbnQpO1xuXG4gIGlmIChpc1NoYWRvd1Jvb3QoY3VycmVudE5vZGUpKSB7XG4gICAgY3VycmVudE5vZGUgPSBjdXJyZW50Tm9kZS5ob3N0O1xuICB9XG5cbiAgd2hpbGUgKGlzSFRNTEVsZW1lbnQoY3VycmVudE5vZGUpICYmIFsnaHRtbCcsICdib2R5J10uaW5kZXhPZihnZXROb2RlTmFtZShjdXJyZW50Tm9kZSkpIDwgMCkge1xuICAgIHZhciBjc3MgPSBnZXRDb21wdXRlZFN0eWxlKGN1cnJlbnROb2RlKTsgLy8gVGhpcyBpcyBub24tZXhoYXVzdGl2ZSBidXQgY292ZXJzIHRoZSBtb3N0IGNvbW1vbiBDU1MgcHJvcGVydGllcyB0aGF0XG4gICAgLy8gY3JlYXRlIGEgY29udGFpbmluZyBibG9jay5cbiAgICAvLyBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9DU1MvQ29udGFpbmluZ19ibG9jayNpZGVudGlmeWluZ190aGVfY29udGFpbmluZ19ibG9ja1xuXG4gICAgaWYgKGNzcy50cmFuc2Zvcm0gIT09ICdub25lJyB8fCBjc3MucGVyc3BlY3RpdmUgIT09ICdub25lJyB8fCBjc3MuY29udGFpbiA9PT0gJ3BhaW50JyB8fCBbJ3RyYW5zZm9ybScsICdwZXJzcGVjdGl2ZSddLmluZGV4T2YoY3NzLndpbGxDaGFuZ2UpICE9PSAtMSB8fCBpc0ZpcmVmb3ggJiYgY3NzLndpbGxDaGFuZ2UgPT09ICdmaWx0ZXInIHx8IGlzRmlyZWZveCAmJiBjc3MuZmlsdGVyICYmIGNzcy5maWx0ZXIgIT09ICdub25lJykge1xuICAgICAgcmV0dXJuIGN1cnJlbnROb2RlO1xuICAgIH0gZWxzZSB7XG4gICAgICBjdXJyZW50Tm9kZSA9IGN1cnJlbnROb2RlLnBhcmVudE5vZGU7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIG51bGw7XG59IC8vIEdldHMgdGhlIGNsb3Nlc3QgYW5jZXN0b3IgcG9zaXRpb25lZCBlbGVtZW50LiBIYW5kbGVzIHNvbWUgZWRnZSBjYXNlcyxcbi8vIHN1Y2ggYXMgdGFibGUgYW5jZXN0b3JzIGFuZCBjcm9zcyBicm93c2VyIGJ1Z3MuXG5cblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gZ2V0T2Zmc2V0UGFyZW50KGVsZW1lbnQpIHtcbiAgdmFyIHdpbmRvdyA9IGdldFdpbmRvdyhlbGVtZW50KTtcbiAgdmFyIG9mZnNldFBhcmVudCA9IGdldFRydWVPZmZzZXRQYXJlbnQoZWxlbWVudCk7XG5cbiAgd2hpbGUgKG9mZnNldFBhcmVudCAmJiBpc1RhYmxlRWxlbWVudChvZmZzZXRQYXJlbnQpICYmIGdldENvbXB1dGVkU3R5bGUob2Zmc2V0UGFyZW50KS5wb3NpdGlvbiA9PT0gJ3N0YXRpYycpIHtcbiAgICBvZmZzZXRQYXJlbnQgPSBnZXRUcnVlT2Zmc2V0UGFyZW50KG9mZnNldFBhcmVudCk7XG4gIH1cblxuICBpZiAob2Zmc2V0UGFyZW50ICYmIChnZXROb2RlTmFtZShvZmZzZXRQYXJlbnQpID09PSAnaHRtbCcgfHwgZ2V0Tm9kZU5hbWUob2Zmc2V0UGFyZW50KSA9PT0gJ2JvZHknICYmIGdldENvbXB1dGVkU3R5bGUob2Zmc2V0UGFyZW50KS5wb3NpdGlvbiA9PT0gJ3N0YXRpYycpKSB7XG4gICAgcmV0dXJuIHdpbmRvdztcbiAgfVxuXG4gIHJldHVybiBvZmZzZXRQYXJlbnQgfHwgZ2V0Q29udGFpbmluZ0Jsb2NrKGVsZW1lbnQpIHx8IHdpbmRvdztcbn0iLCAiZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gZ2V0TWFpbkF4aXNGcm9tUGxhY2VtZW50KHBsYWNlbWVudCkge1xuICByZXR1cm4gWyd0b3AnLCAnYm90dG9tJ10uaW5kZXhPZihwbGFjZW1lbnQpID49IDAgPyAneCcgOiAneSc7XG59IiwgImltcG9ydCB7IG1heCBhcyBtYXRoTWF4LCBtaW4gYXMgbWF0aE1pbiB9IGZyb20gXCIuL21hdGguanNcIjtcbmV4cG9ydCBmdW5jdGlvbiB3aXRoaW4obWluLCB2YWx1ZSwgbWF4KSB7XG4gIHJldHVybiBtYXRoTWF4KG1pbiwgbWF0aE1pbih2YWx1ZSwgbWF4KSk7XG59XG5leHBvcnQgZnVuY3Rpb24gd2l0aGluTWF4Q2xhbXAobWluLCB2YWx1ZSwgbWF4KSB7XG4gIHZhciB2ID0gd2l0aGluKG1pbiwgdmFsdWUsIG1heCk7XG4gIHJldHVybiB2ID4gbWF4ID8gbWF4IDogdjtcbn0iLCAiZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gZ2V0RnJlc2hTaWRlT2JqZWN0KCkge1xuICByZXR1cm4ge1xuICAgIHRvcDogMCxcbiAgICByaWdodDogMCxcbiAgICBib3R0b206IDAsXG4gICAgbGVmdDogMFxuICB9O1xufSIsICJpbXBvcnQgZ2V0RnJlc2hTaWRlT2JqZWN0IGZyb20gXCIuL2dldEZyZXNoU2lkZU9iamVjdC5qc1wiO1xuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gbWVyZ2VQYWRkaW5nT2JqZWN0KHBhZGRpbmdPYmplY3QpIHtcbiAgcmV0dXJuIE9iamVjdC5hc3NpZ24oe30sIGdldEZyZXNoU2lkZU9iamVjdCgpLCBwYWRkaW5nT2JqZWN0KTtcbn0iLCAiZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gZXhwYW5kVG9IYXNoTWFwKHZhbHVlLCBrZXlzKSB7XG4gIHJldHVybiBrZXlzLnJlZHVjZShmdW5jdGlvbiAoaGFzaE1hcCwga2V5KSB7XG4gICAgaGFzaE1hcFtrZXldID0gdmFsdWU7XG4gICAgcmV0dXJuIGhhc2hNYXA7XG4gIH0sIHt9KTtcbn0iLCAiaW1wb3J0IGdldEJhc2VQbGFjZW1lbnQgZnJvbSBcIi4uL3V0aWxzL2dldEJhc2VQbGFjZW1lbnQuanNcIjtcbmltcG9ydCBnZXRMYXlvdXRSZWN0IGZyb20gXCIuLi9kb20tdXRpbHMvZ2V0TGF5b3V0UmVjdC5qc1wiO1xuaW1wb3J0IGNvbnRhaW5zIGZyb20gXCIuLi9kb20tdXRpbHMvY29udGFpbnMuanNcIjtcbmltcG9ydCBnZXRPZmZzZXRQYXJlbnQgZnJvbSBcIi4uL2RvbS11dGlscy9nZXRPZmZzZXRQYXJlbnQuanNcIjtcbmltcG9ydCBnZXRNYWluQXhpc0Zyb21QbGFjZW1lbnQgZnJvbSBcIi4uL3V0aWxzL2dldE1haW5BeGlzRnJvbVBsYWNlbWVudC5qc1wiO1xuaW1wb3J0IHsgd2l0aGluIH0gZnJvbSBcIi4uL3V0aWxzL3dpdGhpbi5qc1wiO1xuaW1wb3J0IG1lcmdlUGFkZGluZ09iamVjdCBmcm9tIFwiLi4vdXRpbHMvbWVyZ2VQYWRkaW5nT2JqZWN0LmpzXCI7XG5pbXBvcnQgZXhwYW5kVG9IYXNoTWFwIGZyb20gXCIuLi91dGlscy9leHBhbmRUb0hhc2hNYXAuanNcIjtcbmltcG9ydCB7IGxlZnQsIHJpZ2h0LCBiYXNlUGxhY2VtZW50cywgdG9wLCBib3R0b20gfSBmcm9tIFwiLi4vZW51bXMuanNcIjtcbmltcG9ydCB7IGlzSFRNTEVsZW1lbnQgfSBmcm9tIFwiLi4vZG9tLXV0aWxzL2luc3RhbmNlT2YuanNcIjsgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGltcG9ydC9uby11bnVzZWQtbW9kdWxlc1xuXG52YXIgdG9QYWRkaW5nT2JqZWN0ID0gZnVuY3Rpb24gdG9QYWRkaW5nT2JqZWN0KHBhZGRpbmcsIHN0YXRlKSB7XG4gIHBhZGRpbmcgPSB0eXBlb2YgcGFkZGluZyA9PT0gJ2Z1bmN0aW9uJyA/IHBhZGRpbmcoT2JqZWN0LmFzc2lnbih7fSwgc3RhdGUucmVjdHMsIHtcbiAgICBwbGFjZW1lbnQ6IHN0YXRlLnBsYWNlbWVudFxuICB9KSkgOiBwYWRkaW5nO1xuICByZXR1cm4gbWVyZ2VQYWRkaW5nT2JqZWN0KHR5cGVvZiBwYWRkaW5nICE9PSAnbnVtYmVyJyA/IHBhZGRpbmcgOiBleHBhbmRUb0hhc2hNYXAocGFkZGluZywgYmFzZVBsYWNlbWVudHMpKTtcbn07XG5cbmZ1bmN0aW9uIGFycm93KF9yZWYpIHtcbiAgdmFyIF9zdGF0ZSRtb2RpZmllcnNEYXRhJDtcblxuICB2YXIgc3RhdGUgPSBfcmVmLnN0YXRlLFxuICAgICAgbmFtZSA9IF9yZWYubmFtZSxcbiAgICAgIG9wdGlvbnMgPSBfcmVmLm9wdGlvbnM7XG4gIHZhciBhcnJvd0VsZW1lbnQgPSBzdGF0ZS5lbGVtZW50cy5hcnJvdztcbiAgdmFyIHBvcHBlck9mZnNldHMgPSBzdGF0ZS5tb2RpZmllcnNEYXRhLnBvcHBlck9mZnNldHM7XG4gIHZhciBiYXNlUGxhY2VtZW50ID0gZ2V0QmFzZVBsYWNlbWVudChzdGF0ZS5wbGFjZW1lbnQpO1xuICB2YXIgYXhpcyA9IGdldE1haW5BeGlzRnJvbVBsYWNlbWVudChiYXNlUGxhY2VtZW50KTtcbiAgdmFyIGlzVmVydGljYWwgPSBbbGVmdCwgcmlnaHRdLmluZGV4T2YoYmFzZVBsYWNlbWVudCkgPj0gMDtcbiAgdmFyIGxlbiA9IGlzVmVydGljYWwgPyAnaGVpZ2h0JyA6ICd3aWR0aCc7XG5cbiAgaWYgKCFhcnJvd0VsZW1lbnQgfHwgIXBvcHBlck9mZnNldHMpIHtcbiAgICByZXR1cm47XG4gIH1cblxuICB2YXIgcGFkZGluZ09iamVjdCA9IHRvUGFkZGluZ09iamVjdChvcHRpb25zLnBhZGRpbmcsIHN0YXRlKTtcbiAgdmFyIGFycm93UmVjdCA9IGdldExheW91dFJlY3QoYXJyb3dFbGVtZW50KTtcbiAgdmFyIG1pblByb3AgPSBheGlzID09PSAneScgPyB0b3AgOiBsZWZ0O1xuICB2YXIgbWF4UHJvcCA9IGF4aXMgPT09ICd5JyA/IGJvdHRvbSA6IHJpZ2h0O1xuICB2YXIgZW5kRGlmZiA9IHN0YXRlLnJlY3RzLnJlZmVyZW5jZVtsZW5dICsgc3RhdGUucmVjdHMucmVmZXJlbmNlW2F4aXNdIC0gcG9wcGVyT2Zmc2V0c1theGlzXSAtIHN0YXRlLnJlY3RzLnBvcHBlcltsZW5dO1xuICB2YXIgc3RhcnREaWZmID0gcG9wcGVyT2Zmc2V0c1theGlzXSAtIHN0YXRlLnJlY3RzLnJlZmVyZW5jZVtheGlzXTtcbiAgdmFyIGFycm93T2Zmc2V0UGFyZW50ID0gZ2V0T2Zmc2V0UGFyZW50KGFycm93RWxlbWVudCk7XG4gIHZhciBjbGllbnRTaXplID0gYXJyb3dPZmZzZXRQYXJlbnQgPyBheGlzID09PSAneScgPyBhcnJvd09mZnNldFBhcmVudC5jbGllbnRIZWlnaHQgfHwgMCA6IGFycm93T2Zmc2V0UGFyZW50LmNsaWVudFdpZHRoIHx8IDAgOiAwO1xuICB2YXIgY2VudGVyVG9SZWZlcmVuY2UgPSBlbmREaWZmIC8gMiAtIHN0YXJ0RGlmZiAvIDI7IC8vIE1ha2Ugc3VyZSB0aGUgYXJyb3cgZG9lc24ndCBvdmVyZmxvdyB0aGUgcG9wcGVyIGlmIHRoZSBjZW50ZXIgcG9pbnQgaXNcbiAgLy8gb3V0c2lkZSBvZiB0aGUgcG9wcGVyIGJvdW5kc1xuXG4gIHZhciBtaW4gPSBwYWRkaW5nT2JqZWN0W21pblByb3BdO1xuICB2YXIgbWF4ID0gY2xpZW50U2l6ZSAtIGFycm93UmVjdFtsZW5dIC0gcGFkZGluZ09iamVjdFttYXhQcm9wXTtcbiAgdmFyIGNlbnRlciA9IGNsaWVudFNpemUgLyAyIC0gYXJyb3dSZWN0W2xlbl0gLyAyICsgY2VudGVyVG9SZWZlcmVuY2U7XG4gIHZhciBvZmZzZXQgPSB3aXRoaW4obWluLCBjZW50ZXIsIG1heCk7IC8vIFByZXZlbnRzIGJyZWFraW5nIHN5bnRheCBoaWdobGlnaHRpbmcuLi5cblxuICB2YXIgYXhpc1Byb3AgPSBheGlzO1xuICBzdGF0ZS5tb2RpZmllcnNEYXRhW25hbWVdID0gKF9zdGF0ZSRtb2RpZmllcnNEYXRhJCA9IHt9LCBfc3RhdGUkbW9kaWZpZXJzRGF0YSRbYXhpc1Byb3BdID0gb2Zmc2V0LCBfc3RhdGUkbW9kaWZpZXJzRGF0YSQuY2VudGVyT2Zmc2V0ID0gb2Zmc2V0IC0gY2VudGVyLCBfc3RhdGUkbW9kaWZpZXJzRGF0YSQpO1xufVxuXG5mdW5jdGlvbiBlZmZlY3QoX3JlZjIpIHtcbiAgdmFyIHN0YXRlID0gX3JlZjIuc3RhdGUsXG4gICAgICBvcHRpb25zID0gX3JlZjIub3B0aW9ucztcbiAgdmFyIF9vcHRpb25zJGVsZW1lbnQgPSBvcHRpb25zLmVsZW1lbnQsXG4gICAgICBhcnJvd0VsZW1lbnQgPSBfb3B0aW9ucyRlbGVtZW50ID09PSB2b2lkIDAgPyAnW2RhdGEtcG9wcGVyLWFycm93XScgOiBfb3B0aW9ucyRlbGVtZW50O1xuXG4gIGlmIChhcnJvd0VsZW1lbnQgPT0gbnVsbCkge1xuICAgIHJldHVybjtcbiAgfSAvLyBDU1Mgc2VsZWN0b3JcblxuXG4gIGlmICh0eXBlb2YgYXJyb3dFbGVtZW50ID09PSAnc3RyaW5nJykge1xuICAgIGFycm93RWxlbWVudCA9IHN0YXRlLmVsZW1lbnRzLnBvcHBlci5xdWVyeVNlbGVjdG9yKGFycm93RWxlbWVudCk7XG5cbiAgICBpZiAoIWFycm93RWxlbWVudCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgfVxuXG4gIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gXCJwcm9kdWN0aW9uXCIpIHtcbiAgICBpZiAoIWlzSFRNTEVsZW1lbnQoYXJyb3dFbGVtZW50KSkge1xuICAgICAgY29uc29sZS5lcnJvcihbJ1BvcHBlcjogXCJhcnJvd1wiIGVsZW1lbnQgbXVzdCBiZSBhbiBIVE1MRWxlbWVudCAobm90IGFuIFNWR0VsZW1lbnQpLicsICdUbyB1c2UgYW4gU1ZHIGFycm93LCB3cmFwIGl0IGluIGFuIEhUTUxFbGVtZW50IHRoYXQgd2lsbCBiZSB1c2VkIGFzJywgJ3RoZSBhcnJvdy4nXS5qb2luKCcgJykpO1xuICAgIH1cbiAgfVxuXG4gIGlmICghY29udGFpbnMoc3RhdGUuZWxlbWVudHMucG9wcGVyLCBhcnJvd0VsZW1lbnQpKSB7XG4gICAgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSBcInByb2R1Y3Rpb25cIikge1xuICAgICAgY29uc29sZS5lcnJvcihbJ1BvcHBlcjogXCJhcnJvd1wiIG1vZGlmaWVyXFwncyBgZWxlbWVudGAgbXVzdCBiZSBhIGNoaWxkIG9mIHRoZSBwb3BwZXInLCAnZWxlbWVudC4nXS5qb2luKCcgJykpO1xuICAgIH1cblxuICAgIHJldHVybjtcbiAgfVxuXG4gIHN0YXRlLmVsZW1lbnRzLmFycm93ID0gYXJyb3dFbGVtZW50O1xufSAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgaW1wb3J0L25vLXVudXNlZC1tb2R1bGVzXG5cblxuZXhwb3J0IGRlZmF1bHQge1xuICBuYW1lOiAnYXJyb3cnLFxuICBlbmFibGVkOiB0cnVlLFxuICBwaGFzZTogJ21haW4nLFxuICBmbjogYXJyb3csXG4gIGVmZmVjdDogZWZmZWN0LFxuICByZXF1aXJlczogWydwb3BwZXJPZmZzZXRzJ10sXG4gIHJlcXVpcmVzSWZFeGlzdHM6IFsncHJldmVudE92ZXJmbG93J11cbn07IiwgImV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGdldFZhcmlhdGlvbihwbGFjZW1lbnQpIHtcbiAgcmV0dXJuIHBsYWNlbWVudC5zcGxpdCgnLScpWzFdO1xufSIsICJpbXBvcnQgeyB0b3AsIGxlZnQsIHJpZ2h0LCBib3R0b20sIGVuZCB9IGZyb20gXCIuLi9lbnVtcy5qc1wiO1xuaW1wb3J0IGdldE9mZnNldFBhcmVudCBmcm9tIFwiLi4vZG9tLXV0aWxzL2dldE9mZnNldFBhcmVudC5qc1wiO1xuaW1wb3J0IGdldFdpbmRvdyBmcm9tIFwiLi4vZG9tLXV0aWxzL2dldFdpbmRvdy5qc1wiO1xuaW1wb3J0IGdldERvY3VtZW50RWxlbWVudCBmcm9tIFwiLi4vZG9tLXV0aWxzL2dldERvY3VtZW50RWxlbWVudC5qc1wiO1xuaW1wb3J0IGdldENvbXB1dGVkU3R5bGUgZnJvbSBcIi4uL2RvbS11dGlscy9nZXRDb21wdXRlZFN0eWxlLmpzXCI7XG5pbXBvcnQgZ2V0QmFzZVBsYWNlbWVudCBmcm9tIFwiLi4vdXRpbHMvZ2V0QmFzZVBsYWNlbWVudC5qc1wiO1xuaW1wb3J0IGdldFZhcmlhdGlvbiBmcm9tIFwiLi4vdXRpbHMvZ2V0VmFyaWF0aW9uLmpzXCI7XG5pbXBvcnQgeyByb3VuZCB9IGZyb20gXCIuLi91dGlscy9tYXRoLmpzXCI7IC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBpbXBvcnQvbm8tdW51c2VkLW1vZHVsZXNcblxudmFyIHVuc2V0U2lkZXMgPSB7XG4gIHRvcDogJ2F1dG8nLFxuICByaWdodDogJ2F1dG8nLFxuICBib3R0b206ICdhdXRvJyxcbiAgbGVmdDogJ2F1dG8nXG59OyAvLyBSb3VuZCB0aGUgb2Zmc2V0cyB0byB0aGUgbmVhcmVzdCBzdWl0YWJsZSBzdWJwaXhlbCBiYXNlZCBvbiB0aGUgRFBSLlxuLy8gWm9vbWluZyBjYW4gY2hhbmdlIHRoZSBEUFIsIGJ1dCBpdCBzZWVtcyB0byByZXBvcnQgYSB2YWx1ZSB0aGF0IHdpbGxcbi8vIGNsZWFubHkgZGl2aWRlIHRoZSB2YWx1ZXMgaW50byB0aGUgYXBwcm9wcmlhdGUgc3VicGl4ZWxzLlxuXG5mdW5jdGlvbiByb3VuZE9mZnNldHNCeURQUihfcmVmKSB7XG4gIHZhciB4ID0gX3JlZi54LFxuICAgICAgeSA9IF9yZWYueTtcbiAgdmFyIHdpbiA9IHdpbmRvdztcbiAgdmFyIGRwciA9IHdpbi5kZXZpY2VQaXhlbFJhdGlvIHx8IDE7XG4gIHJldHVybiB7XG4gICAgeDogcm91bmQoeCAqIGRwcikgLyBkcHIgfHwgMCxcbiAgICB5OiByb3VuZCh5ICogZHByKSAvIGRwciB8fCAwXG4gIH07XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBtYXBUb1N0eWxlcyhfcmVmMikge1xuICB2YXIgX09iamVjdCRhc3NpZ24yO1xuXG4gIHZhciBwb3BwZXIgPSBfcmVmMi5wb3BwZXIsXG4gICAgICBwb3BwZXJSZWN0ID0gX3JlZjIucG9wcGVyUmVjdCxcbiAgICAgIHBsYWNlbWVudCA9IF9yZWYyLnBsYWNlbWVudCxcbiAgICAgIHZhcmlhdGlvbiA9IF9yZWYyLnZhcmlhdGlvbixcbiAgICAgIG9mZnNldHMgPSBfcmVmMi5vZmZzZXRzLFxuICAgICAgcG9zaXRpb24gPSBfcmVmMi5wb3NpdGlvbixcbiAgICAgIGdwdUFjY2VsZXJhdGlvbiA9IF9yZWYyLmdwdUFjY2VsZXJhdGlvbixcbiAgICAgIGFkYXB0aXZlID0gX3JlZjIuYWRhcHRpdmUsXG4gICAgICByb3VuZE9mZnNldHMgPSBfcmVmMi5yb3VuZE9mZnNldHMsXG4gICAgICBpc0ZpeGVkID0gX3JlZjIuaXNGaXhlZDtcbiAgdmFyIF9vZmZzZXRzJHggPSBvZmZzZXRzLngsXG4gICAgICB4ID0gX29mZnNldHMkeCA9PT0gdm9pZCAwID8gMCA6IF9vZmZzZXRzJHgsXG4gICAgICBfb2Zmc2V0cyR5ID0gb2Zmc2V0cy55LFxuICAgICAgeSA9IF9vZmZzZXRzJHkgPT09IHZvaWQgMCA/IDAgOiBfb2Zmc2V0cyR5O1xuXG4gIHZhciBfcmVmMyA9IHR5cGVvZiByb3VuZE9mZnNldHMgPT09ICdmdW5jdGlvbicgPyByb3VuZE9mZnNldHMoe1xuICAgIHg6IHgsXG4gICAgeTogeVxuICB9KSA6IHtcbiAgICB4OiB4LFxuICAgIHk6IHlcbiAgfTtcblxuICB4ID0gX3JlZjMueDtcbiAgeSA9IF9yZWYzLnk7XG4gIHZhciBoYXNYID0gb2Zmc2V0cy5oYXNPd25Qcm9wZXJ0eSgneCcpO1xuICB2YXIgaGFzWSA9IG9mZnNldHMuaGFzT3duUHJvcGVydHkoJ3knKTtcbiAgdmFyIHNpZGVYID0gbGVmdDtcbiAgdmFyIHNpZGVZID0gdG9wO1xuICB2YXIgd2luID0gd2luZG93O1xuXG4gIGlmIChhZGFwdGl2ZSkge1xuICAgIHZhciBvZmZzZXRQYXJlbnQgPSBnZXRPZmZzZXRQYXJlbnQocG9wcGVyKTtcbiAgICB2YXIgaGVpZ2h0UHJvcCA9ICdjbGllbnRIZWlnaHQnO1xuICAgIHZhciB3aWR0aFByb3AgPSAnY2xpZW50V2lkdGgnO1xuXG4gICAgaWYgKG9mZnNldFBhcmVudCA9PT0gZ2V0V2luZG93KHBvcHBlcikpIHtcbiAgICAgIG9mZnNldFBhcmVudCA9IGdldERvY3VtZW50RWxlbWVudChwb3BwZXIpO1xuXG4gICAgICBpZiAoZ2V0Q29tcHV0ZWRTdHlsZShvZmZzZXRQYXJlbnQpLnBvc2l0aW9uICE9PSAnc3RhdGljJyAmJiBwb3NpdGlvbiA9PT0gJ2Fic29sdXRlJykge1xuICAgICAgICBoZWlnaHRQcm9wID0gJ3Njcm9sbEhlaWdodCc7XG4gICAgICAgIHdpZHRoUHJvcCA9ICdzY3JvbGxXaWR0aCc7XG4gICAgICB9XG4gICAgfSAvLyAkRmxvd0ZpeE1lW2luY29tcGF0aWJsZS1jYXN0XTogZm9yY2UgdHlwZSByZWZpbmVtZW50LCB3ZSBjb21wYXJlIG9mZnNldFBhcmVudCB3aXRoIHdpbmRvdyBhYm92ZSwgYnV0IEZsb3cgZG9lc24ndCBkZXRlY3QgaXRcblxuXG4gICAgb2Zmc2V0UGFyZW50ID0gb2Zmc2V0UGFyZW50O1xuXG4gICAgaWYgKHBsYWNlbWVudCA9PT0gdG9wIHx8IChwbGFjZW1lbnQgPT09IGxlZnQgfHwgcGxhY2VtZW50ID09PSByaWdodCkgJiYgdmFyaWF0aW9uID09PSBlbmQpIHtcbiAgICAgIHNpZGVZID0gYm90dG9tO1xuICAgICAgdmFyIG9mZnNldFkgPSBpc0ZpeGVkICYmIG9mZnNldFBhcmVudCA9PT0gd2luICYmIHdpbi52aXN1YWxWaWV3cG9ydCA/IHdpbi52aXN1YWxWaWV3cG9ydC5oZWlnaHQgOiAvLyAkRmxvd0ZpeE1lW3Byb3AtbWlzc2luZ11cbiAgICAgIG9mZnNldFBhcmVudFtoZWlnaHRQcm9wXTtcbiAgICAgIHkgLT0gb2Zmc2V0WSAtIHBvcHBlclJlY3QuaGVpZ2h0O1xuICAgICAgeSAqPSBncHVBY2NlbGVyYXRpb24gPyAxIDogLTE7XG4gICAgfVxuXG4gICAgaWYgKHBsYWNlbWVudCA9PT0gbGVmdCB8fCAocGxhY2VtZW50ID09PSB0b3AgfHwgcGxhY2VtZW50ID09PSBib3R0b20pICYmIHZhcmlhdGlvbiA9PT0gZW5kKSB7XG4gICAgICBzaWRlWCA9IHJpZ2h0O1xuICAgICAgdmFyIG9mZnNldFggPSBpc0ZpeGVkICYmIG9mZnNldFBhcmVudCA9PT0gd2luICYmIHdpbi52aXN1YWxWaWV3cG9ydCA/IHdpbi52aXN1YWxWaWV3cG9ydC53aWR0aCA6IC8vICRGbG93Rml4TWVbcHJvcC1taXNzaW5nXVxuICAgICAgb2Zmc2V0UGFyZW50W3dpZHRoUHJvcF07XG4gICAgICB4IC09IG9mZnNldFggLSBwb3BwZXJSZWN0LndpZHRoO1xuICAgICAgeCAqPSBncHVBY2NlbGVyYXRpb24gPyAxIDogLTE7XG4gICAgfVxuICB9XG5cbiAgdmFyIGNvbW1vblN0eWxlcyA9IE9iamVjdC5hc3NpZ24oe1xuICAgIHBvc2l0aW9uOiBwb3NpdGlvblxuICB9LCBhZGFwdGl2ZSAmJiB1bnNldFNpZGVzKTtcblxuICB2YXIgX3JlZjQgPSByb3VuZE9mZnNldHMgPT09IHRydWUgPyByb3VuZE9mZnNldHNCeURQUih7XG4gICAgeDogeCxcbiAgICB5OiB5XG4gIH0pIDoge1xuICAgIHg6IHgsXG4gICAgeTogeVxuICB9O1xuXG4gIHggPSBfcmVmNC54O1xuICB5ID0gX3JlZjQueTtcblxuICBpZiAoZ3B1QWNjZWxlcmF0aW9uKSB7XG4gICAgdmFyIF9PYmplY3QkYXNzaWduO1xuXG4gICAgcmV0dXJuIE9iamVjdC5hc3NpZ24oe30sIGNvbW1vblN0eWxlcywgKF9PYmplY3QkYXNzaWduID0ge30sIF9PYmplY3QkYXNzaWduW3NpZGVZXSA9IGhhc1kgPyAnMCcgOiAnJywgX09iamVjdCRhc3NpZ25bc2lkZVhdID0gaGFzWCA/ICcwJyA6ICcnLCBfT2JqZWN0JGFzc2lnbi50cmFuc2Zvcm0gPSAod2luLmRldmljZVBpeGVsUmF0aW8gfHwgMSkgPD0gMSA/IFwidHJhbnNsYXRlKFwiICsgeCArIFwicHgsIFwiICsgeSArIFwicHgpXCIgOiBcInRyYW5zbGF0ZTNkKFwiICsgeCArIFwicHgsIFwiICsgeSArIFwicHgsIDApXCIsIF9PYmplY3QkYXNzaWduKSk7XG4gIH1cblxuICByZXR1cm4gT2JqZWN0LmFzc2lnbih7fSwgY29tbW9uU3R5bGVzLCAoX09iamVjdCRhc3NpZ24yID0ge30sIF9PYmplY3QkYXNzaWduMltzaWRlWV0gPSBoYXNZID8geSArIFwicHhcIiA6ICcnLCBfT2JqZWN0JGFzc2lnbjJbc2lkZVhdID0gaGFzWCA/IHggKyBcInB4XCIgOiAnJywgX09iamVjdCRhc3NpZ24yLnRyYW5zZm9ybSA9ICcnLCBfT2JqZWN0JGFzc2lnbjIpKTtcbn1cblxuZnVuY3Rpb24gY29tcHV0ZVN0eWxlcyhfcmVmNSkge1xuICB2YXIgc3RhdGUgPSBfcmVmNS5zdGF0ZSxcbiAgICAgIG9wdGlvbnMgPSBfcmVmNS5vcHRpb25zO1xuICB2YXIgX29wdGlvbnMkZ3B1QWNjZWxlcmF0ID0gb3B0aW9ucy5ncHVBY2NlbGVyYXRpb24sXG4gICAgICBncHVBY2NlbGVyYXRpb24gPSBfb3B0aW9ucyRncHVBY2NlbGVyYXQgPT09IHZvaWQgMCA/IHRydWUgOiBfb3B0aW9ucyRncHVBY2NlbGVyYXQsXG4gICAgICBfb3B0aW9ucyRhZGFwdGl2ZSA9IG9wdGlvbnMuYWRhcHRpdmUsXG4gICAgICBhZGFwdGl2ZSA9IF9vcHRpb25zJGFkYXB0aXZlID09PSB2b2lkIDAgPyB0cnVlIDogX29wdGlvbnMkYWRhcHRpdmUsXG4gICAgICBfb3B0aW9ucyRyb3VuZE9mZnNldHMgPSBvcHRpb25zLnJvdW5kT2Zmc2V0cyxcbiAgICAgIHJvdW5kT2Zmc2V0cyA9IF9vcHRpb25zJHJvdW5kT2Zmc2V0cyA9PT0gdm9pZCAwID8gdHJ1ZSA6IF9vcHRpb25zJHJvdW5kT2Zmc2V0cztcblxuICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09IFwicHJvZHVjdGlvblwiKSB7XG4gICAgdmFyIHRyYW5zaXRpb25Qcm9wZXJ0eSA9IGdldENvbXB1dGVkU3R5bGUoc3RhdGUuZWxlbWVudHMucG9wcGVyKS50cmFuc2l0aW9uUHJvcGVydHkgfHwgJyc7XG5cbiAgICBpZiAoYWRhcHRpdmUgJiYgWyd0cmFuc2Zvcm0nLCAndG9wJywgJ3JpZ2h0JywgJ2JvdHRvbScsICdsZWZ0J10uc29tZShmdW5jdGlvbiAocHJvcGVydHkpIHtcbiAgICAgIHJldHVybiB0cmFuc2l0aW9uUHJvcGVydHkuaW5kZXhPZihwcm9wZXJ0eSkgPj0gMDtcbiAgICB9KSkge1xuICAgICAgY29uc29sZS53YXJuKFsnUG9wcGVyOiBEZXRlY3RlZCBDU1MgdHJhbnNpdGlvbnMgb24gYXQgbGVhc3Qgb25lIG9mIHRoZSBmb2xsb3dpbmcnLCAnQ1NTIHByb3BlcnRpZXM6IFwidHJhbnNmb3JtXCIsIFwidG9wXCIsIFwicmlnaHRcIiwgXCJib3R0b21cIiwgXCJsZWZ0XCIuJywgJ1xcblxcbicsICdEaXNhYmxlIHRoZSBcImNvbXB1dGVTdHlsZXNcIiBtb2RpZmllclxcJ3MgYGFkYXB0aXZlYCBvcHRpb24gdG8gYWxsb3cnLCAnZm9yIHNtb290aCB0cmFuc2l0aW9ucywgb3IgcmVtb3ZlIHRoZXNlIHByb3BlcnRpZXMgZnJvbSB0aGUgQ1NTJywgJ3RyYW5zaXRpb24gZGVjbGFyYXRpb24gb24gdGhlIHBvcHBlciBlbGVtZW50IGlmIG9ubHkgdHJhbnNpdGlvbmluZycsICdvcGFjaXR5IG9yIGJhY2tncm91bmQtY29sb3IgZm9yIGV4YW1wbGUuJywgJ1xcblxcbicsICdXZSByZWNvbW1lbmQgdXNpbmcgdGhlIHBvcHBlciBlbGVtZW50IGFzIGEgd3JhcHBlciBhcm91bmQgYW4gaW5uZXInLCAnZWxlbWVudCB0aGF0IGNhbiBoYXZlIGFueSBDU1MgcHJvcGVydHkgdHJhbnNpdGlvbmVkIGZvciBhbmltYXRpb25zLiddLmpvaW4oJyAnKSk7XG4gICAgfVxuICB9XG5cbiAgdmFyIGNvbW1vblN0eWxlcyA9IHtcbiAgICBwbGFjZW1lbnQ6IGdldEJhc2VQbGFjZW1lbnQoc3RhdGUucGxhY2VtZW50KSxcbiAgICB2YXJpYXRpb246IGdldFZhcmlhdGlvbihzdGF0ZS5wbGFjZW1lbnQpLFxuICAgIHBvcHBlcjogc3RhdGUuZWxlbWVudHMucG9wcGVyLFxuICAgIHBvcHBlclJlY3Q6IHN0YXRlLnJlY3RzLnBvcHBlcixcbiAgICBncHVBY2NlbGVyYXRpb246IGdwdUFjY2VsZXJhdGlvbixcbiAgICBpc0ZpeGVkOiBzdGF0ZS5vcHRpb25zLnN0cmF0ZWd5ID09PSAnZml4ZWQnXG4gIH07XG5cbiAgaWYgKHN0YXRlLm1vZGlmaWVyc0RhdGEucG9wcGVyT2Zmc2V0cyAhPSBudWxsKSB7XG4gICAgc3RhdGUuc3R5bGVzLnBvcHBlciA9IE9iamVjdC5hc3NpZ24oe30sIHN0YXRlLnN0eWxlcy5wb3BwZXIsIG1hcFRvU3R5bGVzKE9iamVjdC5hc3NpZ24oe30sIGNvbW1vblN0eWxlcywge1xuICAgICAgb2Zmc2V0czogc3RhdGUubW9kaWZpZXJzRGF0YS5wb3BwZXJPZmZzZXRzLFxuICAgICAgcG9zaXRpb246IHN0YXRlLm9wdGlvbnMuc3RyYXRlZ3ksXG4gICAgICBhZGFwdGl2ZTogYWRhcHRpdmUsXG4gICAgICByb3VuZE9mZnNldHM6IHJvdW5kT2Zmc2V0c1xuICAgIH0pKSk7XG4gIH1cblxuICBpZiAoc3RhdGUubW9kaWZpZXJzRGF0YS5hcnJvdyAhPSBudWxsKSB7XG4gICAgc3RhdGUuc3R5bGVzLmFycm93ID0gT2JqZWN0LmFzc2lnbih7fSwgc3RhdGUuc3R5bGVzLmFycm93LCBtYXBUb1N0eWxlcyhPYmplY3QuYXNzaWduKHt9LCBjb21tb25TdHlsZXMsIHtcbiAgICAgIG9mZnNldHM6IHN0YXRlLm1vZGlmaWVyc0RhdGEuYXJyb3csXG4gICAgICBwb3NpdGlvbjogJ2Fic29sdXRlJyxcbiAgICAgIGFkYXB0aXZlOiBmYWxzZSxcbiAgICAgIHJvdW5kT2Zmc2V0czogcm91bmRPZmZzZXRzXG4gICAgfSkpKTtcbiAgfVxuXG4gIHN0YXRlLmF0dHJpYnV0ZXMucG9wcGVyID0gT2JqZWN0LmFzc2lnbih7fSwgc3RhdGUuYXR0cmlidXRlcy5wb3BwZXIsIHtcbiAgICAnZGF0YS1wb3BwZXItcGxhY2VtZW50Jzogc3RhdGUucGxhY2VtZW50XG4gIH0pO1xufSAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgaW1wb3J0L25vLXVudXNlZC1tb2R1bGVzXG5cblxuZXhwb3J0IGRlZmF1bHQge1xuICBuYW1lOiAnY29tcHV0ZVN0eWxlcycsXG4gIGVuYWJsZWQ6IHRydWUsXG4gIHBoYXNlOiAnYmVmb3JlV3JpdGUnLFxuICBmbjogY29tcHV0ZVN0eWxlcyxcbiAgZGF0YToge31cbn07IiwgImltcG9ydCBnZXRXaW5kb3cgZnJvbSBcIi4uL2RvbS11dGlscy9nZXRXaW5kb3cuanNcIjsgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGltcG9ydC9uby11bnVzZWQtbW9kdWxlc1xuXG52YXIgcGFzc2l2ZSA9IHtcbiAgcGFzc2l2ZTogdHJ1ZVxufTtcblxuZnVuY3Rpb24gZWZmZWN0KF9yZWYpIHtcbiAgdmFyIHN0YXRlID0gX3JlZi5zdGF0ZSxcbiAgICAgIGluc3RhbmNlID0gX3JlZi5pbnN0YW5jZSxcbiAgICAgIG9wdGlvbnMgPSBfcmVmLm9wdGlvbnM7XG4gIHZhciBfb3B0aW9ucyRzY3JvbGwgPSBvcHRpb25zLnNjcm9sbCxcbiAgICAgIHNjcm9sbCA9IF9vcHRpb25zJHNjcm9sbCA9PT0gdm9pZCAwID8gdHJ1ZSA6IF9vcHRpb25zJHNjcm9sbCxcbiAgICAgIF9vcHRpb25zJHJlc2l6ZSA9IG9wdGlvbnMucmVzaXplLFxuICAgICAgcmVzaXplID0gX29wdGlvbnMkcmVzaXplID09PSB2b2lkIDAgPyB0cnVlIDogX29wdGlvbnMkcmVzaXplO1xuICB2YXIgd2luZG93ID0gZ2V0V2luZG93KHN0YXRlLmVsZW1lbnRzLnBvcHBlcik7XG4gIHZhciBzY3JvbGxQYXJlbnRzID0gW10uY29uY2F0KHN0YXRlLnNjcm9sbFBhcmVudHMucmVmZXJlbmNlLCBzdGF0ZS5zY3JvbGxQYXJlbnRzLnBvcHBlcik7XG5cbiAgaWYgKHNjcm9sbCkge1xuICAgIHNjcm9sbFBhcmVudHMuZm9yRWFjaChmdW5jdGlvbiAoc2Nyb2xsUGFyZW50KSB7XG4gICAgICBzY3JvbGxQYXJlbnQuYWRkRXZlbnRMaXN0ZW5lcignc2Nyb2xsJywgaW5zdGFuY2UudXBkYXRlLCBwYXNzaXZlKTtcbiAgICB9KTtcbiAgfVxuXG4gIGlmIChyZXNpemUpIHtcbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigncmVzaXplJywgaW5zdGFuY2UudXBkYXRlLCBwYXNzaXZlKTtcbiAgfVxuXG4gIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgaWYgKHNjcm9sbCkge1xuICAgICAgc2Nyb2xsUGFyZW50cy5mb3JFYWNoKGZ1bmN0aW9uIChzY3JvbGxQYXJlbnQpIHtcbiAgICAgICAgc2Nyb2xsUGFyZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3Njcm9sbCcsIGluc3RhbmNlLnVwZGF0ZSwgcGFzc2l2ZSk7XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBpZiAocmVzaXplKSB7XG4gICAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcigncmVzaXplJywgaW5zdGFuY2UudXBkYXRlLCBwYXNzaXZlKTtcbiAgICB9XG4gIH07XG59IC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBpbXBvcnQvbm8tdW51c2VkLW1vZHVsZXNcblxuXG5leHBvcnQgZGVmYXVsdCB7XG4gIG5hbWU6ICdldmVudExpc3RlbmVycycsXG4gIGVuYWJsZWQ6IHRydWUsXG4gIHBoYXNlOiAnd3JpdGUnLFxuICBmbjogZnVuY3Rpb24gZm4oKSB7fSxcbiAgZWZmZWN0OiBlZmZlY3QsXG4gIGRhdGE6IHt9XG59OyIsICJ2YXIgaGFzaCA9IHtcbiAgbGVmdDogJ3JpZ2h0JyxcbiAgcmlnaHQ6ICdsZWZ0JyxcbiAgYm90dG9tOiAndG9wJyxcbiAgdG9wOiAnYm90dG9tJ1xufTtcbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGdldE9wcG9zaXRlUGxhY2VtZW50KHBsYWNlbWVudCkge1xuICByZXR1cm4gcGxhY2VtZW50LnJlcGxhY2UoL2xlZnR8cmlnaHR8Ym90dG9tfHRvcC9nLCBmdW5jdGlvbiAobWF0Y2hlZCkge1xuICAgIHJldHVybiBoYXNoW21hdGNoZWRdO1xuICB9KTtcbn0iLCAidmFyIGhhc2ggPSB7XG4gIHN0YXJ0OiAnZW5kJyxcbiAgZW5kOiAnc3RhcnQnXG59O1xuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gZ2V0T3Bwb3NpdGVWYXJpYXRpb25QbGFjZW1lbnQocGxhY2VtZW50KSB7XG4gIHJldHVybiBwbGFjZW1lbnQucmVwbGFjZSgvc3RhcnR8ZW5kL2csIGZ1bmN0aW9uIChtYXRjaGVkKSB7XG4gICAgcmV0dXJuIGhhc2hbbWF0Y2hlZF07XG4gIH0pO1xufSIsICJpbXBvcnQgZ2V0V2luZG93IGZyb20gXCIuL2dldFdpbmRvdy5qc1wiO1xuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gZ2V0V2luZG93U2Nyb2xsKG5vZGUpIHtcbiAgdmFyIHdpbiA9IGdldFdpbmRvdyhub2RlKTtcbiAgdmFyIHNjcm9sbExlZnQgPSB3aW4ucGFnZVhPZmZzZXQ7XG4gIHZhciBzY3JvbGxUb3AgPSB3aW4ucGFnZVlPZmZzZXQ7XG4gIHJldHVybiB7XG4gICAgc2Nyb2xsTGVmdDogc2Nyb2xsTGVmdCxcbiAgICBzY3JvbGxUb3A6IHNjcm9sbFRvcFxuICB9O1xufSIsICJpbXBvcnQgZ2V0Qm91bmRpbmdDbGllbnRSZWN0IGZyb20gXCIuL2dldEJvdW5kaW5nQ2xpZW50UmVjdC5qc1wiO1xuaW1wb3J0IGdldERvY3VtZW50RWxlbWVudCBmcm9tIFwiLi9nZXREb2N1bWVudEVsZW1lbnQuanNcIjtcbmltcG9ydCBnZXRXaW5kb3dTY3JvbGwgZnJvbSBcIi4vZ2V0V2luZG93U2Nyb2xsLmpzXCI7XG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBnZXRXaW5kb3dTY3JvbGxCYXJYKGVsZW1lbnQpIHtcbiAgLy8gSWYgPGh0bWw+IGhhcyBhIENTUyB3aWR0aCBncmVhdGVyIHRoYW4gdGhlIHZpZXdwb3J0LCB0aGVuIHRoaXMgd2lsbCBiZVxuICAvLyBpbmNvcnJlY3QgZm9yIFJUTC5cbiAgLy8gUG9wcGVyIDEgaXMgYnJva2VuIGluIHRoaXMgY2FzZSBhbmQgbmV2ZXIgaGFkIGEgYnVnIHJlcG9ydCBzbyBsZXQncyBhc3N1bWVcbiAgLy8gaXQncyBub3QgYW4gaXNzdWUuIEkgZG9uJ3QgdGhpbmsgYW55b25lIGV2ZXIgc3BlY2lmaWVzIHdpZHRoIG9uIDxodG1sPlxuICAvLyBhbnl3YXkuXG4gIC8vIEJyb3dzZXJzIHdoZXJlIHRoZSBsZWZ0IHNjcm9sbGJhciBkb2Vzbid0IGNhdXNlIGFuIGlzc3VlIHJlcG9ydCBgMGAgZm9yXG4gIC8vIHRoaXMgKGUuZy4gRWRnZSAyMDE5LCBJRTExLCBTYWZhcmkpXG4gIHJldHVybiBnZXRCb3VuZGluZ0NsaWVudFJlY3QoZ2V0RG9jdW1lbnRFbGVtZW50KGVsZW1lbnQpKS5sZWZ0ICsgZ2V0V2luZG93U2Nyb2xsKGVsZW1lbnQpLnNjcm9sbExlZnQ7XG59IiwgImltcG9ydCBnZXRXaW5kb3cgZnJvbSBcIi4vZ2V0V2luZG93LmpzXCI7XG5pbXBvcnQgZ2V0RG9jdW1lbnRFbGVtZW50IGZyb20gXCIuL2dldERvY3VtZW50RWxlbWVudC5qc1wiO1xuaW1wb3J0IGdldFdpbmRvd1Njcm9sbEJhclggZnJvbSBcIi4vZ2V0V2luZG93U2Nyb2xsQmFyWC5qc1wiO1xuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gZ2V0Vmlld3BvcnRSZWN0KGVsZW1lbnQpIHtcbiAgdmFyIHdpbiA9IGdldFdpbmRvdyhlbGVtZW50KTtcbiAgdmFyIGh0bWwgPSBnZXREb2N1bWVudEVsZW1lbnQoZWxlbWVudCk7XG4gIHZhciB2aXN1YWxWaWV3cG9ydCA9IHdpbi52aXN1YWxWaWV3cG9ydDtcbiAgdmFyIHdpZHRoID0gaHRtbC5jbGllbnRXaWR0aDtcbiAgdmFyIGhlaWdodCA9IGh0bWwuY2xpZW50SGVpZ2h0O1xuICB2YXIgeCA9IDA7XG4gIHZhciB5ID0gMDsgLy8gTkI6IFRoaXMgaXNuJ3Qgc3VwcG9ydGVkIG9uIGlPUyA8PSAxMi4gSWYgdGhlIGtleWJvYXJkIGlzIG9wZW4sIHRoZSBwb3BwZXJcbiAgLy8gY2FuIGJlIG9ic2N1cmVkIHVuZGVybmVhdGggaXQuXG4gIC8vIEFsc28sIGBodG1sLmNsaWVudEhlaWdodGAgYWRkcyB0aGUgYm90dG9tIGJhciBoZWlnaHQgaW4gU2FmYXJpIGlPUywgZXZlblxuICAvLyBpZiBpdCBpc24ndCBvcGVuLCBzbyBpZiB0aGlzIGlzbid0IGF2YWlsYWJsZSwgdGhlIHBvcHBlciB3aWxsIGJlIGRldGVjdGVkXG4gIC8vIHRvIG92ZXJmbG93IHRoZSBib3R0b20gb2YgdGhlIHNjcmVlbiB0b28gZWFybHkuXG5cbiAgaWYgKHZpc3VhbFZpZXdwb3J0KSB7XG4gICAgd2lkdGggPSB2aXN1YWxWaWV3cG9ydC53aWR0aDtcbiAgICBoZWlnaHQgPSB2aXN1YWxWaWV3cG9ydC5oZWlnaHQ7IC8vIFVzZXMgTGF5b3V0IFZpZXdwb3J0IChsaWtlIENocm9tZTsgU2FmYXJpIGRvZXMgbm90IGN1cnJlbnRseSlcbiAgICAvLyBJbiBDaHJvbWUsIGl0IHJldHVybnMgYSB2YWx1ZSB2ZXJ5IGNsb3NlIHRvIDAgKCsvLSkgYnV0IGNvbnRhaW5zIHJvdW5kaW5nXG4gICAgLy8gZXJyb3JzIGR1ZSB0byBmbG9hdGluZyBwb2ludCBudW1iZXJzLCBzbyB3ZSBuZWVkIHRvIGNoZWNrIHByZWNpc2lvbi5cbiAgICAvLyBTYWZhcmkgcmV0dXJucyBhIG51bWJlciA8PSAwLCB1c3VhbGx5IDwgLTEgd2hlbiBwaW5jaC16b29tZWRcbiAgICAvLyBGZWF0dXJlIGRldGVjdGlvbiBmYWlscyBpbiBtb2JpbGUgZW11bGF0aW9uIG1vZGUgaW4gQ2hyb21lLlxuICAgIC8vIE1hdGguYWJzKHdpbi5pbm5lcldpZHRoIC8gdmlzdWFsVmlld3BvcnQuc2NhbGUgLSB2aXN1YWxWaWV3cG9ydC53aWR0aCkgPFxuICAgIC8vIDAuMDAxXG4gICAgLy8gRmFsbGJhY2sgaGVyZTogXCJOb3QgU2FmYXJpXCIgdXNlckFnZW50XG5cbiAgICBpZiAoIS9eKCg/IWNocm9tZXxhbmRyb2lkKS4pKnNhZmFyaS9pLnRlc3QobmF2aWdhdG9yLnVzZXJBZ2VudCkpIHtcbiAgICAgIHggPSB2aXN1YWxWaWV3cG9ydC5vZmZzZXRMZWZ0O1xuICAgICAgeSA9IHZpc3VhbFZpZXdwb3J0Lm9mZnNldFRvcDtcbiAgICB9XG4gIH1cblxuICByZXR1cm4ge1xuICAgIHdpZHRoOiB3aWR0aCxcbiAgICBoZWlnaHQ6IGhlaWdodCxcbiAgICB4OiB4ICsgZ2V0V2luZG93U2Nyb2xsQmFyWChlbGVtZW50KSxcbiAgICB5OiB5XG4gIH07XG59IiwgImltcG9ydCBnZXREb2N1bWVudEVsZW1lbnQgZnJvbSBcIi4vZ2V0RG9jdW1lbnRFbGVtZW50LmpzXCI7XG5pbXBvcnQgZ2V0Q29tcHV0ZWRTdHlsZSBmcm9tIFwiLi9nZXRDb21wdXRlZFN0eWxlLmpzXCI7XG5pbXBvcnQgZ2V0V2luZG93U2Nyb2xsQmFyWCBmcm9tIFwiLi9nZXRXaW5kb3dTY3JvbGxCYXJYLmpzXCI7XG5pbXBvcnQgZ2V0V2luZG93U2Nyb2xsIGZyb20gXCIuL2dldFdpbmRvd1Njcm9sbC5qc1wiO1xuaW1wb3J0IHsgbWF4IH0gZnJvbSBcIi4uL3V0aWxzL21hdGguanNcIjsgLy8gR2V0cyB0aGUgZW50aXJlIHNpemUgb2YgdGhlIHNjcm9sbGFibGUgZG9jdW1lbnQgYXJlYSwgZXZlbiBleHRlbmRpbmcgb3V0c2lkZVxuLy8gb2YgdGhlIGA8aHRtbD5gIGFuZCBgPGJvZHk+YCByZWN0IGJvdW5kcyBpZiBob3Jpem9udGFsbHkgc2Nyb2xsYWJsZVxuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBnZXREb2N1bWVudFJlY3QoZWxlbWVudCkge1xuICB2YXIgX2VsZW1lbnQkb3duZXJEb2N1bWVuO1xuXG4gIHZhciBodG1sID0gZ2V0RG9jdW1lbnRFbGVtZW50KGVsZW1lbnQpO1xuICB2YXIgd2luU2Nyb2xsID0gZ2V0V2luZG93U2Nyb2xsKGVsZW1lbnQpO1xuICB2YXIgYm9keSA9IChfZWxlbWVudCRvd25lckRvY3VtZW4gPSBlbGVtZW50Lm93bmVyRG9jdW1lbnQpID09IG51bGwgPyB2b2lkIDAgOiBfZWxlbWVudCRvd25lckRvY3VtZW4uYm9keTtcbiAgdmFyIHdpZHRoID0gbWF4KGh0bWwuc2Nyb2xsV2lkdGgsIGh0bWwuY2xpZW50V2lkdGgsIGJvZHkgPyBib2R5LnNjcm9sbFdpZHRoIDogMCwgYm9keSA/IGJvZHkuY2xpZW50V2lkdGggOiAwKTtcbiAgdmFyIGhlaWdodCA9IG1heChodG1sLnNjcm9sbEhlaWdodCwgaHRtbC5jbGllbnRIZWlnaHQsIGJvZHkgPyBib2R5LnNjcm9sbEhlaWdodCA6IDAsIGJvZHkgPyBib2R5LmNsaWVudEhlaWdodCA6IDApO1xuICB2YXIgeCA9IC13aW5TY3JvbGwuc2Nyb2xsTGVmdCArIGdldFdpbmRvd1Njcm9sbEJhclgoZWxlbWVudCk7XG4gIHZhciB5ID0gLXdpblNjcm9sbC5zY3JvbGxUb3A7XG5cbiAgaWYgKGdldENvbXB1dGVkU3R5bGUoYm9keSB8fCBodG1sKS5kaXJlY3Rpb24gPT09ICdydGwnKSB7XG4gICAgeCArPSBtYXgoaHRtbC5jbGllbnRXaWR0aCwgYm9keSA/IGJvZHkuY2xpZW50V2lkdGggOiAwKSAtIHdpZHRoO1xuICB9XG5cbiAgcmV0dXJuIHtcbiAgICB3aWR0aDogd2lkdGgsXG4gICAgaGVpZ2h0OiBoZWlnaHQsXG4gICAgeDogeCxcbiAgICB5OiB5XG4gIH07XG59IiwgImltcG9ydCBnZXRDb21wdXRlZFN0eWxlIGZyb20gXCIuL2dldENvbXB1dGVkU3R5bGUuanNcIjtcbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGlzU2Nyb2xsUGFyZW50KGVsZW1lbnQpIHtcbiAgLy8gRmlyZWZveCB3YW50cyB1cyB0byBjaGVjayBgLXhgIGFuZCBgLXlgIHZhcmlhdGlvbnMgYXMgd2VsbFxuICB2YXIgX2dldENvbXB1dGVkU3R5bGUgPSBnZXRDb21wdXRlZFN0eWxlKGVsZW1lbnQpLFxuICAgICAgb3ZlcmZsb3cgPSBfZ2V0Q29tcHV0ZWRTdHlsZS5vdmVyZmxvdyxcbiAgICAgIG92ZXJmbG93WCA9IF9nZXRDb21wdXRlZFN0eWxlLm92ZXJmbG93WCxcbiAgICAgIG92ZXJmbG93WSA9IF9nZXRDb21wdXRlZFN0eWxlLm92ZXJmbG93WTtcblxuICByZXR1cm4gL2F1dG98c2Nyb2xsfG92ZXJsYXl8aGlkZGVuLy50ZXN0KG92ZXJmbG93ICsgb3ZlcmZsb3dZICsgb3ZlcmZsb3dYKTtcbn0iLCAiaW1wb3J0IGdldFBhcmVudE5vZGUgZnJvbSBcIi4vZ2V0UGFyZW50Tm9kZS5qc1wiO1xuaW1wb3J0IGlzU2Nyb2xsUGFyZW50IGZyb20gXCIuL2lzU2Nyb2xsUGFyZW50LmpzXCI7XG5pbXBvcnQgZ2V0Tm9kZU5hbWUgZnJvbSBcIi4vZ2V0Tm9kZU5hbWUuanNcIjtcbmltcG9ydCB7IGlzSFRNTEVsZW1lbnQgfSBmcm9tIFwiLi9pbnN0YW5jZU9mLmpzXCI7XG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBnZXRTY3JvbGxQYXJlbnQobm9kZSkge1xuICBpZiAoWydodG1sJywgJ2JvZHknLCAnI2RvY3VtZW50J10uaW5kZXhPZihnZXROb2RlTmFtZShub2RlKSkgPj0gMCkge1xuICAgIC8vICRGbG93Rml4TWVbaW5jb21wYXRpYmxlLXJldHVybl06IGFzc3VtZSBib2R5IGlzIGFsd2F5cyBhdmFpbGFibGVcbiAgICByZXR1cm4gbm9kZS5vd25lckRvY3VtZW50LmJvZHk7XG4gIH1cblxuICBpZiAoaXNIVE1MRWxlbWVudChub2RlKSAmJiBpc1Njcm9sbFBhcmVudChub2RlKSkge1xuICAgIHJldHVybiBub2RlO1xuICB9XG5cbiAgcmV0dXJuIGdldFNjcm9sbFBhcmVudChnZXRQYXJlbnROb2RlKG5vZGUpKTtcbn0iLCAiaW1wb3J0IGdldFNjcm9sbFBhcmVudCBmcm9tIFwiLi9nZXRTY3JvbGxQYXJlbnQuanNcIjtcbmltcG9ydCBnZXRQYXJlbnROb2RlIGZyb20gXCIuL2dldFBhcmVudE5vZGUuanNcIjtcbmltcG9ydCBnZXRXaW5kb3cgZnJvbSBcIi4vZ2V0V2luZG93LmpzXCI7XG5pbXBvcnQgaXNTY3JvbGxQYXJlbnQgZnJvbSBcIi4vaXNTY3JvbGxQYXJlbnQuanNcIjtcbi8qXG5naXZlbiBhIERPTSBlbGVtZW50LCByZXR1cm4gdGhlIGxpc3Qgb2YgYWxsIHNjcm9sbCBwYXJlbnRzLCB1cCB0aGUgbGlzdCBvZiBhbmNlc29yc1xudW50aWwgd2UgZ2V0IHRvIHRoZSB0b3Agd2luZG93IG9iamVjdC4gVGhpcyBsaXN0IGlzIHdoYXQgd2UgYXR0YWNoIHNjcm9sbCBsaXN0ZW5lcnNcbnRvLCBiZWNhdXNlIGlmIGFueSBvZiB0aGVzZSBwYXJlbnQgZWxlbWVudHMgc2Nyb2xsLCB3ZSdsbCBuZWVkIHRvIHJlLWNhbGN1bGF0ZSB0aGVcbnJlZmVyZW5jZSBlbGVtZW50J3MgcG9zaXRpb24uXG4qL1xuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBsaXN0U2Nyb2xsUGFyZW50cyhlbGVtZW50LCBsaXN0KSB7XG4gIHZhciBfZWxlbWVudCRvd25lckRvY3VtZW47XG5cbiAgaWYgKGxpc3QgPT09IHZvaWQgMCkge1xuICAgIGxpc3QgPSBbXTtcbiAgfVxuXG4gIHZhciBzY3JvbGxQYXJlbnQgPSBnZXRTY3JvbGxQYXJlbnQoZWxlbWVudCk7XG4gIHZhciBpc0JvZHkgPSBzY3JvbGxQYXJlbnQgPT09ICgoX2VsZW1lbnQkb3duZXJEb2N1bWVuID0gZWxlbWVudC5vd25lckRvY3VtZW50KSA9PSBudWxsID8gdm9pZCAwIDogX2VsZW1lbnQkb3duZXJEb2N1bWVuLmJvZHkpO1xuICB2YXIgd2luID0gZ2V0V2luZG93KHNjcm9sbFBhcmVudCk7XG4gIHZhciB0YXJnZXQgPSBpc0JvZHkgPyBbd2luXS5jb25jYXQod2luLnZpc3VhbFZpZXdwb3J0IHx8IFtdLCBpc1Njcm9sbFBhcmVudChzY3JvbGxQYXJlbnQpID8gc2Nyb2xsUGFyZW50IDogW10pIDogc2Nyb2xsUGFyZW50O1xuICB2YXIgdXBkYXRlZExpc3QgPSBsaXN0LmNvbmNhdCh0YXJnZXQpO1xuICByZXR1cm4gaXNCb2R5ID8gdXBkYXRlZExpc3QgOiAvLyAkRmxvd0ZpeE1lW2luY29tcGF0aWJsZS1jYWxsXTogaXNCb2R5IHRlbGxzIHVzIHRhcmdldCB3aWxsIGJlIGFuIEhUTUxFbGVtZW50IGhlcmVcbiAgdXBkYXRlZExpc3QuY29uY2F0KGxpc3RTY3JvbGxQYXJlbnRzKGdldFBhcmVudE5vZGUodGFyZ2V0KSkpO1xufSIsICJleHBvcnQgZGVmYXVsdCBmdW5jdGlvbiByZWN0VG9DbGllbnRSZWN0KHJlY3QpIHtcbiAgcmV0dXJuIE9iamVjdC5hc3NpZ24oe30sIHJlY3QsIHtcbiAgICBsZWZ0OiByZWN0LngsXG4gICAgdG9wOiByZWN0LnksXG4gICAgcmlnaHQ6IHJlY3QueCArIHJlY3Qud2lkdGgsXG4gICAgYm90dG9tOiByZWN0LnkgKyByZWN0LmhlaWdodFxuICB9KTtcbn0iLCAiaW1wb3J0IHsgdmlld3BvcnQgfSBmcm9tIFwiLi4vZW51bXMuanNcIjtcbmltcG9ydCBnZXRWaWV3cG9ydFJlY3QgZnJvbSBcIi4vZ2V0Vmlld3BvcnRSZWN0LmpzXCI7XG5pbXBvcnQgZ2V0RG9jdW1lbnRSZWN0IGZyb20gXCIuL2dldERvY3VtZW50UmVjdC5qc1wiO1xuaW1wb3J0IGxpc3RTY3JvbGxQYXJlbnRzIGZyb20gXCIuL2xpc3RTY3JvbGxQYXJlbnRzLmpzXCI7XG5pbXBvcnQgZ2V0T2Zmc2V0UGFyZW50IGZyb20gXCIuL2dldE9mZnNldFBhcmVudC5qc1wiO1xuaW1wb3J0IGdldERvY3VtZW50RWxlbWVudCBmcm9tIFwiLi9nZXREb2N1bWVudEVsZW1lbnQuanNcIjtcbmltcG9ydCBnZXRDb21wdXRlZFN0eWxlIGZyb20gXCIuL2dldENvbXB1dGVkU3R5bGUuanNcIjtcbmltcG9ydCB7IGlzRWxlbWVudCwgaXNIVE1MRWxlbWVudCB9IGZyb20gXCIuL2luc3RhbmNlT2YuanNcIjtcbmltcG9ydCBnZXRCb3VuZGluZ0NsaWVudFJlY3QgZnJvbSBcIi4vZ2V0Qm91bmRpbmdDbGllbnRSZWN0LmpzXCI7XG5pbXBvcnQgZ2V0UGFyZW50Tm9kZSBmcm9tIFwiLi9nZXRQYXJlbnROb2RlLmpzXCI7XG5pbXBvcnQgY29udGFpbnMgZnJvbSBcIi4vY29udGFpbnMuanNcIjtcbmltcG9ydCBnZXROb2RlTmFtZSBmcm9tIFwiLi9nZXROb2RlTmFtZS5qc1wiO1xuaW1wb3J0IHJlY3RUb0NsaWVudFJlY3QgZnJvbSBcIi4uL3V0aWxzL3JlY3RUb0NsaWVudFJlY3QuanNcIjtcbmltcG9ydCB7IG1heCwgbWluIH0gZnJvbSBcIi4uL3V0aWxzL21hdGguanNcIjtcblxuZnVuY3Rpb24gZ2V0SW5uZXJCb3VuZGluZ0NsaWVudFJlY3QoZWxlbWVudCkge1xuICB2YXIgcmVjdCA9IGdldEJvdW5kaW5nQ2xpZW50UmVjdChlbGVtZW50KTtcbiAgcmVjdC50b3AgPSByZWN0LnRvcCArIGVsZW1lbnQuY2xpZW50VG9wO1xuICByZWN0LmxlZnQgPSByZWN0LmxlZnQgKyBlbGVtZW50LmNsaWVudExlZnQ7XG4gIHJlY3QuYm90dG9tID0gcmVjdC50b3AgKyBlbGVtZW50LmNsaWVudEhlaWdodDtcbiAgcmVjdC5yaWdodCA9IHJlY3QubGVmdCArIGVsZW1lbnQuY2xpZW50V2lkdGg7XG4gIHJlY3Qud2lkdGggPSBlbGVtZW50LmNsaWVudFdpZHRoO1xuICByZWN0LmhlaWdodCA9IGVsZW1lbnQuY2xpZW50SGVpZ2h0O1xuICByZWN0LnggPSByZWN0LmxlZnQ7XG4gIHJlY3QueSA9IHJlY3QudG9wO1xuICByZXR1cm4gcmVjdDtcbn1cblxuZnVuY3Rpb24gZ2V0Q2xpZW50UmVjdEZyb21NaXhlZFR5cGUoZWxlbWVudCwgY2xpcHBpbmdQYXJlbnQpIHtcbiAgcmV0dXJuIGNsaXBwaW5nUGFyZW50ID09PSB2aWV3cG9ydCA/IHJlY3RUb0NsaWVudFJlY3QoZ2V0Vmlld3BvcnRSZWN0KGVsZW1lbnQpKSA6IGlzRWxlbWVudChjbGlwcGluZ1BhcmVudCkgPyBnZXRJbm5lckJvdW5kaW5nQ2xpZW50UmVjdChjbGlwcGluZ1BhcmVudCkgOiByZWN0VG9DbGllbnRSZWN0KGdldERvY3VtZW50UmVjdChnZXREb2N1bWVudEVsZW1lbnQoZWxlbWVudCkpKTtcbn0gLy8gQSBcImNsaXBwaW5nIHBhcmVudFwiIGlzIGFuIG92ZXJmbG93YWJsZSBjb250YWluZXIgd2l0aCB0aGUgY2hhcmFjdGVyaXN0aWMgb2Zcbi8vIGNsaXBwaW5nIChvciBoaWRpbmcpIG92ZXJmbG93aW5nIGVsZW1lbnRzIHdpdGggYSBwb3NpdGlvbiBkaWZmZXJlbnQgZnJvbVxuLy8gYGluaXRpYWxgXG5cblxuZnVuY3Rpb24gZ2V0Q2xpcHBpbmdQYXJlbnRzKGVsZW1lbnQpIHtcbiAgdmFyIGNsaXBwaW5nUGFyZW50cyA9IGxpc3RTY3JvbGxQYXJlbnRzKGdldFBhcmVudE5vZGUoZWxlbWVudCkpO1xuICB2YXIgY2FuRXNjYXBlQ2xpcHBpbmcgPSBbJ2Fic29sdXRlJywgJ2ZpeGVkJ10uaW5kZXhPZihnZXRDb21wdXRlZFN0eWxlKGVsZW1lbnQpLnBvc2l0aW9uKSA+PSAwO1xuICB2YXIgY2xpcHBlckVsZW1lbnQgPSBjYW5Fc2NhcGVDbGlwcGluZyAmJiBpc0hUTUxFbGVtZW50KGVsZW1lbnQpID8gZ2V0T2Zmc2V0UGFyZW50KGVsZW1lbnQpIDogZWxlbWVudDtcblxuICBpZiAoIWlzRWxlbWVudChjbGlwcGVyRWxlbWVudCkpIHtcbiAgICByZXR1cm4gW107XG4gIH0gLy8gJEZsb3dGaXhNZVtpbmNvbXBhdGlibGUtcmV0dXJuXTogaHR0cHM6Ly9naXRodWIuY29tL2ZhY2Vib29rL2Zsb3cvaXNzdWVzLzE0MTRcblxuXG4gIHJldHVybiBjbGlwcGluZ1BhcmVudHMuZmlsdGVyKGZ1bmN0aW9uIChjbGlwcGluZ1BhcmVudCkge1xuICAgIHJldHVybiBpc0VsZW1lbnQoY2xpcHBpbmdQYXJlbnQpICYmIGNvbnRhaW5zKGNsaXBwaW5nUGFyZW50LCBjbGlwcGVyRWxlbWVudCkgJiYgZ2V0Tm9kZU5hbWUoY2xpcHBpbmdQYXJlbnQpICE9PSAnYm9keSc7XG4gIH0pO1xufSAvLyBHZXRzIHRoZSBtYXhpbXVtIGFyZWEgdGhhdCB0aGUgZWxlbWVudCBpcyB2aXNpYmxlIGluIGR1ZSB0byBhbnkgbnVtYmVyIG9mXG4vLyBjbGlwcGluZyBwYXJlbnRzXG5cblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gZ2V0Q2xpcHBpbmdSZWN0KGVsZW1lbnQsIGJvdW5kYXJ5LCByb290Qm91bmRhcnkpIHtcbiAgdmFyIG1haW5DbGlwcGluZ1BhcmVudHMgPSBib3VuZGFyeSA9PT0gJ2NsaXBwaW5nUGFyZW50cycgPyBnZXRDbGlwcGluZ1BhcmVudHMoZWxlbWVudCkgOiBbXS5jb25jYXQoYm91bmRhcnkpO1xuICB2YXIgY2xpcHBpbmdQYXJlbnRzID0gW10uY29uY2F0KG1haW5DbGlwcGluZ1BhcmVudHMsIFtyb290Qm91bmRhcnldKTtcbiAgdmFyIGZpcnN0Q2xpcHBpbmdQYXJlbnQgPSBjbGlwcGluZ1BhcmVudHNbMF07XG4gIHZhciBjbGlwcGluZ1JlY3QgPSBjbGlwcGluZ1BhcmVudHMucmVkdWNlKGZ1bmN0aW9uIChhY2NSZWN0LCBjbGlwcGluZ1BhcmVudCkge1xuICAgIHZhciByZWN0ID0gZ2V0Q2xpZW50UmVjdEZyb21NaXhlZFR5cGUoZWxlbWVudCwgY2xpcHBpbmdQYXJlbnQpO1xuICAgIGFjY1JlY3QudG9wID0gbWF4KHJlY3QudG9wLCBhY2NSZWN0LnRvcCk7XG4gICAgYWNjUmVjdC5yaWdodCA9IG1pbihyZWN0LnJpZ2h0LCBhY2NSZWN0LnJpZ2h0KTtcbiAgICBhY2NSZWN0LmJvdHRvbSA9IG1pbihyZWN0LmJvdHRvbSwgYWNjUmVjdC5ib3R0b20pO1xuICAgIGFjY1JlY3QubGVmdCA9IG1heChyZWN0LmxlZnQsIGFjY1JlY3QubGVmdCk7XG4gICAgcmV0dXJuIGFjY1JlY3Q7XG4gIH0sIGdldENsaWVudFJlY3RGcm9tTWl4ZWRUeXBlKGVsZW1lbnQsIGZpcnN0Q2xpcHBpbmdQYXJlbnQpKTtcbiAgY2xpcHBpbmdSZWN0LndpZHRoID0gY2xpcHBpbmdSZWN0LnJpZ2h0IC0gY2xpcHBpbmdSZWN0LmxlZnQ7XG4gIGNsaXBwaW5nUmVjdC5oZWlnaHQgPSBjbGlwcGluZ1JlY3QuYm90dG9tIC0gY2xpcHBpbmdSZWN0LnRvcDtcbiAgY2xpcHBpbmdSZWN0LnggPSBjbGlwcGluZ1JlY3QubGVmdDtcbiAgY2xpcHBpbmdSZWN0LnkgPSBjbGlwcGluZ1JlY3QudG9wO1xuICByZXR1cm4gY2xpcHBpbmdSZWN0O1xufSIsICJpbXBvcnQgZ2V0QmFzZVBsYWNlbWVudCBmcm9tIFwiLi9nZXRCYXNlUGxhY2VtZW50LmpzXCI7XG5pbXBvcnQgZ2V0VmFyaWF0aW9uIGZyb20gXCIuL2dldFZhcmlhdGlvbi5qc1wiO1xuaW1wb3J0IGdldE1haW5BeGlzRnJvbVBsYWNlbWVudCBmcm9tIFwiLi9nZXRNYWluQXhpc0Zyb21QbGFjZW1lbnQuanNcIjtcbmltcG9ydCB7IHRvcCwgcmlnaHQsIGJvdHRvbSwgbGVmdCwgc3RhcnQsIGVuZCB9IGZyb20gXCIuLi9lbnVtcy5qc1wiO1xuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gY29tcHV0ZU9mZnNldHMoX3JlZikge1xuICB2YXIgcmVmZXJlbmNlID0gX3JlZi5yZWZlcmVuY2UsXG4gICAgICBlbGVtZW50ID0gX3JlZi5lbGVtZW50LFxuICAgICAgcGxhY2VtZW50ID0gX3JlZi5wbGFjZW1lbnQ7XG4gIHZhciBiYXNlUGxhY2VtZW50ID0gcGxhY2VtZW50ID8gZ2V0QmFzZVBsYWNlbWVudChwbGFjZW1lbnQpIDogbnVsbDtcbiAgdmFyIHZhcmlhdGlvbiA9IHBsYWNlbWVudCA/IGdldFZhcmlhdGlvbihwbGFjZW1lbnQpIDogbnVsbDtcbiAgdmFyIGNvbW1vblggPSByZWZlcmVuY2UueCArIHJlZmVyZW5jZS53aWR0aCAvIDIgLSBlbGVtZW50LndpZHRoIC8gMjtcbiAgdmFyIGNvbW1vblkgPSByZWZlcmVuY2UueSArIHJlZmVyZW5jZS5oZWlnaHQgLyAyIC0gZWxlbWVudC5oZWlnaHQgLyAyO1xuICB2YXIgb2Zmc2V0cztcblxuICBzd2l0Y2ggKGJhc2VQbGFjZW1lbnQpIHtcbiAgICBjYXNlIHRvcDpcbiAgICAgIG9mZnNldHMgPSB7XG4gICAgICAgIHg6IGNvbW1vblgsXG4gICAgICAgIHk6IHJlZmVyZW5jZS55IC0gZWxlbWVudC5oZWlnaHRcbiAgICAgIH07XG4gICAgICBicmVhaztcblxuICAgIGNhc2UgYm90dG9tOlxuICAgICAgb2Zmc2V0cyA9IHtcbiAgICAgICAgeDogY29tbW9uWCxcbiAgICAgICAgeTogcmVmZXJlbmNlLnkgKyByZWZlcmVuY2UuaGVpZ2h0XG4gICAgICB9O1xuICAgICAgYnJlYWs7XG5cbiAgICBjYXNlIHJpZ2h0OlxuICAgICAgb2Zmc2V0cyA9IHtcbiAgICAgICAgeDogcmVmZXJlbmNlLnggKyByZWZlcmVuY2Uud2lkdGgsXG4gICAgICAgIHk6IGNvbW1vbllcbiAgICAgIH07XG4gICAgICBicmVhaztcblxuICAgIGNhc2UgbGVmdDpcbiAgICAgIG9mZnNldHMgPSB7XG4gICAgICAgIHg6IHJlZmVyZW5jZS54IC0gZWxlbWVudC53aWR0aCxcbiAgICAgICAgeTogY29tbW9uWVxuICAgICAgfTtcbiAgICAgIGJyZWFrO1xuXG4gICAgZGVmYXVsdDpcbiAgICAgIG9mZnNldHMgPSB7XG4gICAgICAgIHg6IHJlZmVyZW5jZS54LFxuICAgICAgICB5OiByZWZlcmVuY2UueVxuICAgICAgfTtcbiAgfVxuXG4gIHZhciBtYWluQXhpcyA9IGJhc2VQbGFjZW1lbnQgPyBnZXRNYWluQXhpc0Zyb21QbGFjZW1lbnQoYmFzZVBsYWNlbWVudCkgOiBudWxsO1xuXG4gIGlmIChtYWluQXhpcyAhPSBudWxsKSB7XG4gICAgdmFyIGxlbiA9IG1haW5BeGlzID09PSAneScgPyAnaGVpZ2h0JyA6ICd3aWR0aCc7XG5cbiAgICBzd2l0Y2ggKHZhcmlhdGlvbikge1xuICAgICAgY2FzZSBzdGFydDpcbiAgICAgICAgb2Zmc2V0c1ttYWluQXhpc10gPSBvZmZzZXRzW21haW5BeGlzXSAtIChyZWZlcmVuY2VbbGVuXSAvIDIgLSBlbGVtZW50W2xlbl0gLyAyKTtcbiAgICAgICAgYnJlYWs7XG5cbiAgICAgIGNhc2UgZW5kOlxuICAgICAgICBvZmZzZXRzW21haW5BeGlzXSA9IG9mZnNldHNbbWFpbkF4aXNdICsgKHJlZmVyZW5jZVtsZW5dIC8gMiAtIGVsZW1lbnRbbGVuXSAvIDIpO1xuICAgICAgICBicmVhaztcblxuICAgICAgZGVmYXVsdDpcbiAgICB9XG4gIH1cblxuICByZXR1cm4gb2Zmc2V0cztcbn0iLCAiaW1wb3J0IGdldENsaXBwaW5nUmVjdCBmcm9tIFwiLi4vZG9tLXV0aWxzL2dldENsaXBwaW5nUmVjdC5qc1wiO1xuaW1wb3J0IGdldERvY3VtZW50RWxlbWVudCBmcm9tIFwiLi4vZG9tLXV0aWxzL2dldERvY3VtZW50RWxlbWVudC5qc1wiO1xuaW1wb3J0IGdldEJvdW5kaW5nQ2xpZW50UmVjdCBmcm9tIFwiLi4vZG9tLXV0aWxzL2dldEJvdW5kaW5nQ2xpZW50UmVjdC5qc1wiO1xuaW1wb3J0IGNvbXB1dGVPZmZzZXRzIGZyb20gXCIuL2NvbXB1dGVPZmZzZXRzLmpzXCI7XG5pbXBvcnQgcmVjdFRvQ2xpZW50UmVjdCBmcm9tIFwiLi9yZWN0VG9DbGllbnRSZWN0LmpzXCI7XG5pbXBvcnQgeyBjbGlwcGluZ1BhcmVudHMsIHJlZmVyZW5jZSwgcG9wcGVyLCBib3R0b20sIHRvcCwgcmlnaHQsIGJhc2VQbGFjZW1lbnRzLCB2aWV3cG9ydCB9IGZyb20gXCIuLi9lbnVtcy5qc1wiO1xuaW1wb3J0IHsgaXNFbGVtZW50IH0gZnJvbSBcIi4uL2RvbS11dGlscy9pbnN0YW5jZU9mLmpzXCI7XG5pbXBvcnQgbWVyZ2VQYWRkaW5nT2JqZWN0IGZyb20gXCIuL21lcmdlUGFkZGluZ09iamVjdC5qc1wiO1xuaW1wb3J0IGV4cGFuZFRvSGFzaE1hcCBmcm9tIFwiLi9leHBhbmRUb0hhc2hNYXAuanNcIjsgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGltcG9ydC9uby11bnVzZWQtbW9kdWxlc1xuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBkZXRlY3RPdmVyZmxvdyhzdGF0ZSwgb3B0aW9ucykge1xuICBpZiAob3B0aW9ucyA9PT0gdm9pZCAwKSB7XG4gICAgb3B0aW9ucyA9IHt9O1xuICB9XG5cbiAgdmFyIF9vcHRpb25zID0gb3B0aW9ucyxcbiAgICAgIF9vcHRpb25zJHBsYWNlbWVudCA9IF9vcHRpb25zLnBsYWNlbWVudCxcbiAgICAgIHBsYWNlbWVudCA9IF9vcHRpb25zJHBsYWNlbWVudCA9PT0gdm9pZCAwID8gc3RhdGUucGxhY2VtZW50IDogX29wdGlvbnMkcGxhY2VtZW50LFxuICAgICAgX29wdGlvbnMkYm91bmRhcnkgPSBfb3B0aW9ucy5ib3VuZGFyeSxcbiAgICAgIGJvdW5kYXJ5ID0gX29wdGlvbnMkYm91bmRhcnkgPT09IHZvaWQgMCA/IGNsaXBwaW5nUGFyZW50cyA6IF9vcHRpb25zJGJvdW5kYXJ5LFxuICAgICAgX29wdGlvbnMkcm9vdEJvdW5kYXJ5ID0gX29wdGlvbnMucm9vdEJvdW5kYXJ5LFxuICAgICAgcm9vdEJvdW5kYXJ5ID0gX29wdGlvbnMkcm9vdEJvdW5kYXJ5ID09PSB2b2lkIDAgPyB2aWV3cG9ydCA6IF9vcHRpb25zJHJvb3RCb3VuZGFyeSxcbiAgICAgIF9vcHRpb25zJGVsZW1lbnRDb250ZSA9IF9vcHRpb25zLmVsZW1lbnRDb250ZXh0LFxuICAgICAgZWxlbWVudENvbnRleHQgPSBfb3B0aW9ucyRlbGVtZW50Q29udGUgPT09IHZvaWQgMCA/IHBvcHBlciA6IF9vcHRpb25zJGVsZW1lbnRDb250ZSxcbiAgICAgIF9vcHRpb25zJGFsdEJvdW5kYXJ5ID0gX29wdGlvbnMuYWx0Qm91bmRhcnksXG4gICAgICBhbHRCb3VuZGFyeSA9IF9vcHRpb25zJGFsdEJvdW5kYXJ5ID09PSB2b2lkIDAgPyBmYWxzZSA6IF9vcHRpb25zJGFsdEJvdW5kYXJ5LFxuICAgICAgX29wdGlvbnMkcGFkZGluZyA9IF9vcHRpb25zLnBhZGRpbmcsXG4gICAgICBwYWRkaW5nID0gX29wdGlvbnMkcGFkZGluZyA9PT0gdm9pZCAwID8gMCA6IF9vcHRpb25zJHBhZGRpbmc7XG4gIHZhciBwYWRkaW5nT2JqZWN0ID0gbWVyZ2VQYWRkaW5nT2JqZWN0KHR5cGVvZiBwYWRkaW5nICE9PSAnbnVtYmVyJyA/IHBhZGRpbmcgOiBleHBhbmRUb0hhc2hNYXAocGFkZGluZywgYmFzZVBsYWNlbWVudHMpKTtcbiAgdmFyIGFsdENvbnRleHQgPSBlbGVtZW50Q29udGV4dCA9PT0gcG9wcGVyID8gcmVmZXJlbmNlIDogcG9wcGVyO1xuICB2YXIgcG9wcGVyUmVjdCA9IHN0YXRlLnJlY3RzLnBvcHBlcjtcbiAgdmFyIGVsZW1lbnQgPSBzdGF0ZS5lbGVtZW50c1thbHRCb3VuZGFyeSA/IGFsdENvbnRleHQgOiBlbGVtZW50Q29udGV4dF07XG4gIHZhciBjbGlwcGluZ0NsaWVudFJlY3QgPSBnZXRDbGlwcGluZ1JlY3QoaXNFbGVtZW50KGVsZW1lbnQpID8gZWxlbWVudCA6IGVsZW1lbnQuY29udGV4dEVsZW1lbnQgfHwgZ2V0RG9jdW1lbnRFbGVtZW50KHN0YXRlLmVsZW1lbnRzLnBvcHBlciksIGJvdW5kYXJ5LCByb290Qm91bmRhcnkpO1xuICB2YXIgcmVmZXJlbmNlQ2xpZW50UmVjdCA9IGdldEJvdW5kaW5nQ2xpZW50UmVjdChzdGF0ZS5lbGVtZW50cy5yZWZlcmVuY2UpO1xuICB2YXIgcG9wcGVyT2Zmc2V0cyA9IGNvbXB1dGVPZmZzZXRzKHtcbiAgICByZWZlcmVuY2U6IHJlZmVyZW5jZUNsaWVudFJlY3QsXG4gICAgZWxlbWVudDogcG9wcGVyUmVjdCxcbiAgICBzdHJhdGVneTogJ2Fic29sdXRlJyxcbiAgICBwbGFjZW1lbnQ6IHBsYWNlbWVudFxuICB9KTtcbiAgdmFyIHBvcHBlckNsaWVudFJlY3QgPSByZWN0VG9DbGllbnRSZWN0KE9iamVjdC5hc3NpZ24oe30sIHBvcHBlclJlY3QsIHBvcHBlck9mZnNldHMpKTtcbiAgdmFyIGVsZW1lbnRDbGllbnRSZWN0ID0gZWxlbWVudENvbnRleHQgPT09IHBvcHBlciA/IHBvcHBlckNsaWVudFJlY3QgOiByZWZlcmVuY2VDbGllbnRSZWN0OyAvLyBwb3NpdGl2ZSA9IG92ZXJmbG93aW5nIHRoZSBjbGlwcGluZyByZWN0XG4gIC8vIDAgb3IgbmVnYXRpdmUgPSB3aXRoaW4gdGhlIGNsaXBwaW5nIHJlY3RcblxuICB2YXIgb3ZlcmZsb3dPZmZzZXRzID0ge1xuICAgIHRvcDogY2xpcHBpbmdDbGllbnRSZWN0LnRvcCAtIGVsZW1lbnRDbGllbnRSZWN0LnRvcCArIHBhZGRpbmdPYmplY3QudG9wLFxuICAgIGJvdHRvbTogZWxlbWVudENsaWVudFJlY3QuYm90dG9tIC0gY2xpcHBpbmdDbGllbnRSZWN0LmJvdHRvbSArIHBhZGRpbmdPYmplY3QuYm90dG9tLFxuICAgIGxlZnQ6IGNsaXBwaW5nQ2xpZW50UmVjdC5sZWZ0IC0gZWxlbWVudENsaWVudFJlY3QubGVmdCArIHBhZGRpbmdPYmplY3QubGVmdCxcbiAgICByaWdodDogZWxlbWVudENsaWVudFJlY3QucmlnaHQgLSBjbGlwcGluZ0NsaWVudFJlY3QucmlnaHQgKyBwYWRkaW5nT2JqZWN0LnJpZ2h0XG4gIH07XG4gIHZhciBvZmZzZXREYXRhID0gc3RhdGUubW9kaWZpZXJzRGF0YS5vZmZzZXQ7IC8vIE9mZnNldHMgY2FuIGJlIGFwcGxpZWQgb25seSB0byB0aGUgcG9wcGVyIGVsZW1lbnRcblxuICBpZiAoZWxlbWVudENvbnRleHQgPT09IHBvcHBlciAmJiBvZmZzZXREYXRhKSB7XG4gICAgdmFyIG9mZnNldCA9IG9mZnNldERhdGFbcGxhY2VtZW50XTtcbiAgICBPYmplY3Qua2V5cyhvdmVyZmxvd09mZnNldHMpLmZvckVhY2goZnVuY3Rpb24gKGtleSkge1xuICAgICAgdmFyIG11bHRpcGx5ID0gW3JpZ2h0LCBib3R0b21dLmluZGV4T2Yoa2V5KSA+PSAwID8gMSA6IC0xO1xuICAgICAgdmFyIGF4aXMgPSBbdG9wLCBib3R0b21dLmluZGV4T2Yoa2V5KSA+PSAwID8gJ3knIDogJ3gnO1xuICAgICAgb3ZlcmZsb3dPZmZzZXRzW2tleV0gKz0gb2Zmc2V0W2F4aXNdICogbXVsdGlwbHk7XG4gICAgfSk7XG4gIH1cblxuICByZXR1cm4gb3ZlcmZsb3dPZmZzZXRzO1xufSIsICJpbXBvcnQgZ2V0VmFyaWF0aW9uIGZyb20gXCIuL2dldFZhcmlhdGlvbi5qc1wiO1xuaW1wb3J0IHsgdmFyaWF0aW9uUGxhY2VtZW50cywgYmFzZVBsYWNlbWVudHMsIHBsYWNlbWVudHMgYXMgYWxsUGxhY2VtZW50cyB9IGZyb20gXCIuLi9lbnVtcy5qc1wiO1xuaW1wb3J0IGRldGVjdE92ZXJmbG93IGZyb20gXCIuL2RldGVjdE92ZXJmbG93LmpzXCI7XG5pbXBvcnQgZ2V0QmFzZVBsYWNlbWVudCBmcm9tIFwiLi9nZXRCYXNlUGxhY2VtZW50LmpzXCI7XG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBjb21wdXRlQXV0b1BsYWNlbWVudChzdGF0ZSwgb3B0aW9ucykge1xuICBpZiAob3B0aW9ucyA9PT0gdm9pZCAwKSB7XG4gICAgb3B0aW9ucyA9IHt9O1xuICB9XG5cbiAgdmFyIF9vcHRpb25zID0gb3B0aW9ucyxcbiAgICAgIHBsYWNlbWVudCA9IF9vcHRpb25zLnBsYWNlbWVudCxcbiAgICAgIGJvdW5kYXJ5ID0gX29wdGlvbnMuYm91bmRhcnksXG4gICAgICByb290Qm91bmRhcnkgPSBfb3B0aW9ucy5yb290Qm91bmRhcnksXG4gICAgICBwYWRkaW5nID0gX29wdGlvbnMucGFkZGluZyxcbiAgICAgIGZsaXBWYXJpYXRpb25zID0gX29wdGlvbnMuZmxpcFZhcmlhdGlvbnMsXG4gICAgICBfb3B0aW9ucyRhbGxvd2VkQXV0b1AgPSBfb3B0aW9ucy5hbGxvd2VkQXV0b1BsYWNlbWVudHMsXG4gICAgICBhbGxvd2VkQXV0b1BsYWNlbWVudHMgPSBfb3B0aW9ucyRhbGxvd2VkQXV0b1AgPT09IHZvaWQgMCA/IGFsbFBsYWNlbWVudHMgOiBfb3B0aW9ucyRhbGxvd2VkQXV0b1A7XG4gIHZhciB2YXJpYXRpb24gPSBnZXRWYXJpYXRpb24ocGxhY2VtZW50KTtcbiAgdmFyIHBsYWNlbWVudHMgPSB2YXJpYXRpb24gPyBmbGlwVmFyaWF0aW9ucyA/IHZhcmlhdGlvblBsYWNlbWVudHMgOiB2YXJpYXRpb25QbGFjZW1lbnRzLmZpbHRlcihmdW5jdGlvbiAocGxhY2VtZW50KSB7XG4gICAgcmV0dXJuIGdldFZhcmlhdGlvbihwbGFjZW1lbnQpID09PSB2YXJpYXRpb247XG4gIH0pIDogYmFzZVBsYWNlbWVudHM7XG4gIHZhciBhbGxvd2VkUGxhY2VtZW50cyA9IHBsYWNlbWVudHMuZmlsdGVyKGZ1bmN0aW9uIChwbGFjZW1lbnQpIHtcbiAgICByZXR1cm4gYWxsb3dlZEF1dG9QbGFjZW1lbnRzLmluZGV4T2YocGxhY2VtZW50KSA+PSAwO1xuICB9KTtcblxuICBpZiAoYWxsb3dlZFBsYWNlbWVudHMubGVuZ3RoID09PSAwKSB7XG4gICAgYWxsb3dlZFBsYWNlbWVudHMgPSBwbGFjZW1lbnRzO1xuXG4gICAgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSBcInByb2R1Y3Rpb25cIikge1xuICAgICAgY29uc29sZS5lcnJvcihbJ1BvcHBlcjogVGhlIGBhbGxvd2VkQXV0b1BsYWNlbWVudHNgIG9wdGlvbiBkaWQgbm90IGFsbG93IGFueScsICdwbGFjZW1lbnRzLiBFbnN1cmUgdGhlIGBwbGFjZW1lbnRgIG9wdGlvbiBtYXRjaGVzIHRoZSB2YXJpYXRpb24nLCAnb2YgdGhlIGFsbG93ZWQgcGxhY2VtZW50cy4nLCAnRm9yIGV4YW1wbGUsIFwiYXV0b1wiIGNhbm5vdCBiZSB1c2VkIHRvIGFsbG93IFwiYm90dG9tLXN0YXJ0XCIuJywgJ1VzZSBcImF1dG8tc3RhcnRcIiBpbnN0ZWFkLiddLmpvaW4oJyAnKSk7XG4gICAgfVxuICB9IC8vICRGbG93Rml4TWVbaW5jb21wYXRpYmxlLXR5cGVdOiBGbG93IHNlZW1zIHRvIGhhdmUgcHJvYmxlbXMgd2l0aCB0d28gYXJyYXkgdW5pb25zLi4uXG5cblxuICB2YXIgb3ZlcmZsb3dzID0gYWxsb3dlZFBsYWNlbWVudHMucmVkdWNlKGZ1bmN0aW9uIChhY2MsIHBsYWNlbWVudCkge1xuICAgIGFjY1twbGFjZW1lbnRdID0gZGV0ZWN0T3ZlcmZsb3coc3RhdGUsIHtcbiAgICAgIHBsYWNlbWVudDogcGxhY2VtZW50LFxuICAgICAgYm91bmRhcnk6IGJvdW5kYXJ5LFxuICAgICAgcm9vdEJvdW5kYXJ5OiByb290Qm91bmRhcnksXG4gICAgICBwYWRkaW5nOiBwYWRkaW5nXG4gICAgfSlbZ2V0QmFzZVBsYWNlbWVudChwbGFjZW1lbnQpXTtcbiAgICByZXR1cm4gYWNjO1xuICB9LCB7fSk7XG4gIHJldHVybiBPYmplY3Qua2V5cyhvdmVyZmxvd3MpLnNvcnQoZnVuY3Rpb24gKGEsIGIpIHtcbiAgICByZXR1cm4gb3ZlcmZsb3dzW2FdIC0gb3ZlcmZsb3dzW2JdO1xuICB9KTtcbn0iLCAiaW1wb3J0IGdldE9wcG9zaXRlUGxhY2VtZW50IGZyb20gXCIuLi91dGlscy9nZXRPcHBvc2l0ZVBsYWNlbWVudC5qc1wiO1xuaW1wb3J0IGdldEJhc2VQbGFjZW1lbnQgZnJvbSBcIi4uL3V0aWxzL2dldEJhc2VQbGFjZW1lbnQuanNcIjtcbmltcG9ydCBnZXRPcHBvc2l0ZVZhcmlhdGlvblBsYWNlbWVudCBmcm9tIFwiLi4vdXRpbHMvZ2V0T3Bwb3NpdGVWYXJpYXRpb25QbGFjZW1lbnQuanNcIjtcbmltcG9ydCBkZXRlY3RPdmVyZmxvdyBmcm9tIFwiLi4vdXRpbHMvZGV0ZWN0T3ZlcmZsb3cuanNcIjtcbmltcG9ydCBjb21wdXRlQXV0b1BsYWNlbWVudCBmcm9tIFwiLi4vdXRpbHMvY29tcHV0ZUF1dG9QbGFjZW1lbnQuanNcIjtcbmltcG9ydCB7IGJvdHRvbSwgdG9wLCBzdGFydCwgcmlnaHQsIGxlZnQsIGF1dG8gfSBmcm9tIFwiLi4vZW51bXMuanNcIjtcbmltcG9ydCBnZXRWYXJpYXRpb24gZnJvbSBcIi4uL3V0aWxzL2dldFZhcmlhdGlvbi5qc1wiOyAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgaW1wb3J0L25vLXVudXNlZC1tb2R1bGVzXG5cbmZ1bmN0aW9uIGdldEV4cGFuZGVkRmFsbGJhY2tQbGFjZW1lbnRzKHBsYWNlbWVudCkge1xuICBpZiAoZ2V0QmFzZVBsYWNlbWVudChwbGFjZW1lbnQpID09PSBhdXRvKSB7XG4gICAgcmV0dXJuIFtdO1xuICB9XG5cbiAgdmFyIG9wcG9zaXRlUGxhY2VtZW50ID0gZ2V0T3Bwb3NpdGVQbGFjZW1lbnQocGxhY2VtZW50KTtcbiAgcmV0dXJuIFtnZXRPcHBvc2l0ZVZhcmlhdGlvblBsYWNlbWVudChwbGFjZW1lbnQpLCBvcHBvc2l0ZVBsYWNlbWVudCwgZ2V0T3Bwb3NpdGVWYXJpYXRpb25QbGFjZW1lbnQob3Bwb3NpdGVQbGFjZW1lbnQpXTtcbn1cblxuZnVuY3Rpb24gZmxpcChfcmVmKSB7XG4gIHZhciBzdGF0ZSA9IF9yZWYuc3RhdGUsXG4gICAgICBvcHRpb25zID0gX3JlZi5vcHRpb25zLFxuICAgICAgbmFtZSA9IF9yZWYubmFtZTtcblxuICBpZiAoc3RhdGUubW9kaWZpZXJzRGF0YVtuYW1lXS5fc2tpcCkge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIHZhciBfb3B0aW9ucyRtYWluQXhpcyA9IG9wdGlvbnMubWFpbkF4aXMsXG4gICAgICBjaGVja01haW5BeGlzID0gX29wdGlvbnMkbWFpbkF4aXMgPT09IHZvaWQgMCA/IHRydWUgOiBfb3B0aW9ucyRtYWluQXhpcyxcbiAgICAgIF9vcHRpb25zJGFsdEF4aXMgPSBvcHRpb25zLmFsdEF4aXMsXG4gICAgICBjaGVja0FsdEF4aXMgPSBfb3B0aW9ucyRhbHRBeGlzID09PSB2b2lkIDAgPyB0cnVlIDogX29wdGlvbnMkYWx0QXhpcyxcbiAgICAgIHNwZWNpZmllZEZhbGxiYWNrUGxhY2VtZW50cyA9IG9wdGlvbnMuZmFsbGJhY2tQbGFjZW1lbnRzLFxuICAgICAgcGFkZGluZyA9IG9wdGlvbnMucGFkZGluZyxcbiAgICAgIGJvdW5kYXJ5ID0gb3B0aW9ucy5ib3VuZGFyeSxcbiAgICAgIHJvb3RCb3VuZGFyeSA9IG9wdGlvbnMucm9vdEJvdW5kYXJ5LFxuICAgICAgYWx0Qm91bmRhcnkgPSBvcHRpb25zLmFsdEJvdW5kYXJ5LFxuICAgICAgX29wdGlvbnMkZmxpcFZhcmlhdGlvID0gb3B0aW9ucy5mbGlwVmFyaWF0aW9ucyxcbiAgICAgIGZsaXBWYXJpYXRpb25zID0gX29wdGlvbnMkZmxpcFZhcmlhdGlvID09PSB2b2lkIDAgPyB0cnVlIDogX29wdGlvbnMkZmxpcFZhcmlhdGlvLFxuICAgICAgYWxsb3dlZEF1dG9QbGFjZW1lbnRzID0gb3B0aW9ucy5hbGxvd2VkQXV0b1BsYWNlbWVudHM7XG4gIHZhciBwcmVmZXJyZWRQbGFjZW1lbnQgPSBzdGF0ZS5vcHRpb25zLnBsYWNlbWVudDtcbiAgdmFyIGJhc2VQbGFjZW1lbnQgPSBnZXRCYXNlUGxhY2VtZW50KHByZWZlcnJlZFBsYWNlbWVudCk7XG4gIHZhciBpc0Jhc2VQbGFjZW1lbnQgPSBiYXNlUGxhY2VtZW50ID09PSBwcmVmZXJyZWRQbGFjZW1lbnQ7XG4gIHZhciBmYWxsYmFja1BsYWNlbWVudHMgPSBzcGVjaWZpZWRGYWxsYmFja1BsYWNlbWVudHMgfHwgKGlzQmFzZVBsYWNlbWVudCB8fCAhZmxpcFZhcmlhdGlvbnMgPyBbZ2V0T3Bwb3NpdGVQbGFjZW1lbnQocHJlZmVycmVkUGxhY2VtZW50KV0gOiBnZXRFeHBhbmRlZEZhbGxiYWNrUGxhY2VtZW50cyhwcmVmZXJyZWRQbGFjZW1lbnQpKTtcbiAgdmFyIHBsYWNlbWVudHMgPSBbcHJlZmVycmVkUGxhY2VtZW50XS5jb25jYXQoZmFsbGJhY2tQbGFjZW1lbnRzKS5yZWR1Y2UoZnVuY3Rpb24gKGFjYywgcGxhY2VtZW50KSB7XG4gICAgcmV0dXJuIGFjYy5jb25jYXQoZ2V0QmFzZVBsYWNlbWVudChwbGFjZW1lbnQpID09PSBhdXRvID8gY29tcHV0ZUF1dG9QbGFjZW1lbnQoc3RhdGUsIHtcbiAgICAgIHBsYWNlbWVudDogcGxhY2VtZW50LFxuICAgICAgYm91bmRhcnk6IGJvdW5kYXJ5LFxuICAgICAgcm9vdEJvdW5kYXJ5OiByb290Qm91bmRhcnksXG4gICAgICBwYWRkaW5nOiBwYWRkaW5nLFxuICAgICAgZmxpcFZhcmlhdGlvbnM6IGZsaXBWYXJpYXRpb25zLFxuICAgICAgYWxsb3dlZEF1dG9QbGFjZW1lbnRzOiBhbGxvd2VkQXV0b1BsYWNlbWVudHNcbiAgICB9KSA6IHBsYWNlbWVudCk7XG4gIH0sIFtdKTtcbiAgdmFyIHJlZmVyZW5jZVJlY3QgPSBzdGF0ZS5yZWN0cy5yZWZlcmVuY2U7XG4gIHZhciBwb3BwZXJSZWN0ID0gc3RhdGUucmVjdHMucG9wcGVyO1xuICB2YXIgY2hlY2tzTWFwID0gbmV3IE1hcCgpO1xuICB2YXIgbWFrZUZhbGxiYWNrQ2hlY2tzID0gdHJ1ZTtcbiAgdmFyIGZpcnN0Rml0dGluZ1BsYWNlbWVudCA9IHBsYWNlbWVudHNbMF07XG5cbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBwbGFjZW1lbnRzLmxlbmd0aDsgaSsrKSB7XG4gICAgdmFyIHBsYWNlbWVudCA9IHBsYWNlbWVudHNbaV07XG5cbiAgICB2YXIgX2Jhc2VQbGFjZW1lbnQgPSBnZXRCYXNlUGxhY2VtZW50KHBsYWNlbWVudCk7XG5cbiAgICB2YXIgaXNTdGFydFZhcmlhdGlvbiA9IGdldFZhcmlhdGlvbihwbGFjZW1lbnQpID09PSBzdGFydDtcbiAgICB2YXIgaXNWZXJ0aWNhbCA9IFt0b3AsIGJvdHRvbV0uaW5kZXhPZihfYmFzZVBsYWNlbWVudCkgPj0gMDtcbiAgICB2YXIgbGVuID0gaXNWZXJ0aWNhbCA/ICd3aWR0aCcgOiAnaGVpZ2h0JztcbiAgICB2YXIgb3ZlcmZsb3cgPSBkZXRlY3RPdmVyZmxvdyhzdGF0ZSwge1xuICAgICAgcGxhY2VtZW50OiBwbGFjZW1lbnQsXG4gICAgICBib3VuZGFyeTogYm91bmRhcnksXG4gICAgICByb290Qm91bmRhcnk6IHJvb3RCb3VuZGFyeSxcbiAgICAgIGFsdEJvdW5kYXJ5OiBhbHRCb3VuZGFyeSxcbiAgICAgIHBhZGRpbmc6IHBhZGRpbmdcbiAgICB9KTtcbiAgICB2YXIgbWFpblZhcmlhdGlvblNpZGUgPSBpc1ZlcnRpY2FsID8gaXNTdGFydFZhcmlhdGlvbiA/IHJpZ2h0IDogbGVmdCA6IGlzU3RhcnRWYXJpYXRpb24gPyBib3R0b20gOiB0b3A7XG5cbiAgICBpZiAocmVmZXJlbmNlUmVjdFtsZW5dID4gcG9wcGVyUmVjdFtsZW5dKSB7XG4gICAgICBtYWluVmFyaWF0aW9uU2lkZSA9IGdldE9wcG9zaXRlUGxhY2VtZW50KG1haW5WYXJpYXRpb25TaWRlKTtcbiAgICB9XG5cbiAgICB2YXIgYWx0VmFyaWF0aW9uU2lkZSA9IGdldE9wcG9zaXRlUGxhY2VtZW50KG1haW5WYXJpYXRpb25TaWRlKTtcbiAgICB2YXIgY2hlY2tzID0gW107XG5cbiAgICBpZiAoY2hlY2tNYWluQXhpcykge1xuICAgICAgY2hlY2tzLnB1c2gob3ZlcmZsb3dbX2Jhc2VQbGFjZW1lbnRdIDw9IDApO1xuICAgIH1cblxuICAgIGlmIChjaGVja0FsdEF4aXMpIHtcbiAgICAgIGNoZWNrcy5wdXNoKG92ZXJmbG93W21haW5WYXJpYXRpb25TaWRlXSA8PSAwLCBvdmVyZmxvd1thbHRWYXJpYXRpb25TaWRlXSA8PSAwKTtcbiAgICB9XG5cbiAgICBpZiAoY2hlY2tzLmV2ZXJ5KGZ1bmN0aW9uIChjaGVjaykge1xuICAgICAgcmV0dXJuIGNoZWNrO1xuICAgIH0pKSB7XG4gICAgICBmaXJzdEZpdHRpbmdQbGFjZW1lbnQgPSBwbGFjZW1lbnQ7XG4gICAgICBtYWtlRmFsbGJhY2tDaGVja3MgPSBmYWxzZTtcbiAgICAgIGJyZWFrO1xuICAgIH1cblxuICAgIGNoZWNrc01hcC5zZXQocGxhY2VtZW50LCBjaGVja3MpO1xuICB9XG5cbiAgaWYgKG1ha2VGYWxsYmFja0NoZWNrcykge1xuICAgIC8vIGAyYCBtYXkgYmUgZGVzaXJlZCBpbiBzb21lIGNhc2VzIFx1MjAxMyByZXNlYXJjaCBsYXRlclxuICAgIHZhciBudW1iZXJPZkNoZWNrcyA9IGZsaXBWYXJpYXRpb25zID8gMyA6IDE7XG5cbiAgICB2YXIgX2xvb3AgPSBmdW5jdGlvbiBfbG9vcChfaSkge1xuICAgICAgdmFyIGZpdHRpbmdQbGFjZW1lbnQgPSBwbGFjZW1lbnRzLmZpbmQoZnVuY3Rpb24gKHBsYWNlbWVudCkge1xuICAgICAgICB2YXIgY2hlY2tzID0gY2hlY2tzTWFwLmdldChwbGFjZW1lbnQpO1xuXG4gICAgICAgIGlmIChjaGVja3MpIHtcbiAgICAgICAgICByZXR1cm4gY2hlY2tzLnNsaWNlKDAsIF9pKS5ldmVyeShmdW5jdGlvbiAoY2hlY2spIHtcbiAgICAgICAgICAgIHJldHVybiBjaGVjaztcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfSk7XG5cbiAgICAgIGlmIChmaXR0aW5nUGxhY2VtZW50KSB7XG4gICAgICAgIGZpcnN0Rml0dGluZ1BsYWNlbWVudCA9IGZpdHRpbmdQbGFjZW1lbnQ7XG4gICAgICAgIHJldHVybiBcImJyZWFrXCI7XG4gICAgICB9XG4gICAgfTtcblxuICAgIGZvciAodmFyIF9pID0gbnVtYmVyT2ZDaGVja3M7IF9pID4gMDsgX2ktLSkge1xuICAgICAgdmFyIF9yZXQgPSBfbG9vcChfaSk7XG5cbiAgICAgIGlmIChfcmV0ID09PSBcImJyZWFrXCIpIGJyZWFrO1xuICAgIH1cbiAgfVxuXG4gIGlmIChzdGF0ZS5wbGFjZW1lbnQgIT09IGZpcnN0Rml0dGluZ1BsYWNlbWVudCkge1xuICAgIHN0YXRlLm1vZGlmaWVyc0RhdGFbbmFtZV0uX3NraXAgPSB0cnVlO1xuICAgIHN0YXRlLnBsYWNlbWVudCA9IGZpcnN0Rml0dGluZ1BsYWNlbWVudDtcbiAgICBzdGF0ZS5yZXNldCA9IHRydWU7XG4gIH1cbn0gLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGltcG9ydC9uby11bnVzZWQtbW9kdWxlc1xuXG5cbmV4cG9ydCBkZWZhdWx0IHtcbiAgbmFtZTogJ2ZsaXAnLFxuICBlbmFibGVkOiB0cnVlLFxuICBwaGFzZTogJ21haW4nLFxuICBmbjogZmxpcCxcbiAgcmVxdWlyZXNJZkV4aXN0czogWydvZmZzZXQnXSxcbiAgZGF0YToge1xuICAgIF9za2lwOiBmYWxzZVxuICB9XG59OyIsICJpbXBvcnQgeyB0b3AsIGJvdHRvbSwgbGVmdCwgcmlnaHQgfSBmcm9tIFwiLi4vZW51bXMuanNcIjtcbmltcG9ydCBkZXRlY3RPdmVyZmxvdyBmcm9tIFwiLi4vdXRpbHMvZGV0ZWN0T3ZlcmZsb3cuanNcIjtcblxuZnVuY3Rpb24gZ2V0U2lkZU9mZnNldHMob3ZlcmZsb3csIHJlY3QsIHByZXZlbnRlZE9mZnNldHMpIHtcbiAgaWYgKHByZXZlbnRlZE9mZnNldHMgPT09IHZvaWQgMCkge1xuICAgIHByZXZlbnRlZE9mZnNldHMgPSB7XG4gICAgICB4OiAwLFxuICAgICAgeTogMFxuICAgIH07XG4gIH1cblxuICByZXR1cm4ge1xuICAgIHRvcDogb3ZlcmZsb3cudG9wIC0gcmVjdC5oZWlnaHQgLSBwcmV2ZW50ZWRPZmZzZXRzLnksXG4gICAgcmlnaHQ6IG92ZXJmbG93LnJpZ2h0IC0gcmVjdC53aWR0aCArIHByZXZlbnRlZE9mZnNldHMueCxcbiAgICBib3R0b206IG92ZXJmbG93LmJvdHRvbSAtIHJlY3QuaGVpZ2h0ICsgcHJldmVudGVkT2Zmc2V0cy55LFxuICAgIGxlZnQ6IG92ZXJmbG93LmxlZnQgLSByZWN0LndpZHRoIC0gcHJldmVudGVkT2Zmc2V0cy54XG4gIH07XG59XG5cbmZ1bmN0aW9uIGlzQW55U2lkZUZ1bGx5Q2xpcHBlZChvdmVyZmxvdykge1xuICByZXR1cm4gW3RvcCwgcmlnaHQsIGJvdHRvbSwgbGVmdF0uc29tZShmdW5jdGlvbiAoc2lkZSkge1xuICAgIHJldHVybiBvdmVyZmxvd1tzaWRlXSA+PSAwO1xuICB9KTtcbn1cblxuZnVuY3Rpb24gaGlkZShfcmVmKSB7XG4gIHZhciBzdGF0ZSA9IF9yZWYuc3RhdGUsXG4gICAgICBuYW1lID0gX3JlZi5uYW1lO1xuICB2YXIgcmVmZXJlbmNlUmVjdCA9IHN0YXRlLnJlY3RzLnJlZmVyZW5jZTtcbiAgdmFyIHBvcHBlclJlY3QgPSBzdGF0ZS5yZWN0cy5wb3BwZXI7XG4gIHZhciBwcmV2ZW50ZWRPZmZzZXRzID0gc3RhdGUubW9kaWZpZXJzRGF0YS5wcmV2ZW50T3ZlcmZsb3c7XG4gIHZhciByZWZlcmVuY2VPdmVyZmxvdyA9IGRldGVjdE92ZXJmbG93KHN0YXRlLCB7XG4gICAgZWxlbWVudENvbnRleHQ6ICdyZWZlcmVuY2UnXG4gIH0pO1xuICB2YXIgcG9wcGVyQWx0T3ZlcmZsb3cgPSBkZXRlY3RPdmVyZmxvdyhzdGF0ZSwge1xuICAgIGFsdEJvdW5kYXJ5OiB0cnVlXG4gIH0pO1xuICB2YXIgcmVmZXJlbmNlQ2xpcHBpbmdPZmZzZXRzID0gZ2V0U2lkZU9mZnNldHMocmVmZXJlbmNlT3ZlcmZsb3csIHJlZmVyZW5jZVJlY3QpO1xuICB2YXIgcG9wcGVyRXNjYXBlT2Zmc2V0cyA9IGdldFNpZGVPZmZzZXRzKHBvcHBlckFsdE92ZXJmbG93LCBwb3BwZXJSZWN0LCBwcmV2ZW50ZWRPZmZzZXRzKTtcbiAgdmFyIGlzUmVmZXJlbmNlSGlkZGVuID0gaXNBbnlTaWRlRnVsbHlDbGlwcGVkKHJlZmVyZW5jZUNsaXBwaW5nT2Zmc2V0cyk7XG4gIHZhciBoYXNQb3BwZXJFc2NhcGVkID0gaXNBbnlTaWRlRnVsbHlDbGlwcGVkKHBvcHBlckVzY2FwZU9mZnNldHMpO1xuICBzdGF0ZS5tb2RpZmllcnNEYXRhW25hbWVdID0ge1xuICAgIHJlZmVyZW5jZUNsaXBwaW5nT2Zmc2V0czogcmVmZXJlbmNlQ2xpcHBpbmdPZmZzZXRzLFxuICAgIHBvcHBlckVzY2FwZU9mZnNldHM6IHBvcHBlckVzY2FwZU9mZnNldHMsXG4gICAgaXNSZWZlcmVuY2VIaWRkZW46IGlzUmVmZXJlbmNlSGlkZGVuLFxuICAgIGhhc1BvcHBlckVzY2FwZWQ6IGhhc1BvcHBlckVzY2FwZWRcbiAgfTtcbiAgc3RhdGUuYXR0cmlidXRlcy5wb3BwZXIgPSBPYmplY3QuYXNzaWduKHt9LCBzdGF0ZS5hdHRyaWJ1dGVzLnBvcHBlciwge1xuICAgICdkYXRhLXBvcHBlci1yZWZlcmVuY2UtaGlkZGVuJzogaXNSZWZlcmVuY2VIaWRkZW4sXG4gICAgJ2RhdGEtcG9wcGVyLWVzY2FwZWQnOiBoYXNQb3BwZXJFc2NhcGVkXG4gIH0pO1xufSAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgaW1wb3J0L25vLXVudXNlZC1tb2R1bGVzXG5cblxuZXhwb3J0IGRlZmF1bHQge1xuICBuYW1lOiAnaGlkZScsXG4gIGVuYWJsZWQ6IHRydWUsXG4gIHBoYXNlOiAnbWFpbicsXG4gIHJlcXVpcmVzSWZFeGlzdHM6IFsncHJldmVudE92ZXJmbG93J10sXG4gIGZuOiBoaWRlXG59OyIsICJpbXBvcnQgZ2V0QmFzZVBsYWNlbWVudCBmcm9tIFwiLi4vdXRpbHMvZ2V0QmFzZVBsYWNlbWVudC5qc1wiO1xuaW1wb3J0IHsgdG9wLCBsZWZ0LCByaWdodCwgcGxhY2VtZW50cyB9IGZyb20gXCIuLi9lbnVtcy5qc1wiOyAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgaW1wb3J0L25vLXVudXNlZC1tb2R1bGVzXG5cbmV4cG9ydCBmdW5jdGlvbiBkaXN0YW5jZUFuZFNraWRkaW5nVG9YWShwbGFjZW1lbnQsIHJlY3RzLCBvZmZzZXQpIHtcbiAgdmFyIGJhc2VQbGFjZW1lbnQgPSBnZXRCYXNlUGxhY2VtZW50KHBsYWNlbWVudCk7XG4gIHZhciBpbnZlcnREaXN0YW5jZSA9IFtsZWZ0LCB0b3BdLmluZGV4T2YoYmFzZVBsYWNlbWVudCkgPj0gMCA/IC0xIDogMTtcblxuICB2YXIgX3JlZiA9IHR5cGVvZiBvZmZzZXQgPT09ICdmdW5jdGlvbicgPyBvZmZzZXQoT2JqZWN0LmFzc2lnbih7fSwgcmVjdHMsIHtcbiAgICBwbGFjZW1lbnQ6IHBsYWNlbWVudFxuICB9KSkgOiBvZmZzZXQsXG4gICAgICBza2lkZGluZyA9IF9yZWZbMF0sXG4gICAgICBkaXN0YW5jZSA9IF9yZWZbMV07XG5cbiAgc2tpZGRpbmcgPSBza2lkZGluZyB8fCAwO1xuICBkaXN0YW5jZSA9IChkaXN0YW5jZSB8fCAwKSAqIGludmVydERpc3RhbmNlO1xuICByZXR1cm4gW2xlZnQsIHJpZ2h0XS5pbmRleE9mKGJhc2VQbGFjZW1lbnQpID49IDAgPyB7XG4gICAgeDogZGlzdGFuY2UsXG4gICAgeTogc2tpZGRpbmdcbiAgfSA6IHtcbiAgICB4OiBza2lkZGluZyxcbiAgICB5OiBkaXN0YW5jZVxuICB9O1xufVxuXG5mdW5jdGlvbiBvZmZzZXQoX3JlZjIpIHtcbiAgdmFyIHN0YXRlID0gX3JlZjIuc3RhdGUsXG4gICAgICBvcHRpb25zID0gX3JlZjIub3B0aW9ucyxcbiAgICAgIG5hbWUgPSBfcmVmMi5uYW1lO1xuICB2YXIgX29wdGlvbnMkb2Zmc2V0ID0gb3B0aW9ucy5vZmZzZXQsXG4gICAgICBvZmZzZXQgPSBfb3B0aW9ucyRvZmZzZXQgPT09IHZvaWQgMCA/IFswLCAwXSA6IF9vcHRpb25zJG9mZnNldDtcbiAgdmFyIGRhdGEgPSBwbGFjZW1lbnRzLnJlZHVjZShmdW5jdGlvbiAoYWNjLCBwbGFjZW1lbnQpIHtcbiAgICBhY2NbcGxhY2VtZW50XSA9IGRpc3RhbmNlQW5kU2tpZGRpbmdUb1hZKHBsYWNlbWVudCwgc3RhdGUucmVjdHMsIG9mZnNldCk7XG4gICAgcmV0dXJuIGFjYztcbiAgfSwge30pO1xuICB2YXIgX2RhdGEkc3RhdGUkcGxhY2VtZW50ID0gZGF0YVtzdGF0ZS5wbGFjZW1lbnRdLFxuICAgICAgeCA9IF9kYXRhJHN0YXRlJHBsYWNlbWVudC54LFxuICAgICAgeSA9IF9kYXRhJHN0YXRlJHBsYWNlbWVudC55O1xuXG4gIGlmIChzdGF0ZS5tb2RpZmllcnNEYXRhLnBvcHBlck9mZnNldHMgIT0gbnVsbCkge1xuICAgIHN0YXRlLm1vZGlmaWVyc0RhdGEucG9wcGVyT2Zmc2V0cy54ICs9IHg7XG4gICAgc3RhdGUubW9kaWZpZXJzRGF0YS5wb3BwZXJPZmZzZXRzLnkgKz0geTtcbiAgfVxuXG4gIHN0YXRlLm1vZGlmaWVyc0RhdGFbbmFtZV0gPSBkYXRhO1xufSAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgaW1wb3J0L25vLXVudXNlZC1tb2R1bGVzXG5cblxuZXhwb3J0IGRlZmF1bHQge1xuICBuYW1lOiAnb2Zmc2V0JyxcbiAgZW5hYmxlZDogdHJ1ZSxcbiAgcGhhc2U6ICdtYWluJyxcbiAgcmVxdWlyZXM6IFsncG9wcGVyT2Zmc2V0cyddLFxuICBmbjogb2Zmc2V0XG59OyIsICJpbXBvcnQgY29tcHV0ZU9mZnNldHMgZnJvbSBcIi4uL3V0aWxzL2NvbXB1dGVPZmZzZXRzLmpzXCI7XG5cbmZ1bmN0aW9uIHBvcHBlck9mZnNldHMoX3JlZikge1xuICB2YXIgc3RhdGUgPSBfcmVmLnN0YXRlLFxuICAgICAgbmFtZSA9IF9yZWYubmFtZTtcbiAgLy8gT2Zmc2V0cyBhcmUgdGhlIGFjdHVhbCBwb3NpdGlvbiB0aGUgcG9wcGVyIG5lZWRzIHRvIGhhdmUgdG8gYmVcbiAgLy8gcHJvcGVybHkgcG9zaXRpb25lZCBuZWFyIGl0cyByZWZlcmVuY2UgZWxlbWVudFxuICAvLyBUaGlzIGlzIHRoZSBtb3N0IGJhc2ljIHBsYWNlbWVudCwgYW5kIHdpbGwgYmUgYWRqdXN0ZWQgYnlcbiAgLy8gdGhlIG1vZGlmaWVycyBpbiB0aGUgbmV4dCBzdGVwXG4gIHN0YXRlLm1vZGlmaWVyc0RhdGFbbmFtZV0gPSBjb21wdXRlT2Zmc2V0cyh7XG4gICAgcmVmZXJlbmNlOiBzdGF0ZS5yZWN0cy5yZWZlcmVuY2UsXG4gICAgZWxlbWVudDogc3RhdGUucmVjdHMucG9wcGVyLFxuICAgIHN0cmF0ZWd5OiAnYWJzb2x1dGUnLFxuICAgIHBsYWNlbWVudDogc3RhdGUucGxhY2VtZW50XG4gIH0pO1xufSAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgaW1wb3J0L25vLXVudXNlZC1tb2R1bGVzXG5cblxuZXhwb3J0IGRlZmF1bHQge1xuICBuYW1lOiAncG9wcGVyT2Zmc2V0cycsXG4gIGVuYWJsZWQ6IHRydWUsXG4gIHBoYXNlOiAncmVhZCcsXG4gIGZuOiBwb3BwZXJPZmZzZXRzLFxuICBkYXRhOiB7fVxufTsiLCAiZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gZ2V0QWx0QXhpcyhheGlzKSB7XG4gIHJldHVybiBheGlzID09PSAneCcgPyAneScgOiAneCc7XG59IiwgImltcG9ydCB7IHRvcCwgbGVmdCwgcmlnaHQsIGJvdHRvbSwgc3RhcnQgfSBmcm9tIFwiLi4vZW51bXMuanNcIjtcbmltcG9ydCBnZXRCYXNlUGxhY2VtZW50IGZyb20gXCIuLi91dGlscy9nZXRCYXNlUGxhY2VtZW50LmpzXCI7XG5pbXBvcnQgZ2V0TWFpbkF4aXNGcm9tUGxhY2VtZW50IGZyb20gXCIuLi91dGlscy9nZXRNYWluQXhpc0Zyb21QbGFjZW1lbnQuanNcIjtcbmltcG9ydCBnZXRBbHRBeGlzIGZyb20gXCIuLi91dGlscy9nZXRBbHRBeGlzLmpzXCI7XG5pbXBvcnQgeyB3aXRoaW4sIHdpdGhpbk1heENsYW1wIH0gZnJvbSBcIi4uL3V0aWxzL3dpdGhpbi5qc1wiO1xuaW1wb3J0IGdldExheW91dFJlY3QgZnJvbSBcIi4uL2RvbS11dGlscy9nZXRMYXlvdXRSZWN0LmpzXCI7XG5pbXBvcnQgZ2V0T2Zmc2V0UGFyZW50IGZyb20gXCIuLi9kb20tdXRpbHMvZ2V0T2Zmc2V0UGFyZW50LmpzXCI7XG5pbXBvcnQgZGV0ZWN0T3ZlcmZsb3cgZnJvbSBcIi4uL3V0aWxzL2RldGVjdE92ZXJmbG93LmpzXCI7XG5pbXBvcnQgZ2V0VmFyaWF0aW9uIGZyb20gXCIuLi91dGlscy9nZXRWYXJpYXRpb24uanNcIjtcbmltcG9ydCBnZXRGcmVzaFNpZGVPYmplY3QgZnJvbSBcIi4uL3V0aWxzL2dldEZyZXNoU2lkZU9iamVjdC5qc1wiO1xuaW1wb3J0IHsgbWluIGFzIG1hdGhNaW4sIG1heCBhcyBtYXRoTWF4IH0gZnJvbSBcIi4uL3V0aWxzL21hdGguanNcIjtcblxuZnVuY3Rpb24gcHJldmVudE92ZXJmbG93KF9yZWYpIHtcbiAgdmFyIHN0YXRlID0gX3JlZi5zdGF0ZSxcbiAgICAgIG9wdGlvbnMgPSBfcmVmLm9wdGlvbnMsXG4gICAgICBuYW1lID0gX3JlZi5uYW1lO1xuICB2YXIgX29wdGlvbnMkbWFpbkF4aXMgPSBvcHRpb25zLm1haW5BeGlzLFxuICAgICAgY2hlY2tNYWluQXhpcyA9IF9vcHRpb25zJG1haW5BeGlzID09PSB2b2lkIDAgPyB0cnVlIDogX29wdGlvbnMkbWFpbkF4aXMsXG4gICAgICBfb3B0aW9ucyRhbHRBeGlzID0gb3B0aW9ucy5hbHRBeGlzLFxuICAgICAgY2hlY2tBbHRBeGlzID0gX29wdGlvbnMkYWx0QXhpcyA9PT0gdm9pZCAwID8gZmFsc2UgOiBfb3B0aW9ucyRhbHRBeGlzLFxuICAgICAgYm91bmRhcnkgPSBvcHRpb25zLmJvdW5kYXJ5LFxuICAgICAgcm9vdEJvdW5kYXJ5ID0gb3B0aW9ucy5yb290Qm91bmRhcnksXG4gICAgICBhbHRCb3VuZGFyeSA9IG9wdGlvbnMuYWx0Qm91bmRhcnksXG4gICAgICBwYWRkaW5nID0gb3B0aW9ucy5wYWRkaW5nLFxuICAgICAgX29wdGlvbnMkdGV0aGVyID0gb3B0aW9ucy50ZXRoZXIsXG4gICAgICB0ZXRoZXIgPSBfb3B0aW9ucyR0ZXRoZXIgPT09IHZvaWQgMCA/IHRydWUgOiBfb3B0aW9ucyR0ZXRoZXIsXG4gICAgICBfb3B0aW9ucyR0ZXRoZXJPZmZzZXQgPSBvcHRpb25zLnRldGhlck9mZnNldCxcbiAgICAgIHRldGhlck9mZnNldCA9IF9vcHRpb25zJHRldGhlck9mZnNldCA9PT0gdm9pZCAwID8gMCA6IF9vcHRpb25zJHRldGhlck9mZnNldDtcbiAgdmFyIG92ZXJmbG93ID0gZGV0ZWN0T3ZlcmZsb3coc3RhdGUsIHtcbiAgICBib3VuZGFyeTogYm91bmRhcnksXG4gICAgcm9vdEJvdW5kYXJ5OiByb290Qm91bmRhcnksXG4gICAgcGFkZGluZzogcGFkZGluZyxcbiAgICBhbHRCb3VuZGFyeTogYWx0Qm91bmRhcnlcbiAgfSk7XG4gIHZhciBiYXNlUGxhY2VtZW50ID0gZ2V0QmFzZVBsYWNlbWVudChzdGF0ZS5wbGFjZW1lbnQpO1xuICB2YXIgdmFyaWF0aW9uID0gZ2V0VmFyaWF0aW9uKHN0YXRlLnBsYWNlbWVudCk7XG4gIHZhciBpc0Jhc2VQbGFjZW1lbnQgPSAhdmFyaWF0aW9uO1xuICB2YXIgbWFpbkF4aXMgPSBnZXRNYWluQXhpc0Zyb21QbGFjZW1lbnQoYmFzZVBsYWNlbWVudCk7XG4gIHZhciBhbHRBeGlzID0gZ2V0QWx0QXhpcyhtYWluQXhpcyk7XG4gIHZhciBwb3BwZXJPZmZzZXRzID0gc3RhdGUubW9kaWZpZXJzRGF0YS5wb3BwZXJPZmZzZXRzO1xuICB2YXIgcmVmZXJlbmNlUmVjdCA9IHN0YXRlLnJlY3RzLnJlZmVyZW5jZTtcbiAgdmFyIHBvcHBlclJlY3QgPSBzdGF0ZS5yZWN0cy5wb3BwZXI7XG4gIHZhciB0ZXRoZXJPZmZzZXRWYWx1ZSA9IHR5cGVvZiB0ZXRoZXJPZmZzZXQgPT09ICdmdW5jdGlvbicgPyB0ZXRoZXJPZmZzZXQoT2JqZWN0LmFzc2lnbih7fSwgc3RhdGUucmVjdHMsIHtcbiAgICBwbGFjZW1lbnQ6IHN0YXRlLnBsYWNlbWVudFxuICB9KSkgOiB0ZXRoZXJPZmZzZXQ7XG4gIHZhciBub3JtYWxpemVkVGV0aGVyT2Zmc2V0VmFsdWUgPSB0eXBlb2YgdGV0aGVyT2Zmc2V0VmFsdWUgPT09ICdudW1iZXInID8ge1xuICAgIG1haW5BeGlzOiB0ZXRoZXJPZmZzZXRWYWx1ZSxcbiAgICBhbHRBeGlzOiB0ZXRoZXJPZmZzZXRWYWx1ZVxuICB9IDogT2JqZWN0LmFzc2lnbih7XG4gICAgbWFpbkF4aXM6IDAsXG4gICAgYWx0QXhpczogMFxuICB9LCB0ZXRoZXJPZmZzZXRWYWx1ZSk7XG4gIHZhciBvZmZzZXRNb2RpZmllclN0YXRlID0gc3RhdGUubW9kaWZpZXJzRGF0YS5vZmZzZXQgPyBzdGF0ZS5tb2RpZmllcnNEYXRhLm9mZnNldFtzdGF0ZS5wbGFjZW1lbnRdIDogbnVsbDtcbiAgdmFyIGRhdGEgPSB7XG4gICAgeDogMCxcbiAgICB5OiAwXG4gIH07XG5cbiAgaWYgKCFwb3BwZXJPZmZzZXRzKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgaWYgKGNoZWNrTWFpbkF4aXMpIHtcbiAgICB2YXIgX29mZnNldE1vZGlmaWVyU3RhdGUkO1xuXG4gICAgdmFyIG1haW5TaWRlID0gbWFpbkF4aXMgPT09ICd5JyA/IHRvcCA6IGxlZnQ7XG4gICAgdmFyIGFsdFNpZGUgPSBtYWluQXhpcyA9PT0gJ3knID8gYm90dG9tIDogcmlnaHQ7XG4gICAgdmFyIGxlbiA9IG1haW5BeGlzID09PSAneScgPyAnaGVpZ2h0JyA6ICd3aWR0aCc7XG4gICAgdmFyIG9mZnNldCA9IHBvcHBlck9mZnNldHNbbWFpbkF4aXNdO1xuICAgIHZhciBtaW4gPSBvZmZzZXQgKyBvdmVyZmxvd1ttYWluU2lkZV07XG4gICAgdmFyIG1heCA9IG9mZnNldCAtIG92ZXJmbG93W2FsdFNpZGVdO1xuICAgIHZhciBhZGRpdGl2ZSA9IHRldGhlciA/IC1wb3BwZXJSZWN0W2xlbl0gLyAyIDogMDtcbiAgICB2YXIgbWluTGVuID0gdmFyaWF0aW9uID09PSBzdGFydCA/IHJlZmVyZW5jZVJlY3RbbGVuXSA6IHBvcHBlclJlY3RbbGVuXTtcbiAgICB2YXIgbWF4TGVuID0gdmFyaWF0aW9uID09PSBzdGFydCA/IC1wb3BwZXJSZWN0W2xlbl0gOiAtcmVmZXJlbmNlUmVjdFtsZW5dOyAvLyBXZSBuZWVkIHRvIGluY2x1ZGUgdGhlIGFycm93IGluIHRoZSBjYWxjdWxhdGlvbiBzbyB0aGUgYXJyb3cgZG9lc24ndCBnb1xuICAgIC8vIG91dHNpZGUgdGhlIHJlZmVyZW5jZSBib3VuZHNcblxuICAgIHZhciBhcnJvd0VsZW1lbnQgPSBzdGF0ZS5lbGVtZW50cy5hcnJvdztcbiAgICB2YXIgYXJyb3dSZWN0ID0gdGV0aGVyICYmIGFycm93RWxlbWVudCA/IGdldExheW91dFJlY3QoYXJyb3dFbGVtZW50KSA6IHtcbiAgICAgIHdpZHRoOiAwLFxuICAgICAgaGVpZ2h0OiAwXG4gICAgfTtcbiAgICB2YXIgYXJyb3dQYWRkaW5nT2JqZWN0ID0gc3RhdGUubW9kaWZpZXJzRGF0YVsnYXJyb3cjcGVyc2lzdGVudCddID8gc3RhdGUubW9kaWZpZXJzRGF0YVsnYXJyb3cjcGVyc2lzdGVudCddLnBhZGRpbmcgOiBnZXRGcmVzaFNpZGVPYmplY3QoKTtcbiAgICB2YXIgYXJyb3dQYWRkaW5nTWluID0gYXJyb3dQYWRkaW5nT2JqZWN0W21haW5TaWRlXTtcbiAgICB2YXIgYXJyb3dQYWRkaW5nTWF4ID0gYXJyb3dQYWRkaW5nT2JqZWN0W2FsdFNpZGVdOyAvLyBJZiB0aGUgcmVmZXJlbmNlIGxlbmd0aCBpcyBzbWFsbGVyIHRoYW4gdGhlIGFycm93IGxlbmd0aCwgd2UgZG9uJ3Qgd2FudFxuICAgIC8vIHRvIGluY2x1ZGUgaXRzIGZ1bGwgc2l6ZSBpbiB0aGUgY2FsY3VsYXRpb24uIElmIHRoZSByZWZlcmVuY2UgaXMgc21hbGxcbiAgICAvLyBhbmQgbmVhciB0aGUgZWRnZSBvZiBhIGJvdW5kYXJ5LCB0aGUgcG9wcGVyIGNhbiBvdmVyZmxvdyBldmVuIGlmIHRoZVxuICAgIC8vIHJlZmVyZW5jZSBpcyBub3Qgb3ZlcmZsb3dpbmcgYXMgd2VsbCAoZS5nLiB2aXJ0dWFsIGVsZW1lbnRzIHdpdGggbm9cbiAgICAvLyB3aWR0aCBvciBoZWlnaHQpXG5cbiAgICB2YXIgYXJyb3dMZW4gPSB3aXRoaW4oMCwgcmVmZXJlbmNlUmVjdFtsZW5dLCBhcnJvd1JlY3RbbGVuXSk7XG4gICAgdmFyIG1pbk9mZnNldCA9IGlzQmFzZVBsYWNlbWVudCA/IHJlZmVyZW5jZVJlY3RbbGVuXSAvIDIgLSBhZGRpdGl2ZSAtIGFycm93TGVuIC0gYXJyb3dQYWRkaW5nTWluIC0gbm9ybWFsaXplZFRldGhlck9mZnNldFZhbHVlLm1haW5BeGlzIDogbWluTGVuIC0gYXJyb3dMZW4gLSBhcnJvd1BhZGRpbmdNaW4gLSBub3JtYWxpemVkVGV0aGVyT2Zmc2V0VmFsdWUubWFpbkF4aXM7XG4gICAgdmFyIG1heE9mZnNldCA9IGlzQmFzZVBsYWNlbWVudCA/IC1yZWZlcmVuY2VSZWN0W2xlbl0gLyAyICsgYWRkaXRpdmUgKyBhcnJvd0xlbiArIGFycm93UGFkZGluZ01heCArIG5vcm1hbGl6ZWRUZXRoZXJPZmZzZXRWYWx1ZS5tYWluQXhpcyA6IG1heExlbiArIGFycm93TGVuICsgYXJyb3dQYWRkaW5nTWF4ICsgbm9ybWFsaXplZFRldGhlck9mZnNldFZhbHVlLm1haW5BeGlzO1xuICAgIHZhciBhcnJvd09mZnNldFBhcmVudCA9IHN0YXRlLmVsZW1lbnRzLmFycm93ICYmIGdldE9mZnNldFBhcmVudChzdGF0ZS5lbGVtZW50cy5hcnJvdyk7XG4gICAgdmFyIGNsaWVudE9mZnNldCA9IGFycm93T2Zmc2V0UGFyZW50ID8gbWFpbkF4aXMgPT09ICd5JyA/IGFycm93T2Zmc2V0UGFyZW50LmNsaWVudFRvcCB8fCAwIDogYXJyb3dPZmZzZXRQYXJlbnQuY2xpZW50TGVmdCB8fCAwIDogMDtcbiAgICB2YXIgb2Zmc2V0TW9kaWZpZXJWYWx1ZSA9IChfb2Zmc2V0TW9kaWZpZXJTdGF0ZSQgPSBvZmZzZXRNb2RpZmllclN0YXRlID09IG51bGwgPyB2b2lkIDAgOiBvZmZzZXRNb2RpZmllclN0YXRlW21haW5BeGlzXSkgIT0gbnVsbCA/IF9vZmZzZXRNb2RpZmllclN0YXRlJCA6IDA7XG4gICAgdmFyIHRldGhlck1pbiA9IG9mZnNldCArIG1pbk9mZnNldCAtIG9mZnNldE1vZGlmaWVyVmFsdWUgLSBjbGllbnRPZmZzZXQ7XG4gICAgdmFyIHRldGhlck1heCA9IG9mZnNldCArIG1heE9mZnNldCAtIG9mZnNldE1vZGlmaWVyVmFsdWU7XG4gICAgdmFyIHByZXZlbnRlZE9mZnNldCA9IHdpdGhpbih0ZXRoZXIgPyBtYXRoTWluKG1pbiwgdGV0aGVyTWluKSA6IG1pbiwgb2Zmc2V0LCB0ZXRoZXIgPyBtYXRoTWF4KG1heCwgdGV0aGVyTWF4KSA6IG1heCk7XG4gICAgcG9wcGVyT2Zmc2V0c1ttYWluQXhpc10gPSBwcmV2ZW50ZWRPZmZzZXQ7XG4gICAgZGF0YVttYWluQXhpc10gPSBwcmV2ZW50ZWRPZmZzZXQgLSBvZmZzZXQ7XG4gIH1cblxuICBpZiAoY2hlY2tBbHRBeGlzKSB7XG4gICAgdmFyIF9vZmZzZXRNb2RpZmllclN0YXRlJDI7XG5cbiAgICB2YXIgX21haW5TaWRlID0gbWFpbkF4aXMgPT09ICd4JyA/IHRvcCA6IGxlZnQ7XG5cbiAgICB2YXIgX2FsdFNpZGUgPSBtYWluQXhpcyA9PT0gJ3gnID8gYm90dG9tIDogcmlnaHQ7XG5cbiAgICB2YXIgX29mZnNldCA9IHBvcHBlck9mZnNldHNbYWx0QXhpc107XG5cbiAgICB2YXIgX2xlbiA9IGFsdEF4aXMgPT09ICd5JyA/ICdoZWlnaHQnIDogJ3dpZHRoJztcblxuICAgIHZhciBfbWluID0gX29mZnNldCArIG92ZXJmbG93W19tYWluU2lkZV07XG5cbiAgICB2YXIgX21heCA9IF9vZmZzZXQgLSBvdmVyZmxvd1tfYWx0U2lkZV07XG5cbiAgICB2YXIgaXNPcmlnaW5TaWRlID0gW3RvcCwgbGVmdF0uaW5kZXhPZihiYXNlUGxhY2VtZW50KSAhPT0gLTE7XG5cbiAgICB2YXIgX29mZnNldE1vZGlmaWVyVmFsdWUgPSAoX29mZnNldE1vZGlmaWVyU3RhdGUkMiA9IG9mZnNldE1vZGlmaWVyU3RhdGUgPT0gbnVsbCA/IHZvaWQgMCA6IG9mZnNldE1vZGlmaWVyU3RhdGVbYWx0QXhpc10pICE9IG51bGwgPyBfb2Zmc2V0TW9kaWZpZXJTdGF0ZSQyIDogMDtcblxuICAgIHZhciBfdGV0aGVyTWluID0gaXNPcmlnaW5TaWRlID8gX21pbiA6IF9vZmZzZXQgLSByZWZlcmVuY2VSZWN0W19sZW5dIC0gcG9wcGVyUmVjdFtfbGVuXSAtIF9vZmZzZXRNb2RpZmllclZhbHVlICsgbm9ybWFsaXplZFRldGhlck9mZnNldFZhbHVlLmFsdEF4aXM7XG5cbiAgICB2YXIgX3RldGhlck1heCA9IGlzT3JpZ2luU2lkZSA/IF9vZmZzZXQgKyByZWZlcmVuY2VSZWN0W19sZW5dICsgcG9wcGVyUmVjdFtfbGVuXSAtIF9vZmZzZXRNb2RpZmllclZhbHVlIC0gbm9ybWFsaXplZFRldGhlck9mZnNldFZhbHVlLmFsdEF4aXMgOiBfbWF4O1xuXG4gICAgdmFyIF9wcmV2ZW50ZWRPZmZzZXQgPSB0ZXRoZXIgJiYgaXNPcmlnaW5TaWRlID8gd2l0aGluTWF4Q2xhbXAoX3RldGhlck1pbiwgX29mZnNldCwgX3RldGhlck1heCkgOiB3aXRoaW4odGV0aGVyID8gX3RldGhlck1pbiA6IF9taW4sIF9vZmZzZXQsIHRldGhlciA/IF90ZXRoZXJNYXggOiBfbWF4KTtcblxuICAgIHBvcHBlck9mZnNldHNbYWx0QXhpc10gPSBfcHJldmVudGVkT2Zmc2V0O1xuICAgIGRhdGFbYWx0QXhpc10gPSBfcHJldmVudGVkT2Zmc2V0IC0gX29mZnNldDtcbiAgfVxuXG4gIHN0YXRlLm1vZGlmaWVyc0RhdGFbbmFtZV0gPSBkYXRhO1xufSAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgaW1wb3J0L25vLXVudXNlZC1tb2R1bGVzXG5cblxuZXhwb3J0IGRlZmF1bHQge1xuICBuYW1lOiAncHJldmVudE92ZXJmbG93JyxcbiAgZW5hYmxlZDogdHJ1ZSxcbiAgcGhhc2U6ICdtYWluJyxcbiAgZm46IHByZXZlbnRPdmVyZmxvdyxcbiAgcmVxdWlyZXNJZkV4aXN0czogWydvZmZzZXQnXVxufTsiLCAiZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gZ2V0SFRNTEVsZW1lbnRTY3JvbGwoZWxlbWVudCkge1xuICByZXR1cm4ge1xuICAgIHNjcm9sbExlZnQ6IGVsZW1lbnQuc2Nyb2xsTGVmdCxcbiAgICBzY3JvbGxUb3A6IGVsZW1lbnQuc2Nyb2xsVG9wXG4gIH07XG59IiwgImltcG9ydCBnZXRXaW5kb3dTY3JvbGwgZnJvbSBcIi4vZ2V0V2luZG93U2Nyb2xsLmpzXCI7XG5pbXBvcnQgZ2V0V2luZG93IGZyb20gXCIuL2dldFdpbmRvdy5qc1wiO1xuaW1wb3J0IHsgaXNIVE1MRWxlbWVudCB9IGZyb20gXCIuL2luc3RhbmNlT2YuanNcIjtcbmltcG9ydCBnZXRIVE1MRWxlbWVudFNjcm9sbCBmcm9tIFwiLi9nZXRIVE1MRWxlbWVudFNjcm9sbC5qc1wiO1xuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gZ2V0Tm9kZVNjcm9sbChub2RlKSB7XG4gIGlmIChub2RlID09PSBnZXRXaW5kb3cobm9kZSkgfHwgIWlzSFRNTEVsZW1lbnQobm9kZSkpIHtcbiAgICByZXR1cm4gZ2V0V2luZG93U2Nyb2xsKG5vZGUpO1xuICB9IGVsc2Uge1xuICAgIHJldHVybiBnZXRIVE1MRWxlbWVudFNjcm9sbChub2RlKTtcbiAgfVxufSIsICJpbXBvcnQgZ2V0Qm91bmRpbmdDbGllbnRSZWN0IGZyb20gXCIuL2dldEJvdW5kaW5nQ2xpZW50UmVjdC5qc1wiO1xuaW1wb3J0IGdldE5vZGVTY3JvbGwgZnJvbSBcIi4vZ2V0Tm9kZVNjcm9sbC5qc1wiO1xuaW1wb3J0IGdldE5vZGVOYW1lIGZyb20gXCIuL2dldE5vZGVOYW1lLmpzXCI7XG5pbXBvcnQgeyBpc0hUTUxFbGVtZW50IH0gZnJvbSBcIi4vaW5zdGFuY2VPZi5qc1wiO1xuaW1wb3J0IGdldFdpbmRvd1Njcm9sbEJhclggZnJvbSBcIi4vZ2V0V2luZG93U2Nyb2xsQmFyWC5qc1wiO1xuaW1wb3J0IGdldERvY3VtZW50RWxlbWVudCBmcm9tIFwiLi9nZXREb2N1bWVudEVsZW1lbnQuanNcIjtcbmltcG9ydCBpc1Njcm9sbFBhcmVudCBmcm9tIFwiLi9pc1Njcm9sbFBhcmVudC5qc1wiO1xuaW1wb3J0IHsgcm91bmQgfSBmcm9tIFwiLi4vdXRpbHMvbWF0aC5qc1wiO1xuXG5mdW5jdGlvbiBpc0VsZW1lbnRTY2FsZWQoZWxlbWVudCkge1xuICB2YXIgcmVjdCA9IGVsZW1lbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG4gIHZhciBzY2FsZVggPSByb3VuZChyZWN0LndpZHRoKSAvIGVsZW1lbnQub2Zmc2V0V2lkdGggfHwgMTtcbiAgdmFyIHNjYWxlWSA9IHJvdW5kKHJlY3QuaGVpZ2h0KSAvIGVsZW1lbnQub2Zmc2V0SGVpZ2h0IHx8IDE7XG4gIHJldHVybiBzY2FsZVggIT09IDEgfHwgc2NhbGVZICE9PSAxO1xufSAvLyBSZXR1cm5zIHRoZSBjb21wb3NpdGUgcmVjdCBvZiBhbiBlbGVtZW50IHJlbGF0aXZlIHRvIGl0cyBvZmZzZXRQYXJlbnQuXG4vLyBDb21wb3NpdGUgbWVhbnMgaXQgdGFrZXMgaW50byBhY2NvdW50IHRyYW5zZm9ybXMgYXMgd2VsbCBhcyBsYXlvdXQuXG5cblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gZ2V0Q29tcG9zaXRlUmVjdChlbGVtZW50T3JWaXJ0dWFsRWxlbWVudCwgb2Zmc2V0UGFyZW50LCBpc0ZpeGVkKSB7XG4gIGlmIChpc0ZpeGVkID09PSB2b2lkIDApIHtcbiAgICBpc0ZpeGVkID0gZmFsc2U7XG4gIH1cblxuICB2YXIgaXNPZmZzZXRQYXJlbnRBbkVsZW1lbnQgPSBpc0hUTUxFbGVtZW50KG9mZnNldFBhcmVudCk7XG4gIHZhciBvZmZzZXRQYXJlbnRJc1NjYWxlZCA9IGlzSFRNTEVsZW1lbnQob2Zmc2V0UGFyZW50KSAmJiBpc0VsZW1lbnRTY2FsZWQob2Zmc2V0UGFyZW50KTtcbiAgdmFyIGRvY3VtZW50RWxlbWVudCA9IGdldERvY3VtZW50RWxlbWVudChvZmZzZXRQYXJlbnQpO1xuICB2YXIgcmVjdCA9IGdldEJvdW5kaW5nQ2xpZW50UmVjdChlbGVtZW50T3JWaXJ0dWFsRWxlbWVudCwgb2Zmc2V0UGFyZW50SXNTY2FsZWQpO1xuICB2YXIgc2Nyb2xsID0ge1xuICAgIHNjcm9sbExlZnQ6IDAsXG4gICAgc2Nyb2xsVG9wOiAwXG4gIH07XG4gIHZhciBvZmZzZXRzID0ge1xuICAgIHg6IDAsXG4gICAgeTogMFxuICB9O1xuXG4gIGlmIChpc09mZnNldFBhcmVudEFuRWxlbWVudCB8fCAhaXNPZmZzZXRQYXJlbnRBbkVsZW1lbnQgJiYgIWlzRml4ZWQpIHtcbiAgICBpZiAoZ2V0Tm9kZU5hbWUob2Zmc2V0UGFyZW50KSAhPT0gJ2JvZHknIHx8IC8vIGh0dHBzOi8vZ2l0aHViLmNvbS9wb3BwZXJqcy9wb3BwZXItY29yZS9pc3N1ZXMvMTA3OFxuICAgIGlzU2Nyb2xsUGFyZW50KGRvY3VtZW50RWxlbWVudCkpIHtcbiAgICAgIHNjcm9sbCA9IGdldE5vZGVTY3JvbGwob2Zmc2V0UGFyZW50KTtcbiAgICB9XG5cbiAgICBpZiAoaXNIVE1MRWxlbWVudChvZmZzZXRQYXJlbnQpKSB7XG4gICAgICBvZmZzZXRzID0gZ2V0Qm91bmRpbmdDbGllbnRSZWN0KG9mZnNldFBhcmVudCwgdHJ1ZSk7XG4gICAgICBvZmZzZXRzLnggKz0gb2Zmc2V0UGFyZW50LmNsaWVudExlZnQ7XG4gICAgICBvZmZzZXRzLnkgKz0gb2Zmc2V0UGFyZW50LmNsaWVudFRvcDtcbiAgICB9IGVsc2UgaWYgKGRvY3VtZW50RWxlbWVudCkge1xuICAgICAgb2Zmc2V0cy54ID0gZ2V0V2luZG93U2Nyb2xsQmFyWChkb2N1bWVudEVsZW1lbnQpO1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiB7XG4gICAgeDogcmVjdC5sZWZ0ICsgc2Nyb2xsLnNjcm9sbExlZnQgLSBvZmZzZXRzLngsXG4gICAgeTogcmVjdC50b3AgKyBzY3JvbGwuc2Nyb2xsVG9wIC0gb2Zmc2V0cy55LFxuICAgIHdpZHRoOiByZWN0LndpZHRoLFxuICAgIGhlaWdodDogcmVjdC5oZWlnaHRcbiAgfTtcbn0iLCAiaW1wb3J0IHsgbW9kaWZpZXJQaGFzZXMgfSBmcm9tIFwiLi4vZW51bXMuanNcIjsgLy8gc291cmNlOiBodHRwczovL3N0YWNrb3ZlcmZsb3cuY29tL3F1ZXN0aW9ucy80OTg3NTI1NVxuXG5mdW5jdGlvbiBvcmRlcihtb2RpZmllcnMpIHtcbiAgdmFyIG1hcCA9IG5ldyBNYXAoKTtcbiAgdmFyIHZpc2l0ZWQgPSBuZXcgU2V0KCk7XG4gIHZhciByZXN1bHQgPSBbXTtcbiAgbW9kaWZpZXJzLmZvckVhY2goZnVuY3Rpb24gKG1vZGlmaWVyKSB7XG4gICAgbWFwLnNldChtb2RpZmllci5uYW1lLCBtb2RpZmllcik7XG4gIH0pOyAvLyBPbiB2aXNpdGluZyBvYmplY3QsIGNoZWNrIGZvciBpdHMgZGVwZW5kZW5jaWVzIGFuZCB2aXNpdCB0aGVtIHJlY3Vyc2l2ZWx5XG5cbiAgZnVuY3Rpb24gc29ydChtb2RpZmllcikge1xuICAgIHZpc2l0ZWQuYWRkKG1vZGlmaWVyLm5hbWUpO1xuICAgIHZhciByZXF1aXJlcyA9IFtdLmNvbmNhdChtb2RpZmllci5yZXF1aXJlcyB8fCBbXSwgbW9kaWZpZXIucmVxdWlyZXNJZkV4aXN0cyB8fCBbXSk7XG4gICAgcmVxdWlyZXMuZm9yRWFjaChmdW5jdGlvbiAoZGVwKSB7XG4gICAgICBpZiAoIXZpc2l0ZWQuaGFzKGRlcCkpIHtcbiAgICAgICAgdmFyIGRlcE1vZGlmaWVyID0gbWFwLmdldChkZXApO1xuXG4gICAgICAgIGlmIChkZXBNb2RpZmllcikge1xuICAgICAgICAgIHNvcnQoZGVwTW9kaWZpZXIpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSk7XG4gICAgcmVzdWx0LnB1c2gobW9kaWZpZXIpO1xuICB9XG5cbiAgbW9kaWZpZXJzLmZvckVhY2goZnVuY3Rpb24gKG1vZGlmaWVyKSB7XG4gICAgaWYgKCF2aXNpdGVkLmhhcyhtb2RpZmllci5uYW1lKSkge1xuICAgICAgLy8gY2hlY2sgZm9yIHZpc2l0ZWQgb2JqZWN0XG4gICAgICBzb3J0KG1vZGlmaWVyKTtcbiAgICB9XG4gIH0pO1xuICByZXR1cm4gcmVzdWx0O1xufVxuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBvcmRlck1vZGlmaWVycyhtb2RpZmllcnMpIHtcbiAgLy8gb3JkZXIgYmFzZWQgb24gZGVwZW5kZW5jaWVzXG4gIHZhciBvcmRlcmVkTW9kaWZpZXJzID0gb3JkZXIobW9kaWZpZXJzKTsgLy8gb3JkZXIgYmFzZWQgb24gcGhhc2VcblxuICByZXR1cm4gbW9kaWZpZXJQaGFzZXMucmVkdWNlKGZ1bmN0aW9uIChhY2MsIHBoYXNlKSB7XG4gICAgcmV0dXJuIGFjYy5jb25jYXQob3JkZXJlZE1vZGlmaWVycy5maWx0ZXIoZnVuY3Rpb24gKG1vZGlmaWVyKSB7XG4gICAgICByZXR1cm4gbW9kaWZpZXIucGhhc2UgPT09IHBoYXNlO1xuICAgIH0pKTtcbiAgfSwgW10pO1xufSIsICJleHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBkZWJvdW5jZShmbikge1xuICB2YXIgcGVuZGluZztcbiAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICBpZiAoIXBlbmRpbmcpIHtcbiAgICAgIHBlbmRpbmcgPSBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSkge1xuICAgICAgICBQcm9taXNlLnJlc29sdmUoKS50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICBwZW5kaW5nID0gdW5kZWZpbmVkO1xuICAgICAgICAgIHJlc29sdmUoZm4oKSk7XG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHBlbmRpbmc7XG4gIH07XG59IiwgImV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGZvcm1hdChzdHIpIHtcbiAgZm9yICh2YXIgX2xlbiA9IGFyZ3VtZW50cy5sZW5ndGgsIGFyZ3MgPSBuZXcgQXJyYXkoX2xlbiA+IDEgPyBfbGVuIC0gMSA6IDApLCBfa2V5ID0gMTsgX2tleSA8IF9sZW47IF9rZXkrKykge1xuICAgIGFyZ3NbX2tleSAtIDFdID0gYXJndW1lbnRzW19rZXldO1xuICB9XG5cbiAgcmV0dXJuIFtdLmNvbmNhdChhcmdzKS5yZWR1Y2UoZnVuY3Rpb24gKHAsIGMpIHtcbiAgICByZXR1cm4gcC5yZXBsYWNlKC8lcy8sIGMpO1xuICB9LCBzdHIpO1xufSIsICJpbXBvcnQgZm9ybWF0IGZyb20gXCIuL2Zvcm1hdC5qc1wiO1xuaW1wb3J0IHsgbW9kaWZpZXJQaGFzZXMgfSBmcm9tIFwiLi4vZW51bXMuanNcIjtcbnZhciBJTlZBTElEX01PRElGSUVSX0VSUk9SID0gJ1BvcHBlcjogbW9kaWZpZXIgXCIlc1wiIHByb3ZpZGVkIGFuIGludmFsaWQgJXMgcHJvcGVydHksIGV4cGVjdGVkICVzIGJ1dCBnb3QgJXMnO1xudmFyIE1JU1NJTkdfREVQRU5ERU5DWV9FUlJPUiA9ICdQb3BwZXI6IG1vZGlmaWVyIFwiJXNcIiByZXF1aXJlcyBcIiVzXCIsIGJ1dCBcIiVzXCIgbW9kaWZpZXIgaXMgbm90IGF2YWlsYWJsZSc7XG52YXIgVkFMSURfUFJPUEVSVElFUyA9IFsnbmFtZScsICdlbmFibGVkJywgJ3BoYXNlJywgJ2ZuJywgJ2VmZmVjdCcsICdyZXF1aXJlcycsICdvcHRpb25zJ107XG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiB2YWxpZGF0ZU1vZGlmaWVycyhtb2RpZmllcnMpIHtcbiAgbW9kaWZpZXJzLmZvckVhY2goZnVuY3Rpb24gKG1vZGlmaWVyKSB7XG4gICAgW10uY29uY2F0KE9iamVjdC5rZXlzKG1vZGlmaWVyKSwgVkFMSURfUFJPUEVSVElFUykgLy8gSUUxMS1jb21wYXRpYmxlIHJlcGxhY2VtZW50IGZvciBgbmV3IFNldChpdGVyYWJsZSlgXG4gICAgLmZpbHRlcihmdW5jdGlvbiAodmFsdWUsIGluZGV4LCBzZWxmKSB7XG4gICAgICByZXR1cm4gc2VsZi5pbmRleE9mKHZhbHVlKSA9PT0gaW5kZXg7XG4gICAgfSkuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7XG4gICAgICBzd2l0Y2ggKGtleSkge1xuICAgICAgICBjYXNlICduYW1lJzpcbiAgICAgICAgICBpZiAodHlwZW9mIG1vZGlmaWVyLm5hbWUgIT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKGZvcm1hdChJTlZBTElEX01PRElGSUVSX0VSUk9SLCBTdHJpbmcobW9kaWZpZXIubmFtZSksICdcIm5hbWVcIicsICdcInN0cmluZ1wiJywgXCJcXFwiXCIgKyBTdHJpbmcobW9kaWZpZXIubmFtZSkgKyBcIlxcXCJcIikpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgIGNhc2UgJ2VuYWJsZWQnOlxuICAgICAgICAgIGlmICh0eXBlb2YgbW9kaWZpZXIuZW5hYmxlZCAhPT0gJ2Jvb2xlYW4nKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKGZvcm1hdChJTlZBTElEX01PRElGSUVSX0VSUk9SLCBtb2RpZmllci5uYW1lLCAnXCJlbmFibGVkXCInLCAnXCJib29sZWFuXCInLCBcIlxcXCJcIiArIFN0cmluZyhtb2RpZmllci5lbmFibGVkKSArIFwiXFxcIlwiKSk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgY2FzZSAncGhhc2UnOlxuICAgICAgICAgIGlmIChtb2RpZmllclBoYXNlcy5pbmRleE9mKG1vZGlmaWVyLnBoYXNlKSA8IDApIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZm9ybWF0KElOVkFMSURfTU9ESUZJRVJfRVJST1IsIG1vZGlmaWVyLm5hbWUsICdcInBoYXNlXCInLCBcImVpdGhlciBcIiArIG1vZGlmaWVyUGhhc2VzLmpvaW4oJywgJyksIFwiXFxcIlwiICsgU3RyaW5nKG1vZGlmaWVyLnBoYXNlKSArIFwiXFxcIlwiKSk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgY2FzZSAnZm4nOlxuICAgICAgICAgIGlmICh0eXBlb2YgbW9kaWZpZXIuZm4gIT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZm9ybWF0KElOVkFMSURfTU9ESUZJRVJfRVJST1IsIG1vZGlmaWVyLm5hbWUsICdcImZuXCInLCAnXCJmdW5jdGlvblwiJywgXCJcXFwiXCIgKyBTdHJpbmcobW9kaWZpZXIuZm4pICsgXCJcXFwiXCIpKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBicmVhaztcblxuICAgICAgICBjYXNlICdlZmZlY3QnOlxuICAgICAgICAgIGlmIChtb2RpZmllci5lZmZlY3QgIT0gbnVsbCAmJiB0eXBlb2YgbW9kaWZpZXIuZWZmZWN0ICE9PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKGZvcm1hdChJTlZBTElEX01PRElGSUVSX0VSUk9SLCBtb2RpZmllci5uYW1lLCAnXCJlZmZlY3RcIicsICdcImZ1bmN0aW9uXCInLCBcIlxcXCJcIiArIFN0cmluZyhtb2RpZmllci5mbikgKyBcIlxcXCJcIikpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgIGNhc2UgJ3JlcXVpcmVzJzpcbiAgICAgICAgICBpZiAobW9kaWZpZXIucmVxdWlyZXMgIT0gbnVsbCAmJiAhQXJyYXkuaXNBcnJheShtb2RpZmllci5yZXF1aXJlcykpIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZm9ybWF0KElOVkFMSURfTU9ESUZJRVJfRVJST1IsIG1vZGlmaWVyLm5hbWUsICdcInJlcXVpcmVzXCInLCAnXCJhcnJheVwiJywgXCJcXFwiXCIgKyBTdHJpbmcobW9kaWZpZXIucmVxdWlyZXMpICsgXCJcXFwiXCIpKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBicmVhaztcblxuICAgICAgICBjYXNlICdyZXF1aXJlc0lmRXhpc3RzJzpcbiAgICAgICAgICBpZiAoIUFycmF5LmlzQXJyYXkobW9kaWZpZXIucmVxdWlyZXNJZkV4aXN0cykpIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZm9ybWF0KElOVkFMSURfTU9ESUZJRVJfRVJST1IsIG1vZGlmaWVyLm5hbWUsICdcInJlcXVpcmVzSWZFeGlzdHNcIicsICdcImFycmF5XCInLCBcIlxcXCJcIiArIFN0cmluZyhtb2RpZmllci5yZXF1aXJlc0lmRXhpc3RzKSArIFwiXFxcIlwiKSk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgY2FzZSAnb3B0aW9ucyc6XG4gICAgICAgIGNhc2UgJ2RhdGEnOlxuICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgY29uc29sZS5lcnJvcihcIlBvcHBlckpTOiBhbiBpbnZhbGlkIHByb3BlcnR5IGhhcyBiZWVuIHByb3ZpZGVkIHRvIHRoZSBcXFwiXCIgKyBtb2RpZmllci5uYW1lICsgXCJcXFwiIG1vZGlmaWVyLCB2YWxpZCBwcm9wZXJ0aWVzIGFyZSBcIiArIFZBTElEX1BST1BFUlRJRVMubWFwKGZ1bmN0aW9uIChzKSB7XG4gICAgICAgICAgICByZXR1cm4gXCJcXFwiXCIgKyBzICsgXCJcXFwiXCI7XG4gICAgICAgICAgfSkuam9pbignLCAnKSArIFwiOyBidXQgXFxcIlwiICsga2V5ICsgXCJcXFwiIHdhcyBwcm92aWRlZC5cIik7XG4gICAgICB9XG5cbiAgICAgIG1vZGlmaWVyLnJlcXVpcmVzICYmIG1vZGlmaWVyLnJlcXVpcmVzLmZvckVhY2goZnVuY3Rpb24gKHJlcXVpcmVtZW50KSB7XG4gICAgICAgIGlmIChtb2RpZmllcnMuZmluZChmdW5jdGlvbiAobW9kKSB7XG4gICAgICAgICAgcmV0dXJuIG1vZC5uYW1lID09PSByZXF1aXJlbWVudDtcbiAgICAgICAgfSkgPT0gbnVsbCkge1xuICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZm9ybWF0KE1JU1NJTkdfREVQRU5ERU5DWV9FUlJPUiwgU3RyaW5nKG1vZGlmaWVyLm5hbWUpLCByZXF1aXJlbWVudCwgcmVxdWlyZW1lbnQpKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfSk7XG4gIH0pO1xufSIsICJleHBvcnQgZGVmYXVsdCBmdW5jdGlvbiB1bmlxdWVCeShhcnIsIGZuKSB7XG4gIHZhciBpZGVudGlmaWVycyA9IG5ldyBTZXQoKTtcbiAgcmV0dXJuIGFyci5maWx0ZXIoZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICB2YXIgaWRlbnRpZmllciA9IGZuKGl0ZW0pO1xuXG4gICAgaWYgKCFpZGVudGlmaWVycy5oYXMoaWRlbnRpZmllcikpIHtcbiAgICAgIGlkZW50aWZpZXJzLmFkZChpZGVudGlmaWVyKTtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgfSk7XG59IiwgImV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIG1lcmdlQnlOYW1lKG1vZGlmaWVycykge1xuICB2YXIgbWVyZ2VkID0gbW9kaWZpZXJzLnJlZHVjZShmdW5jdGlvbiAobWVyZ2VkLCBjdXJyZW50KSB7XG4gICAgdmFyIGV4aXN0aW5nID0gbWVyZ2VkW2N1cnJlbnQubmFtZV07XG4gICAgbWVyZ2VkW2N1cnJlbnQubmFtZV0gPSBleGlzdGluZyA/IE9iamVjdC5hc3NpZ24oe30sIGV4aXN0aW5nLCBjdXJyZW50LCB7XG4gICAgICBvcHRpb25zOiBPYmplY3QuYXNzaWduKHt9LCBleGlzdGluZy5vcHRpb25zLCBjdXJyZW50Lm9wdGlvbnMpLFxuICAgICAgZGF0YTogT2JqZWN0LmFzc2lnbih7fSwgZXhpc3RpbmcuZGF0YSwgY3VycmVudC5kYXRhKVxuICAgIH0pIDogY3VycmVudDtcbiAgICByZXR1cm4gbWVyZ2VkO1xuICB9LCB7fSk7IC8vIElFMTEgZG9lcyBub3Qgc3VwcG9ydCBPYmplY3QudmFsdWVzXG5cbiAgcmV0dXJuIE9iamVjdC5rZXlzKG1lcmdlZCkubWFwKGZ1bmN0aW9uIChrZXkpIHtcbiAgICByZXR1cm4gbWVyZ2VkW2tleV07XG4gIH0pO1xufSIsICJpbXBvcnQgZ2V0Q29tcG9zaXRlUmVjdCBmcm9tIFwiLi9kb20tdXRpbHMvZ2V0Q29tcG9zaXRlUmVjdC5qc1wiO1xuaW1wb3J0IGdldExheW91dFJlY3QgZnJvbSBcIi4vZG9tLXV0aWxzL2dldExheW91dFJlY3QuanNcIjtcbmltcG9ydCBsaXN0U2Nyb2xsUGFyZW50cyBmcm9tIFwiLi9kb20tdXRpbHMvbGlzdFNjcm9sbFBhcmVudHMuanNcIjtcbmltcG9ydCBnZXRPZmZzZXRQYXJlbnQgZnJvbSBcIi4vZG9tLXV0aWxzL2dldE9mZnNldFBhcmVudC5qc1wiO1xuaW1wb3J0IGdldENvbXB1dGVkU3R5bGUgZnJvbSBcIi4vZG9tLXV0aWxzL2dldENvbXB1dGVkU3R5bGUuanNcIjtcbmltcG9ydCBvcmRlck1vZGlmaWVycyBmcm9tIFwiLi91dGlscy9vcmRlck1vZGlmaWVycy5qc1wiO1xuaW1wb3J0IGRlYm91bmNlIGZyb20gXCIuL3V0aWxzL2RlYm91bmNlLmpzXCI7XG5pbXBvcnQgdmFsaWRhdGVNb2RpZmllcnMgZnJvbSBcIi4vdXRpbHMvdmFsaWRhdGVNb2RpZmllcnMuanNcIjtcbmltcG9ydCB1bmlxdWVCeSBmcm9tIFwiLi91dGlscy91bmlxdWVCeS5qc1wiO1xuaW1wb3J0IGdldEJhc2VQbGFjZW1lbnQgZnJvbSBcIi4vdXRpbHMvZ2V0QmFzZVBsYWNlbWVudC5qc1wiO1xuaW1wb3J0IG1lcmdlQnlOYW1lIGZyb20gXCIuL3V0aWxzL21lcmdlQnlOYW1lLmpzXCI7XG5pbXBvcnQgZGV0ZWN0T3ZlcmZsb3cgZnJvbSBcIi4vdXRpbHMvZGV0ZWN0T3ZlcmZsb3cuanNcIjtcbmltcG9ydCB7IGlzRWxlbWVudCB9IGZyb20gXCIuL2RvbS11dGlscy9pbnN0YW5jZU9mLmpzXCI7XG5pbXBvcnQgeyBhdXRvIH0gZnJvbSBcIi4vZW51bXMuanNcIjtcbnZhciBJTlZBTElEX0VMRU1FTlRfRVJST1IgPSAnUG9wcGVyOiBJbnZhbGlkIHJlZmVyZW5jZSBvciBwb3BwZXIgYXJndW1lbnQgcHJvdmlkZWQuIFRoZXkgbXVzdCBiZSBlaXRoZXIgYSBET00gZWxlbWVudCBvciB2aXJ0dWFsIGVsZW1lbnQuJztcbnZhciBJTkZJTklURV9MT09QX0VSUk9SID0gJ1BvcHBlcjogQW4gaW5maW5pdGUgbG9vcCBpbiB0aGUgbW9kaWZpZXJzIGN5Y2xlIGhhcyBiZWVuIGRldGVjdGVkISBUaGUgY3ljbGUgaGFzIGJlZW4gaW50ZXJydXB0ZWQgdG8gcHJldmVudCBhIGJyb3dzZXIgY3Jhc2guJztcbnZhciBERUZBVUxUX09QVElPTlMgPSB7XG4gIHBsYWNlbWVudDogJ2JvdHRvbScsXG4gIG1vZGlmaWVyczogW10sXG4gIHN0cmF0ZWd5OiAnYWJzb2x1dGUnXG59O1xuXG5mdW5jdGlvbiBhcmVWYWxpZEVsZW1lbnRzKCkge1xuICBmb3IgKHZhciBfbGVuID0gYXJndW1lbnRzLmxlbmd0aCwgYXJncyA9IG5ldyBBcnJheShfbGVuKSwgX2tleSA9IDA7IF9rZXkgPCBfbGVuOyBfa2V5KyspIHtcbiAgICBhcmdzW19rZXldID0gYXJndW1lbnRzW19rZXldO1xuICB9XG5cbiAgcmV0dXJuICFhcmdzLnNvbWUoZnVuY3Rpb24gKGVsZW1lbnQpIHtcbiAgICByZXR1cm4gIShlbGVtZW50ICYmIHR5cGVvZiBlbGVtZW50LmdldEJvdW5kaW5nQ2xpZW50UmVjdCA9PT0gJ2Z1bmN0aW9uJyk7XG4gIH0pO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gcG9wcGVyR2VuZXJhdG9yKGdlbmVyYXRvck9wdGlvbnMpIHtcbiAgaWYgKGdlbmVyYXRvck9wdGlvbnMgPT09IHZvaWQgMCkge1xuICAgIGdlbmVyYXRvck9wdGlvbnMgPSB7fTtcbiAgfVxuXG4gIHZhciBfZ2VuZXJhdG9yT3B0aW9ucyA9IGdlbmVyYXRvck9wdGlvbnMsXG4gICAgICBfZ2VuZXJhdG9yT3B0aW9ucyRkZWYgPSBfZ2VuZXJhdG9yT3B0aW9ucy5kZWZhdWx0TW9kaWZpZXJzLFxuICAgICAgZGVmYXVsdE1vZGlmaWVycyA9IF9nZW5lcmF0b3JPcHRpb25zJGRlZiA9PT0gdm9pZCAwID8gW10gOiBfZ2VuZXJhdG9yT3B0aW9ucyRkZWYsXG4gICAgICBfZ2VuZXJhdG9yT3B0aW9ucyRkZWYyID0gX2dlbmVyYXRvck9wdGlvbnMuZGVmYXVsdE9wdGlvbnMsXG4gICAgICBkZWZhdWx0T3B0aW9ucyA9IF9nZW5lcmF0b3JPcHRpb25zJGRlZjIgPT09IHZvaWQgMCA/IERFRkFVTFRfT1BUSU9OUyA6IF9nZW5lcmF0b3JPcHRpb25zJGRlZjI7XG4gIHJldHVybiBmdW5jdGlvbiBjcmVhdGVQb3BwZXIocmVmZXJlbmNlLCBwb3BwZXIsIG9wdGlvbnMpIHtcbiAgICBpZiAob3B0aW9ucyA9PT0gdm9pZCAwKSB7XG4gICAgICBvcHRpb25zID0gZGVmYXVsdE9wdGlvbnM7XG4gICAgfVxuXG4gICAgdmFyIHN0YXRlID0ge1xuICAgICAgcGxhY2VtZW50OiAnYm90dG9tJyxcbiAgICAgIG9yZGVyZWRNb2RpZmllcnM6IFtdLFxuICAgICAgb3B0aW9uczogT2JqZWN0LmFzc2lnbih7fSwgREVGQVVMVF9PUFRJT05TLCBkZWZhdWx0T3B0aW9ucyksXG4gICAgICBtb2RpZmllcnNEYXRhOiB7fSxcbiAgICAgIGVsZW1lbnRzOiB7XG4gICAgICAgIHJlZmVyZW5jZTogcmVmZXJlbmNlLFxuICAgICAgICBwb3BwZXI6IHBvcHBlclxuICAgICAgfSxcbiAgICAgIGF0dHJpYnV0ZXM6IHt9LFxuICAgICAgc3R5bGVzOiB7fVxuICAgIH07XG4gICAgdmFyIGVmZmVjdENsZWFudXBGbnMgPSBbXTtcbiAgICB2YXIgaXNEZXN0cm95ZWQgPSBmYWxzZTtcbiAgICB2YXIgaW5zdGFuY2UgPSB7XG4gICAgICBzdGF0ZTogc3RhdGUsXG4gICAgICBzZXRPcHRpb25zOiBmdW5jdGlvbiBzZXRPcHRpb25zKHNldE9wdGlvbnNBY3Rpb24pIHtcbiAgICAgICAgdmFyIG9wdGlvbnMgPSB0eXBlb2Ygc2V0T3B0aW9uc0FjdGlvbiA9PT0gJ2Z1bmN0aW9uJyA/IHNldE9wdGlvbnNBY3Rpb24oc3RhdGUub3B0aW9ucykgOiBzZXRPcHRpb25zQWN0aW9uO1xuICAgICAgICBjbGVhbnVwTW9kaWZpZXJFZmZlY3RzKCk7XG4gICAgICAgIHN0YXRlLm9wdGlvbnMgPSBPYmplY3QuYXNzaWduKHt9LCBkZWZhdWx0T3B0aW9ucywgc3RhdGUub3B0aW9ucywgb3B0aW9ucyk7XG4gICAgICAgIHN0YXRlLnNjcm9sbFBhcmVudHMgPSB7XG4gICAgICAgICAgcmVmZXJlbmNlOiBpc0VsZW1lbnQocmVmZXJlbmNlKSA/IGxpc3RTY3JvbGxQYXJlbnRzKHJlZmVyZW5jZSkgOiByZWZlcmVuY2UuY29udGV4dEVsZW1lbnQgPyBsaXN0U2Nyb2xsUGFyZW50cyhyZWZlcmVuY2UuY29udGV4dEVsZW1lbnQpIDogW10sXG4gICAgICAgICAgcG9wcGVyOiBsaXN0U2Nyb2xsUGFyZW50cyhwb3BwZXIpXG4gICAgICAgIH07IC8vIE9yZGVycyB0aGUgbW9kaWZpZXJzIGJhc2VkIG9uIHRoZWlyIGRlcGVuZGVuY2llcyBhbmQgYHBoYXNlYFxuICAgICAgICAvLyBwcm9wZXJ0aWVzXG5cbiAgICAgICAgdmFyIG9yZGVyZWRNb2RpZmllcnMgPSBvcmRlck1vZGlmaWVycyhtZXJnZUJ5TmFtZShbXS5jb25jYXQoZGVmYXVsdE1vZGlmaWVycywgc3RhdGUub3B0aW9ucy5tb2RpZmllcnMpKSk7IC8vIFN0cmlwIG91dCBkaXNhYmxlZCBtb2RpZmllcnNcblxuICAgICAgICBzdGF0ZS5vcmRlcmVkTW9kaWZpZXJzID0gb3JkZXJlZE1vZGlmaWVycy5maWx0ZXIoZnVuY3Rpb24gKG0pIHtcbiAgICAgICAgICByZXR1cm4gbS5lbmFibGVkO1xuICAgICAgICB9KTsgLy8gVmFsaWRhdGUgdGhlIHByb3ZpZGVkIG1vZGlmaWVycyBzbyB0aGF0IHRoZSBjb25zdW1lciB3aWxsIGdldCB3YXJuZWRcbiAgICAgICAgLy8gaWYgb25lIG9mIHRoZSBtb2RpZmllcnMgaXMgaW52YWxpZCBmb3IgYW55IHJlYXNvblxuXG4gICAgICAgIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gXCJwcm9kdWN0aW9uXCIpIHtcbiAgICAgICAgICB2YXIgbW9kaWZpZXJzID0gdW5pcXVlQnkoW10uY29uY2F0KG9yZGVyZWRNb2RpZmllcnMsIHN0YXRlLm9wdGlvbnMubW9kaWZpZXJzKSwgZnVuY3Rpb24gKF9yZWYpIHtcbiAgICAgICAgICAgIHZhciBuYW1lID0gX3JlZi5uYW1lO1xuICAgICAgICAgICAgcmV0dXJuIG5hbWU7XG4gICAgICAgICAgfSk7XG4gICAgICAgICAgdmFsaWRhdGVNb2RpZmllcnMobW9kaWZpZXJzKTtcblxuICAgICAgICAgIGlmIChnZXRCYXNlUGxhY2VtZW50KHN0YXRlLm9wdGlvbnMucGxhY2VtZW50KSA9PT0gYXV0bykge1xuICAgICAgICAgICAgdmFyIGZsaXBNb2RpZmllciA9IHN0YXRlLm9yZGVyZWRNb2RpZmllcnMuZmluZChmdW5jdGlvbiAoX3JlZjIpIHtcbiAgICAgICAgICAgICAgdmFyIG5hbWUgPSBfcmVmMi5uYW1lO1xuICAgICAgICAgICAgICByZXR1cm4gbmFtZSA9PT0gJ2ZsaXAnO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGlmICghZmxpcE1vZGlmaWVyKSB7XG4gICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoWydQb3BwZXI6IFwiYXV0b1wiIHBsYWNlbWVudHMgcmVxdWlyZSB0aGUgXCJmbGlwXCIgbW9kaWZpZXIgYmUnLCAncHJlc2VudCBhbmQgZW5hYmxlZCB0byB3b3JrLiddLmpvaW4oJyAnKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgdmFyIF9nZXRDb21wdXRlZFN0eWxlID0gZ2V0Q29tcHV0ZWRTdHlsZShwb3BwZXIpLFxuICAgICAgICAgICAgICBtYXJnaW5Ub3AgPSBfZ2V0Q29tcHV0ZWRTdHlsZS5tYXJnaW5Ub3AsXG4gICAgICAgICAgICAgIG1hcmdpblJpZ2h0ID0gX2dldENvbXB1dGVkU3R5bGUubWFyZ2luUmlnaHQsXG4gICAgICAgICAgICAgIG1hcmdpbkJvdHRvbSA9IF9nZXRDb21wdXRlZFN0eWxlLm1hcmdpbkJvdHRvbSxcbiAgICAgICAgICAgICAgbWFyZ2luTGVmdCA9IF9nZXRDb21wdXRlZFN0eWxlLm1hcmdpbkxlZnQ7IC8vIFdlIG5vIGxvbmdlciB0YWtlIGludG8gYWNjb3VudCBgbWFyZ2luc2Agb24gdGhlIHBvcHBlciwgYW5kIGl0IGNhblxuICAgICAgICAgIC8vIGNhdXNlIGJ1Z3Mgd2l0aCBwb3NpdGlvbmluZywgc28gd2UnbGwgd2FybiB0aGUgY29uc3VtZXJcblxuXG4gICAgICAgICAgaWYgKFttYXJnaW5Ub3AsIG1hcmdpblJpZ2h0LCBtYXJnaW5Cb3R0b20sIG1hcmdpbkxlZnRdLnNvbWUoZnVuY3Rpb24gKG1hcmdpbikge1xuICAgICAgICAgICAgcmV0dXJuIHBhcnNlRmxvYXQobWFyZ2luKTtcbiAgICAgICAgICB9KSkge1xuICAgICAgICAgICAgY29uc29sZS53YXJuKFsnUG9wcGVyOiBDU1MgXCJtYXJnaW5cIiBzdHlsZXMgY2Fubm90IGJlIHVzZWQgdG8gYXBwbHkgcGFkZGluZycsICdiZXR3ZWVuIHRoZSBwb3BwZXIgYW5kIGl0cyByZWZlcmVuY2UgZWxlbWVudCBvciBib3VuZGFyeS4nLCAnVG8gcmVwbGljYXRlIG1hcmdpbiwgdXNlIHRoZSBgb2Zmc2V0YCBtb2RpZmllciwgYXMgd2VsbCBhcycsICd0aGUgYHBhZGRpbmdgIG9wdGlvbiBpbiB0aGUgYHByZXZlbnRPdmVyZmxvd2AgYW5kIGBmbGlwYCcsICdtb2RpZmllcnMuJ10uam9pbignICcpKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBydW5Nb2RpZmllckVmZmVjdHMoKTtcbiAgICAgICAgcmV0dXJuIGluc3RhbmNlLnVwZGF0ZSgpO1xuICAgICAgfSxcbiAgICAgIC8vIFN5bmMgdXBkYXRlIFx1MjAxMyBpdCB3aWxsIGFsd2F5cyBiZSBleGVjdXRlZCwgZXZlbiBpZiBub3QgbmVjZXNzYXJ5LiBUaGlzXG4gICAgICAvLyBpcyB1c2VmdWwgZm9yIGxvdyBmcmVxdWVuY3kgdXBkYXRlcyB3aGVyZSBzeW5jIGJlaGF2aW9yIHNpbXBsaWZpZXMgdGhlXG4gICAgICAvLyBsb2dpYy5cbiAgICAgIC8vIEZvciBoaWdoIGZyZXF1ZW5jeSB1cGRhdGVzIChlLmcuIGByZXNpemVgIGFuZCBgc2Nyb2xsYCBldmVudHMpLCBhbHdheXNcbiAgICAgIC8vIHByZWZlciB0aGUgYXN5bmMgUG9wcGVyI3VwZGF0ZSBtZXRob2RcbiAgICAgIGZvcmNlVXBkYXRlOiBmdW5jdGlvbiBmb3JjZVVwZGF0ZSgpIHtcbiAgICAgICAgaWYgKGlzRGVzdHJveWVkKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgdmFyIF9zdGF0ZSRlbGVtZW50cyA9IHN0YXRlLmVsZW1lbnRzLFxuICAgICAgICAgICAgcmVmZXJlbmNlID0gX3N0YXRlJGVsZW1lbnRzLnJlZmVyZW5jZSxcbiAgICAgICAgICAgIHBvcHBlciA9IF9zdGF0ZSRlbGVtZW50cy5wb3BwZXI7IC8vIERvbid0IHByb2NlZWQgaWYgYHJlZmVyZW5jZWAgb3IgYHBvcHBlcmAgYXJlIG5vdCB2YWxpZCBlbGVtZW50c1xuICAgICAgICAvLyBhbnltb3JlXG5cbiAgICAgICAgaWYgKCFhcmVWYWxpZEVsZW1lbnRzKHJlZmVyZW5jZSwgcG9wcGVyKSkge1xuICAgICAgICAgIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gXCJwcm9kdWN0aW9uXCIpIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoSU5WQUxJRF9FTEVNRU5UX0VSUk9SKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH0gLy8gU3RvcmUgdGhlIHJlZmVyZW5jZSBhbmQgcG9wcGVyIHJlY3RzIHRvIGJlIHJlYWQgYnkgbW9kaWZpZXJzXG5cblxuICAgICAgICBzdGF0ZS5yZWN0cyA9IHtcbiAgICAgICAgICByZWZlcmVuY2U6IGdldENvbXBvc2l0ZVJlY3QocmVmZXJlbmNlLCBnZXRPZmZzZXRQYXJlbnQocG9wcGVyKSwgc3RhdGUub3B0aW9ucy5zdHJhdGVneSA9PT0gJ2ZpeGVkJyksXG4gICAgICAgICAgcG9wcGVyOiBnZXRMYXlvdXRSZWN0KHBvcHBlcilcbiAgICAgICAgfTsgLy8gTW9kaWZpZXJzIGhhdmUgdGhlIGFiaWxpdHkgdG8gcmVzZXQgdGhlIGN1cnJlbnQgdXBkYXRlIGN5Y2xlLiBUaGVcbiAgICAgICAgLy8gbW9zdCBjb21tb24gdXNlIGNhc2UgZm9yIHRoaXMgaXMgdGhlIGBmbGlwYCBtb2RpZmllciBjaGFuZ2luZyB0aGVcbiAgICAgICAgLy8gcGxhY2VtZW50LCB3aGljaCB0aGVuIG5lZWRzIHRvIHJlLXJ1biBhbGwgdGhlIG1vZGlmaWVycywgYmVjYXVzZSB0aGVcbiAgICAgICAgLy8gbG9naWMgd2FzIHByZXZpb3VzbHkgcmFuIGZvciB0aGUgcHJldmlvdXMgcGxhY2VtZW50IGFuZCBpcyB0aGVyZWZvcmVcbiAgICAgICAgLy8gc3RhbGUvaW5jb3JyZWN0XG5cbiAgICAgICAgc3RhdGUucmVzZXQgPSBmYWxzZTtcbiAgICAgICAgc3RhdGUucGxhY2VtZW50ID0gc3RhdGUub3B0aW9ucy5wbGFjZW1lbnQ7IC8vIE9uIGVhY2ggdXBkYXRlIGN5Y2xlLCB0aGUgYG1vZGlmaWVyc0RhdGFgIHByb3BlcnR5IGZvciBlYWNoIG1vZGlmaWVyXG4gICAgICAgIC8vIGlzIGZpbGxlZCB3aXRoIHRoZSBpbml0aWFsIGRhdGEgc3BlY2lmaWVkIGJ5IHRoZSBtb2RpZmllci4gVGhpcyBtZWFuc1xuICAgICAgICAvLyBpdCBkb2Vzbid0IHBlcnNpc3QgYW5kIGlzIGZyZXNoIG9uIGVhY2ggdXBkYXRlLlxuICAgICAgICAvLyBUbyBlbnN1cmUgcGVyc2lzdGVudCBkYXRhLCB1c2UgYCR7bmFtZX0jcGVyc2lzdGVudGBcblxuICAgICAgICBzdGF0ZS5vcmRlcmVkTW9kaWZpZXJzLmZvckVhY2goZnVuY3Rpb24gKG1vZGlmaWVyKSB7XG4gICAgICAgICAgcmV0dXJuIHN0YXRlLm1vZGlmaWVyc0RhdGFbbW9kaWZpZXIubmFtZV0gPSBPYmplY3QuYXNzaWduKHt9LCBtb2RpZmllci5kYXRhKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHZhciBfX2RlYnVnX2xvb3BzX18gPSAwO1xuXG4gICAgICAgIGZvciAodmFyIGluZGV4ID0gMDsgaW5kZXggPCBzdGF0ZS5vcmRlcmVkTW9kaWZpZXJzLmxlbmd0aDsgaW5kZXgrKykge1xuICAgICAgICAgIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gXCJwcm9kdWN0aW9uXCIpIHtcbiAgICAgICAgICAgIF9fZGVidWdfbG9vcHNfXyArPSAxO1xuXG4gICAgICAgICAgICBpZiAoX19kZWJ1Z19sb29wc19fID4gMTAwKSB7XG4gICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoSU5GSU5JVEVfTE9PUF9FUlJPUik7XG4gICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cblxuICAgICAgICAgIGlmIChzdGF0ZS5yZXNldCA9PT0gdHJ1ZSkge1xuICAgICAgICAgICAgc3RhdGUucmVzZXQgPSBmYWxzZTtcbiAgICAgICAgICAgIGluZGV4ID0gLTE7XG4gICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICB2YXIgX3N0YXRlJG9yZGVyZWRNb2RpZmllID0gc3RhdGUub3JkZXJlZE1vZGlmaWVyc1tpbmRleF0sXG4gICAgICAgICAgICAgIGZuID0gX3N0YXRlJG9yZGVyZWRNb2RpZmllLmZuLFxuICAgICAgICAgICAgICBfc3RhdGUkb3JkZXJlZE1vZGlmaWUyID0gX3N0YXRlJG9yZGVyZWRNb2RpZmllLm9wdGlvbnMsXG4gICAgICAgICAgICAgIF9vcHRpb25zID0gX3N0YXRlJG9yZGVyZWRNb2RpZmllMiA9PT0gdm9pZCAwID8ge30gOiBfc3RhdGUkb3JkZXJlZE1vZGlmaWUyLFxuICAgICAgICAgICAgICBuYW1lID0gX3N0YXRlJG9yZGVyZWRNb2RpZmllLm5hbWU7XG5cbiAgICAgICAgICBpZiAodHlwZW9mIGZuID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICBzdGF0ZSA9IGZuKHtcbiAgICAgICAgICAgICAgc3RhdGU6IHN0YXRlLFxuICAgICAgICAgICAgICBvcHRpb25zOiBfb3B0aW9ucyxcbiAgICAgICAgICAgICAgbmFtZTogbmFtZSxcbiAgICAgICAgICAgICAgaW5zdGFuY2U6IGluc3RhbmNlXG4gICAgICAgICAgICB9KSB8fCBzdGF0ZTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICAvLyBBc3luYyBhbmQgb3B0aW1pc3RpY2FsbHkgb3B0aW1pemVkIHVwZGF0ZSBcdTIwMTMgaXQgd2lsbCBub3QgYmUgZXhlY3V0ZWQgaWZcbiAgICAgIC8vIG5vdCBuZWNlc3NhcnkgKGRlYm91bmNlZCB0byBydW4gYXQgbW9zdCBvbmNlLXBlci10aWNrKVxuICAgICAgdXBkYXRlOiBkZWJvdW5jZShmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSkge1xuICAgICAgICAgIGluc3RhbmNlLmZvcmNlVXBkYXRlKCk7XG4gICAgICAgICAgcmVzb2x2ZShzdGF0ZSk7XG4gICAgICAgIH0pO1xuICAgICAgfSksXG4gICAgICBkZXN0cm95OiBmdW5jdGlvbiBkZXN0cm95KCkge1xuICAgICAgICBjbGVhbnVwTW9kaWZpZXJFZmZlY3RzKCk7XG4gICAgICAgIGlzRGVzdHJveWVkID0gdHJ1ZTtcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgaWYgKCFhcmVWYWxpZEVsZW1lbnRzKHJlZmVyZW5jZSwgcG9wcGVyKSkge1xuICAgICAgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSBcInByb2R1Y3Rpb25cIikge1xuICAgICAgICBjb25zb2xlLmVycm9yKElOVkFMSURfRUxFTUVOVF9FUlJPUik7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBpbnN0YW5jZTtcbiAgICB9XG5cbiAgICBpbnN0YW5jZS5zZXRPcHRpb25zKG9wdGlvbnMpLnRoZW4oZnVuY3Rpb24gKHN0YXRlKSB7XG4gICAgICBpZiAoIWlzRGVzdHJveWVkICYmIG9wdGlvbnMub25GaXJzdFVwZGF0ZSkge1xuICAgICAgICBvcHRpb25zLm9uRmlyc3RVcGRhdGUoc3RhdGUpO1xuICAgICAgfVxuICAgIH0pOyAvLyBNb2RpZmllcnMgaGF2ZSB0aGUgYWJpbGl0eSB0byBleGVjdXRlIGFyYml0cmFyeSBjb2RlIGJlZm9yZSB0aGUgZmlyc3RcbiAgICAvLyB1cGRhdGUgY3ljbGUgcnVucy4gVGhleSB3aWxsIGJlIGV4ZWN1dGVkIGluIHRoZSBzYW1lIG9yZGVyIGFzIHRoZSB1cGRhdGVcbiAgICAvLyBjeWNsZS4gVGhpcyBpcyB1c2VmdWwgd2hlbiBhIG1vZGlmaWVyIGFkZHMgc29tZSBwZXJzaXN0ZW50IGRhdGEgdGhhdFxuICAgIC8vIG90aGVyIG1vZGlmaWVycyBuZWVkIHRvIHVzZSwgYnV0IHRoZSBtb2RpZmllciBpcyBydW4gYWZ0ZXIgdGhlIGRlcGVuZGVudFxuICAgIC8vIG9uZS5cblxuICAgIGZ1bmN0aW9uIHJ1bk1vZGlmaWVyRWZmZWN0cygpIHtcbiAgICAgIHN0YXRlLm9yZGVyZWRNb2RpZmllcnMuZm9yRWFjaChmdW5jdGlvbiAoX3JlZjMpIHtcbiAgICAgICAgdmFyIG5hbWUgPSBfcmVmMy5uYW1lLFxuICAgICAgICAgICAgX3JlZjMkb3B0aW9ucyA9IF9yZWYzLm9wdGlvbnMsXG4gICAgICAgICAgICBvcHRpb25zID0gX3JlZjMkb3B0aW9ucyA9PT0gdm9pZCAwID8ge30gOiBfcmVmMyRvcHRpb25zLFxuICAgICAgICAgICAgZWZmZWN0ID0gX3JlZjMuZWZmZWN0O1xuXG4gICAgICAgIGlmICh0eXBlb2YgZWZmZWN0ID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgdmFyIGNsZWFudXBGbiA9IGVmZmVjdCh7XG4gICAgICAgICAgICBzdGF0ZTogc3RhdGUsXG4gICAgICAgICAgICBuYW1lOiBuYW1lLFxuICAgICAgICAgICAgaW5zdGFuY2U6IGluc3RhbmNlLFxuICAgICAgICAgICAgb3B0aW9uczogb3B0aW9uc1xuICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgdmFyIG5vb3BGbiA9IGZ1bmN0aW9uIG5vb3BGbigpIHt9O1xuXG4gICAgICAgICAgZWZmZWN0Q2xlYW51cEZucy5wdXNoKGNsZWFudXBGbiB8fCBub29wRm4pO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBjbGVhbnVwTW9kaWZpZXJFZmZlY3RzKCkge1xuICAgICAgZWZmZWN0Q2xlYW51cEZucy5mb3JFYWNoKGZ1bmN0aW9uIChmbikge1xuICAgICAgICByZXR1cm4gZm4oKTtcbiAgICAgIH0pO1xuICAgICAgZWZmZWN0Q2xlYW51cEZucyA9IFtdO1xuICAgIH1cblxuICAgIHJldHVybiBpbnN0YW5jZTtcbiAgfTtcbn1cbmV4cG9ydCB2YXIgY3JlYXRlUG9wcGVyID0gLyojX19QVVJFX18qL3BvcHBlckdlbmVyYXRvcigpOyAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgaW1wb3J0L25vLXVudXNlZC1tb2R1bGVzXG5cbmV4cG9ydCB7IGRldGVjdE92ZXJmbG93IH07IiwgImltcG9ydCB7IHBvcHBlckdlbmVyYXRvciwgZGV0ZWN0T3ZlcmZsb3cgfSBmcm9tIFwiLi9jcmVhdGVQb3BwZXIuanNcIjtcbmltcG9ydCBldmVudExpc3RlbmVycyBmcm9tIFwiLi9tb2RpZmllcnMvZXZlbnRMaXN0ZW5lcnMuanNcIjtcbmltcG9ydCBwb3BwZXJPZmZzZXRzIGZyb20gXCIuL21vZGlmaWVycy9wb3BwZXJPZmZzZXRzLmpzXCI7XG5pbXBvcnQgY29tcHV0ZVN0eWxlcyBmcm9tIFwiLi9tb2RpZmllcnMvY29tcHV0ZVN0eWxlcy5qc1wiO1xuaW1wb3J0IGFwcGx5U3R5bGVzIGZyb20gXCIuL21vZGlmaWVycy9hcHBseVN0eWxlcy5qc1wiO1xuaW1wb3J0IG9mZnNldCBmcm9tIFwiLi9tb2RpZmllcnMvb2Zmc2V0LmpzXCI7XG5pbXBvcnQgZmxpcCBmcm9tIFwiLi9tb2RpZmllcnMvZmxpcC5qc1wiO1xuaW1wb3J0IHByZXZlbnRPdmVyZmxvdyBmcm9tIFwiLi9tb2RpZmllcnMvcHJldmVudE92ZXJmbG93LmpzXCI7XG5pbXBvcnQgYXJyb3cgZnJvbSBcIi4vbW9kaWZpZXJzL2Fycm93LmpzXCI7XG5pbXBvcnQgaGlkZSBmcm9tIFwiLi9tb2RpZmllcnMvaGlkZS5qc1wiO1xudmFyIGRlZmF1bHRNb2RpZmllcnMgPSBbZXZlbnRMaXN0ZW5lcnMsIHBvcHBlck9mZnNldHMsIGNvbXB1dGVTdHlsZXMsIGFwcGx5U3R5bGVzLCBvZmZzZXQsIGZsaXAsIHByZXZlbnRPdmVyZmxvdywgYXJyb3csIGhpZGVdO1xudmFyIGNyZWF0ZVBvcHBlciA9IC8qI19fUFVSRV9fKi9wb3BwZXJHZW5lcmF0b3Ioe1xuICBkZWZhdWx0TW9kaWZpZXJzOiBkZWZhdWx0TW9kaWZpZXJzXG59KTsgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGltcG9ydC9uby11bnVzZWQtbW9kdWxlc1xuXG5leHBvcnQgeyBjcmVhdGVQb3BwZXIsIHBvcHBlckdlbmVyYXRvciwgZGVmYXVsdE1vZGlmaWVycywgZGV0ZWN0T3ZlcmZsb3cgfTsgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGltcG9ydC9uby11bnVzZWQtbW9kdWxlc1xuXG5leHBvcnQgeyBjcmVhdGVQb3BwZXIgYXMgY3JlYXRlUG9wcGVyTGl0ZSB9IGZyb20gXCIuL3BvcHBlci1saXRlLmpzXCI7IC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBpbXBvcnQvbm8tdW51c2VkLW1vZHVsZXNcblxuZXhwb3J0ICogZnJvbSBcIi4vbW9kaWZpZXJzL2luZGV4LmpzXCI7IiwgImltcG9ydCBNZXRhZGF0YU1lbnUgZnJvbSBcIm1haW5cIjtcbmltcG9ydCB7XG4gICAgbm9ybWFsaXplUGF0aCxcbiAgICBUQWJzdHJhY3RGaWxlLFxuICAgIFRGaWxlLFxuICAgIFRGb2xkZXIsXG4gICAgVmF1bHQsXG59IGZyb20gXCJvYnNpZGlhblwiO1xuXG5cbmV4cG9ydCBmdW5jdGlvbiByZXNvbHZlX3Rmb2xkZXIocGx1Z2luOiBNZXRhZGF0YU1lbnUsIGZvbGRlcl9zdHI6IHN0cmluZyk6IFRGb2xkZXIge1xuICAgIGZvbGRlcl9zdHIgPSBub3JtYWxpemVQYXRoKGZvbGRlcl9zdHIpO1xuXG4gICAgY29uc3QgZm9sZGVyID0gcGx1Z2luLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgoZm9sZGVyX3N0cik7XG4gICAgaWYgKCFmb2xkZXIpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBGb2xkZXIgXCIke2ZvbGRlcl9zdHJ9XCIgZG9lc24ndCBleGlzdGApO1xuICAgIH1cbiAgICBpZiAoIShmb2xkZXIgaW5zdGFuY2VvZiBURm9sZGVyKSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYCR7Zm9sZGVyX3N0cn0gaXMgYSBmaWxlLCBub3QgYSBmb2xkZXJgKTtcbiAgICB9XG5cbiAgICByZXR1cm4gZm9sZGVyO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0X3RmaWxlc19mcm9tX2ZvbGRlcihcbiAgICBwbHVnaW46IE1ldGFkYXRhTWVudSxcbiAgICBmb2xkZXJfc3RyOiBzdHJpbmdcbik6IEFycmF5PFRGaWxlPiB7XG4gICAgY29uc3QgZm9sZGVyID0gcmVzb2x2ZV90Zm9sZGVyKHBsdWdpbiwgZm9sZGVyX3N0cik7XG5cbiAgICBjb25zdCBmaWxlczogQXJyYXk8VEZpbGU+ID0gW107XG4gICAgVmF1bHQucmVjdXJzZUNoaWxkcmVuKGZvbGRlciwgKGZpbGU6IFRBYnN0cmFjdEZpbGUpID0+IHtcbiAgICAgICAgaWYgKGZpbGUgaW5zdGFuY2VvZiBURmlsZSkge1xuICAgICAgICAgICAgZmlsZXMucHVzaChmaWxlKTtcbiAgICAgICAgfVxuICAgIH0pO1xuXG4gICAgZmlsZXMuc29ydCgoYSwgYikgPT4ge1xuICAgICAgICByZXR1cm4gYS5iYXNlbmFtZS5sb2NhbGVDb21wYXJlKGIuYmFzZW5hbWUpO1xuICAgIH0pO1xuXG4gICAgcmV0dXJuIGZpbGVzO1xufSIsICJpbXBvcnQgTWV0YWRhdGFNZW51IGZyb20gXCJtYWluXCI7XG5pbXBvcnQgeyBNZW51LCBzZXRJY29uLCBUZXh0Q29tcG9uZW50LCBURmlsZSB9IGZyb20gXCJvYnNpZGlhblwiO1xuaW1wb3J0IHsgcmVwbGFjZVZhbHVlcyB9IGZyb20gXCJzcmMvY29tbWFuZHMvcmVwbGFjZVZhbHVlc1wiO1xuaW1wb3J0IEZpZWxkQ29tbWFuZFN1Z2dlc3RNb2RhbCBmcm9tIFwic3JjL29wdGlvbnMvRmllbGRDb21tYW5kU3VnZ2VzdE1vZGFsXCI7XG5pbXBvcnQgU2VsZWN0TW9kYWwgZnJvbSBcInNyYy9vcHRpb25Nb2RhbHMvZmllbGRzL1NlbGVjdE1vZGFsXCI7XG5pbXBvcnQgeyBGaWVsZEljb24sIEZpZWxkVHlwZSB9IGZyb20gXCJzcmMvdHlwZXMvZmllbGRUeXBlc1wiO1xuaW1wb3J0IEZpZWxkIGZyb20gXCIuLi9GaWVsZFwiO1xuaW1wb3J0IEFic3RyYWN0TGlzdEJhc2VkRmllbGQgZnJvbSBcIi4vQWJzdHJhY3RMaXN0QmFzZWRGaWVsZFwiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBDeWNsZUZpZWxkIGV4dGVuZHMgQWJzdHJhY3RMaXN0QmFzZWRGaWVsZCB7XG5cbiAgICB2YWx1ZXNQcm9tcHRDb21wb25lbnRzOiBBcnJheTxUZXh0Q29tcG9uZW50PiA9IFtdO1xuXG4gICAgY29uc3RydWN0b3IocGx1Z2luOiBNZXRhZGF0YU1lbnUsIGZpZWxkOiBGaWVsZCkge1xuICAgICAgICBzdXBlcihwbHVnaW4sIGZpZWxkLCBGaWVsZFR5cGUuQ3ljbGUpXG4gICAgfVxuXG4gICAgcHVibGljIG5leHRPcHRpb24odmFsdWU6IHN0cmluZyk6IHN0cmluZyB7XG4gICAgICAgIGxldCBuZXh0T3B0aW9uOiBzdHJpbmc7XG4gICAgICAgIGNvbnN0IHZhbHVlcyA9IHRoaXMuZ2V0T3B0aW9uc0xpc3QoKTtcbiAgICAgICAgaWYgKHZhbHVlcy5pbmRleE9mKHZhbHVlKSA9PT0gLTEpIHtcbiAgICAgICAgICAgIG5leHRPcHRpb24gPSB2YWx1ZXNbMF0gfHwgXCJcIlxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgbmV4dE9wdGlvbiA9IHZhbHVlc1sodmFsdWVzLmluZGV4T2YodmFsdWUpICsgMSkgJSB2YWx1ZXMubGVuZ3RoXVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBuZXh0T3B0aW9uXG4gICAgfVxuXG4gICAgcHVibGljIGFkZEZpZWxkT3B0aW9uKG5hbWU6IHN0cmluZywgdmFsdWU6IHN0cmluZywgZmlsZTogVEZpbGUsIGxvY2F0aW9uOiBNZW51IHwgRmllbGRDb21tYW5kU3VnZ2VzdE1vZGFsKTogdm9pZCB7XG4gICAgICAgIGlmIChDeWNsZUZpZWxkLmlzTWVudShsb2NhdGlvbikpIHtcbiAgICAgICAgICAgIGxvY2F0aW9uLmFkZEl0ZW0oKGl0ZW0pID0+IHtcbiAgICAgICAgICAgICAgICBpdGVtLnNldFRpdGxlKGAke25hbWV9IDogJHt2YWx1ZX0gXHUyNUI3ICR7dGhpcy5uZXh0T3B0aW9uKHZhbHVlKX1gKTtcbiAgICAgICAgICAgICAgICBpdGVtLnNldEljb24oRmllbGRJY29uW0ZpZWxkVHlwZS5DeWNsZV0pO1xuICAgICAgICAgICAgICAgIGl0ZW0ub25DbGljayhhc3luYyAoKSA9PiBhd2FpdCB0aGlzLnBsdWdpbi5maWxlVGFza01hbmFnZXJcbiAgICAgICAgICAgICAgICAgICAgLnB1c2hUYXNrKCgpID0+IHsgcmVwbGFjZVZhbHVlcyh0aGlzLnBsdWdpbiwgZmlsZSwgbmFtZSwgdGhpcy5uZXh0T3B0aW9uKHZhbHVlKS50b1N0cmluZygpKSB9KSk7XG4gICAgICAgICAgICAgICAgaXRlbS5zZXRTZWN0aW9uKFwibWV0YWRhdGEtbWVudS5maWVsZHNcIik7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSBlbHNlIGlmIChDeWNsZUZpZWxkLmlzU3VnZ2VzdChsb2NhdGlvbikpIHtcbiAgICAgICAgICAgIGxvY2F0aW9uLm9wdGlvbnMucHVzaCh7XG4gICAgICAgICAgICAgICAgaWQ6IGAke25hbWV9XyR7dmFsdWV9XyR7dGhpcy5uZXh0T3B0aW9uKHZhbHVlKX1gLFxuICAgICAgICAgICAgICAgIGFjdGlvbkxhYmVsOiBgPHNwYW4+PGI+JHtuYW1lfTwvYj4gOiAke3ZhbHVlfSBcdTI1QjcgJHt0aGlzLm5leHRPcHRpb24odmFsdWUpfTwvc3Bhbj5gLFxuICAgICAgICAgICAgICAgIGFjdGlvbjogYXN5bmMgKCkgPT4gYXdhaXQgdGhpcy5wbHVnaW4uZmlsZVRhc2tNYW5hZ2VyXG4gICAgICAgICAgICAgICAgICAgIC5wdXNoVGFzaygoKSA9PiB7IHJlcGxhY2VWYWx1ZXModGhpcy5wbHVnaW4sIGZpbGUsIG5hbWUsIHRoaXMubmV4dE9wdGlvbih2YWx1ZSkudG9TdHJpbmcoKSkgfSksXG4gICAgICAgICAgICAgICAgaWNvbjogRmllbGRJY29uW0ZpZWxkVHlwZS5DeWNsZV1cbiAgICAgICAgICAgIH0pXG4gICAgICAgIH07XG4gICAgfTtcblxuICAgIHB1YmxpYyBjcmVhdGVBbmRPcGVuRmllbGRNb2RhbChmaWxlOiBURmlsZSwgc2VsZWN0ZWRGaWVsZE5hbWU6IHN0cmluZywgdmFsdWU/OiBzdHJpbmcsIGxpbmVOdW1iZXI/OiBudW1iZXIsIGluRnJvbnRtYXR0ZXI/OiBib29sZWFuLCBhZnRlcj86IGJvb2xlYW4pOiB2b2lkIHtcbiAgICAgICAgY29uc3QgZmllbGRNb2RhbCA9IG5ldyBTZWxlY3RNb2RhbCh0aGlzLnBsdWdpbiwgZmlsZSwgdmFsdWUgfHwgXCJcIiwgdGhpcy5maWVsZCwgbGluZU51bWJlciwgaW5Gcm9udG1hdHRlciwgYWZ0ZXIpO1xuICAgICAgICBmaWVsZE1vZGFsLnRpdGxlRWwuc2V0VGV4dChgU2VsZWN0IG9wdGlvbiBmb3IgJHtzZWxlY3RlZEZpZWxkTmFtZX1gKTtcbiAgICAgICAgZmllbGRNb2RhbC5vcGVuKCk7XG4gICAgfVxuXG4gICAgcHVibGljIGNyZWF0ZUR2RmllbGQoXG4gICAgICAgIGR2OiBhbnksXG4gICAgICAgIHA6IGFueSxcbiAgICAgICAgZmllbGRDb250YWluZXI6IEhUTUxFbGVtZW50LFxuICAgICAgICBhdHRycz86IHsgY2xzPzogc3RyaW5nLCBhdHRyPzogUmVjb3JkPHN0cmluZywgc3RyaW5nPiwgb3B0aW9ucz86IFJlY29yZDxzdHJpbmcsIGFueT4gfVxuICAgICk6IHZvaWQge1xuICAgICAgICBjb25zdCBuZXh0T3B0aW9uID0gdGhpcy5uZXh0T3B0aW9uKHBbdGhpcy5maWVsZC5uYW1lXSlcbiAgICAgICAgY29uc3QgZmllbGRWYWx1ZSA9IGR2LmVsKCdzcGFuJywgcFt0aGlzLmZpZWxkLm5hbWVdLCBhdHRycyk7XG4gICAgICAgIC8qIGVuZCBzcGFjZXIgKi9cbiAgICAgICAgY29uc3Qgc3BhY2VyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgICAgICAgc3BhY2VyLnNldEF0dHIoXCJjbGFzc1wiLCBcIm1ldGFkYXRhLW1lbnUtZHYtZmllbGQtc3BhY2VyXCIpO1xuICAgICAgICAvKiBidXR0b24gdG8gZGlzcGxheSBpbnB1dCAqL1xuICAgICAgICBjb25zdCBidXR0b24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiYnV0dG9uXCIpO1xuICAgICAgICBzZXRJY29uKGJ1dHRvbiwgRmllbGRJY29uW0ZpZWxkVHlwZS5DeWNsZV0pXG4gICAgICAgIGJ1dHRvbi5zZXRBdHRyKCdjbGFzcycsIFwibWV0YWRhdGEtbWVudS1kdi1maWVsZC1idXR0b25cIik7XG4gICAgICAgIGlmICghYXR0cnM/Lm9wdGlvbnM/LmFsd2F5c09uKSB7XG4gICAgICAgICAgICBidXR0b24uaGlkZSgpO1xuICAgICAgICAgICAgc3BhY2VyLnNob3coKTtcbiAgICAgICAgICAgIGZpZWxkQ29udGFpbmVyLm9ubW91c2VvdmVyID0gKCkgPT4ge1xuICAgICAgICAgICAgICAgIGJ1dHRvbi5zaG93KCk7XG4gICAgICAgICAgICAgICAgc3BhY2VyLmhpZGUoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGZpZWxkQ29udGFpbmVyLm9ubW91c2VvdXQgPSAoKSA9PiB7XG4gICAgICAgICAgICAgICAgYnV0dG9uLmhpZGUoKTtcbiAgICAgICAgICAgICAgICBzcGFjZXIuc2hvdygpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cblxuICAgICAgICAvKiBidXR0b24gb24gY2xpY2sgOiBnbyB0byBuZXh0IHZlcnNpb24qL1xuICAgICAgICBidXR0b24ub25jbGljayA9IChlKSA9PiB7XG4gICAgICAgICAgICBDeWNsZUZpZWxkLnJlcGxhY2VWYWx1ZXModGhpcy5wbHVnaW4sIHAuZmlsZS5wYXRoLCB0aGlzLmZpZWxkLm5hbWUsIG5leHRPcHRpb24pO1xuICAgICAgICAgICAgaWYgKCFhdHRycz8ub3B0aW9ucz8uYWx3YXlzT24pIHtcbiAgICAgICAgICAgICAgICBidXR0b24uaGlkZSgpO1xuICAgICAgICAgICAgICAgIHNwYWNlci5zaG93KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBmaWVsZENvbnRhaW5lci5hcHBlbmRDaGlsZChidXR0b24pO1xuICAgICAgICBmaWVsZENvbnRhaW5lci5hcHBlbmRDaGlsZChmaWVsZFZhbHVlKTtcbiAgICAgICAgZmllbGRDb250YWluZXIuYXBwZW5kQ2hpbGQoc3BhY2VyKTtcbiAgICB9XG59IiwgImltcG9ydCBNZXRhZGF0YU1lbnUgZnJvbSBcIm1haW5cIjtcbmltcG9ydCB7IE1lbnUsIHNldEljb24sIFRleHRDb21wb25lbnQsIFRGaWxlIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgRmllbGRDb21tYW5kU3VnZ2VzdE1vZGFsIGZyb20gXCJzcmMvb3B0aW9ucy9GaWVsZENvbW1hbmRTdWdnZXN0TW9kYWxcIjtcbmltcG9ydCBNdWx0aVNlbGVjdE1vZGFsIGZyb20gXCJzcmMvb3B0aW9uTW9kYWxzL2ZpZWxkcy9NdWx0aVNlbGVjdE1vZGFsXCI7XG5pbXBvcnQgeyBGaWVsZEljb24sIEZpZWxkVHlwZSB9IGZyb20gXCJzcmMvdHlwZXMvZmllbGRUeXBlc1wiO1xuaW1wb3J0IEZpZWxkIGZyb20gXCIuLi9GaWVsZFwiO1xuaW1wb3J0IEFic3RyYWN0TGlzdEJhc2VkRmllbGQgZnJvbSBcIi4vQWJzdHJhY3RMaXN0QmFzZWRGaWVsZFwiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBNdWx0aUZpZWxkIGV4dGVuZHMgQWJzdHJhY3RMaXN0QmFzZWRGaWVsZCB7XG5cbiAgICB2YWx1ZXNQcm9tcHRDb21wb25lbnRzOiBBcnJheTxUZXh0Q29tcG9uZW50PiA9IFtdO1xuXG4gICAgY29uc3RydWN0b3IocGx1Z2luOiBNZXRhZGF0YU1lbnUsIGZpZWxkOiBGaWVsZCkge1xuICAgICAgICBzdXBlcihwbHVnaW4sIGZpZWxkLCBGaWVsZFR5cGUuTXVsdGkpXG4gICAgfVxuXG4gICAgcHVibGljIGFkZEZpZWxkT3B0aW9uKG5hbWU6IHN0cmluZywgdmFsdWU6IHN0cmluZywgZmlsZTogVEZpbGUsIGxvY2F0aW9uOiBNZW51IHwgRmllbGRDb21tYW5kU3VnZ2VzdE1vZGFsKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IG1vZGFsID0gbmV3IE11bHRpU2VsZWN0TW9kYWwodGhpcy5wbHVnaW4sIGZpbGUsIHRoaXMuZmllbGQsIHZhbHVlKTtcbiAgICAgICAgbW9kYWwudGl0bGVFbC5zZXRUZXh0KFwiU2VsZWN0IHZhbHVlc1wiKTtcbiAgICAgICAgaWYgKE11bHRpRmllbGQuaXNNZW51KGxvY2F0aW9uKSkge1xuICAgICAgICAgICAgbG9jYXRpb24uYWRkSXRlbSgoaXRlbSkgPT4ge1xuICAgICAgICAgICAgICAgIGl0ZW0uc2V0VGl0bGUoYFVwZGF0ZSA8JHtuYW1lfT5gKTtcbiAgICAgICAgICAgICAgICBpdGVtLnNldEljb24oRmllbGRJY29uW0ZpZWxkVHlwZS5NdWx0aV0pO1xuICAgICAgICAgICAgICAgIGl0ZW0ub25DbGljaygoKSA9PiBtb2RhbC5vcGVuKCkpO1xuICAgICAgICAgICAgICAgIGl0ZW0uc2V0U2VjdGlvbihcIm1ldGFkYXRhLW1lbnUuZmllbGRzXCIpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0gZWxzZSBpZiAoTXVsdGlGaWVsZC5pc1N1Z2dlc3QobG9jYXRpb24pKSB7XG4gICAgICAgICAgICBsb2NhdGlvbi5vcHRpb25zLnB1c2goe1xuICAgICAgICAgICAgICAgIGlkOiBgdXBkYXRlXyR7bmFtZX1gLFxuICAgICAgICAgICAgICAgIGFjdGlvbkxhYmVsOiBgPHNwYW4+VXBkYXRlIDxiPiR7bmFtZX08L2I+PC9zcGFuPmAsXG4gICAgICAgICAgICAgICAgYWN0aW9uOiAoKSA9PiBtb2RhbC5vcGVuKCksXG4gICAgICAgICAgICAgICAgaWNvbjogRmllbGRJY29uW0ZpZWxkVHlwZS5NdWx0aV1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuICAgIH07XG5cbiAgICBwdWJsaWMgY3JlYXRlQW5kT3BlbkZpZWxkTW9kYWwoZmlsZTogVEZpbGUsIHNlbGVjdGVkRmllbGROYW1lOiBzdHJpbmcsIHZhbHVlPzogc3RyaW5nLCBsaW5lTnVtYmVyPzogbnVtYmVyLCBpbkZyb250bWF0dGVyPzogYm9vbGVhbiwgYWZ0ZXI/OiBib29sZWFuKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IGZpZWxkTW9kYWwgPSBuZXcgTXVsdGlTZWxlY3RNb2RhbCh0aGlzLnBsdWdpbiwgZmlsZSwgdGhpcy5maWVsZCwgdmFsdWUgfHwgXCJcIiwgbGluZU51bWJlciwgaW5Gcm9udG1hdHRlciwgYWZ0ZXIpO1xuICAgICAgICBmaWVsZE1vZGFsLnRpdGxlRWwuc2V0VGV4dChgU2VsZWN0IG9wdGlvbnMgZm9yICR7c2VsZWN0ZWRGaWVsZE5hbWV9YCk7XG4gICAgICAgIGZpZWxkTW9kYWwub3BlbigpO1xuICAgIH1cblxuICAgIHB1YmxpYyBjcmVhdGVEdkZpZWxkKFxuICAgICAgICBkdjogYW55LFxuICAgICAgICBwOiBhbnksXG4gICAgICAgIGZpZWxkQ29udGFpbmVyOiBIVE1MRWxlbWVudCxcbiAgICAgICAgYXR0cnM/OiB7IGNscz86IHN0cmluZywgYXR0cj86IFJlY29yZDxzdHJpbmcsIHN0cmluZz4sIG9wdGlvbnM/OiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+IH1cbiAgICApOiB2b2lkIHtcbiAgICAgICAgLyogXG4gICAgICAgIHRoaXMgY29udHJvbCBkaXNwbGF5cyBieSBkZWZhdWx0IHRoZSBsaXN0IG9mIHZhbHVlXG4gICAgICAgIHdoZW4gbW91c2VvdmVyOiB3ZSBkaXNwbGF5IGEgXCIrXCIgYnV0dG9uIGF0IHRoZSBiZWdnaW5pbmcgb2YgdGhlIGZpZWxkIHRvIGFkZCBhIG5ldyB2YWx1ZSBhbmQgYSBcInhcIiBidXR0b24gYWZ0ZXIgdGhlIHZhbHVlIGhvdmVyZWQgdG8gcmVtb3ZlIGl0IGZyb20gbGlzdFxuICAgICAgICB3aGVuIHRoZSBcInhcIiBidXR0b24gaXMgY2xpY2tlZCwgd2UgcmVtb3ZlIHRoZSBsaXN0IGZyb20gdmFsdWVcbiAgICAgICAgd2hlbiB0aGUgXCIrXCIgYnV0dG9uIGlzIGNsaWNrZWQsIHdlIGRpc3BsYXkgYSBzZWxlY3QgZHJvcGRvd24gZmlsdGVyZWQgd2l0aCByZW1haW5pbmcgb3B0aW9ucy4gd2hlbiBvbmUgb3B0aW9uIGlzIHNlbGVjdGVkIHdlIGFkZCBpdCB0byB0aGUgbGlzdCBhbmQgcmVtb3ZlIHRoZSBjb250cm9sXG4gICAgICAgICovXG4gICAgICAgIGxldCB2YWx1ZUhvdmVyZWQgPSBmYWxzZTtcbiAgICAgICAgbGV0IGN1cnJlbnRWYWx1ZXM6IHN0cmluZ1tdID0gW107XG4gICAgICAgIGlmIChwW3RoaXMuZmllbGQubmFtZV0pIHtcbiAgICAgICAgICAgIGlmIChPYmplY3Qua2V5cyhwW3RoaXMuZmllbGQubmFtZV0pLmluY2x1ZGVzKFwicGF0aFwiKSkge1xuICAgICAgICAgICAgICAgIGN1cnJlbnRWYWx1ZXMgPSBbYFtbJHtwW3RoaXMuZmllbGQubmFtZV0ucGF0aC5yZXBsYWNlKFwiLm1kXCIsIFwiXCIpfV1dYF1cbiAgICAgICAgICAgIH0gZWxzZSBpZiAoQXJyYXkuaXNBcnJheShwW3RoaXMuZmllbGQubmFtZV0pKSB7XG4gICAgICAgICAgICAgICAgY3VycmVudFZhbHVlcy5wdXNoKC4uLnBbdGhpcy5maWVsZC5uYW1lXS5tYXAoKHY6IHN0cmluZykgPT4gdi50cmltKCkpKVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgY3VycmVudFZhbHVlcyA9IHBbdGhpcy5maWVsZC5uYW1lXS5zcGxpdChcIixcIikubWFwKCh2OiBzdHJpbmcpID0+IHYudHJpbSgpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8qIHNlbGVjdCBjb250YWluZXIgKi9cbiAgICAgICAgY29uc3Qgc2VsZWN0Q29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgICAgICAgY29uc3Qgc2VsZWN0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInNlbGVjdFwiKTtcbiAgICAgICAgc2VsZWN0LnNldEF0dHIoXCJjbGFzc1wiLCBcIm1ldGFkYXRhLW1lbnUtZHYtc2VsZWN0XCIpO1xuICAgICAgICBzZWxlY3RDb250YWluZXIuYXBwZW5kQ2hpbGQoc2VsZWN0KVxuICAgICAgICBjb25zdCBudWxsT3B0aW9uID0gbmV3IE9wdGlvbihcIi0tc2VsZWN0LS1cIiwgdW5kZWZpbmVkKTtcbiAgICAgICAgc2VsZWN0LmFkZChudWxsT3B0aW9uKTtcbiAgICAgICAgY29uc3QgdmFsdWVzID0gdGhpcy5nZXRPcHRpb25zTGlzdCgpO1xuICAgICAgICB2YWx1ZXMuZmlsdGVyKHYgPT4gIWN1cnJlbnRWYWx1ZXMuY29udGFpbnModikpLmZvckVhY2godiA9PiB7XG4gICAgICAgICAgICBjb25zdCB2YWx1ZSA9IG5ldyBPcHRpb24odiwgdik7XG4gICAgICAgICAgICBpZiAocFt0aGlzLmZpZWxkLm5hbWVdID09PSB2YWx1ZSkge1xuICAgICAgICAgICAgICAgIHZhbHVlLnNlbGVjdGVkID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHNlbGVjdC5hZGQodmFsdWUpO1xuICAgICAgICB9KVxuICAgICAgICBzZWxlY3Qub25jaGFuZ2UgPSBhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBuZXdWYWx1ZXMgPSBbLi4uY3VycmVudFZhbHVlcywgc2VsZWN0LnZhbHVlXS5qb2luKFwiLCBcIik7XG4gICAgICAgICAgICBNdWx0aUZpZWxkLnJlcGxhY2VWYWx1ZXModGhpcy5wbHVnaW4sIHAuZmlsZS5wYXRoLCB0aGlzLmZpZWxkLm5hbWUsIG5ld1ZhbHVlcyk7XG4gICAgICAgICAgICBzaW5nbGVTcGFjZXIuaGlkZSgpO1xuICAgICAgICAgICAgZG91YmxlU3BhY2VyLnNob3coKTtcbiAgICAgICAgICAgIGFkZEJ0bi5oaWRlKCk7XG4gICAgICAgICAgICBmaWVsZENvbnRhaW5lci5hcHBlbmRDaGlsZCh2YWx1ZXNDb250YWluZXIpO1xuICAgICAgICAgICAgZmllbGRDb250YWluZXIuYXBwZW5kQ2hpbGQoc2luZ2xlU3BhY2VyKTtcbiAgICAgICAgICAgIGZpZWxkQ29udGFpbmVyLmFwcGVuZENoaWxkKGRvdWJsZVNwYWNlcik7XG4gICAgICAgICAgICBmaWVsZENvbnRhaW5lci5yZW1vdmVDaGlsZChzZWxlY3RDb250YWluZXIpO1xuICAgICAgICB9XG5cbiAgICAgICAgc2VsZWN0Lm9ua2V5ZG93biA9IChlKSA9PiB7XG4gICAgICAgICAgICBpZiAoZS5rZXkgPT09ICdFc2NhcGUnKSB7XG4gICAgICAgICAgICAgICAgZmllbGRDb250YWluZXIuYXBwZW5kQ2hpbGQodmFsdWVzQ29udGFpbmVyKTtcbiAgICAgICAgICAgICAgICBmaWVsZENvbnRhaW5lci5hcHBlbmRDaGlsZChzaW5nbGVTcGFjZXIpO1xuICAgICAgICAgICAgICAgIGZpZWxkQ29udGFpbmVyLmFwcGVuZENoaWxkKGRvdWJsZVNwYWNlcik7XG4gICAgICAgICAgICAgICAgZmllbGRDb250YWluZXIucmVtb3ZlQ2hpbGQoc2VsZWN0Q29udGFpbmVyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBjb25zdCBjbG9zZVNlbGVjdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJidXR0b25cIik7XG4gICAgICAgIHNldEljb24oY2xvc2VTZWxlY3QsIFwiY3Jvc3NcIik7XG4gICAgICAgIGNsb3NlU2VsZWN0LmFkZENsYXNzKFwibWV0YWRhdGEtbWVudS1kdi1maWVsZC1idXR0b25cIik7XG4gICAgICAgIGNsb3NlU2VsZWN0LmFkZENsYXNzKFwibXVsdGlcIik7XG4gICAgICAgIGNsb3NlU2VsZWN0Lm9uY2xpY2sgPSAoKSA9PiB7XG4gICAgICAgICAgICBmaWVsZENvbnRhaW5lci5hcHBlbmRDaGlsZCh2YWx1ZXNDb250YWluZXIpO1xuICAgICAgICAgICAgZmllbGRDb250YWluZXIuYXBwZW5kQ2hpbGQoc2luZ2xlU3BhY2VyKTtcbiAgICAgICAgICAgIGZpZWxkQ29udGFpbmVyLmFwcGVuZENoaWxkKGRvdWJsZVNwYWNlcik7XG4gICAgICAgICAgICBmaWVsZENvbnRhaW5lci5yZW1vdmVDaGlsZChzZWxlY3RDb250YWluZXIpO1xuICAgICAgICB9O1xuICAgICAgICBzZWxlY3RDb250YWluZXIuYXBwZW5kQ2hpbGQoY2xvc2VTZWxlY3QpO1xuXG4gICAgICAgIC8qIGN1cnJlbnQgdmFsdWVzIGNvbnRhaW5lciAqL1xuICAgICAgICBjb25zdCB2YWx1ZXNDb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgICAgICB2YWx1ZXNDb250YWluZXIuYWRkQ2xhc3MoXCJtZXRhZGF0YS1tZW51LWR2LW11bHRpLXZhbHVlcy1jb250YWluZXJcIik7XG5cbiAgICAgICAgLyogY3VycmVudCB2YWx1ZXMgKi9cbiAgICAgICAgY3VycmVudFZhbHVlcy5mb3JFYWNoKHYgPT4ge1xuICAgICAgICAgICAgY29uc3QgdmFsdWVDb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgICAgICAgICAgdmFsdWVDb250YWluZXIuYWRkQ2xhc3MoXCJtZXRhZGF0YS1tZW51LWR2LW11bHRpLXZhbHVlcy1jb250YWluZXJcIik7XG5cblxuICAgICAgICAgICAgY29uc3QgdmFsdWVSZW1vdmVCdG4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiYnV0dG9uXCIpO1xuICAgICAgICAgICAgc2V0SWNvbih2YWx1ZVJlbW92ZUJ0biwgXCJjcm9zc1wiKVxuICAgICAgICAgICAgdmFsdWVSZW1vdmVCdG4uYWRkQ2xhc3MoXCJtZXRhZGF0YS1tZW51LWR2LWZpZWxkLWJ1dHRvblwiKTtcbiAgICAgICAgICAgIHZhbHVlUmVtb3ZlQnRuLmFkZENsYXNzKFwibXVsdGlcIik7XG4gICAgICAgICAgICB2YWx1ZVJlbW92ZUJ0bi5oaWRlKCk7XG4gICAgICAgICAgICB2YWx1ZVJlbW92ZUJ0bi5vbmNsaWNrID0gYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IHJlbWFpbmluZ1ZhbHVlcyA9IGN1cnJlbnRWYWx1ZXMuZmlsdGVyKGNWID0+IGNWICE9PSB2KS5qb2luKFwiLCBcIilcbiAgICAgICAgICAgICAgICBNdWx0aUZpZWxkLnJlcGxhY2VWYWx1ZXModGhpcy5wbHVnaW4sIHAuZmlsZS5wYXRoLCB0aGlzLmZpZWxkLm5hbWUsIHJlbWFpbmluZ1ZhbHVlcyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YWx1ZUNvbnRhaW5lci5hcHBlbmRDaGlsZCh2YWx1ZVJlbW92ZUJ0bik7XG5cbiAgICAgICAgICAgIGNvbnN0IHZhbHVlTGFiZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgICAgICAgICAgdmFsdWVMYWJlbC5zZXRUZXh0KHYpO1xuICAgICAgICAgICAgdmFsdWVMYWJlbC5hZGRDbGFzcyhcIm1ldGFkYXRhLW1lbnUtZHYtbXVsdGktdmFsdWUtbGFiZWxcIik7XG4gICAgICAgICAgICB2YWx1ZUNvbnRhaW5lci5hcHBlbmRDaGlsZCh2YWx1ZUxhYmVsKTtcblxuICAgICAgICAgICAgdmFsdWVDb250YWluZXIub25tb3VzZW92ZXIgPSAoKSA9PiB7XG4gICAgICAgICAgICAgICAgdmFsdWVIb3ZlcmVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBkb3VibGVTcGFjZXIuaGlkZSgpO1xuICAgICAgICAgICAgICAgIHNpbmdsZVNwYWNlci5oaWRlKCk7XG4gICAgICAgICAgICAgICAgdmFsdWVSZW1vdmVCdG4uc2hvdygpO1xuICAgICAgICAgICAgICAgIHZhbHVlTGFiZWwuYWRkQ2xhc3MoXCJob3ZlcmVkXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFsdWVDb250YWluZXIub25tb3VzZW91dCA9ICgpID0+IHtcbiAgICAgICAgICAgICAgICB2YWx1ZUhvdmVyZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB2YWx1ZVJlbW92ZUJ0bi5oaWRlKCk7XG4gICAgICAgICAgICAgICAgc2luZ2xlU3BhY2VyLnNob3coKTtcbiAgICAgICAgICAgICAgICBkb3VibGVTcGFjZXIuaGlkZSgpO1xuICAgICAgICAgICAgICAgIHZhbHVlTGFiZWwucmVtb3ZlQ2xhc3MoXCJob3ZlcmVkXCIpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YWx1ZXNDb250YWluZXIuYXBwZW5kQ2hpbGQodmFsdWVDb250YWluZXIpO1xuICAgICAgICB9KVxuXG4gICAgICAgIC8qIGJ1dHRvbiB0byBkaXNwbGF5IGlucHV0ICovXG4gICAgICAgIGNvbnN0IGFkZEJ0biA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJidXR0b25cIik7XG4gICAgICAgIHNldEljb24oYWRkQnRuLCBcImJ1bGxldC1saXN0XCIpO1xuICAgICAgICBhZGRCdG4uc2V0QXR0cignY2xhc3MnLCBcIm1ldGFkYXRhLW1lbnUtZHYtZmllbGQtYnV0dG9uXCIpO1xuXG4gICAgICAgIHZhbHVlc0NvbnRhaW5lci5hcHBlbmRDaGlsZChhZGRCdG4pO1xuICAgICAgICBhZGRCdG4ub25jbGljayA9ICgpID0+IHtcbiAgICAgICAgICAgIGZpZWxkQ29udGFpbmVyLnJlbW92ZUNoaWxkKHZhbHVlc0NvbnRhaW5lcik7XG4gICAgICAgICAgICBmaWVsZENvbnRhaW5lci5yZW1vdmVDaGlsZChzaW5nbGVTcGFjZXIpO1xuICAgICAgICAgICAgZmllbGRDb250YWluZXIucmVtb3ZlQ2hpbGQoZG91YmxlU3BhY2VyKTtcbiAgICAgICAgICAgIGZpZWxkQ29udGFpbmVyLmFwcGVuZENoaWxkKHNlbGVjdENvbnRhaW5lcik7XG4gICAgICAgIH1cblxuICAgICAgICAvKiBlbmQgc3BhY2VyICovXG4gICAgICAgIGNvbnN0IHNpbmdsZVNwYWNlciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gICAgICAgIHNpbmdsZVNwYWNlci5zZXRBdHRyKFwiY2xhc3NcIiwgXCJtZXRhZGF0YS1tZW51LWR2LWZpZWxkLXNwYWNlclwiKVxuICAgICAgICBjb25zdCBkb3VibGVTcGFjZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgICAgICBkb3VibGVTcGFjZXIuc2V0QXR0cihcImNsYXNzXCIsIFwibWV0YWRhdGEtbWVudS1kdi1maWVsZC1kb3VibGUtc3BhY2VyXCIpXG5cbiAgICAgICAgaWYgKCFhdHRycz8ub3B0aW9ucz8uYWx3YXlzT24pIHtcbiAgICAgICAgICAgIGFkZEJ0bi5oaWRlKCk7XG4gICAgICAgICAgICBmaWVsZENvbnRhaW5lci5vbm1vdXNlb3ZlciA9ICgpID0+IHtcbiAgICAgICAgICAgICAgICBhZGRCdG4uc2hvdygpO1xuICAgICAgICAgICAgICAgIGRvdWJsZVNwYWNlci5oaWRlKCk7XG4gICAgICAgICAgICAgICAgaWYgKCF2YWx1ZUhvdmVyZWQpIHNpbmdsZVNwYWNlci5zaG93KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmaWVsZENvbnRhaW5lci5vbm1vdXNlb3V0ID0gKCkgPT4ge1xuICAgICAgICAgICAgICAgIGFkZEJ0bi5oaWRlKCk7XG4gICAgICAgICAgICAgICAgc2luZ2xlU3BhY2VyLmhpZGUoKTtcbiAgICAgICAgICAgICAgICBkb3VibGVTcGFjZXIuc2hvdygpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLyogaW5pdGlhbCBzdGF0ZSAqL1xuICAgICAgICBpZiAoIWF0dHJzPy5vcHRpb25zPy5hbHdheXNPbikge1xuICAgICAgICAgICAgc2luZ2xlU3BhY2VyLmhpZGUoKTtcbiAgICAgICAgICAgIGRvdWJsZVNwYWNlci5zaG93KCk7XG4gICAgICAgICAgICBhZGRCdG4uaGlkZSgpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgc2luZ2xlU3BhY2VyLnNob3coKTtcbiAgICAgICAgICAgIGRvdWJsZVNwYWNlci5oaWRlKCk7XG4gICAgICAgICAgICBhZGRCdG4uc2hvdygpO1xuICAgICAgICB9XG4gICAgICAgIGZpZWxkQ29udGFpbmVyLmFwcGVuZENoaWxkKHZhbHVlc0NvbnRhaW5lcik7XG4gICAgICAgIGZpZWxkQ29udGFpbmVyLmFwcGVuZENoaWxkKHNpbmdsZVNwYWNlcik7XG4gICAgICAgIGZpZWxkQ29udGFpbmVyLmFwcGVuZENoaWxkKGRvdWJsZVNwYWNlcik7XG4gICAgfVxufVxuIiwgImltcG9ydCB7IFRGaWxlLCBCdXR0b25Db21wb25lbnQsIFN1Z2dlc3RNb2RhbCwgc2V0SWNvbiwgTm90aWNlLCBwYXJzZUxpbmt0ZXh0IH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgRmllbGQgZnJvbSBcInNyYy9maWVsZHMvRmllbGRcIjtcbmltcG9ydCB7IHJlcGxhY2VWYWx1ZXMgfSBmcm9tIFwic3JjL2NvbW1hbmRzL3JlcGxhY2VWYWx1ZXNcIjtcbmltcG9ydCB7IGluc2VydFZhbHVlcyB9IGZyb20gXCJzcmMvY29tbWFuZHMvaW5zZXJ0VmFsdWVzXCI7XG5pbXBvcnQgTWV0YWRhdGFNZW51IGZyb20gXCJtYWluXCI7XG5pbXBvcnQgeyBGaWVsZE1hbmFnZXIgfSBmcm9tIFwic3JjL3R5cGVzL2ZpZWxkVHlwZXNcIjtcbmltcG9ydCBBYnN0cmFjdExpc3RCYXNlZEZpZWxkIGZyb20gXCJzcmMvZmllbGRzL2ZpZWxkTWFuYWdlcnMvQWJzdHJhY3RMaXN0QmFzZWRGaWVsZFwiO1xuaW1wb3J0ICogYXMgc2VsZWN0VmFsdWVzU291cmNlIGZyb20gXCJzcmMvdHlwZXMvc2VsZWN0VmFsdWVzU291cmNlVHlwZXNcIlxuaW1wb3J0IHsgcmVsYXRpdmVUaW1lUm91bmRpbmcgfSBmcm9tIFwibW9tZW50XCI7XG5pbXBvcnQgRmlsZUZpZWxkIGZyb20gXCJzcmMvZmllbGRzL2ZpZWxkTWFuYWdlcnMvRmlsZUZpZWxkXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIE11bHRpU3VnZ2VzdE1vZGFsIGV4dGVuZHMgU3VnZ2VzdE1vZGFsPHN0cmluZz4ge1xuXG4gICAgcHJpdmF0ZSBzZWxlY3RlZE9wdGlvbnM6IEFycmF5PHN0cmluZz47XG4gICAgcHJpdmF0ZSBhZGRCdXR0b246IEJ1dHRvbkNvbXBvbmVudDtcbiAgICBwcml2YXRlIHJlbG9hZEJ1dHRvbjogQnV0dG9uQ29tcG9uZW50O1xuXG4gICAgY29uc3RydWN0b3IoXG4gICAgICAgIHByaXZhdGUgcGx1Z2luOiBNZXRhZGF0YU1lbnUsXG4gICAgICAgIHByaXZhdGUgZmlsZTogVEZpbGUsXG4gICAgICAgIHByaXZhdGUgZmllbGQ6IEZpZWxkLFxuICAgICAgICBpbml0aWFsT3B0aW9uczogc3RyaW5nLFxuICAgICAgICBwcml2YXRlIGxpbmVOdW1iZXI6IG51bWJlciA9IC0xLFxuICAgICAgICBwcml2YXRlIGluRnJvbnRtYXR0ZXI6IGJvb2xlYW4gPSBmYWxzZSxcbiAgICAgICAgcHJpdmF0ZSBhZnRlcjogYm9vbGVhbiA9IGZhbHNlXG4gICAgKSB7XG4gICAgICAgIHN1cGVyKHBsdWdpbi5hcHApO1xuICAgICAgICBpZiAoaW5pdGlhbE9wdGlvbnMpIHtcbiAgICAgICAgICAgIGlmIChBcnJheS5pc0FycmF5KGluaXRpYWxPcHRpb25zKSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGR2QXBpID0gdGhpcy5wbHVnaW4uYXBwLnBsdWdpbnMucGx1Z2lucy5kYXRhdmlldz8uYXBpXG4gICAgICAgICAgICAgICAgaWYgKGR2QXBpICYmIGluaXRpYWxPcHRpb25zLnNvbWUobyA9PiBkdkFwaS52YWx1ZS5pc0xpbmsobykpKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWRPcHRpb25zID0gaW5pdGlhbE9wdGlvbnMubWFwKGl0ZW0gPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGR2QXBpLnZhbHVlLmlzTGluayhpdGVtKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBGaWxlRmllbGQuYnVpbGRNYXJrRG93bkxpbmsodGhpcy5wbHVnaW4sIHRoaXMuZmlsZSwgaXRlbS5wYXRoKVxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gaXRlbS50b1N0cmluZygpXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWRPcHRpb25zID0gaW5pdGlhbE9wdGlvbnMubWFwKGl0ZW0gPT4gaXRlbS50b1N0cmluZygpKVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoaW5pdGlhbE9wdGlvbnMudG9TdHJpbmcoKS5zdGFydHNXaXRoKFwiW1tcIikpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdGVkT3B0aW9ucyA9IGluaXRpYWxPcHRpb25zLnNwbGl0KFwiLFwiKS5tYXAoaXRlbSA9PiBpdGVtLnRyaW0oKSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWRPcHRpb25zID0gaW5pdGlhbE9wdGlvbnMudG9TdHJpbmcoKS5yZXBsYWNlKC9eXFxbKC4qKVxcXSQvLCBcIiQxXCIpLnNwbGl0KFwiLFwiKS5tYXAoaXRlbSA9PiBpdGVtLnRyaW0oKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLnNlbGVjdGVkT3B0aW9ucyA9IFtdO1xuICAgICAgICB9XG4gICAgfTtcblxuICAgIGFzeW5jIG9uT3BlbigpIHtcbiAgICAgICAgc3VwZXIub25PcGVuKClcbiAgICAgICAgdGhpcy5jb250YWluZXJFbC5vbmtleWRvd24gPSBhc3luYyAoZSkgPT4ge1xuICAgICAgICAgICAgaWYgKGUua2V5ID09IFwiRW50ZXJcIiAmJiBlLmFsdEtleSkge1xuICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucmVwbGFjZVZhbHVlcygpO1xuICAgICAgICAgICAgICAgIHRoaXMuY2xvc2UoKVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cblxuICAgICAgICBjb25zdCB1cGRhdGVTZXR0aW5nc0luZm9Db250YWluZXIgPSB0aGlzLmNvbnRhaW5lckVsLmNyZWF0ZURpdih7IGNsczogXCJtZXRhZGF0YS1tZW51LXZhbHVlLXN1Z2dlc3Rlci1ub3RpY2UtY29udGFpbmVyXCIgfSlcbiAgICAgICAgY29uc3Qgbm90aWNlID0gdXBkYXRlU2V0dGluZ3NJbmZvQ29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJtZXRhZGF0YS1tZW51LXZhbHVlLXN1Z2dlc3Rlci1ub3RpY2UtbGFiZWxcIiB9KTtcbiAgICAgICAgdXBkYXRlU2V0dGluZ3NJbmZvQ29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJtZXRhZGF0YS1tZW51LXZhbHVlLXN1Z2dlc3Rlci1ub3RpY2Utc3BhY2VyXCIgfSk7XG4gICAgICAgIHVwZGF0ZVNldHRpbmdzSW5mb0NvbnRhaW5lci5oaWRlKCk7XG4gICAgICAgIHRoaXMuY29udGFpbmVyRWwuZmluZChcIi5wcm9tcHRcIikucHJlcGVuZCh1cGRhdGVTZXR0aW5nc0luZm9Db250YWluZXIpO1xuXG4gICAgICAgIGNvbnN0IGlucHV0Q29udGFpbmVyID0gdGhpcy5jb250YWluZXJFbC5jcmVhdGVEaXYoeyBjbHM6IFwibWV0YWRhdGEtbWVudS12YWx1ZS1zdWdnZXN0ZXItaW5wdXQtY29udGFpbmVyXCIgfSlcbiAgICAgICAgaW5wdXRDb250YWluZXIuYXBwZW5kQ2hpbGQodGhpcy5pbnB1dEVsKVxuICAgICAgICB0aGlzLmNvbnRhaW5lckVsLmZpbmQoXCIucHJvbXB0XCIpLnByZXBlbmQoaW5wdXRDb250YWluZXIpXG5cblxuICAgICAgICBjb25zdCBidXR0b25Db250YWluZXIgPSB0aGlzLmNvbnRhaW5lckVsLmNyZWF0ZURpdih7IGNsczogXCJtZXRhZGF0YS1tZW51LXZhbHVlLXN1Z2dlc3Rlci1hY3Rpb25zXCIgfSlcbiAgICAgICAgYnV0dG9uQ29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJtZXRhZGF0YS1tZW51LXZhbHVlLXN1Z2dlc3Rlci1hY3Rpb25zLXNwYWNlclwiIH0pXG4gICAgICAgIGNvbnN0IGluZm9Db250YWluZXIgPSBidXR0b25Db250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcIm1ldGFkYXRhLW1lbnUtdmFsdWUtc3VnZ2VzdGVyLWluZm9cIiB9KVxuICAgICAgICBpbmZvQ29udGFpbmVyLnNldFRleHQoXCJBbHQrRW50ZXIgdG8gc2F2ZVwiKVxuICAgICAgICAvLyBhZGRCdXR0b25cbiAgICAgICAgdGhpcy5hZGRCdXR0b24gPSBuZXcgQnV0dG9uQ29tcG9uZW50KGlucHV0Q29udGFpbmVyKVxuICAgICAgICB0aGlzLmFkZEJ1dHRvbi5zZXRJY29uKFwicGx1c1wiKVxuICAgICAgICB0aGlzLmFkZEJ1dHRvbi5vbkNsaWNrKGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMuYWRkTmV3VmFsdWVUb1NldHRpbmdzKCk7XG4gICAgICAgICAgICBub3RpY2Uuc2V0VGV4dChgJHt0aGlzLmlucHV0RWwudmFsdWV9IGFkZGVkIHRvIHRoZSBmaWVsZCBzZXR0aW5nc1xcbmNsaWNrIG9uIHJlbG9hZGApXG4gICAgICAgICAgICB0aGlzLmFkZEJ1dHRvbi5idXR0b25FbC5oaWRlKCk7XG4gICAgICAgICAgICB1cGRhdGVTZXR0aW5nc0luZm9Db250YWluZXIuc2hvdygpO1xuICAgICAgICB9KVxuICAgICAgICB0aGlzLmFkZEJ1dHRvbi5idXR0b25FbC5hZGRDbGFzcyhcIm1ldGFkYXRhLW1lbnUtdmFsdWUtc3VnZ2VzdGVyLWJ1dHRvblwiKVxuICAgICAgICB0aGlzLmFkZEJ1dHRvbi5zZXRDdGEoKTtcbiAgICAgICAgdGhpcy5hZGRCdXR0b24uc2V0VG9vbHRpcChcIkFkZCB0aGlzIHZhbHVlIHRvIHRoaXMgZmllbGQgc2V0dGluZ3NcIilcbiAgICAgICAgdGhpcy5hZGRCdXR0b24uYnV0dG9uRWwuaGlkZSgpO1xuICAgICAgICAvL3JlbG9hZCBidXR0b25cbiAgICAgICAgdGhpcy5yZWxvYWRCdXR0b24gPSBuZXcgQnV0dG9uQ29tcG9uZW50KHVwZGF0ZVNldHRpbmdzSW5mb0NvbnRhaW5lcilcbiAgICAgICAgdGhpcy5yZWxvYWRCdXR0b24uYnV0dG9uRWwuYWRkQ2xhc3MoXCJtZXRhZGF0YS1tZW51LXZhbHVlLXN1Z2dlc3Rlci1idXR0b25cIilcbiAgICAgICAgdGhpcy5yZWxvYWRCdXR0b24uc2V0SWNvbihcInJlZnJlc2gtY3dcIilcbiAgICAgICAgdGhpcy5yZWxvYWRCdXR0b24uc2V0Q3RhKClcbiAgICAgICAgdGhpcy5yZWxvYWRCdXR0b24ub25DbGljayhhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLmlucHV0RWwudmFsdWUgPSAnJztcbiAgICAgICAgICAgIC8vQHRzLWlnbm9yZVxuICAgICAgICAgICAgdGhpcy51cGRhdGVTdWdnZXN0aW9ucygpO1xuICAgICAgICAgICAgdXBkYXRlU2V0dGluZ3NJbmZvQ29udGFpbmVyLmhpZGUoKTtcbiAgICAgICAgICAgIHRoaXMuYWRkQnV0dG9uLmJ1dHRvbkVsLmhpZGUoKTtcbiAgICAgICAgfSlcbiAgICAgICAgLy9jb25maXJtIGJ1dHRvblxuICAgICAgICBjb25zdCBjb25maXJtQnV0dG9uID0gbmV3IEJ1dHRvbkNvbXBvbmVudChidXR0b25Db250YWluZXIpXG4gICAgICAgIGNvbmZpcm1CdXR0b24uc2V0SWNvbihcImNoZWNrbWFya1wiKVxuICAgICAgICBjb25maXJtQnV0dG9uLm9uQ2xpY2soYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgYXdhaXQgdGhpcy5yZXBsYWNlVmFsdWVzKCk7XG4gICAgICAgICAgICB0aGlzLmNsb3NlKClcbiAgICAgICAgfSlcbiAgICAgICAgY29uZmlybUJ1dHRvbi5idXR0b25FbC5hZGRDbGFzcyhcIm1ldGFkYXRhLW1lbnUtdmFsdWUtc3VnZ2VzdGVyLWJ1dHRvblwiKVxuICAgICAgICAvL2NhbmNlbCBidXR0b25cbiAgICAgICAgY29uc3QgY2FuY2VsQnV0dG9uID0gbmV3IEJ1dHRvbkNvbXBvbmVudChidXR0b25Db250YWluZXIpXG4gICAgICAgIGNhbmNlbEJ1dHRvbi5zZXRJY29uKFwiY3Jvc3NcIilcbiAgICAgICAgY2FuY2VsQnV0dG9uLm9uQ2xpY2soKCkgPT4geyB0aGlzLmNsb3NlKCk7IH0pXG4gICAgICAgIGNhbmNlbEJ1dHRvbi5idXR0b25FbC5hZGRDbGFzcyhcIm1ldGFkYXRhLW1lbnUtdmFsdWUtc3VnZ2VzdGVyLWJ1dHRvblwiKVxuICAgICAgICAvL2NsZWFyIHZhbHVlIGJ1dHRvblxuICAgICAgICBjb25zdCBjbGVhckJ1dHRvbiA9IG5ldyBCdXR0b25Db21wb25lbnQoYnV0dG9uQ29udGFpbmVyKVxuICAgICAgICBjbGVhckJ1dHRvbi5zZXRJY29uKFwidHJhc2hcIilcbiAgICAgICAgY2xlYXJCdXR0b24ub25DbGljayhhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICBhd2FpdCB0aGlzLmNsZWFyVmFsdWVzKCk7XG4gICAgICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICAgIH0pXG4gICAgICAgIGNsZWFyQnV0dG9uLmJ1dHRvbkVsLmFkZENsYXNzKFwibWV0YWRhdGEtbWVudS12YWx1ZS1zdWdnZXN0ZXItYnV0dG9uXCIpXG4gICAgICAgIGNsZWFyQnV0dG9uLmJ1dHRvbkVsLmFkZENsYXNzKFwiZGFuZ2VyXCIpXG4gICAgICAgIHRoaXMubW9kYWxFbC5hcHBlbmRDaGlsZChidXR0b25Db250YWluZXIpXG4gICAgfVxuXG4gICAgYXN5bmMgYWRkTmV3VmFsdWVUb1NldHRpbmdzKCk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICBjb25zdCBuZXdWYWx1ZSA9IHRoaXMuaW5wdXRFbC52YWx1ZTtcbiAgICAgICAgY29uc3QgZmlsZUNsYXNzTmFtZSA9IHRoaXMucGx1Z2luLmZpZWxkSW5kZXguZmlsZXNGaWxlQ2xhc3NOYW1lLmdldCh0aGlzLmZpbGUucGF0aClcbiAgICAgICAgaWYgKGZpbGVDbGFzc05hbWUpIHtcbiAgICAgICAgICAgIGNvbnN0IGZpbGVDbGFzcyA9IHRoaXMucGx1Z2luLmZpZWxkSW5kZXguZmlsZUNsYXNzZXNOYW1lLmdldChmaWxlQ2xhc3NOYW1lKVxuICAgICAgICAgICAgY29uc3QgZmlsZUNsYXNzQXR0cmlidXRlID0gZmlsZUNsYXNzPy5hdHRyaWJ1dGVzLmZpbmQoYXR0ciA9PiBhdHRyLm5hbWUgPT09IHRoaXMuZmllbGQubmFtZSlcbiAgICAgICAgICAgIGlmIChmaWxlQ2xhc3MgJiYgZmlsZUNsYXNzQXR0cmlidXRlKSB7XG4gICAgICAgICAgICAgICAgbGV0IG5ld09wdGlvbnM6IHN0cmluZ1tdIHwgUmVjb3JkPHN0cmluZywgc3RyaW5nPjtcbiAgICAgICAgICAgICAgICBpZiAoQXJyYXkuaXNBcnJheShmaWxlQ2xhc3NBdHRyaWJ1dGUub3B0aW9ucykpIHtcbiAgICAgICAgICAgICAgICAgICAgbmV3T3B0aW9ucyA9IFsuLi5maWxlQ2xhc3NBdHRyaWJ1dGUub3B0aW9ucywgbmV3VmFsdWVdXG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IGZpbGVDbGFzcy51cGRhdGVBdHRyaWJ1dGUoZmlsZUNsYXNzQXR0cmlidXRlLnR5cGUsIGZpbGVDbGFzc0F0dHJpYnV0ZS5uYW1lLCBuZXdPcHRpb25zLCBmaWxlQ2xhc3NBdHRyaWJ1dGUpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZmlsZUNsYXNzQXR0cmlidXRlLm9wdGlvbnMuc291cmNlVHlwZSA9PT0gc2VsZWN0VmFsdWVzU291cmNlLlR5cGUuVmFsdWVzTGlzdCkge1xuICAgICAgICAgICAgICAgICAgICBuZXdPcHRpb25zID0gZmlsZUNsYXNzQXR0cmlidXRlLm9wdGlvbnMudmFsdWVzTGlzdCBhcyBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+O1xuICAgICAgICAgICAgICAgICAgICBuZXdPcHRpb25zW2Ake09iamVjdC5rZXlzKGZpbGVDbGFzc0F0dHJpYnV0ZS5vcHRpb25zLnZhbHVlc0xpc3QpLmxlbmd0aH1gXSA9IG5ld1ZhbHVlXG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IGZpbGVDbGFzcy51cGRhdGVBdHRyaWJ1dGUoZmlsZUNsYXNzQXR0cmlidXRlLnR5cGUsIGZpbGVDbGFzc0F0dHJpYnV0ZS5uYW1lLCBuZXdPcHRpb25zLCBmaWxlQ2xhc3NBdHRyaWJ1dGUpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZmlsZUNsYXNzQXR0cmlidXRlLm9wdGlvbnMuc291cmNlVHlwZSA9PT0gc2VsZWN0VmFsdWVzU291cmNlLlR5cGUuVmFsdWVzTGlzdE5vdGVQYXRoKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHZhbHVlc0ZpbGUgPSB0aGlzLnBsdWdpbi5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKGZpbGVDbGFzc0F0dHJpYnV0ZS5vcHRpb25zLnZhbHVlc0xpc3ROb3RlUGF0aCk7XG4gICAgICAgICAgICAgICAgICAgIGlmICh2YWx1ZXNGaWxlIGluc3RhbmNlb2YgVEZpbGUgJiYgdmFsdWVzRmlsZS5leHRlbnNpb24gPT0gXCJtZFwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLnBsdWdpbi5hcHAudmF1bHQucmVhZCh2YWx1ZXNGaWxlKVxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uYXBwLnZhdWx0Lm1vZGlmeSh2YWx1ZXNGaWxlLCBgJHtyZXN1bHR9XFxuJHtuZXdWYWx1ZX1gKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIG5ld09wdGlvbnMgPSBmaWxlQ2xhc3NBdHRyaWJ1dGUub3B0aW9ucztcbiAgICAgICAgICAgICAgICAgICAgbmV3T3B0aW9uc1tgJHtPYmplY3Qua2V5cyhmaWxlQ2xhc3NBdHRyaWJ1dGUub3B0aW9ucykubGVuZ3RofWBdID0gbmV3VmFsdWVcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgZmlsZUNsYXNzLnVwZGF0ZUF0dHJpYnV0ZShmaWxlQ2xhc3NBdHRyaWJ1dGUudHlwZSwgZmlsZUNsYXNzQXR0cmlidXRlLm5hbWUsIG5ld09wdGlvbnMsIGZpbGVDbGFzc0F0dHJpYnV0ZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29uc3QgcHJlc2V0RmllbGQgPSB0aGlzLnBsdWdpbi5zZXR0aW5ncy5wcmVzZXRGaWVsZHMuZmluZChmaWVsZCA9PiBmaWVsZC5uYW1lID09PSB0aGlzLmZpZWxkLm5hbWUpXG4gICAgICAgICAgICBpZiAocHJlc2V0RmllbGQ/Lm9wdGlvbnMuc291cmNlVHlwZSA9PT0gc2VsZWN0VmFsdWVzU291cmNlLlR5cGUuVmFsdWVzTGlzdE5vdGVQYXRoKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgdmFsdWVzRmlsZSA9IHRoaXMucGx1Z2luLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgocHJlc2V0RmllbGQub3B0aW9ucy52YWx1ZXNMaXN0Tm90ZVBhdGgpXG4gICAgICAgICAgICAgICAgaWYgKHZhbHVlc0ZpbGUgaW5zdGFuY2VvZiBURmlsZSAmJiB2YWx1ZXNGaWxlLmV4dGVuc2lvbiA9PSBcIm1kXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy5wbHVnaW4uYXBwLnZhdWx0LnJlYWQodmFsdWVzRmlsZSlcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uYXBwLnZhdWx0Lm1vZGlmeSh2YWx1ZXNGaWxlLCBgJHtyZXN1bHR9XFxuJHtuZXdWYWx1ZX1gKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHByZXNldEZpZWxkPy5vcHRpb25zLnNvdXJjZVR5cGUgPT09IHNlbGVjdFZhbHVlc1NvdXJjZS5UeXBlLlZhbHVlc0xpc3QpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBjdXJyZW50RXhpc3RpbmdGaWVsZCA9IHRoaXMucGx1Z2luLmluaXRpYWxQcm9wZXJ0aWVzLmZpbmQocCA9PiBwLmlkID09IHRoaXMuZmllbGQuaWQpO1xuICAgICAgICAgICAgICAgIGlmIChjdXJyZW50RXhpc3RpbmdGaWVsZCkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCB2YWx1ZXNMaXN0ID0gY3VycmVudEV4aXN0aW5nRmllbGQub3B0aW9ucy52YWx1ZXNMaXN0XG4gICAgICAgICAgICAgICAgICAgIHZhbHVlc0xpc3RbYCR7T2JqZWN0LmtleXModmFsdWVzTGlzdCkubGVuZ3RoICsgMX1gXSA9IG5ld1ZhbHVlXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLmZpZWxkSW5kZXguZnVsbEluZGV4KFwidmFsdWVBZGRcIik7XG4gICAgICAgIHRoaXMuc2VsZWN0ZWRPcHRpb25zLnB1c2gobmV3VmFsdWUpXG4gICAgfVxuXG4gICAgYXN5bmMgcmVwbGFjZVZhbHVlcygpIHtcbiAgICAgICAgY29uc3Qgb3B0aW9ucyA9IHRoaXMuc2VsZWN0ZWRPcHRpb25zO1xuICAgICAgICBpZiAodGhpcy5saW5lTnVtYmVyID09IC0xKSB7XG4gICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5maWxlVGFza01hbmFnZXJcbiAgICAgICAgICAgICAgICAucHVzaFRhc2soKCkgPT4geyByZXBsYWNlVmFsdWVzKHRoaXMucGx1Z2luLCB0aGlzLmZpbGUsIHRoaXMuZmllbGQubmFtZSwgb3B0aW9ucy5qb2luKFwiLCBcIikpIH0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29uc3QgcmVuZGVyZWRWYWx1ZXMgPSAhdGhpcy5pbkZyb250bWF0dGVyID8gb3B0aW9ucy5qb2luKFwiLCBcIikgOiBvcHRpb25zLmxlbmd0aCA+IDEgPyBgWyR7b3B0aW9ucy5qb2luKFwiLCBcIil9XWAgOiBgJHtvcHRpb25zWzBdfWBcbiAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLmZpbGVUYXNrTWFuYWdlclxuICAgICAgICAgICAgICAgIC5wdXNoVGFzaygoKSA9PiB7IGluc2VydFZhbHVlcyh0aGlzLnBsdWdpbiwgdGhpcy5maWxlLCB0aGlzLmZpZWxkLm5hbWUsIHJlbmRlcmVkVmFsdWVzLCB0aGlzLmxpbmVOdW1iZXIsIHRoaXMuaW5Gcm9udG1hdHRlciwgdGhpcy5hZnRlcikgfSk7XG4gICAgICAgIH07XG4gICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICB9XG5cbiAgICBhc3luYyBjbGVhclZhbHVlcygpIHtcbiAgICAgICAgaWYgKHRoaXMubGluZU51bWJlciA9PSAtMSkge1xuICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uZmlsZVRhc2tNYW5hZ2VyXG4gICAgICAgICAgICAgICAgLnB1c2hUYXNrKCgpID0+IHsgcmVwbGFjZVZhbHVlcyh0aGlzLnBsdWdpbiwgdGhpcy5maWxlLCB0aGlzLmZpZWxkLm5hbWUsIFwiXCIpIH0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uZmlsZVRhc2tNYW5hZ2VyXG4gICAgICAgICAgICAgICAgLnB1c2hUYXNrKCgpID0+IHsgaW5zZXJ0VmFsdWVzKHRoaXMucGx1Z2luLCB0aGlzLmZpbGUsIHRoaXMuZmllbGQubmFtZSwgXCJcIiwgdGhpcy5saW5lTnVtYmVyLCB0aGlzLmluRnJvbnRtYXR0ZXIsIHRoaXMuYWZ0ZXIpIH0pO1xuICAgICAgICB9O1xuICAgIH1cblxuICAgIHJlbmRlclNlbGVjdGVkKCkge1xuICAgICAgICAvL0B0cy1pZ25vcmVcbiAgICAgICAgY29uc3QgY2hvb3NlciA9IHRoaXMuY2hvb3NlclxuICAgICAgICBjb25zdCBzdWdnZXN0aW9uczogSFRNTERpdkVsZW1lbnRbXSA9IGNob29zZXIuc3VnZ2VzdGlvbnNcbiAgICAgICAgY29uc3QgdmFsdWVzOiBzdHJpbmdbXSA9IGNob29zZXIudmFsdWVzXG4gICAgICAgIHN1Z2dlc3Rpb25zLmZvckVhY2goKHMsIGkpID0+IHtcbiAgICAgICAgICAgIGlmICh0aGlzLnNlbGVjdGVkT3B0aW9ucy5pbmNsdWRlcyh2YWx1ZXNbaV0udG9TdHJpbmcoKSkpIHtcbiAgICAgICAgICAgICAgICBzLmFkZENsYXNzKFwibWV0YWRhdGEtbWVudS12YWx1ZS1zZWxlY3RlZFwiKVxuICAgICAgICAgICAgICAgIGlmIChzLnF1ZXJ5U2VsZWN0b3JBbGwoXCIubWV0YWRhdGEtbWVudS1jb21tYW5kLXN1Z2dlc3QtaWNvblwiKS5sZW5ndGggPT0gMCkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBpY29uQ29udGFpbmVyID0gcy5jcmVhdGVEaXYoeyBjbHM6IFwibWV0YWRhdGEtbWVudS1jb21tYW5kLXN1Z2dlc3QtaWNvblwiIH0pXG4gICAgICAgICAgICAgICAgICAgIHNldEljb24oaWNvbkNvbnRhaW5lciwgXCJjaGVjay1jaXJjbGVcIilcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHMucmVtb3ZlQ2xhc3MoXCJtZXRhZGF0YS1tZW51LXZhbHVlLXNlbGVjdGVkXCIpXG4gICAgICAgICAgICAgICAgcy5xdWVyeVNlbGVjdG9yQWxsKFwiLm1ldGFkYXRhLW1lbnUtY29tbWFuZC1zdWdnZXN0LWljb25cIikuZm9yRWFjaChpY29uID0+IGljb24ucmVtb3ZlKCkpXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pXG4gICAgfVxuXG4gICAgZ2V0U3VnZ2VzdGlvbnMocXVlcnk6IHN0cmluZyk6IHN0cmluZ1tdIHtcbiAgICAgICAgY29uc3QgZHZBcGkgPSB0aGlzLnBsdWdpbi5hcHAucGx1Z2lucy5wbHVnaW5zLmRhdGF2aWV3Py5hcGlcbiAgICAgICAgbGV0IGR2RmlsZTogYW55O1xuICAgICAgICBpZiAoZHZBcGkpIGR2RmlsZSA9IGR2QXBpLnBhZ2UodGhpcy5maWxlLnBhdGgpXG4gICAgICAgIGNvbnN0IGZpZWxkTWFuYWdlciA9IG5ldyBGaWVsZE1hbmFnZXJbdGhpcy5maWVsZC50eXBlXSh0aGlzLnBsdWdpbiwgdGhpcy5maWVsZCkgYXMgQWJzdHJhY3RMaXN0QmFzZWRGaWVsZFxuICAgICAgICBjb25zdCB2YWx1ZXMgPSBmaWVsZE1hbmFnZXIuZ2V0T3B0aW9uc0xpc3QoZHZGaWxlKS5maWx0ZXIobyA9PiBvLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMocXVlcnkudG9Mb3dlckNhc2UoKSkpXG4gICAgICAgIGlmICh0aGlzLmFkZEJ1dHRvbikge1xuICAgICAgICAgICAgKHZhbHVlcy5zb21lKHAgPT4gcCA9PT0gcXVlcnkpIHx8IHRoaXMuZmllbGQub3B0aW9ucy5zb3VyY2VUeXBlID09IHNlbGVjdFZhbHVlc1NvdXJjZS5UeXBlLlZhbHVlc0Zyb21EVlF1ZXJ5IHx8ICFxdWVyeSkgP1xuICAgICAgICAgICAgICAgIHRoaXMuYWRkQnV0dG9uLmJ1dHRvbkVsLmhpZGUoKSA6XG4gICAgICAgICAgICAgICAgdGhpcy5hZGRCdXR0b24uYnV0dG9uRWwuc2hvdygpO1xuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gdmFsdWVzXG4gICAgfVxuXG4gICAgcmVuZGVyU3VnZ2VzdGlvbih2YWx1ZTogc3RyaW5nLCBlbDogSFRNTEVsZW1lbnQpIHtcbiAgICAgICAgZWwuc2V0VGV4dCh2YWx1ZSlcbiAgICAgICAgZWwuYWRkQ2xhc3MoXCJtZXRhZGF0YS1tZW51LXZhbHVlLXN1Z2dlc3Rlci12YWx1ZS1jb250YWluZXJcIilcbiAgICAgICAgY29uc3Qgc3BhY2VyID0gdGhpcy5jb250YWluZXJFbC5jcmVhdGVEaXYoeyBjbHM6IFwibWV0YWRhdGEtbWVudS12YWx1ZS1zdWdnZXN0ZXItdmFsdWUtY29udGFpbmVyLXNwYWNlclwiIH0pXG4gICAgICAgIGVsLmFwcGVuZENoaWxkKHNwYWNlcilcbiAgICAgICAgaWYgKHRoaXMuc2VsZWN0ZWRPcHRpb25zLmluY2x1ZGVzKHZhbHVlLnRvU3RyaW5nKCkpKSB7XG4gICAgICAgICAgICBlbC5hZGRDbGFzcyhcIm1ldGFkYXRhLW1lbnUtdmFsdWUtc2VsZWN0ZWRcIilcbiAgICAgICAgICAgIGNvbnN0IGljb25Db250YWluZXIgPSBlbC5jcmVhdGVEaXYoeyBjbHM6IFwibWV0YWRhdGEtbWVudS1jb21tYW5kLXN1Z2dlc3QtaWNvblwiIH0pXG4gICAgICAgICAgICBzZXRJY29uKGljb25Db250YWluZXIsIFwiY2hlY2stY2lyY2xlXCIpXG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5pbnB1dEVsLmZvY3VzKClcbiAgICB9XG5cbiAgICBzZWxlY3RTdWdnZXN0aW9uKHZhbHVlOiBzdHJpbmcsIGV2dDogTW91c2VFdmVudCB8IEtleWJvYXJkRXZlbnQpOiB2b2lkIHtcbiAgICAgICAgaWYgKHRoaXMuc2VsZWN0ZWRPcHRpb25zLmluY2x1ZGVzKHZhbHVlLnRvU3RyaW5nKCkpKSB7XG4gICAgICAgICAgICB0aGlzLnNlbGVjdGVkT3B0aW9ucy5yZW1vdmUodmFsdWUudG9TdHJpbmcoKSlcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWRPcHRpb25zLnB1c2godmFsdWUudG9TdHJpbmcoKSlcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnJlbmRlclNlbGVjdGVkKClcbiAgICB9XG5cbiAgICBvbkNob29zZVN1Z2dlc3Rpb24oaXRlbTogc3RyaW5nLCBldnQ6IE1vdXNlRXZlbnQgfCBLZXlib2FyZEV2ZW50KSB7XG5cbiAgICB9XG5cbn0iLCAiaW1wb3J0IE1ldGFkYXRhTWVudSBmcm9tIFwibWFpblwiO1xuaW1wb3J0IHsgTWVudSwgTm90aWNlLCBzZXRJY29uLCBUZXh0QXJlYUNvbXBvbmVudCwgVEZpbGUgfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCBGaWVsZENvbW1hbmRTdWdnZXN0TW9kYWwgZnJvbSBcInNyYy9vcHRpb25zL0ZpZWxkQ29tbWFuZFN1Z2dlc3RNb2RhbFwiO1xuaW1wb3J0IFNpbmdsZUZpbGVNb2RhbCBmcm9tIFwic3JjL29wdGlvbk1vZGFscy9maWVsZHMvU2luZ2xlRmlsZU1vZGFsXCI7XG5pbXBvcnQgRmllbGRTZXR0aW5nc01vZGFsIGZyb20gXCJzcmMvc2V0dGluZ3MvRmllbGRTZXR0aW5nc01vZGFsXCI7XG5pbXBvcnQgeyBGaWVsZEljb24sIEZpZWxkVHlwZSB9IGZyb20gXCJzcmMvdHlwZXMvZmllbGRUeXBlc1wiO1xuaW1wb3J0IEZpZWxkIGZyb20gXCIuLi9GaWVsZFwiO1xuaW1wb3J0IHsgRmllbGRNYW5hZ2VyLCBTZXR0aW5nTG9jYXRpb24gfSBmcm9tIFwiLi4vRmllbGRNYW5hZ2VyXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEZpbGVGaWVsZCBleHRlbmRzIEZpZWxkTWFuYWdlciB7XG5cbiAgICBwcml2YXRlIGZpbGVWYWxpZGF0b3JGaWVsZDogSFRNTERpdkVsZW1lbnRcbiAgICBwcml2YXRlIGR2UXVlcnlTdHJpbmc6IFRleHRBcmVhQ29tcG9uZW50XG5cbiAgICBjb25zdHJ1Y3RvcihwbHVnaW46IE1ldGFkYXRhTWVudSwgZmllbGQ6IEZpZWxkKSB7XG4gICAgICAgIHN1cGVyKHBsdWdpbiwgZmllbGQsIEZpZWxkVHlwZS5GaWxlKVxuICAgIH1cblxuICAgIHB1YmxpYyBnZXRGaWxlcyA9IChjdXJyZW50RmlsZT86IFRGaWxlKTogVEZpbGVbXSA9PiB7XG4gICAgICAgIC8vQHRzLWlnbm9yZVxuICAgICAgICBjb25zdCBnZXRSZXN1bHRzID0gKGFwaTogRGF0YXZpZXdQbHVnaW5bXCJhcGlcIl0pID0+IHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIChuZXcgRnVuY3Rpb24oXCJkdlwiLCBcImN1cnJlbnRcIiwgYHJldHVybiAke3RoaXMuZmllbGQub3B0aW9ucy5kdlF1ZXJ5U3RyaW5nfWApKShhcGksIGFwaS5wYWdlKGN1cnJlbnRGaWxlPy5wYXRoKSlcbiAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgbmV3IE5vdGljZShgV3JvbmcgcXVlcnkgZm9yIGZpZWxkIDwke3RoaXMuZmllbGQubmFtZX0+XFxuY2hlY2sgeW91ciBzZXR0aW5nc2AsIDMwMDApXG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIGNvbnN0IGRhdGF2aWV3ID0gdGhpcy5wbHVnaW4uYXBwLnBsdWdpbnMucGx1Z2luc1tcImRhdGF2aWV3XCJdXG4gICAgICAgIC8vQHRzLWlnbm9yZVxuICAgICAgICBpZiAodGhpcy5maWVsZC5vcHRpb25zLmR2UXVlcnlTdHJpbmcgJiYgZGF0YXZpZXc/LnNldHRpbmdzLmVuYWJsZURhdGF2aWV3SnMgJiYgZGF0YXZpZXc/LnNldHRpbmdzLmVuYWJsZUlubGluZURhdGF2aWV3SnMpIHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgY29uc3QgZmlsZXNQYXRoID0gZ2V0UmVzdWx0cyhkYXRhdmlldy5hcGkpLnZhbHVlcy5tYXAoKHY6IGFueSkgPT4gdi5maWxlLnBhdGgpXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMucGx1Z2luLmFwcC52YXVsdC5nZXRNYXJrZG93bkZpbGVzKCkuZmlsdGVyKGYgPT4gZmlsZXNQYXRoLmluY2x1ZGVzKGYucGF0aCkpO1xuICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyAoZXJyb3IpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMucGx1Z2luLmFwcC52YXVsdC5nZXRNYXJrZG93bkZpbGVzKCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwdWJsaWMgYWRkRmllbGRPcHRpb24obmFtZTogc3RyaW5nLCB2YWx1ZTogc3RyaW5nLCBmaWxlOiBURmlsZSwgbG9jYXRpb246IE1lbnUgfCBGaWVsZENvbW1hbmRTdWdnZXN0TW9kYWwpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgbW9kYWwgPSBuZXcgU2luZ2xlRmlsZU1vZGFsKHRoaXMucGx1Z2luLCBmaWxlLCB0aGlzLmZpZWxkLCB2YWx1ZSlcbiAgICAgICAgbW9kYWwudGl0bGVFbC5zZXRUZXh0KFwiU2VsZWN0IHZhbHVlXCIpO1xuICAgICAgICBpZiAoRmlsZUZpZWxkLmlzTWVudShsb2NhdGlvbikpIHtcbiAgICAgICAgICAgIGxvY2F0aW9uLmFkZEl0ZW0oKGl0ZW0pID0+IHtcbiAgICAgICAgICAgICAgICBpdGVtLnNldFRpdGxlKGBVcGRhdGUgJHtuYW1lfWApO1xuICAgICAgICAgICAgICAgIGl0ZW0uc2V0SWNvbihGaWVsZEljb25bRmllbGRUeXBlLkZpbGVdKTtcbiAgICAgICAgICAgICAgICBpdGVtLm9uQ2xpY2soKCkgPT4gbW9kYWwub3BlbigpKTtcbiAgICAgICAgICAgICAgICBpdGVtLnNldFNlY3Rpb24oXCJtZXRhZGF0YS1tZW51LmZpZWxkc1wiKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9IGVsc2UgaWYgKEZpbGVGaWVsZC5pc1N1Z2dlc3QobG9jYXRpb24pKSB7XG4gICAgICAgICAgICBsb2NhdGlvbi5vcHRpb25zLnB1c2goe1xuICAgICAgICAgICAgICAgIGlkOiBgdXBkYXRlXyR7bmFtZX1gLFxuICAgICAgICAgICAgICAgIGFjdGlvbkxhYmVsOiBgPHNwYW4+VXBkYXRlIDxiPiR7bmFtZX08L2I+PC9zcGFuPmAsXG4gICAgICAgICAgICAgICAgYWN0aW9uOiAoKSA9PiBtb2RhbC5vcGVuKCksXG4gICAgICAgICAgICAgICAgaWNvbjogRmllbGRJY29uW0ZpZWxkVHlwZS5GaWxlXVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgcHVibGljIGNyZWF0ZUFuZE9wZW5GaWVsZE1vZGFsKGZpbGU6IFRGaWxlLCBzZWxlY3RlZEZpZWxkTmFtZTogc3RyaW5nLCB2YWx1ZT86IHN0cmluZywgbGluZU51bWJlcj86IG51bWJlciwgaW5Gcm9udG1hdHRlcj86IGJvb2xlYW4sIGFmdGVyPzogYm9vbGVhbik6IHZvaWQge1xuICAgICAgICBjb25zdCBmaWVsZE1vZGFsID0gbmV3IFNpbmdsZUZpbGVNb2RhbCh0aGlzLnBsdWdpbiwgZmlsZSwgdGhpcy5maWVsZCwgdmFsdWUsIGxpbmVOdW1iZXIsIGluRnJvbnRtYXR0ZXIsIGFmdGVyKTtcbiAgICAgICAgZmllbGRNb2RhbC50aXRsZUVsLnNldFRleHQoYEVudGVyIHZhbHVlIGZvciAke3NlbGVjdGVkRmllbGROYW1lfWApO1xuICAgICAgICBmaWVsZE1vZGFsLm9wZW4oKTtcbiAgICB9XG5cbiAgICBwdWJsaWMgY3JlYXRlRHZGaWVsZChcbiAgICAgICAgZHY6IGFueSxcbiAgICAgICAgcDogYW55LFxuICAgICAgICBmaWVsZENvbnRhaW5lcjogSFRNTEVsZW1lbnQsXG4gICAgICAgIGF0dHJzPzogeyBjbHM/OiBzdHJpbmcsIGF0dHI/OiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+LCBvcHRpb25zPzogUmVjb3JkPHN0cmluZywgc3RyaW5nPiB9XG4gICAgKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IGZpZWxkVmFsdWUgPSBkdi5lbCgnc3BhbicsIHBbdGhpcy5maWVsZC5uYW1lXSwgYXR0cnMpO1xuICAgICAgICBjb25zdCBzZWFyY2hCdG4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiYnV0dG9uXCIpXG4gICAgICAgIHNldEljb24oc2VhcmNoQnRuLCBGaWVsZEljb25bRmllbGRUeXBlLkZpbGVdKVxuICAgICAgICBzZWFyY2hCdG4uYWRkQ2xhc3MoXCJtZXRhZGF0YS1tZW51LWR2LWZpZWxkLWJ1dHRvblwiKVxuICAgICAgICAvKiBlbmQgc3BhY2VyICovXG4gICAgICAgIGNvbnN0IHNwYWNlciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIilcbiAgICAgICAgc3BhY2VyLnNldEF0dHIoXCJjbGFzc1wiLCBcIm1ldGFkYXRhLW1lbnUtZHYtZmllbGQtc3BhY2VyXCIpXG5cbiAgICAgICAgY29uc3QgZmlsZSA9IHRoaXMucGx1Z2luLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgocFtcImZpbGVcIl1bXCJwYXRoXCJdKVxuICAgICAgICBsZXQgZmllbGRNb2RhbDogU2luZ2xlRmlsZU1vZGFsO1xuICAgICAgICBpZiAoZmlsZSBpbnN0YW5jZW9mIFRGaWxlICYmIGZpbGUuZXh0ZW5zaW9uID09IFwibWRcIikge1xuICAgICAgICAgICAgZmllbGRNb2RhbCA9IG5ldyBTaW5nbGVGaWxlTW9kYWwodGhpcy5wbHVnaW4sIGZpbGUsIHRoaXMuZmllbGQsIHBbdGhpcy5maWVsZC5uYW1lXSlcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRocm93IEVycm9yKFwicGF0aCBkb2Vzbid0IGNvcnJlc3BvbmQgdG8gYSBwcm9wZXIgZmlsZVwiKTtcbiAgICAgICAgfVxuICAgICAgICBzZWFyY2hCdG4ub25jbGljayA9ICgpID0+IHtcbiAgICAgICAgICAgIGZpZWxkTW9kYWwub3BlbigpXG4gICAgICAgIH1cblxuICAgICAgICBpZiAoIWF0dHJzPy5vcHRpb25zPy5hbHdheXNPbikge1xuICAgICAgICAgICAgc2VhcmNoQnRuLmhpZGUoKVxuICAgICAgICAgICAgc3BhY2VyLnNob3coKVxuICAgICAgICAgICAgZmllbGRDb250YWluZXIub25tb3VzZW92ZXIgPSAoKSA9PiB7XG4gICAgICAgICAgICAgICAgc2VhcmNoQnRuLnNob3coKVxuICAgICAgICAgICAgICAgIHNwYWNlci5oaWRlKClcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGZpZWxkQ29udGFpbmVyLm9ubW91c2VvdXQgPSAoKSA9PiB7XG4gICAgICAgICAgICAgICAgc2VhcmNoQnRuLmhpZGUoKVxuICAgICAgICAgICAgICAgIHNwYWNlci5zaG93KClcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8qIGluaXRpYWwgc3RhdGUgKi9cbiAgICAgICAgZmllbGRDb250YWluZXIuYXBwZW5kQ2hpbGQoZmllbGRWYWx1ZSk7XG4gICAgICAgIGZpZWxkQ29udGFpbmVyLmFwcGVuZENoaWxkKHNlYXJjaEJ0bik7XG4gICAgICAgIGZpZWxkQ29udGFpbmVyLmFwcGVuZENoaWxkKHNwYWNlcik7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBjcmVhdGVGaWxlQ29udGFpbmVyKHBhcmVudENvbnRhaW5lcjogSFRNTERpdkVsZW1lbnQpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgZHZRdWVyeVN0cmluZ0NvbnRhaW5lciA9IHBhcmVudENvbnRhaW5lci5jcmVhdGVEaXYoKTtcbiAgICAgICAgZHZRdWVyeVN0cmluZ0NvbnRhaW5lci5jcmVhdGVFbChcInNwYW5cIiwgeyB0ZXh0OiBcIkRhdGF2aWV3IFF1ZXJ5IChvcHRpb25hbClcIiwgY2xzOiAnbWV0YWRhdGEtbWVudS1maWVsZC1vcHRpb24nIH0pO1xuICAgICAgICB0aGlzLmR2UXVlcnlTdHJpbmcgPSBuZXcgVGV4dEFyZWFDb21wb25lbnQoZHZRdWVyeVN0cmluZ0NvbnRhaW5lcik7XG4gICAgICAgIHRoaXMuZHZRdWVyeVN0cmluZy5pbnB1dEVsLmNvbHMgPSA1MDtcbiAgICAgICAgdGhpcy5kdlF1ZXJ5U3RyaW5nLmlucHV0RWwucm93cyA9IDQ7XG4gICAgICAgIHRoaXMuZHZRdWVyeVN0cmluZy5zZXRWYWx1ZSh0aGlzLmZpZWxkLm9wdGlvbnMuZHZRdWVyeVN0cmluZyB8fCBcIlwiKTtcblxuICAgICAgICB0aGlzLmR2UXVlcnlTdHJpbmcub25DaGFuZ2UodmFsdWUgPT4ge1xuICAgICAgICAgICAgdGhpcy5maWVsZC5vcHRpb25zLmR2UXVlcnlTdHJpbmcgPSB2YWx1ZTtcbiAgICAgICAgICAgIEZpZWxkU2V0dGluZ3NNb2RhbC5yZW1vdmVWYWxpZGF0aW9uRXJyb3IodGhpcy5kdlF1ZXJ5U3RyaW5nKTtcbiAgICAgICAgfSlcblxuXG4gICAgICAgIGNvbnN0IGN1c3RvbWVSZW5kZXJpbmdDb250YWluZXIgPSBwYXJlbnRDb250YWluZXIuY3JlYXRlRGl2KCk7XG4gICAgICAgIGN1c3RvbWVSZW5kZXJpbmdDb250YWluZXIuY3JlYXRlRWwoXCJzcGFuXCIsIHsgdGV4dDogXCJBbGlhc1wiLCBjbHM6ICdtZXRhZGF0YS1tZW51LWZpZWxkLW9wdGlvbicgfSk7XG4gICAgICAgIGN1c3RvbWVSZW5kZXJpbmdDb250YWluZXIuY3JlYXRlRWwoXCJzcGFuXCIsIHsgdGV4dDogXCJQZXJzb25hbGlzZSB0aGUgcmVuZGVyaW5nIG9mIHlvdXIgbGlua3MnIGFsaWFzZXMgd2l0aCBhIGZ1bmN0aW9uIHJldHVybmluZyBhIHN0cmluZyAoPHBhZ2U+IG9iamVjdCBpcyBhdmFpbGFibGUpXCIsIGNsczogJ21ldGFkYXRhLW1lbnUtZmllbGQtb3B0aW9uLXN1YnRleHQnIH0pO1xuICAgICAgICBjdXN0b21lUmVuZGVyaW5nQ29udGFpbmVyLmNyZWF0ZUVsKFwiY29kZVwiLCB7XG4gICAgICAgICAgICB0ZXh0OiBgZnVuY3Rpb24ocGFnZSkgeyByZXR1cm4gPGZ1bmN0aW9uIHVzaW5nIFwicGFnZVwiPjsgfWBcbiAgICAgICAgfSlcbiAgICAgICAgY29uc3QgY3VzdG9tUmVuZGVyaW5nID0gbmV3IFRleHRBcmVhQ29tcG9uZW50KGN1c3RvbWVSZW5kZXJpbmdDb250YWluZXIpO1xuICAgICAgICBjdXN0b21SZW5kZXJpbmcuaW5wdXRFbC5jb2xzID0gNTA7XG4gICAgICAgIGN1c3RvbVJlbmRlcmluZy5pbnB1dEVsLnJvd3MgPSA0O1xuICAgICAgICBjdXN0b21SZW5kZXJpbmcuc2V0VmFsdWUodGhpcy5maWVsZC5vcHRpb25zLmN1c3RvbVJlbmRlcmluZyB8fCBcIlwiKTtcbiAgICAgICAgY3VzdG9tUmVuZGVyaW5nLnNldFBsYWNlaG9sZGVyKFwiSmF2YXNjcmlwdCBzdHJpbmcsIFwiICtcbiAgICAgICAgICAgIFwidGhlIFxcXCJwYWdlXFxcIiAoZGF0YXZpZXcgcGFnZSB0eXBlKSB2YXJpYWJsZSBpcyBhdmFpbGFibGVcXG5cIiArXG4gICAgICAgICAgICBcImV4YW1wbGUgMTogcGFnZS5maWxlLm5hbWVcXG5leGFtcGxlIDI6IGAke3BhZ2UuZmlsZS5uYW1lfSBvZiBnZW5kZXIgJHtwYWdlLmdlbmRlcn1gXCIpXG4gICAgICAgIGN1c3RvbVJlbmRlcmluZy5vbkNoYW5nZSh2YWx1ZSA9PiB7XG4gICAgICAgICAgICB0aGlzLmZpZWxkLm9wdGlvbnMuY3VzdG9tUmVuZGVyaW5nID0gdmFsdWU7XG4gICAgICAgICAgICBGaWVsZFNldHRpbmdzTW9kYWwucmVtb3ZlVmFsaWRhdGlvbkVycm9yKGN1c3RvbVJlbmRlcmluZyk7XG4gICAgICAgIH0pXG4gICAgfVxuXG4gICAgcHVibGljIGNyZWF0ZVNldHRpbmdDb250YWluZXIocGFyZW50Q29udGFpbmVyOiBIVE1MRGl2RWxlbWVudCwgcGx1Z2luOiBNZXRhZGF0YU1lbnUsIGxvY2F0aW9uPzogU2V0dGluZ0xvY2F0aW9uKTogdm9pZCB7XG4gICAgICAgIHRoaXMuZmlsZVZhbGlkYXRvckZpZWxkID0gcGFyZW50Q29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJtZXRhZGF0YS1tZW51LW51bWJlci1vcHRpb25zXCIgfSlcbiAgICAgICAgdGhpcy5jcmVhdGVGaWxlQ29udGFpbmVyKHRoaXMuZmlsZVZhbGlkYXRvckZpZWxkKVxuICAgICAgICB0aGlzLmZpbGVWYWxpZGF0b3JGaWVsZC5jcmVhdGVEaXYoeyBjbHM6ICdtZXRhZGF0YS1tZW51LXNlcGFyYXRvcicgfSkuY3JlYXRlRWwoXCJoclwiKTtcbiAgICB9XG5cbiAgICBwdWJsaWMgZ2V0T3B0aW9uc1N0cigpOiBzdHJpbmcge1xuICAgICAgICByZXR1cm4gdGhpcy5maWVsZC5vcHRpb25zLmR2UXVlcnlTdHJpbmcgfHwgXCJcIjtcbiAgICB9XG5cbiAgICBwdWJsaWMgdmFsaWRhdGVPcHRpb25zKCk6IGJvb2xlYW4ge1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG5cbiAgICBwdWJsaWMgdmFsaWRhdGVWYWx1ZSh2YWx1ZTogc3RyaW5nKTogYm9vbGVhbiB7XG4gICAgICAgIGNvbnN0IGJhc2VuYW1lID0gdmFsdWUudHJpbSgpLnJlcGxhY2UoL15cXFtcXFsvZywgXCJcIikucmVwbGFjZSgvXFxdXFxdJC9nLCBcIlwiKTtcbiAgICAgICAgcmV0dXJuICEhdGhpcy5nZXRGaWxlcygpLm1hcChmID0+IGYuYmFzZW5hbWUpLmZpbmQoaXRlbSA9PiBpdGVtID09PSBiYXNlbmFtZSk7XG4gICAgfVxufSIsICJpbXBvcnQgeyBURmlsZSwgRnV6enlTdWdnZXN0TW9kYWwsIEZ1enp5TWF0Y2gsIHNldEljb24gfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCBGaWVsZCBmcm9tIFwic3JjL2ZpZWxkcy9GaWVsZFwiO1xuaW1wb3J0IHsgcmVwbGFjZVZhbHVlcyB9IGZyb20gXCJzcmMvY29tbWFuZHMvcmVwbGFjZVZhbHVlc1wiO1xuaW1wb3J0IHsgaW5zZXJ0VmFsdWVzIH0gZnJvbSBcInNyYy9jb21tYW5kcy9pbnNlcnRWYWx1ZXNcIjtcbmltcG9ydCB7IEZpZWxkTWFuYWdlciB9IGZyb20gXCJzcmMvdHlwZXMvZmllbGRUeXBlc1wiO1xuaW1wb3J0IEZpbGVGaWVsZCBmcm9tIFwic3JjL2ZpZWxkcy9maWVsZE1hbmFnZXJzL0ZpbGVGaWVsZFwiO1xuaW1wb3J0IE1ldGFkYXRhTWVudSBmcm9tIFwibWFpblwiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBGaWxlRnV6enlTdWdnZXN0ZXIgZXh0ZW5kcyBGdXp6eVN1Z2dlc3RNb2RhbDxURmlsZT4ge1xuXG4gICAgcHJpdmF0ZSBzZWxlY3RlZEZpbGU/OiBURmlsZVxuXG4gICAgY29uc3RydWN0b3IoXG4gICAgICAgIHByaXZhdGUgcGx1Z2luOiBNZXRhZGF0YU1lbnUsXG4gICAgICAgIHByaXZhdGUgZmlsZTogVEZpbGUsXG4gICAgICAgIHByaXZhdGUgZmllbGQ6IEZpZWxkLFxuICAgICAgICBpbml0aWFsVmFsdWVPYmplY3Q6IGFueSxcbiAgICAgICAgcHJpdmF0ZSBsaW5lTnVtYmVyOiBudW1iZXIgPSAtMSxcbiAgICAgICAgcHJpdmF0ZSBpbkZyb250bWF0dGVyOiBib29sZWFuID0gZmFsc2UsXG4gICAgICAgIHByaXZhdGUgYWZ0ZXI6IGJvb2xlYW4gPSBmYWxzZVxuICAgICkge1xuICAgICAgICBzdXBlcihwbHVnaW4uYXBwKTtcbiAgICAgICAgY29uc3QgZHZBcGkgPSB0aGlzLnBsdWdpbi5hcHAucGx1Z2lucy5wbHVnaW5zW1wiZGF0YXZpZXdcIl0/LmFwaVxuICAgICAgICBpZiAoZHZBcGkpIHtcbiAgICAgICAgICAgIGlmIChkdkFwaS52YWx1ZS5pc0xpbmsoaW5pdGlhbFZhbHVlT2JqZWN0KSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGZpbGUgPSB0aGlzLnBsdWdpbi5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKGluaXRpYWxWYWx1ZU9iamVjdC5wYXRoKVxuICAgICAgICAgICAgICAgIGlmIChmaWxlIGluc3RhbmNlb2YgVEZpbGUpIHRoaXMuc2VsZWN0ZWRGaWxlID0gZmlsZVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgZ2V0SXRlbXMoKTogVEZpbGVbXSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCBmaWxlTWFuYWdlciA9IG5ldyBGaWVsZE1hbmFnZXJbdGhpcy5maWVsZC50eXBlXSh0aGlzLnBsdWdpbiwgdGhpcy5maWVsZCk7XG4gICAgICAgICAgICByZXR1cm4gZmlsZU1hbmFnZXIuZ2V0RmlsZXModGhpcy5maWxlKTtcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgICAgICAgIHRocm93IChlcnJvcik7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBnZXRJdGVtVGV4dChpdGVtOiBURmlsZSk6IHN0cmluZyB7XG4gICAgICAgIHJldHVybiBpdGVtLmJhc2VuYW1lO1xuICAgIH1cblxuICAgIHJlbmRlclN1Z2dlc3Rpb24odmFsdWU6IEZ1enp5TWF0Y2g8VEZpbGU+LCBlbDogSFRNTEVsZW1lbnQpIHtcbiAgICAgICAgY29uc3QgZHZBcGkgPSB0aGlzLnBsdWdpbi5hcHAucGx1Z2lucy5wbHVnaW5zLmRhdGF2aWV3Py5hcGlcbiAgICAgICAgaWYgKGR2QXBpICYmIHRoaXMuZmllbGQub3B0aW9ucy5jdXN0b21SZW5kZXJpbmcpIHtcbiAgICAgICAgICAgIGNvbnN0IHN1Z2dlc3Rpb25Db250YWluZXIgPSBlbC5jcmVhdGVEaXYoeyBjbHM6IFwibWV0YWRhdGEtbWVudS1zdWdnZXN0ZXItaXRlbS13aXRoLWFsaWFzXCIgfSk7XG4gICAgICAgICAgICBjb25zdCBsYWJlbCA9IHN1Z2dlc3Rpb25Db250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcIm1ldGFkYXRhLW1lbnUtc3VnZ2VzdGVyLWl0ZW0td2l0aC1hbGlhcy1sYWJlbFwiIH0pXG4gICAgICAgICAgICBsYWJlbC5zZXRUZXh0KG5ldyBGdW5jdGlvbihcInBhZ2VcIiwgYHJldHVybiAke3RoaXMuZmllbGQub3B0aW9ucy5jdXN0b21SZW5kZXJpbmd9YCkoZHZBcGkucGFnZSh2YWx1ZS5pdGVtLnBhdGgpKSlcbiAgICAgICAgICAgIGNvbnN0IGZpbGVQYXRoID0gc3VnZ2VzdGlvbkNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IFwibWV0YWRhdGEtbWVudS1zdWdnZXN0ZXItaXRlbS13aXRoLWFsaWFzLWZpbGVwYXRoXCIgfSlcbiAgICAgICAgICAgIGZpbGVQYXRoLnNldFRleHQodmFsdWUuaXRlbS5wYXRoKVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgZWwuc2V0VGV4dCh2YWx1ZS5pdGVtLmJhc2VuYW1lKVxuICAgICAgICB9XG4gICAgICAgIGVsLmFkZENsYXNzKFwibWV0YWRhdGEtbWVudS12YWx1ZS1zdWdnZXN0ZXItdmFsdWUtY29udGFpbmVyXCIpXG4gICAgICAgIGNvbnN0IHNwYWNlciA9IHRoaXMuY29udGFpbmVyRWwuY3JlYXRlRGl2KHsgY2xzOiBcIm1ldGFkYXRhLW1lbnUtdmFsdWUtc3VnZ2VzdGVyLXZhbHVlLWNvbnRhaW5lci1zcGFjZXJcIiB9KVxuICAgICAgICBlbC5hcHBlbmRDaGlsZChzcGFjZXIpXG4gICAgICAgIGlmICh0aGlzLnNlbGVjdGVkRmlsZT8ucGF0aCA9PT0gdmFsdWUuaXRlbS5wYXRoKSB7XG4gICAgICAgICAgICBlbC5hZGRDbGFzcyhcIm1ldGFkYXRhLW1lbnUtdmFsdWUtc2VsZWN0ZWRcIilcbiAgICAgICAgICAgIGNvbnN0IGljb25Db250YWluZXIgPSBlbC5jcmVhdGVEaXYoeyBjbHM6IFwibWV0YWRhdGEtbWVudS1jb21tYW5kLXN1Z2dlc3QtaWNvblwiIH0pXG4gICAgICAgICAgICBzZXRJY29uKGljb25Db250YWluZXIsIFwiY2hlY2stY2lyY2xlXCIpXG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5pbnB1dEVsLmZvY3VzKClcbiAgICB9XG5cblxuICAgIGFzeW5jIG9uQ2hvb3NlSXRlbShpdGVtOiBURmlsZSk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICBjb25zdCBkdkFwaSA9IHRoaXMucGx1Z2luLmFwcC5wbHVnaW5zLnBsdWdpbnMuZGF0YXZpZXc/LmFwaVxuICAgICAgICBsZXQgYWxpYXM6IHN0cmluZyB8IHVuZGVmaW5lZCA9IHVuZGVmaW5lZDtcbiAgICAgICAgaWYgKGR2QXBpICYmIHRoaXMuZmllbGQub3B0aW9ucy5jdXN0b21SZW5kZXJpbmcpIHtcbiAgICAgICAgICAgIGFsaWFzID0gbmV3IEZ1bmN0aW9uKFwicGFnZVwiLCBgcmV0dXJuICR7dGhpcy5maWVsZC5vcHRpb25zLmN1c3RvbVJlbmRlcmluZ31gKShkdkFwaS5wYWdlKGl0ZW0ucGF0aCkpXG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMubGluZU51bWJlciA9PSAtMSkge1xuICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uZmlsZVRhc2tNYW5hZ2VyXG4gICAgICAgICAgICAgICAgLnB1c2hUYXNrKCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgcmVwbGFjZVZhbHVlcyhcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLFxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5maWxlLFxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5maWVsZC5uYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgRmlsZUZpZWxkLmJ1aWxkTWFya0Rvd25MaW5rKHRoaXMucGx1Z2luLCB0aGlzLmZpbGUsIGl0ZW0uYmFzZW5hbWUsIGFsaWFzKVxuICAgICAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5maWxlVGFza01hbmFnZXJcbiAgICAgICAgICAgICAgICAucHVzaFRhc2soKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBpbnNlcnRWYWx1ZXMoXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbixcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZmlsZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZmllbGQubmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIEZpbGVGaWVsZC5idWlsZE1hcmtEb3duTGluayh0aGlzLnBsdWdpbiwgdGhpcy5maWxlLCBpdGVtLmJhc2VuYW1lLCBhbGlhcyksXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmxpbmVOdW1iZXIsXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmluRnJvbnRtYXR0ZXIsXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFmdGVyXG4gICAgICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcbiAgICB9XG5cbn0iLCAiaW1wb3J0IE1ldGFkYXRhTWVudSBmcm9tIFwibWFpblwiO1xuaW1wb3J0IHsgTWVudSwgbW9tZW50LCBzZXRJY29uLCBUZXh0Q29tcG9uZW50LCBURmlsZSwgVG9nZ2xlQ29tcG9uZW50IH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgRmllbGRDb21tYW5kU3VnZ2VzdE1vZGFsIGZyb20gXCJzcmMvb3B0aW9ucy9GaWVsZENvbW1hbmRTdWdnZXN0TW9kYWxcIjtcbmltcG9ydCBEYXRlTW9kYWwgZnJvbSBcInNyYy9vcHRpb25Nb2RhbHMvZmllbGRzL0RhdGVNb2RhbFwiO1xuaW1wb3J0IHsgRmllbGRJY29uLCBGaWVsZFR5cGUgfSBmcm9tIFwic3JjL3R5cGVzL2ZpZWxkVHlwZXNcIjtcbmltcG9ydCBGaWVsZCBmcm9tIFwiLi4vRmllbGRcIjtcbmltcG9ydCB7IEZpZWxkTWFuYWdlciwgU2V0dGluZ0xvY2F0aW9uIH0gZnJvbSBcIi4uL0ZpZWxkTWFuYWdlclwiO1xuaW1wb3J0IHsgZ2V0RmllbGQgfSBmcm9tIFwic3JjL2NvbW1hbmRzL2dldEZpZWxkXCI7XG5pbXBvcnQgeyBGaWxlQ2xhc3MgfSBmcm9tIFwic3JjL2ZpbGVDbGFzcy9maWxlQ2xhc3NcIjtcbmltcG9ydCBDeWNsZUZpZWxkIGZyb20gXCIuL0N5Y2xlRmllbGRcIjtcbmltcG9ydCB7IEZpZWxkTWFuYWdlciBhcyBGTSB9IGZyb20gXCJzcmMvdHlwZXMvZmllbGRUeXBlc1wiO1xuaW1wb3J0IHsgcmVwbGFjZVZhbHVlcyB9IGZyb20gXCJzcmMvY29tbWFuZHMvcmVwbGFjZVZhbHVlc1wiO1xuaW1wb3J0IHsgTGluayB9IGZyb20gXCJzcmMvdHlwZXMvZGF0YXZpZXdUeXBlc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBEYXRlRmllbGQgZXh0ZW5kcyBGaWVsZE1hbmFnZXIge1xuXG4gICAgcHJpdmF0ZSBkYXRlVmFsaWRhdG9yRmllbGQ6IEhUTUxEaXZFbGVtZW50XG4gICAgcHVibGljIGRlZmF1bHREYXRlRm9ybWF0OiBzdHJpbmcgPSBcIllZWVktTU0tRERcIlxuICAgIHByaXZhdGUgc2hpZnRCdG46IEhUTUxCdXR0b25FbGVtZW50XG5cbiAgICBjb25zdHJ1Y3RvcihwbHVnaW46IE1ldGFkYXRhTWVudSwgZmllbGQ6IEZpZWxkKSB7XG4gICAgICAgIHN1cGVyKHBsdWdpbiwgZmllbGQsIEZpZWxkVHlwZS5EYXRlKVxuICAgIH1cblxuICAgIHB1YmxpYyBhZGRGaWVsZE9wdGlvbihuYW1lOiBzdHJpbmcsIHZhbHVlOiBzdHJpbmcsIGZpbGU6IFRGaWxlLCBsb2NhdGlvbjogTWVudSB8IEZpZWxkQ29tbWFuZFN1Z2dlc3RNb2RhbCk6IHZvaWQge1xuICAgICAgICBjb25zdCBtb2RhbCA9IG5ldyBEYXRlTW9kYWwodGhpcy5wbHVnaW4sIGZpbGUsIHRoaXMuZmllbGQsIHZhbHVlKTtcbiAgICAgICAgbW9kYWwudGl0bGVFbC5zZXRUZXh0KGBDaGFuZ2UgZGF0ZSBmb3IgPCR7bmFtZX0+YCk7XG4gICAgICAgIGNvbnN0IGR2QXBpID0gdGhpcy5wbHVnaW4uYXBwLnBsdWdpbnMucGx1Z2lucy5kYXRhdmlldz8uYXBpO1xuICAgICAgICBpZiAoRGF0ZUZpZWxkLmlzTWVudShsb2NhdGlvbikpIHtcbiAgICAgICAgICAgIGxvY2F0aW9uLmFkZEl0ZW0oKGl0ZW0pID0+IHtcbiAgICAgICAgICAgICAgICBpdGVtLnNldFRpdGxlKGBVcGRhdGUgPCR7bmFtZX0+YCk7XG4gICAgICAgICAgICAgICAgaXRlbS5zZXRJY29uKEZpZWxkSWNvbltGaWVsZFR5cGUuRGF0ZV0pO1xuICAgICAgICAgICAgICAgIGl0ZW0ub25DbGljaygoKSA9PiBtb2RhbC5vcGVuKCkpO1xuICAgICAgICAgICAgICAgIGl0ZW0uc2V0U2VjdGlvbihcIm1ldGFkYXRhLW1lbnUuZmllbGRzXCIpO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIGlmICh0aGlzLmZpZWxkLm9wdGlvbnMuZGF0ZVNoaWZ0SW50ZXJ2YWwgfHwgdGhpcy5maWVsZC5vcHRpb25zLm5leHRTaGlmdEludGVydmFsRmllbGQgJiYgZHZBcGkpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBwID0gZHZBcGkucGFnZShmaWxlLnBhdGgpXG4gICAgICAgICAgICAgICAgY29uc3QgZmllbGRNYW5hZ2VyOiBEYXRlRmllbGQgPSBuZXcgRk1bdGhpcy5maWVsZC50eXBlXSh0aGlzLnBsdWdpbiwgdGhpcy5maWVsZCk7XG4gICAgICAgICAgICAgICAgY29uc3QgW2N1cnJlbnRTaGlmdF06IFtzdHJpbmcgfCB1bmRlZmluZWQsIEZpZWxkIHwgdW5kZWZpbmVkLCBzdHJpbmcgfCB1bmRlZmluZWRdID0gZmllbGRNYW5hZ2VyLnNoaWZ0RHVyYXRpb24oZmlsZSk7XG4gICAgICAgICAgICAgICAgbG9jYXRpb24uYWRkSXRlbSgoaXRlbSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBpdGVtLnNldFRpdGxlKGBTaGlmdCA8JHtuYW1lfT4gJHtjdXJyZW50U2hpZnR9IGFoZWFkYCk7XG4gICAgICAgICAgICAgICAgICAgIGl0ZW0uc2V0SWNvbihcInNraXAtZm9yd2FyZFwiKTtcbiAgICAgICAgICAgICAgICAgICAgaXRlbS5vbkNsaWNrKCgpID0+IHsgdGhpcy5zaGlmdERhdGUoZHZBcGksIHAsIGZpbGUpIH0pO1xuICAgICAgICAgICAgICAgICAgICBpdGVtLnNldFNlY3Rpb24oXCJtZXRhZGF0YS1tZW51LmZpZWxkc1wiKTtcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2UgaWYgKERhdGVGaWVsZC5pc1N1Z2dlc3QobG9jYXRpb24pKSB7XG4gICAgICAgICAgICBsb2NhdGlvbi5vcHRpb25zLnB1c2goe1xuICAgICAgICAgICAgICAgIGlkOiBgdXBkYXRlXyR7bmFtZX1gLFxuICAgICAgICAgICAgICAgIGFjdGlvbkxhYmVsOiBgPHNwYW4+VXBkYXRlIDxiPiR7bmFtZX08L2I+PC9zcGFuPmAsXG4gICAgICAgICAgICAgICAgYWN0aW9uOiAoKSA9PiBtb2RhbC5vcGVuKCksXG4gICAgICAgICAgICAgICAgaWNvbjogRmllbGRJY29uW0ZpZWxkVHlwZS5EYXRlXVxuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIGlmICh0aGlzLmZpZWxkLm9wdGlvbnMuZGF0ZVNoaWZ0SW50ZXJ2YWwgfHwgdGhpcy5maWVsZC5vcHRpb25zLm5leHRTaGlmdEludGVydmFsRmllbGQgJiYgZHZBcGkpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBwID0gZHZBcGkucGFnZShmaWxlLnBhdGgpXG4gICAgICAgICAgICAgICAgY29uc3QgZmllbGRNYW5hZ2VyOiBEYXRlRmllbGQgPSBuZXcgRk1bdGhpcy5maWVsZC50eXBlXSh0aGlzLnBsdWdpbiwgdGhpcy5maWVsZCk7XG4gICAgICAgICAgICAgICAgY29uc3QgW2N1cnJlbnRTaGlmdF06IFtzdHJpbmcgfCB1bmRlZmluZWQsIEZpZWxkIHwgdW5kZWZpbmVkLCBzdHJpbmcgfCB1bmRlZmluZWRdID0gZmllbGRNYW5hZ2VyLnNoaWZ0RHVyYXRpb24oZmlsZSk7XG4gICAgICAgICAgICAgICAgbG9jYXRpb24ub3B0aW9ucy5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgaWQ6IGB1cGRhdGVfJHtuYW1lfWAsXG4gICAgICAgICAgICAgICAgICAgIGFjdGlvbkxhYmVsOiBgPHNwYW4+U2hpZnQgPGI+JHtuYW1lfTwvYj4gJHtjdXJyZW50U2hpZnR9IGFoZWFkPC9zcGFuPmAsXG4gICAgICAgICAgICAgICAgICAgIGFjdGlvbjogKCkgPT4gdGhpcy5zaGlmdERhdGUoZHZBcGksIHAsIGZpbGUpLFxuICAgICAgICAgICAgICAgICAgICBpY29uOiBGaWVsZEljb25bRmllbGRUeXBlLkRhdGVdXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICBwdWJsaWMgY3JlYXRlQW5kT3BlbkZpZWxkTW9kYWwoZmlsZTogVEZpbGUsIHNlbGVjdGVkRmllbGROYW1lOiBzdHJpbmcsIHZhbHVlPzogc3RyaW5nLCBsaW5lTnVtYmVyPzogbnVtYmVyLCBpbkZyb250bWF0dGVyPzogYm9vbGVhbiwgYWZ0ZXI/OiBib29sZWFuKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IGZpZWxkTW9kYWwgPSBuZXcgRGF0ZU1vZGFsKHRoaXMucGx1Z2luLCBmaWxlLCB0aGlzLmZpZWxkLCB2YWx1ZSB8fCBcIlwiLCBsaW5lTnVtYmVyLCBpbkZyb250bWF0dGVyLCBhZnRlcik7XG4gICAgICAgIGZpZWxkTW9kYWwudGl0bGVFbC5zZXRUZXh0KGBFbnRlciBkYXRlIGZvciAke3NlbGVjdGVkRmllbGROYW1lfWApO1xuICAgICAgICBmaWVsZE1vZGFsLm9wZW4oKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGNyZWF0ZURhdGVDb250YWluZXIocGFyZW50Q29udGFpbmVyOiBIVE1MRGl2RWxlbWVudCk6IHZvaWQge1xuICAgICAgICBpZiAoIXRoaXMuZmllbGQub3B0aW9ucy5kYXRlRm9ybWF0KSB0aGlzLmZpZWxkLm9wdGlvbnMuZGF0ZUZvcm1hdCA9IHRoaXMuZGVmYXVsdERhdGVGb3JtYXRcbiAgICAgICAgaWYgKCF0aGlzLmZpZWxkLm9wdGlvbnMuZGVmYXVsdEluc2VydEFzTGluaykgdGhpcy5maWVsZC5vcHRpb25zLmRlZmF1bHRJbnNlcnRBc0xpbmsgPSBcImZhbHNlXCJcbiAgICAgICAgY29uc3QgZGF0ZUZvcm1hdENvbnRhaW5lciA9IHBhcmVudENvbnRhaW5lci5jcmVhdGVEaXYoKTtcbiAgICAgICAgZGF0ZUZvcm1hdENvbnRhaW5lci5jcmVhdGVFbChcInNwYW5cIiwgeyB0ZXh0OiBcIkRhdGUgZm9ybWF0XCIsIGNsczogJ21ldGFkYXRhLW1lbnUtZmllbGQtb3B0aW9uJyB9KVxuICAgICAgICBjb25zdCBkYXRlRm9ybWF0SW5wdXQgPSBuZXcgVGV4dENvbXBvbmVudChkYXRlRm9ybWF0Q29udGFpbmVyKVxuICAgICAgICBkYXRlRm9ybWF0SW5wdXQuc2V0VmFsdWUodGhpcy5maWVsZC5vcHRpb25zLmRhdGVGb3JtYXQpXG4gICAgICAgIGNvbnN0IGRhdGVFeGFtcGxlID0gZGF0ZUZvcm1hdENvbnRhaW5lci5jcmVhdGVFbChcInNwYW5cIiwgeyB0ZXh0OiBcIlwiLCBjbHM6ICdtZXRhZGF0YS1tZW51LWZpZWxkLW9wdGlvbicgfSlcbiAgICAgICAgZGF0ZUV4YW1wbGUuc2V0VGV4dChgZXhhbXBsZTogJHttb21lbnQoKS5mb3JtYXQoZGF0ZUZvcm1hdElucHV0LmdldFZhbHVlKCkpfWApXG4gICAgICAgIGRhdGVGb3JtYXRJbnB1dC5vbkNoYW5nZSgodmFsdWU6IHN0cmluZykgPT4ge1xuICAgICAgICAgICAgdGhpcy5maWVsZC5vcHRpb25zLmRhdGVGb3JtYXQgPSB2YWx1ZVxuICAgICAgICAgICAgZGF0ZUV4YW1wbGUuc2V0VGV4dChgZXhhbXBsZTogJHttb21lbnQoKS5mb3JtYXQodmFsdWUpfWApO1xuICAgICAgICB9KTtcblxuICAgICAgICAvLyBpbnNlcnQgYXMgbGluayB0b2dnbGVyXG4gICAgICAgIGNvbnN0IGRlZmF1bHRJbnNlcnRBc0xpbmtDb250YWluZXIgPSBwYXJlbnRDb250YWluZXIuY3JlYXRlRGl2KCk7XG4gICAgICAgIGRlZmF1bHRJbnNlcnRBc0xpbmtDb250YWluZXIuY3JlYXRlRWwoXCJzcGFuXCIsIHsgdGV4dDogXCJJbnNlcnQgYXMgbGluayBieSBkZWZhdWx0XCIsIGNsczogJ21ldGFkYXRhLW1lbnUtZmllbGQtb3B0aW9uJyB9KTtcbiAgICAgICAgY29uc3QgZGVmYXVsdEluc2VydEFzTGluayA9IG5ldyBUb2dnbGVDb21wb25lbnQoZGVmYXVsdEluc2VydEFzTGlua0NvbnRhaW5lcik7XG4gICAgICAgIGRlZmF1bHRJbnNlcnRBc0xpbmsuc2V0VmFsdWUoRGF0ZUZpZWxkLnN0cmluZ1RvQm9vbGVhbih0aGlzLmZpZWxkLm9wdGlvbnMuZGVmYXVsdEluc2VydEFzTGluaykpXG4gICAgICAgIGRlZmF1bHRJbnNlcnRBc0xpbmsub25DaGFuZ2UoKHZhbHVlOiBib29sZWFuKSA9PiB7XG4gICAgICAgICAgICB0aGlzLmZpZWxkLm9wdGlvbnMuZGVmYXVsdEluc2VydEFzTGluayA9IHZhbHVlLnRvU3RyaW5nKCk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vZm9sZGVyIHBhdGggZm9yIGxpbmtcbiAgICAgICAgY29uc3QgZGF0ZUxpbmtQYXRoQ29udGFpbmVyID0gcGFyZW50Q29udGFpbmVyLmNyZWF0ZURpdigpO1xuICAgICAgICBkYXRlTGlua1BhdGhDb250YWluZXIuY3JlYXRlRWwoXCJzcGFuXCIsIHsgdGV4dDogXCJMaW5rIHBhdGggKG9wdGlvbmFsKVwiLCBjbHM6ICdtZXRhZGF0YS1tZW51LWZpZWxkLW9wdGlvbicgfSlcbiAgICAgICAgY29uc3QgZGF0ZUxpbmtQYXRoSW5wdXQgPSBuZXcgVGV4dENvbXBvbmVudChkYXRlTGlua1BhdGhDb250YWluZXIpXG4gICAgICAgIGRhdGVMaW5rUGF0aElucHV0LnNldFZhbHVlKHRoaXMuZmllbGQub3B0aW9ucy5saW5rUGF0aClcbiAgICAgICAgZGF0ZUxpbmtQYXRoSW5wdXQub25DaGFuZ2UoKHZhbHVlOiBzdHJpbmcpID0+IHtcbiAgICAgICAgICAgIHRoaXMuZmllbGQub3B0aW9ucy5saW5rUGF0aCA9IHZhbHVlLmVuZHNXaXRoKFwiL1wiKSA/IHZhbHVlIDogdmFsdWUgKyBcIi9cIjtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gc2hpZnQgaW50ZXJ2YWwgKHNob3VsZCBiZSBhIG51bWJlciBvciBhIGx1eG9uIGh1bWFuaXplZCBkdXJhdGlvbiAocmVxdWlyZXMgZGF0YXZpZXcpIC0+IHRvIGluY2x1ZGUgaW4gdmFsaWRhdGlvbilcbiAgICAgICAgY29uc3QgZGF0ZVNoaWZ0SW50ZXJ2YWxDb250YWluZXIgPSBwYXJlbnRDb250YWluZXIuY3JlYXRlRGl2KCk7XG4gICAgICAgIGRhdGVTaGlmdEludGVydmFsQ29udGFpbmVyLmNyZWF0ZUVsKFwic3BhblwiLCB7IHRleHQ6IFwiRGVmaW5lIGEgc2hpZnQgaW50ZXJ2YWxcIiwgY2xzOiAnbWV0YWRhdGEtbWVudS1maWVsZC1vcHRpb24nIH0pO1xuICAgICAgICBjb25zdCBkYXRlU2hpZnRJbnRlcnZhbCA9IG5ldyBUZXh0Q29tcG9uZW50KGRhdGVTaGlmdEludGVydmFsQ29udGFpbmVyKTtcbiAgICAgICAgZGF0ZVNoaWZ0SW50ZXJ2YWwuc2V0UGxhY2Vob2xkZXIoXCJleDogMSBtb250aCAyIGRheXNcIilcbiAgICAgICAgZGF0ZVNoaWZ0SW50ZXJ2YWwuc2V0VmFsdWUodGhpcy5maWVsZC5vcHRpb25zLmRhdGVTaGlmdEludGVydmFsKVxuICAgICAgICBkYXRlU2hpZnRJbnRlcnZhbC5vbkNoYW5nZSgodmFsdWU6IHN0cmluZykgPT4ge1xuICAgICAgICAgICAgaWYgKCF2YWx1ZSkge1xuICAgICAgICAgICAgICAgIGRlbGV0ZSB0aGlzLmZpZWxkLm9wdGlvbnMuZGF0ZVNoaWZ0SW50ZXJ2YWw7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMuZmllbGQub3B0aW9ucy5kYXRlU2hpZnRJbnRlcnZhbCA9IHZhbHVlLnRvU3RyaW5nKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIGludGVydmFscyBjeWNsZSBmaWVsZCBuYW1lXG4gICAgICAgIGNvbnN0IG5leHRTaGlmdEludGVydmFsRmllbGRDb250YWluZXIgPSBwYXJlbnRDb250YWluZXIuY3JlYXRlRGl2KCk7XG4gICAgICAgIG5leHRTaGlmdEludGVydmFsRmllbGRDb250YWluZXIuY3JlYXRlRWwoXCJzcGFuXCIsIHtcbiAgICAgICAgICAgIHRleHQ6IFwiRmllbGQgY29udGFpbmluZyBzaGlmdCBpbnRlcnZhbHMgKGhhcyB0aGUgcHJpb3JpdHkgb3ZlciB0aGUgU2hpZnQgSW50ZXJ2YWwgYWJvdmUpXCIsXG4gICAgICAgICAgICBjbHM6ICdtZXRhZGF0YS1tZW51LWZpZWxkLW9wdGlvbidcbiAgICAgICAgfSk7XG4gICAgICAgIGNvbnN0IG5leHRTaGlmdEludGVydmFsRmllbGQgPSBuZXcgVGV4dENvbXBvbmVudChuZXh0U2hpZnRJbnRlcnZhbEZpZWxkQ29udGFpbmVyKTtcbiAgICAgICAgbmV4dFNoaWZ0SW50ZXJ2YWxGaWVsZC5zZXRWYWx1ZSh0aGlzLmZpZWxkLm9wdGlvbnMubmV4dFNoaWZ0SW50ZXJ2YWxGaWVsZClcbiAgICAgICAgbmV4dFNoaWZ0SW50ZXJ2YWxGaWVsZC5vbkNoYW5nZSgodmFsdWU6IHN0cmluZykgPT4ge1xuICAgICAgICAgICAgaWYgKCF2YWx1ZSkge1xuICAgICAgICAgICAgICAgIGRlbGV0ZSB0aGlzLmZpZWxkLm9wdGlvbnMubmV4dFNoaWZ0SW50ZXJ2YWxGaWVsZDtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5maWVsZC5vcHRpb25zLm5leHRTaGlmdEludGVydmFsRmllbGQgPSB2YWx1ZS50b1N0cmluZygpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgIH1cblxuICAgIHB1YmxpYyBjcmVhdGVTZXR0aW5nQ29udGFpbmVyKHBhcmVudENvbnRhaW5lcjogSFRNTERpdkVsZW1lbnQsIHBsdWdpbjogTWV0YWRhdGFNZW51LCBsb2NhdGlvbj86IFNldHRpbmdMb2NhdGlvbik6IHZvaWQge1xuICAgICAgICB0aGlzLmRhdGVWYWxpZGF0b3JGaWVsZCA9IHBhcmVudENvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IFwibWV0YWRhdGEtbWVudS1udW1iZXItb3B0aW9uc1wiIH0pO1xuICAgICAgICB0aGlzLmNyZWF0ZURhdGVDb250YWluZXIodGhpcy5kYXRlVmFsaWRhdG9yRmllbGQpO1xuICAgICAgICB0aGlzLmRhdGVWYWxpZGF0b3JGaWVsZC5jcmVhdGVEaXYoeyBjbHM6ICdtZXRhZGF0YS1tZW51LXNlcGFyYXRvcicgfSkuY3JlYXRlRWwoXCJoclwiKTtcbiAgICB9XG5cbiAgICBwdWJsaWMgYXN5bmMgc2hpZnREYXRlKGR2OiBhbnksIHA6IGFueSwgZmlsZTogVEZpbGUpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgY29uc3QgeyBkYXRlRm9ybWF0LCBkZWZhdWx0SW5zZXJ0QXNMaW5rLCBsaW5rUGF0aCB9ID0gdGhpcy5maWVsZC5vcHRpb25zXG4gICAgICAgIGNvbnN0IGZpZWxkTWFuYWdlcjogRGF0ZUZpZWxkID0gbmV3IEZNW3RoaXMuZmllbGQudHlwZV0odGhpcy5wbHVnaW4sIHRoaXMuZmllbGQpO1xuICAgICAgICBjb25zdCBbY3VycmVudFNoaWZ0LCBuZXh0SW50ZXJ2YWxGaWVsZCwgbmV4dFNoaWZ0XTogW3N0cmluZyB8IHVuZGVmaW5lZCwgRmllbGQgfCB1bmRlZmluZWQsIHN0cmluZyB8IHVuZGVmaW5lZF0gPSBmaWVsZE1hbmFnZXIuc2hpZnREdXJhdGlvbihmaWxlKTtcbiAgICAgICAgY29uc3QgZHZEYXRlID0gcFt0aGlzLmZpZWxkLm5hbWVdXG4gICAgICAgIC8vZGF0YXZpZXcgaXMgY29udmVydGluZyBkYXRlcyB0byBsaW5rcyBvciBkYXRldGltZXMsIGxldCdzIG5vcm1hbGl6ZVxuICAgICAgICBjb25zdCBjdXJyZW50RGF0ZVZhbHVlID0gZHYudmFsdWUuaXNMaW5rKGR2RGF0ZSkgP1xuICAgICAgICAgICAgZHZEYXRlLnBhdGguc3BsaXQoXCIvXCIpLmxhc3QoKSA6XG4gICAgICAgICAgICBkdi52YWx1ZS5pc0RhdGUoZHZEYXRlKSA/XG4gICAgICAgICAgICAgICAgbW9tZW50KGR2RGF0ZS50b0pTRGF0ZSgpKS5mb3JtYXQoZGF0ZUZvcm1hdCkgOlxuICAgICAgICAgICAgICAgIGR2RGF0ZVxuICAgICAgICBjb25zdCBjdXJyZW50RHZEYXRlID0gZHYuZGF0ZShtb21lbnQoY3VycmVudERhdGVWYWx1ZSwgZGF0ZUZvcm1hdCkudG9JU09TdHJpbmcoKSk7XG4gICAgICAgIGNvbnN0IG5ld0RhdGUgPSBjdXJyZW50RHZEYXRlLnBsdXMoZHYuZHVyYXRpb24oY3VycmVudFNoaWZ0IHx8IFwiMSBkYXlcIikpO1xuICAgICAgICBjb25zdCBuZXdWYWx1ZSA9IG1vbWVudChuZXdEYXRlLnRvU3RyaW5nKCkpLmZvcm1hdChkYXRlRm9ybWF0KVxuICAgICAgICBpZiAobmV4dEludGVydmFsRmllbGQgJiYgbmV4dFNoaWZ0KSB7XG4gICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5maWxlVGFza01hbmFnZXJcbiAgICAgICAgICAgICAgICAucHVzaFRhc2soKCkgPT4geyByZXBsYWNlVmFsdWVzKHRoaXMucGx1Z2luLCBmaWxlLnBhdGgsIG5leHRJbnRlcnZhbEZpZWxkLm5hbWUsIG5leHRTaGlmdCkgfSk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgbGlua0ZpbGUgPSB0aGlzLnBsdWdpbi5hcHAubWV0YWRhdGFDYWNoZS5nZXRGaXJzdExpbmtwYXRoRGVzdChsaW5rUGF0aCB8fCBcIlwiICsgbmV3VmFsdWUuZm9ybWF0KGRhdGVGb3JtYXQpLCBmaWxlLnBhdGgpXG4gICAgICAgIGNvbnN0IGZvcm1hdHRlZFZhbHVlID0gRGF0ZUZpZWxkLnN0cmluZ1RvQm9vbGVhbihkZWZhdWx0SW5zZXJ0QXNMaW5rKSA/XG4gICAgICAgICAgICBgW1ske2xpbmtQYXRoIHx8IFwiXCJ9JHtuZXdWYWx1ZX0ke2xpbmtGaWxlID8gXCJ8XCIgKyBsaW5rRmlsZS5iYXNlbmFtZSA6IFwiXCJ9XV1gIDpcbiAgICAgICAgICAgIG5ld1ZhbHVlXG4gICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLmZpbGVUYXNrTWFuYWdlclxuICAgICAgICAgICAgLnB1c2hUYXNrKCgpID0+IHsgcmVwbGFjZVZhbHVlcyh0aGlzLnBsdWdpbiwgZmlsZS5wYXRoLCB0aGlzLmZpZWxkLm5hbWUsIGZvcm1hdHRlZFZhbHVlKSB9KTtcblxuICAgIH1cblxuICAgIHB1YmxpYyBjcmVhdGVEdkZpZWxkKFxuICAgICAgICBkdjogYW55LFxuICAgICAgICBwOiBhbnksXG4gICAgICAgIGZpZWxkQ29udGFpbmVyOiBIVE1MRWxlbWVudCxcbiAgICAgICAgYXR0cnM/OiB7IGNscz86IHN0cmluZyB8IHVuZGVmaW5lZDsgYXR0cj86IFJlY29yZDxzdHJpbmcsIHN0cmluZz4gfCB1bmRlZmluZWQ7IG9wdGlvbnM/OiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+IHwgdW5kZWZpbmVkOyB9XG4gICAgKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IGZpZWxkVmFsdWUgPSBkdi5lbCgnc3BhbicsIHBbdGhpcy5maWVsZC5uYW1lXSwgYXR0cnMpO1xuICAgICAgICBjb25zdCBkYXRlQnRuID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImJ1dHRvblwiKVxuICAgICAgICBzZXRJY29uKGRhdGVCdG4sIEZpZWxkSWNvbltGaWVsZFR5cGUuRGF0ZV0pXG4gICAgICAgIGRhdGVCdG4uYWRkQ2xhc3MoXCJtZXRhZGF0YS1tZW51LWR2LWZpZWxkLWJ1dHRvblwiKVxuICAgICAgICAvKiBlbmQgc3BhY2VyICovXG4gICAgICAgIGNvbnN0IHNwYWNlciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIilcbiAgICAgICAgaWYgKHRoaXMuZmllbGQub3B0aW9ucy5kYXRlU2hpZnRJbnRlcnZhbCB8fCB0aGlzLmZpZWxkLm9wdGlvbnMubmV4dFNoaWZ0SW50ZXJ2YWxGaWVsZCkge1xuICAgICAgICAgICAgdGhpcy5zaGlmdEJ0biA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJidXR0b25cIilcbiAgICAgICAgICAgIHNldEljb24odGhpcy5zaGlmdEJ0biwgXCJza2lwLWZvcndhcmRcIilcbiAgICAgICAgICAgIHRoaXMuc2hpZnRCdG4uYWRkQ2xhc3MoXCJtZXRhZGF0YS1tZW51LWR2LWZpZWxkLWJ1dHRvblwiKVxuICAgICAgICAgICAgc3BhY2VyLnNldEF0dHIoXCJjbGFzc1wiLCBcIm1ldGFkYXRhLW1lbnUtZHYtZmllbGQtZG91YmxlLXNwYWNlclwiKVxuXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBzcGFjZXIuc2V0QXR0cihcImNsYXNzXCIsIFwibWV0YWRhdGEtbWVudS1kdi1maWVsZC1zcGFjZXJcIilcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGZpbGUgPSB0aGlzLnBsdWdpbi5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKHAuZmlsZS5wYXRoKVxuICAgICAgICBsZXQgZmllbGRNb2RhbDogRGF0ZU1vZGFsO1xuICAgICAgICBpZiAoZmlsZSBpbnN0YW5jZW9mIFRGaWxlICYmIGZpbGUuZXh0ZW5zaW9uID09IFwibWRcIikge1xuICAgICAgICAgICAgaWYgKHBbdGhpcy5maWVsZC5uYW1lXSAmJiBwW3RoaXMuZmllbGQubmFtZV0uaGFzT3duUHJvcGVydHkoXCJwYXRoXCIpKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgZGF0ZUZpbGUgPSB0aGlzLnBsdWdpbi5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKHBbdGhpcy5maWVsZC5uYW1lXSlcbiAgICAgICAgICAgICAgICBpZiAoZGF0ZUZpbGUgaW5zdGFuY2VvZiBURmlsZSAmJiBkYXRlRmlsZS5leHRlbnNpb24gPT0gXCJtZFwiKSB7XG4gICAgICAgICAgICAgICAgICAgIGZpZWxkTW9kYWwgPSBuZXcgRGF0ZU1vZGFsKHRoaXMucGx1Z2luLCBmaWxlLCB0aGlzLmZpZWxkLCBkYXRlRmlsZS5uYW1lKVxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGZpZWxkTW9kYWwgPSBuZXcgRGF0ZU1vZGFsKHRoaXMucGx1Z2luLCBmaWxlLCB0aGlzLmZpZWxkLCBwW3RoaXMuZmllbGQubmFtZV0ucGF0aC5zcGxpdChcIi9cIikubGFzdCgpLnJlcGxhY2UoXCIubWRcIiwgXCJcIikpXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIGlmIChwW3RoaXMuZmllbGQubmFtZV0pIHtcbiAgICAgICAgICAgICAgICBmaWVsZE1vZGFsID0gbmV3IERhdGVNb2RhbCh0aGlzLnBsdWdpbiwgZmlsZSwgdGhpcy5maWVsZCwgcFt0aGlzLmZpZWxkLm5hbWVdKVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBmaWVsZE1vZGFsID0gbmV3IERhdGVNb2RhbCh0aGlzLnBsdWdpbiwgZmlsZSwgdGhpcy5maWVsZCwgXCJcIilcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0aGlzLnNoaWZ0QnRuKSB0aGlzLnNoaWZ0QnRuLm9uY2xpY2sgPSAoKSA9PiB7IHRoaXMuc2hpZnREYXRlKGR2LCBwLCBmaWxlKSB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aHJvdyBFcnJvcihcInBhdGggZG9lc24ndCBjb3JyZXNwb25kIHRvIGEgcHJvcGVyIGZpbGVcIik7XG4gICAgICAgIH1cbiAgICAgICAgZmllbGRNb2RhbC5vbkNsb3NlID0gKCkgPT4geyBmaWVsZE1vZGFsLmNvbnRlbnRFbC5pbm5lckhUTUwgPSBcIlwiOyB9XG4gICAgICAgIGRhdGVCdG4ub25jbGljayA9ICgpID0+IHsgZmllbGRNb2RhbC5vcGVuKCkgfVxuXG4gICAgICAgIGlmICghYXR0cnM/Lm9wdGlvbnM/LmFsd2F5c09uKSB7XG4gICAgICAgICAgICBkYXRlQnRuLmhpZGUoKVxuICAgICAgICAgICAgaWYgKHRoaXMuc2hpZnRCdG4pIHRoaXMuc2hpZnRCdG4uaGlkZSgpXG4gICAgICAgICAgICBzcGFjZXIuc2hvdygpXG4gICAgICAgICAgICBmaWVsZENvbnRhaW5lci5vbm1vdXNlb3ZlciA9ICgpID0+IHtcbiAgICAgICAgICAgICAgICBkYXRlQnRuLnNob3coKVxuICAgICAgICAgICAgICAgIGlmICh0aGlzLnNoaWZ0QnRuKSB0aGlzLnNoaWZ0QnRuLnNob3coKVxuICAgICAgICAgICAgICAgIHNwYWNlci5oaWRlKClcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGZpZWxkQ29udGFpbmVyLm9ubW91c2VvdXQgPSAoKSA9PiB7XG4gICAgICAgICAgICAgICAgZGF0ZUJ0bi5oaWRlKClcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5zaGlmdEJ0bikgdGhpcy5zaGlmdEJ0bi5oaWRlKClcbiAgICAgICAgICAgICAgICBzcGFjZXIuc2hvdygpXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvKiBpbml0aWFsIHN0YXRlICovXG4gICAgICAgIGZpZWxkQ29udGFpbmVyLmFwcGVuZENoaWxkKGZpZWxkVmFsdWUpO1xuICAgICAgICBmaWVsZENvbnRhaW5lci5hcHBlbmRDaGlsZChkYXRlQnRuKTtcbiAgICAgICAgaWYgKHRoaXMuc2hpZnRCdG4pIGZpZWxkQ29udGFpbmVyLmFwcGVuZENoaWxkKHRoaXMuc2hpZnRCdG4pO1xuICAgICAgICBmaWVsZENvbnRhaW5lci5hcHBlbmRDaGlsZChzcGFjZXIpO1xuICAgIH1cblxuICAgIHB1YmxpYyBnZXRPcHRpb25zU3RyKCk6IHN0cmluZyB7XG4gICAgICAgIHJldHVybiB0aGlzLmZpZWxkLm9wdGlvbnMuZGF0ZUZvcm1hdDtcbiAgICB9XG5cbiAgICBwdWJsaWMgdmFsaWRhdGVPcHRpb25zKCk6IGJvb2xlYW4ge1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG5cbiAgICBwdWJsaWMgdmFsaWRhdGVWYWx1ZSh2YWx1ZTogc3RyaW5nKTogYm9vbGVhbiB7XG4gICAgICAgIGlmICghdmFsdWUpIHtcbiAgICAgICAgICAgIHJldHVybiB0cnVlXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBpZiAodHlwZW9mICh2YWx1ZSkgPT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbW9tZW50KFxuICAgICAgICAgICAgICAgICAgICB2YWx1ZS5yZXBsYWNlKC9eXFxbXFxbL2csIFwiXCIpLnJlcGxhY2UoL1xcXVxcXSQvZywgXCJcIikuc3BsaXQoXCJ8XCIpLmZpcnN0KCk/LnNwbGl0KFwiL1wiKS5sYXN0KCksXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZmllbGQub3B0aW9ucy5kYXRlRm9ybWF0XG4gICAgICAgICAgICAgICAgKS5pc1ZhbGlkKClcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG1vbWVudChcbiAgICAgICAgICAgICAgICAgICAgKHZhbHVlIGFzIHsgcGF0aDogc3RyaW5nIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAucGF0aC5yZXBsYWNlKC9eXFxbXFxbL2csIFwiXCIpLnJlcGxhY2UoL1xcXVxcXSQvZywgXCJcIikuc3BsaXQoXCJ8XCIpLmZpcnN0KCk/LnNwbGl0KFwiL1wiKS5sYXN0KCksXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZmllbGQub3B0aW9ucy5kYXRlRm9ybWF0XG4gICAgICAgICAgICAgICAgKS5pc1ZhbGlkKClcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIHB1YmxpYyBzaGlmdER1cmF0aW9uKGZpbGU6IFRGaWxlKTogW3N0cmluZyB8IHVuZGVmaW5lZCwgRmllbGQgfCB1bmRlZmluZWQsIHN0cmluZyB8IHVuZGVmaW5lZF0ge1xuICAgICAgICBjb25zdCBkdkFwaSA9IHRoaXMucGx1Z2luLmFwcC5wbHVnaW5zLnBsdWdpbnMuZGF0YXZpZXc/LmFwaVxuICAgICAgICBpZiAoZHZBcGkpIHtcbiAgICAgICAgICAgIGNvbnN0IGludGVydmFsID0gdGhpcy5maWVsZC5vcHRpb25zLmRhdGVTaGlmdEludGVydmFsXG5cbiAgICAgICAgICAgIGNvbnN0IGN5Y2xlSW50ZXJ2YWxGaWVsZCA9IHRoaXMuZmllbGQub3B0aW9ucy5uZXh0U2hpZnRJbnRlcnZhbEZpZWxkXG4gICAgICAgICAgICBsZXQgZmlsZUNsYXNzOiBGaWxlQ2xhc3MgfCB1bmRlZmluZWQ7XG4gICAgICAgICAgICBjb25zdCBmcm9udG1hdHRlciA9IHRoaXMucGx1Z2luLmFwcC5tZXRhZGF0YUNhY2hlLmdldEZpbGVDYWNoZShmaWxlKT8uZnJvbnRtYXR0ZXJcbiAgICAgICAgICAgIGlmIChmcm9udG1hdHRlcikge1xuICAgICAgICAgICAgICAgIGNvbnN0IGZpbGVDbGFzc05hbWUgPSBmcm9udG1hdHRlclt0aGlzLnBsdWdpbi5zZXR0aW5ncy5maWxlQ2xhc3NBbGlhc11cbiAgICAgICAgICAgICAgICBsZXQgZmlsZUNsYXNzOiBGaWxlQ2xhc3MgfCB1bmRlZmluZWRcbiAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICBmaWxlQ2xhc3MgPSBmaWxlQ2xhc3NOYW1lID8gRmlsZUNsYXNzLmNyZWF0ZUZpbGVDbGFzcyh0aGlzLnBsdWdpbiwgZmlsZUNsYXNzTmFtZSkgOiB1bmRlZmluZWRcbiAgICAgICAgICAgICAgICB9IGNhdGNoIHtcbiAgICAgICAgICAgICAgICAgICAgZmlsZUNsYXNzID0gdW5kZWZpbmVkXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uc3QgY3ljbGUgPSBnZXRGaWVsZCh0aGlzLnBsdWdpbiwgY3ljbGVJbnRlcnZhbEZpZWxkLCBmaWxlQ2xhc3MpXG4gICAgICAgICAgICBpZiAoY3ljbGUpIHtcbiAgICAgICAgICAgICAgICAvL2N5Y2xlIGZpZWxkIGV4aXN0c1xuICAgICAgICAgICAgICAgIGNvbnN0IGN5Y2xlTWFuYWdlcjogQ3ljbGVGaWVsZCA9IG5ldyBGTVtjeWNsZS50eXBlXSh0aGlzLnBsdWdpbiwgY3ljbGUpXG4gICAgICAgICAgICAgICAgY29uc3Qgb3B0aW9ucyA9IE9iamVjdC5lbnRyaWVzKGN5Y2xlTWFuYWdlci5maWVsZC5vcHRpb25zKTtcbiAgICAgICAgICAgICAgICBjb25zdCBjdXJyZW50VmFsdWUgPSBkdkFwaS5wYWdlKGZpbGUucGF0aClbY3ljbGUubmFtZV1cblxuICAgICAgICAgICAgICAgIGlmIChjdXJyZW50VmFsdWUpIHtcbiAgICAgICAgICAgICAgICAgICAgLy9jdXJyZW50IHZhbHVlIGlzIG5vdCBudWxsXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGN1cnJlbnRWYWx1ZVN0cmluZyA9IG9wdGlvbnNcbiAgICAgICAgICAgICAgICAgICAgICAgIC5maWx0ZXIobyA9PiBkdkFwaS5kdXJhdGlvbihvWzFdKSAhPT0gbnVsbClcbiAgICAgICAgICAgICAgICAgICAgICAgIC5maW5kKG8gPT4gZHZBcGkuZHVyYXRpb24ob1sxXSkuZXF1YWxzKGN1cnJlbnRWYWx1ZSkpXG4gICAgICAgICAgICAgICAgICAgIGlmIChjdXJyZW50VmFsdWVTdHJpbmcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vY3VycmVudCB2YWx1ZSBoYXMgYSBtYXRjaCBpbiBjeWNsZSBvcHRpb25zXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBuZXh0VmFsdWUgPSBjeWNsZU1hbmFnZXIubmV4dE9wdGlvbihjdXJyZW50VmFsdWVTdHJpbmdbMV0pXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gW2N1cnJlbnRWYWx1ZVN0cmluZ1sxXSwgY3ljbGUsIG5leHRWYWx1ZV1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvL2N1cnJlbnQgdmFsdWUgaXMgbm90IGZvdW5kIG9yIDogZmFsbCBiYWNrIG9uIGZpcnN0IHZhbHVlXG4gICAgICAgICAgICAgICAgcmV0dXJuIFtvcHRpb25zWzBdWzFdLCBjeWNsZSwgb3B0aW9uc1sxXVsxXSB8fCBvcHRpb25zWzBdWzFdXVxuICAgICAgICAgICAgfSBlbHNlIGlmIChpbnRlcnZhbCAmJiBkdkFwaS5kdXJhdGlvbihpbnRlcnZhbCkpIHtcbiAgICAgICAgICAgICAgICAvL25vIGN5Y2xlIGZpZWxkOiBmYWxsIGJhY2sgb24gaW50ZXJ2YWwgaWYgZXhpc3RzXG4gICAgICAgICAgICAgICAgcmV0dXJuIFtpbnRlcnZhbCwgdW5kZWZpbmVkLCB1bmRlZmluZWRdXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgLy8gZHYgbm90IGF2YWlsYWJsZSA9PiByZXR1cm4gdW5kZWZpbmVkIGN5Y2xlIHZhbHVlc1xuICAgICAgICByZXR1cm4gW3VuZGVmaW5lZCwgdW5kZWZpbmVkLCB1bmRlZmluZWRdXG4gICAgfVxufSIsICJpbXBvcnQgeyBNb2RhbCwgVGV4dENvbXBvbmVudCwgVEZpbGUsIFRvZ2dsZUNvbXBvbmVudCwgQnV0dG9uQ29tcG9uZW50IH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgeyBpbnNlcnRWYWx1ZXMgfSBmcm9tIFwic3JjL2NvbW1hbmRzL2luc2VydFZhbHVlc1wiO1xuaW1wb3J0IHsgcmVwbGFjZVZhbHVlcyB9IGZyb20gXCJzcmMvY29tbWFuZHMvcmVwbGFjZVZhbHVlc1wiO1xuaW1wb3J0IEZpZWxkIGZyb20gXCJzcmMvZmllbGRzL0ZpZWxkXCI7XG5pbXBvcnQgeyBGaWVsZE1hbmFnZXIgYXMgRk0gfSBmcm9tIFwic3JjL2ZpZWxkcy9GaWVsZE1hbmFnZXJcIjtcbmltcG9ydCB7IG1vbWVudCB9IGZyb20gXCJvYnNpZGlhblwiO1xuaW1wb3J0IGZsYXRwaWNrciBmcm9tIFwiZmxhdHBpY2tyXCI7XG5pbXBvcnQgTWV0YWRhdGFNZW51IGZyb20gXCJtYWluXCI7XG5pbXBvcnQgeyBGaWVsZEljb24sIEZpZWxkVHlwZSwgRmllbGRNYW5hZ2VyIH0gZnJvbSBcInNyYy90eXBlcy9maWVsZFR5cGVzXCI7XG5pbXBvcnQgRGF0ZUZpZWxkIGZyb20gXCJzcmMvZmllbGRzL2ZpZWxkTWFuYWdlcnMvRGF0ZUZpZWxkXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIERhdGVNb2RhbCBleHRlbmRzIE1vZGFsIHtcblxuICAgIHByaXZhdGUgdmFsdWU6IHN0cmluZztcbiAgICBwcml2YXRlIGluc2VydEFzTGluazogYm9vbGVhbjtcbiAgICBwcml2YXRlIGlucHV0RWw6IFRleHRDb21wb25lbnQ7XG4gICAgcHJpdmF0ZSBlcnJvckZpZWxkOiBIVE1MRGl2RWxlbWVudDtcbiAgICBwcml2YXRlIGZvcm1hdDogc3RyaW5nO1xuICAgIHByaXZhdGUgbmV4dEludGVydmFsRmllbGQ/OiBGaWVsZDtcbiAgICBwcml2YXRlIHB1c2hOZXh0SW50ZXJ2YWw6IGJvb2xlYW4gPSBmYWxzZTtcbiAgICBwcml2YXRlIGN1cnJlbnRTaGlmdD86IHN0cmluZ1xuICAgIHByaXZhdGUgbmV4dFNoaWZ0Pzogc3RyaW5nXG4gICAgcHJpdmF0ZSBkYXRlTWFuYWdlcj86IERhdGVGaWVsZFxuICAgIHByaXZhdGUgZHZBcGk/OiBhbnlcblxuICAgIGNvbnN0cnVjdG9yKFxuICAgICAgICBwcml2YXRlIHBsdWdpbjogTWV0YWRhdGFNZW51LFxuICAgICAgICBwcml2YXRlIGZpbGU6IFRGaWxlLFxuICAgICAgICBwcml2YXRlIGZpZWxkOiBGaWVsZCxcbiAgICAgICAgcHJpdmF0ZSBpbml0aWFsVmFsdWU6IHN0cmluZyxcbiAgICAgICAgcHJpdmF0ZSBsaW5lTnVtYmVyOiBudW1iZXIgPSAtMSxcbiAgICAgICAgcHJpdmF0ZSBpbkZyb250bWF0dGVyOiBib29sZWFuID0gZmFsc2UsXG4gICAgICAgIHByaXZhdGUgYWZ0ZXI6IGJvb2xlYW4gPSBmYWxzZVxuICAgICkge1xuICAgICAgICBzdXBlcihwbHVnaW4uYXBwKTtcbiAgICAgICAgdGhpcy5pbml0aWFsVmFsdWUgPSBpbml0aWFsVmFsdWUgPyBpbml0aWFsVmFsdWUudG9TdHJpbmcoKS5yZXBsYWNlKC9eXFxbXFxbL2csIFwiXCIpLnJlcGxhY2UoL1xcXVxcXSQvZywgXCJcIikuc3BsaXQoXCJ8XCIpLmZpcnN0KCk/LnNwbGl0KFwiL1wiKS5sYXN0KCkgfHwgXCJcIiA6IFwiXCI7XG4gICAgICAgIHRoaXMuaW5zZXJ0QXNMaW5rID0gRk0uc3RyaW5nVG9Cb29sZWFuKHRoaXMuZmllbGQub3B0aW9ucy5kZWZhdWx0SW5zZXJ0QXNMaW5rIHx8IFwiZmFsc2VcIikgfHwgZmFsc2U7XG4gICAgICAgIHRoaXMuZm9ybWF0ID0gdGhpcy5maWVsZC5vcHRpb25zLmRhdGVGb3JtYXQgfHwgdGhpcy5maWVsZC5vcHRpb25zLmRlZmF1bHREYXRlRm9ybWF0O1xuICAgICAgICB0aGlzLmR2QXBpID0gdGhpcy5wbHVnaW4uYXBwLnBsdWdpbnMucGx1Z2luc1tcImRhdGF2aWV3XCJdPy5hcGlcbiAgICAgICAgaWYgKHRoaXMuZHZBcGkpIHRoaXMuZGF0ZU1hbmFnZXIgPSBuZXcgRmllbGRNYW5hZ2VyW3RoaXMuZmllbGQudHlwZV0odGhpcy5wbHVnaW4sIHRoaXMuZmllbGQpO1xuICAgICAgICB0aGlzLnZhbHVlID0gdGhpcy5pbml0aWFsVmFsdWU7XG4gICAgfTtcblxuICAgIG9uT3BlbigpIHtcbiAgICAgICAgY29uc3QgZmllbGRDb250YWluZXIgPSB0aGlzLmNvbnRlbnRFbC5jcmVhdGVEaXYoeyBjbHM6IFwibWV0YWRhdGEtbWVudS1tb2RhbC12YWx1ZVwiIH0pO1xuICAgICAgICB0aGlzLmJ1aWxkRmllbGRzKGZpZWxkQ29udGFpbmVyKTtcbiAgICB9O1xuXG4gICAgcHJpdmF0ZSBidWlsZEZpZWxkcyhwYXJlbnRDb250YWluZXI6IEhUTUxEaXZFbGVtZW50KSB7XG5cbiAgICAgICAgY29uc3QgZGF0ZUZpZWxkc0NvbnRhaW5lciA9IHBhcmVudENvbnRhaW5lci5jcmVhdGVFbChcImRpdlwiLCB7IGNsczogXCJtZXRhZGF0YS1tZW51LW1vZGFsLWZpZWxkcy1jb250YWluZXJcIiB9KTtcbiAgICAgICAgdGhpcy5idWlsZElucHV0RWwoZGF0ZUZpZWxkc0NvbnRhaW5lcik7XG4gICAgICAgIHRoaXMuZXJyb3JGaWVsZCA9IGRhdGVGaWVsZHNDb250YWluZXIuY3JlYXRlRWwoXCJkaXZcIiwgeyBjbHM6IFwibWV0YWRhdGEtbWVudS1tb2RhbC12YWx1ZS1lcnJvci1maWVsZFwiIH0pO1xuICAgICAgICB0aGlzLmVycm9yRmllbGQuaGlkZSgpO1xuICAgICAgICB0aGlzLmJ1aWxkSW5zZXJ0QXNMaW5rVG9nZ2xlcihkYXRlRmllbGRzQ29udGFpbmVyKTtcbiAgICAgICAgY29uc3Qgc2F2ZUJ0bkNvbnRhaW5lciA9IGRhdGVGaWVsZHNDb250YWluZXIuY3JlYXRlRWwoXCJkaXZcIiwgeyBjbHM6IFwibWV0YWRhdGEtbWVudS12YWx1ZS1ncmlkLWZvb3RlclwiIH0pO1xuICAgICAgICBjb25zdCBzYXZlQnRuID0gbmV3IEJ1dHRvbkNvbXBvbmVudChzYXZlQnRuQ29udGFpbmVyKVxuICAgICAgICBzYXZlQnRuLnNldEljb24oXCJjaGVja21hcmtcIilcblxuICAgICAgICBzYXZlQnRuLm9uQ2xpY2soYXN5bmMgKGU6IEV2ZW50KSA9PiB7XG4gICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICBsZXQgbmV3VmFsdWU6IG1vbWVudC5Nb21lbnQ7XG4gICAgICAgICAgICAvL3RyeSBuYXR1cmFsIGxhbmd1YWdlIGRhdGVcbiAgICAgICAgICAgIGlmICh0aGlzLnBsdWdpbi5hcHAucGx1Z2lucy5lbmFibGVkUGx1Z2lucy5oYXMoJ25sZGF0ZXMtb2JzaWRpYW4nKSkge1xuICAgICAgICAgICAgICAgIC8vQHRzLWlnbm9yZVxuICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG5sZGF0ZXMgPSB0aGlzLnBsdWdpbi5hcHAucGx1Z2lucy5wbHVnaW5zWydubGRhdGVzLW9ic2lkaWFuJ107XG4gICAgICAgICAgICAgICAgICAgIG5ld1ZhbHVlID0gbmxkYXRlcy5wYXJzZURhdGUodGhpcy52YWx1ZSkubW9tZW50O1xuICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgIG5ld1ZhbHVlID0gbW9tZW50KHRoaXMudmFsdWUsIHRoaXMuZm9ybWF0KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIG5ld1ZhbHVlID0gbW9tZW50KHRoaXMudmFsdWUsIHRoaXMuZm9ybWF0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChuZXdWYWx1ZS5pc1ZhbGlkKCkpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBsaW5rUGF0aCA9IHRoaXMucGx1Z2luLmFwcC5tZXRhZGF0YUNhY2hlLmdldEZpcnN0TGlua3BhdGhEZXN0KHRoaXMuZmllbGQub3B0aW9ucy5saW5rUGF0aCB8fCBcIlwiICsgbmV3VmFsdWUuZm9ybWF0KHRoaXMuZm9ybWF0KSwgdGhpcy5maWxlLnBhdGgpXG4gICAgICAgICAgICAgICAgY29uc3QgZm9ybWF0dGVkVmFsdWUgPSB0aGlzLmluc2VydEFzTGluayA/IGBbWyR7dGhpcy5maWVsZC5vcHRpb25zLmxpbmtQYXRoIHx8IFwiXCJ9JHtuZXdWYWx1ZS5mb3JtYXQodGhpcy5mb3JtYXQpfSR7bGlua1BhdGggPyBcInxcIiArIGxpbmtQYXRoLmJhc2VuYW1lIDogXCJcIn1dXWAgOiBuZXdWYWx1ZS5mb3JtYXQodGhpcy5mb3JtYXQpXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMubGluZU51bWJlciA9PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5maWxlVGFza01hbmFnZXJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5wdXNoVGFzaygoKSA9PiB7IHJlcGxhY2VWYWx1ZXModGhpcy5wbHVnaW4sIHRoaXMuZmlsZSwgdGhpcy5maWVsZC5uYW1lLCBmb3JtYXR0ZWRWYWx1ZSkgfSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uZmlsZVRhc2tNYW5hZ2VyXG4gICAgICAgICAgICAgICAgICAgICAgICAucHVzaFRhc2soKCkgPT4geyBpbnNlcnRWYWx1ZXModGhpcy5wbHVnaW4sIHRoaXMuZmlsZSwgdGhpcy5maWVsZC5uYW1lLCBmb3JtYXR0ZWRWYWx1ZSwgdGhpcy5saW5lTnVtYmVyLCB0aGlzLmluRnJvbnRtYXR0ZXIsIHRoaXMuYWZ0ZXIpIH0pO1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMubmV4dEludGVydmFsRmllbGQgJiYgdGhpcy5wdXNoTmV4dEludGVydmFsICYmIHRoaXMubmV4dFNoaWZ0KSB7XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLmZpbGVUYXNrTWFuYWdlclxuICAgICAgICAgICAgICAgICAgICAgICAgLnB1c2hUYXNrKCgpID0+IHsgcmVwbGFjZVZhbHVlcyh0aGlzLnBsdWdpbiwgdGhpcy5maWxlLnBhdGgsIHRoaXMubmV4dEludGVydmFsRmllbGQhLm5hbWUsIHRoaXMubmV4dFNoaWZ0ISkgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoIXRoaXMudmFsdWUpIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5saW5lTnVtYmVyID09IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLmZpbGVUYXNrTWFuYWdlclxuICAgICAgICAgICAgICAgICAgICAgICAgLnB1c2hUYXNrKCgpID0+IHsgcmVwbGFjZVZhbHVlcyh0aGlzLnBsdWdpbiwgdGhpcy5maWxlLCB0aGlzLmZpZWxkLm5hbWUsIFwiXCIpIH0pO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLmZpbGVUYXNrTWFuYWdlclxuICAgICAgICAgICAgICAgICAgICAgICAgLnB1c2hUYXNrKCgpID0+IHsgaW5zZXJ0VmFsdWVzKHRoaXMucGx1Z2luLCB0aGlzLmZpbGUsIHRoaXMuZmllbGQubmFtZSwgXCJcIiwgdGhpcy5saW5lTnVtYmVyLCB0aGlzLmluRnJvbnRtYXR0ZXIsIHRoaXMuYWZ0ZXIpIH0pO1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgdGhpcy5jbG9zZSgpXG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMuZXJyb3JGaWVsZC5zaG93KCk7XG4gICAgICAgICAgICAgICAgdGhpcy5lcnJvckZpZWxkLnNldFRleHQoYHZhbHVlIG11c3QgYmUgYSB2YWxpZCBkYXRlYClcbiAgICAgICAgICAgICAgICB0aGlzLmlucHV0RWwuaW5wdXRFbC5hZGRDbGFzcyhcImlzLWludmFsaWRcIilcbiAgICAgICAgICAgICAgICByZXR1cm5cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBidWlsZEluc2VydEFzTGlua1RvZ2dsZXIoY29udGFpbmVyOiBIVE1MRGl2RWxlbWVudCkge1xuICAgICAgICBjb25zdCB0b2dnbGVyQ29udGFpbmVyID0gY29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJtZXRhZGF0YS1tZW51LXRvZ2dsZXItd2l0aC1sYWJlbFwiIH0pXG4gICAgICAgIGNvbnN0IHRvZ2dsZXJDb250YWluZXJMYWJlbCA9IHRvZ2dsZXJDb250YWluZXIuY3JlYXRlRGl2KHtcbiAgICAgICAgICAgIGNsczogXCJtZXRhZGF0YS1tZW51LXRvZ2dsZXItbGFiZWxcIlxuICAgICAgICB9KTtcbiAgICAgICAgdG9nZ2xlckNvbnRhaW5lckxhYmVsLnNldFRleHQoXCJJbnNlcnQgYXMgbGlua1wiKTtcbiAgICAgICAgY29uc3QgdG9nZ2xlRWwgPSBuZXcgVG9nZ2xlQ29tcG9uZW50KHRvZ2dsZXJDb250YWluZXIpO1xuICAgICAgICB0b2dnbGVFbC5zZXRWYWx1ZShGTS5zdHJpbmdUb0Jvb2xlYW4odGhpcy5maWVsZC5vcHRpb25zLmRlZmF1bHRJbnNlcnRBc0xpbmsgfHwgXCJmYWxzZVwiKSlcbiAgICAgICAgdG9nZ2xlRWwub25DaGFuZ2UoKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICB0aGlzLmluc2VydEFzTGluayA9IHZhbHVlXG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIHByaXZhdGUgdG9nZ2xlQnV0dG9uKGJ1dHRvbjogQnV0dG9uQ29tcG9uZW50LCB2YWx1ZTogc3RyaW5nKTogdm9pZCB7XG4gICAgICAgIGJ1dHRvbi5zZXREaXNhYmxlZCghIXZhbHVlKVxuICAgICAgICBpZiAodmFsdWUpIHtcbiAgICAgICAgICAgIGJ1dHRvbi5idXR0b25FbC5hZGRDbGFzcyhcImRpc2FibGVkXCIpXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBidXR0b24uYnV0dG9uRWwucmVtb3ZlQ2xhc3MoXCJkaXNhYmxlZFwiKVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBidWlsZElucHV0RWwoY29udGFpbmVyOiBIVE1MRGl2RWxlbWVudCk6IHZvaWQge1xuICAgICAgICAvL2xldCBjdXJyZW50RHZEdXJhdGlvbjogYW55O1xuXG4gICAgICAgIGlmICh0aGlzLmRhdGVNYW5hZ2VyKSBbdGhpcy5jdXJyZW50U2hpZnQsIHRoaXMubmV4dEludGVydmFsRmllbGQsIHRoaXMubmV4dFNoaWZ0XSA9IHRoaXMuZGF0ZU1hbmFnZXIuc2hpZnREdXJhdGlvbih0aGlzLmZpbGUpO1xuXG4gICAgICAgIGNvbnN0IGlucHV0Q29udGFpbmVyID0gY29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJtZXRhZGF0YS1tZW51LWRhdGVpbnB1dC13aXRoLXBpY2tlclwiIH0pXG4gICAgICAgIHRoaXMuaW5wdXRFbCA9IG5ldyBUZXh0Q29tcG9uZW50KGlucHV0Q29udGFpbmVyKTtcbiAgICAgICAgdGhpcy5pbnB1dEVsLmlucHV0RWwuZm9jdXMoKTtcblxuICAgICAgICB0aGlzLmlucHV0RWwuc2V0UGxhY2Vob2xkZXIoXG4gICAgICAgICAgICB0aGlzLmluaXRpYWxWYWx1ZSA/XG4gICAgICAgICAgICAgICAgbW9tZW50KHRoaXMuaW5pdGlhbFZhbHVlLCB0aGlzLmZpZWxkLm9wdGlvbnMuZGF0ZUZvcm1hdCkuZm9ybWF0KHRoaXMuZmllbGQub3B0aW9ucy5kYXRlRm9ybWF0KVxuICAgICAgICAgICAgICAgIDogXCJcIik7XG4gICAgICAgIHRoaXMuaW5wdXRFbC5pbnB1dEVsLmFkZENsYXNzKFwibWV0YWRhdGEtbWVudS1wcm9tcHQtaW5wdXRcIik7XG4gICAgICAgIHRoaXMuaW5wdXRFbC5vbkNoYW5nZSh2YWx1ZSA9PiB7XG4gICAgICAgICAgICB0aGlzLmlucHV0RWwuaW5wdXRFbC5yZW1vdmVDbGFzcyhcImlzLWludmFsaWRcIilcbiAgICAgICAgICAgIHRoaXMuZXJyb3JGaWVsZC5oaWRlKCk7XG4gICAgICAgICAgICB0aGlzLmVycm9yRmllbGQuc2V0VGV4dChcIlwiKTtcbiAgICAgICAgICAgIHRoaXMudmFsdWUgPSB2YWx1ZVxuICAgICAgICAgICAgdGhpcy50b2dnbGVCdXR0b24oc2hpZnRGcm9tVG9kYXlCdG4sIHZhbHVlKVxuICAgICAgICB9KTtcbiAgICAgICAgY29uc3QgY2FsZW5kYXJEaXNwbGF5QnRuID0gbmV3IEJ1dHRvbkNvbXBvbmVudChpbnB1dENvbnRhaW5lcilcbiAgICAgICAgY2FsZW5kYXJEaXNwbGF5QnRuLmJ1dHRvbkVsLmFkZENsYXNzKFwibWV0YWRhdGEtbWVudS1tb2RhbC1pbmxpbmUtYnRuXCIpXG4gICAgICAgIGNhbGVuZGFyRGlzcGxheUJ0bi5zZXRJY29uKEZpZWxkSWNvbltGaWVsZFR5cGUuRGF0ZV0pXG4gICAgICAgIGNhbGVuZGFyRGlzcGxheUJ0bi5zZXRUb29sdGlwKFwib3BlbiBkYXRlIHBpY2tlclwiKVxuICAgICAgICBjb25zdCBzaGlmdEZyb21Ub2RheUJ0biA9IG5ldyBCdXR0b25Db21wb25lbnQoaW5wdXRDb250YWluZXIpXG4gICAgICAgIHNoaWZ0RnJvbVRvZGF5QnRuLmJ1dHRvbkVsLmFkZENsYXNzKFwibWV0YWRhdGEtbWVudS1tb2RhbC1pbmxpbmUtYnRuXCIpXG4gICAgICAgIHNoaWZ0RnJvbVRvZGF5QnRuLnNldEljb24oXCJza2lwLWZvcndhcmRcIilcbiAgICAgICAgc2hpZnRGcm9tVG9kYXlCdG4uc2V0VG9vbHRpcChgU2hpZnQgJHt0aGlzLmZpZWxkLm5hbWV9ICR7dGhpcy5jdXJyZW50U2hpZnQgfHwgXCIxIGRheVwifSBhaGVhZGApXG5cbiAgICAgICAgY29uc3QgZGF0ZVBpY2tlckNvbnRhaW5lciA9IGNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IFwibWV0YWRhdGEtbWVudS1waWNrZXItY29udGFpbmVyXCIgfSk7XG4gICAgICAgIGNvbnN0IGRhdGVQaWNrZXIgPSBmbGF0cGlja3IoZGF0ZVBpY2tlckNvbnRhaW5lciwge1xuICAgICAgICAgICAgbG9jYWxlOiB7XG4gICAgICAgICAgICAgICAgZmlyc3REYXlPZldlZWs6IHRoaXMucGx1Z2luLnNldHRpbmdzLmZpcnN0RGF5T2ZXZWVrXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgZGVmYXVsdERhdGU6IFwiMjAyMi0wOS0yMlwiXG4gICAgICAgIH0pO1xuICAgICAgICBkYXRlUGlja2VyLmNvbmZpZy5vbkNoYW5nZS5wdXNoKCh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgY29uc3QgbmV3RGF0ZSA9IG1vbWVudCh2YWx1ZS50b1N0cmluZygpKS5mb3JtYXQodGhpcy5mb3JtYXQpO1xuICAgICAgICAgICAgdGhpcy5pbnB1dEVsLnNldFZhbHVlKG5ld0RhdGUpO1xuICAgICAgICAgICAgdGhpcy52YWx1ZSA9IG5ld0RhdGU7XG4gICAgICAgICAgICB0aGlzLnRvZ2dsZUJ1dHRvbihzaGlmdEZyb21Ub2RheUJ0biwgdGhpcy52YWx1ZSlcbiAgICAgICAgfSlcblxuICAgICAgICBjYWxlbmRhckRpc3BsYXlCdG4ub25DbGljaygoZTogTW91c2VFdmVudCkgPT4ge1xuICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgZGF0ZVBpY2tlci5zZXREYXRlKGRhdGVQaWNrZXIucGFyc2VEYXRlKHRoaXMuaW5wdXRFbC5nZXRWYWx1ZSgpKSB8fCBuZXcgRGF0ZSgpKVxuICAgICAgICAgICAgZGF0ZVBpY2tlci5vcGVuKCk7XG4gICAgICAgIH0pXG5cbiAgICAgICAgc2hpZnRGcm9tVG9kYXlCdG4ub25DbGljayhhc3luYyAoZTogTW91c2VFdmVudCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgY3VycmVudER2RGF0ZSA9IHRoaXMuZHZBcGkuZGF0ZShtb21lbnQodGhpcy5pbml0aWFsVmFsdWUsIHRoaXMuZm9ybWF0KS50b0lTT1N0cmluZygpKTtcbiAgICAgICAgICAgIGNvbnN0IG5ld0RhdGUgPSBjdXJyZW50RHZEYXRlLnBsdXModGhpcy5kdkFwaS5kdXJhdGlvbih0aGlzLmN1cnJlbnRTaGlmdCB8fCBcIjEgZGF5XCIpKTtcbiAgICAgICAgICAgIGNvbnN0IG5ld1ZhbHVlID0gbW9tZW50KG5ld0RhdGUudG9TdHJpbmcoKSkuZm9ybWF0KHRoaXMuZm9ybWF0KVxuICAgICAgICAgICAgdGhpcy5pbnB1dEVsLnNldFZhbHVlKG5ld1ZhbHVlKTtcbiAgICAgICAgICAgIHRoaXMudmFsdWUgPSBuZXdWYWx1ZTtcbiAgICAgICAgICAgIHRoaXMucHVzaE5leHRJbnRlcnZhbCA9IHRydWU7XG4gICAgICAgICAgICB0aGlzLnRvZ2dsZUJ1dHRvbihzaGlmdEZyb21Ub2RheUJ0biwgdGhpcy5pbnB1dEVsLmdldFZhbHVlKCkpXG4gICAgICAgIH0pXG5cbiAgICAgICAgaWYgKCF0aGlzLmR2QXBpKSB7XG4gICAgICAgICAgICBzaGlmdEZyb21Ub2RheUJ0bi5idXR0b25FbC5oaWRlKCk7XG4gICAgICAgICAgICBzaGlmdEZyb21Ub2RheUJ0bi5zZXREaXNhYmxlZCh0cnVlKTtcbiAgICAgICAgfVxuICAgIH07XG59O1xuIiwgImV4cG9ydCB2YXIgSE9PS1MgPSBbXG4gICAgXCJvbkNoYW5nZVwiLFxuICAgIFwib25DbG9zZVwiLFxuICAgIFwib25EYXlDcmVhdGVcIixcbiAgICBcIm9uRGVzdHJveVwiLFxuICAgIFwib25LZXlEb3duXCIsXG4gICAgXCJvbk1vbnRoQ2hhbmdlXCIsXG4gICAgXCJvbk9wZW5cIixcbiAgICBcIm9uUGFyc2VDb25maWdcIixcbiAgICBcIm9uUmVhZHlcIixcbiAgICBcIm9uVmFsdWVVcGRhdGVcIixcbiAgICBcIm9uWWVhckNoYW5nZVwiLFxuICAgIFwib25QcmVDYWxlbmRhclBvc2l0aW9uXCIsXG5dO1xuZXhwb3J0IHZhciBkZWZhdWx0cyA9IHtcbiAgICBfZGlzYWJsZTogW10sXG4gICAgYWxsb3dJbnB1dDogZmFsc2UsXG4gICAgYWxsb3dJbnZhbGlkUHJlbG9hZDogZmFsc2UsXG4gICAgYWx0Rm9ybWF0OiBcIkYgaiwgWVwiLFxuICAgIGFsdElucHV0OiBmYWxzZSxcbiAgICBhbHRJbnB1dENsYXNzOiBcImZvcm0tY29udHJvbCBpbnB1dFwiLFxuICAgIGFuaW1hdGU6IHR5cGVvZiB3aW5kb3cgPT09IFwib2JqZWN0XCIgJiZcbiAgICAgICAgd2luZG93Lm5hdmlnYXRvci51c2VyQWdlbnQuaW5kZXhPZihcIk1TSUVcIikgPT09IC0xLFxuICAgIGFyaWFEYXRlRm9ybWF0OiBcIkYgaiwgWVwiLFxuICAgIGF1dG9GaWxsRGVmYXVsdFRpbWU6IHRydWUsXG4gICAgY2xpY2tPcGVuczogdHJ1ZSxcbiAgICBjbG9zZU9uU2VsZWN0OiB0cnVlLFxuICAgIGNvbmp1bmN0aW9uOiBcIiwgXCIsXG4gICAgZGF0ZUZvcm1hdDogXCJZLW0tZFwiLFxuICAgIGRlZmF1bHRIb3VyOiAxMixcbiAgICBkZWZhdWx0TWludXRlOiAwLFxuICAgIGRlZmF1bHRTZWNvbmRzOiAwLFxuICAgIGRpc2FibGU6IFtdLFxuICAgIGRpc2FibGVNb2JpbGU6IGZhbHNlLFxuICAgIGVuYWJsZVNlY29uZHM6IGZhbHNlLFxuICAgIGVuYWJsZVRpbWU6IGZhbHNlLFxuICAgIGVycm9ySGFuZGxlcjogZnVuY3Rpb24gKGVycikge1xuICAgICAgICByZXR1cm4gdHlwZW9mIGNvbnNvbGUgIT09IFwidW5kZWZpbmVkXCIgJiYgY29uc29sZS53YXJuKGVycik7XG4gICAgfSxcbiAgICBnZXRXZWVrOiBmdW5jdGlvbiAoZ2l2ZW5EYXRlKSB7XG4gICAgICAgIHZhciBkYXRlID0gbmV3IERhdGUoZ2l2ZW5EYXRlLmdldFRpbWUoKSk7XG4gICAgICAgIGRhdGUuc2V0SG91cnMoMCwgMCwgMCwgMCk7XG4gICAgICAgIGRhdGUuc2V0RGF0ZShkYXRlLmdldERhdGUoKSArIDMgLSAoKGRhdGUuZ2V0RGF5KCkgKyA2KSAlIDcpKTtcbiAgICAgICAgdmFyIHdlZWsxID0gbmV3IERhdGUoZGF0ZS5nZXRGdWxsWWVhcigpLCAwLCA0KTtcbiAgICAgICAgcmV0dXJuICgxICtcbiAgICAgICAgICAgIE1hdGgucm91bmQoKChkYXRlLmdldFRpbWUoKSAtIHdlZWsxLmdldFRpbWUoKSkgLyA4NjQwMDAwMCAtXG4gICAgICAgICAgICAgICAgMyArXG4gICAgICAgICAgICAgICAgKCh3ZWVrMS5nZXREYXkoKSArIDYpICUgNykpIC9cbiAgICAgICAgICAgICAgICA3KSk7XG4gICAgfSxcbiAgICBob3VySW5jcmVtZW50OiAxLFxuICAgIGlnbm9yZWRGb2N1c0VsZW1lbnRzOiBbXSxcbiAgICBpbmxpbmU6IGZhbHNlLFxuICAgIGxvY2FsZTogXCJkZWZhdWx0XCIsXG4gICAgbWludXRlSW5jcmVtZW50OiA1LFxuICAgIG1vZGU6IFwic2luZ2xlXCIsXG4gICAgbW9udGhTZWxlY3RvclR5cGU6IFwiZHJvcGRvd25cIixcbiAgICBuZXh0QXJyb3c6IFwiPHN2ZyB2ZXJzaW9uPScxLjEnIHhtbG5zPSdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZycgeG1sbnM6eGxpbms9J2h0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsnIHZpZXdCb3g9JzAgMCAxNyAxNyc+PGc+PC9nPjxwYXRoIGQ9J00xMy4yMDcgOC40NzJsLTcuODU0IDcuODU0LTAuNzA3LTAuNzA3IDcuMTQ2LTcuMTQ2LTcuMTQ2LTcuMTQ4IDAuNzA3LTAuNzA3IDcuODU0IDcuODU0eicgLz48L3N2Zz5cIixcbiAgICBub0NhbGVuZGFyOiBmYWxzZSxcbiAgICBub3c6IG5ldyBEYXRlKCksXG4gICAgb25DaGFuZ2U6IFtdLFxuICAgIG9uQ2xvc2U6IFtdLFxuICAgIG9uRGF5Q3JlYXRlOiBbXSxcbiAgICBvbkRlc3Ryb3k6IFtdLFxuICAgIG9uS2V5RG93bjogW10sXG4gICAgb25Nb250aENoYW5nZTogW10sXG4gICAgb25PcGVuOiBbXSxcbiAgICBvblBhcnNlQ29uZmlnOiBbXSxcbiAgICBvblJlYWR5OiBbXSxcbiAgICBvblZhbHVlVXBkYXRlOiBbXSxcbiAgICBvblllYXJDaGFuZ2U6IFtdLFxuICAgIG9uUHJlQ2FsZW5kYXJQb3NpdGlvbjogW10sXG4gICAgcGx1Z2luczogW10sXG4gICAgcG9zaXRpb246IFwiYXV0b1wiLFxuICAgIHBvc2l0aW9uRWxlbWVudDogdW5kZWZpbmVkLFxuICAgIHByZXZBcnJvdzogXCI8c3ZnIHZlcnNpb249JzEuMScgeG1sbnM9J2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJyB4bWxuczp4bGluaz0naHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluaycgdmlld0JveD0nMCAwIDE3IDE3Jz48Zz48L2c+PHBhdGggZD0nTTUuMjA3IDguNDcxbDcuMTQ2IDcuMTQ3LTAuNzA3IDAuNzA3LTcuODUzLTcuODU0IDcuODU0LTcuODUzIDAuNzA3IDAuNzA3LTcuMTQ3IDcuMTQ2eicgLz48L3N2Zz5cIixcbiAgICBzaG9ydGhhbmRDdXJyZW50TW9udGg6IGZhbHNlLFxuICAgIHNob3dNb250aHM6IDEsXG4gICAgc3RhdGljOiBmYWxzZSxcbiAgICB0aW1lXzI0aHI6IGZhbHNlLFxuICAgIHdlZWtOdW1iZXJzOiBmYWxzZSxcbiAgICB3cmFwOiBmYWxzZSxcbn07XG4iLCAiZXhwb3J0IHZhciBlbmdsaXNoID0ge1xuICAgIHdlZWtkYXlzOiB7XG4gICAgICAgIHNob3J0aGFuZDogW1wiU3VuXCIsIFwiTW9uXCIsIFwiVHVlXCIsIFwiV2VkXCIsIFwiVGh1XCIsIFwiRnJpXCIsIFwiU2F0XCJdLFxuICAgICAgICBsb25naGFuZDogW1xuICAgICAgICAgICAgXCJTdW5kYXlcIixcbiAgICAgICAgICAgIFwiTW9uZGF5XCIsXG4gICAgICAgICAgICBcIlR1ZXNkYXlcIixcbiAgICAgICAgICAgIFwiV2VkbmVzZGF5XCIsXG4gICAgICAgICAgICBcIlRodXJzZGF5XCIsXG4gICAgICAgICAgICBcIkZyaWRheVwiLFxuICAgICAgICAgICAgXCJTYXR1cmRheVwiLFxuICAgICAgICBdLFxuICAgIH0sXG4gICAgbW9udGhzOiB7XG4gICAgICAgIHNob3J0aGFuZDogW1xuICAgICAgICAgICAgXCJKYW5cIixcbiAgICAgICAgICAgIFwiRmViXCIsXG4gICAgICAgICAgICBcIk1hclwiLFxuICAgICAgICAgICAgXCJBcHJcIixcbiAgICAgICAgICAgIFwiTWF5XCIsXG4gICAgICAgICAgICBcIkp1blwiLFxuICAgICAgICAgICAgXCJKdWxcIixcbiAgICAgICAgICAgIFwiQXVnXCIsXG4gICAgICAgICAgICBcIlNlcFwiLFxuICAgICAgICAgICAgXCJPY3RcIixcbiAgICAgICAgICAgIFwiTm92XCIsXG4gICAgICAgICAgICBcIkRlY1wiLFxuICAgICAgICBdLFxuICAgICAgICBsb25naGFuZDogW1xuICAgICAgICAgICAgXCJKYW51YXJ5XCIsXG4gICAgICAgICAgICBcIkZlYnJ1YXJ5XCIsXG4gICAgICAgICAgICBcIk1hcmNoXCIsXG4gICAgICAgICAgICBcIkFwcmlsXCIsXG4gICAgICAgICAgICBcIk1heVwiLFxuICAgICAgICAgICAgXCJKdW5lXCIsXG4gICAgICAgICAgICBcIkp1bHlcIixcbiAgICAgICAgICAgIFwiQXVndXN0XCIsXG4gICAgICAgICAgICBcIlNlcHRlbWJlclwiLFxuICAgICAgICAgICAgXCJPY3RvYmVyXCIsXG4gICAgICAgICAgICBcIk5vdmVtYmVyXCIsXG4gICAgICAgICAgICBcIkRlY2VtYmVyXCIsXG4gICAgICAgIF0sXG4gICAgfSxcbiAgICBkYXlzSW5Nb250aDogWzMxLCAyOCwgMzEsIDMwLCAzMSwgMzAsIDMxLCAzMSwgMzAsIDMxLCAzMCwgMzFdLFxuICAgIGZpcnN0RGF5T2ZXZWVrOiAwLFxuICAgIG9yZGluYWw6IGZ1bmN0aW9uIChudGgpIHtcbiAgICAgICAgdmFyIHMgPSBudGggJSAxMDA7XG4gICAgICAgIGlmIChzID4gMyAmJiBzIDwgMjEpXG4gICAgICAgICAgICByZXR1cm4gXCJ0aFwiO1xuICAgICAgICBzd2l0Y2ggKHMgJSAxMCkge1xuICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgIHJldHVybiBcInN0XCI7XG4gICAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIFwibmRcIjtcbiAgICAgICAgICAgIGNhc2UgMzpcbiAgICAgICAgICAgICAgICByZXR1cm4gXCJyZFwiO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gXCJ0aFwiO1xuICAgICAgICB9XG4gICAgfSxcbiAgICByYW5nZVNlcGFyYXRvcjogXCIgdG8gXCIsXG4gICAgd2Vla0FiYnJldmlhdGlvbjogXCJXa1wiLFxuICAgIHNjcm9sbFRpdGxlOiBcIlNjcm9sbCB0byBpbmNyZW1lbnRcIixcbiAgICB0b2dnbGVUaXRsZTogXCJDbGljayB0byB0b2dnbGVcIixcbiAgICBhbVBNOiBbXCJBTVwiLCBcIlBNXCJdLFxuICAgIHllYXJBcmlhTGFiZWw6IFwiWWVhclwiLFxuICAgIG1vbnRoQXJpYUxhYmVsOiBcIk1vbnRoXCIsXG4gICAgaG91ckFyaWFMYWJlbDogXCJIb3VyXCIsXG4gICAgbWludXRlQXJpYUxhYmVsOiBcIk1pbnV0ZVwiLFxuICAgIHRpbWVfMjRocjogZmFsc2UsXG59O1xuZXhwb3J0IGRlZmF1bHQgZW5nbGlzaDtcbiIsICJleHBvcnQgdmFyIHBhZCA9IGZ1bmN0aW9uIChudW1iZXIsIGxlbmd0aCkge1xuICAgIGlmIChsZW5ndGggPT09IHZvaWQgMCkgeyBsZW5ndGggPSAyOyB9XG4gICAgcmV0dXJuIChcIjAwMFwiICsgbnVtYmVyKS5zbGljZShsZW5ndGggKiAtMSk7XG59O1xuZXhwb3J0IHZhciBpbnQgPSBmdW5jdGlvbiAoYm9vbCkgeyByZXR1cm4gKGJvb2wgPT09IHRydWUgPyAxIDogMCk7IH07XG5leHBvcnQgZnVuY3Rpb24gZGVib3VuY2UoZm4sIHdhaXQpIHtcbiAgICB2YXIgdDtcbiAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB2YXIgYXJncyA9IGFyZ3VtZW50cztcbiAgICAgICAgY2xlYXJUaW1lb3V0KHQpO1xuICAgICAgICB0ID0gc2V0VGltZW91dChmdW5jdGlvbiAoKSB7IHJldHVybiBmbi5hcHBseShfdGhpcywgYXJncyk7IH0sIHdhaXQpO1xuICAgIH07XG59XG5leHBvcnQgdmFyIGFycmF5aWZ5ID0gZnVuY3Rpb24gKG9iaikge1xuICAgIHJldHVybiBvYmogaW5zdGFuY2VvZiBBcnJheSA/IG9iaiA6IFtvYmpdO1xufTtcbiIsICJleHBvcnQgZnVuY3Rpb24gdG9nZ2xlQ2xhc3MoZWxlbSwgY2xhc3NOYW1lLCBib29sKSB7XG4gICAgaWYgKGJvb2wgPT09IHRydWUpXG4gICAgICAgIHJldHVybiBlbGVtLmNsYXNzTGlzdC5hZGQoY2xhc3NOYW1lKTtcbiAgICBlbGVtLmNsYXNzTGlzdC5yZW1vdmUoY2xhc3NOYW1lKTtcbn1cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVFbGVtZW50KHRhZywgY2xhc3NOYW1lLCBjb250ZW50KSB7XG4gICAgdmFyIGUgPSB3aW5kb3cuZG9jdW1lbnQuY3JlYXRlRWxlbWVudCh0YWcpO1xuICAgIGNsYXNzTmFtZSA9IGNsYXNzTmFtZSB8fCBcIlwiO1xuICAgIGNvbnRlbnQgPSBjb250ZW50IHx8IFwiXCI7XG4gICAgZS5jbGFzc05hbWUgPSBjbGFzc05hbWU7XG4gICAgaWYgKGNvbnRlbnQgIT09IHVuZGVmaW5lZClcbiAgICAgICAgZS50ZXh0Q29udGVudCA9IGNvbnRlbnQ7XG4gICAgcmV0dXJuIGU7XG59XG5leHBvcnQgZnVuY3Rpb24gY2xlYXJOb2RlKG5vZGUpIHtcbiAgICB3aGlsZSAobm9kZS5maXJzdENoaWxkKVxuICAgICAgICBub2RlLnJlbW92ZUNoaWxkKG5vZGUuZmlyc3RDaGlsZCk7XG59XG5leHBvcnQgZnVuY3Rpb24gZmluZFBhcmVudChub2RlLCBjb25kaXRpb24pIHtcbiAgICBpZiAoY29uZGl0aW9uKG5vZGUpKVxuICAgICAgICByZXR1cm4gbm9kZTtcbiAgICBlbHNlIGlmIChub2RlLnBhcmVudE5vZGUpXG4gICAgICAgIHJldHVybiBmaW5kUGFyZW50KG5vZGUucGFyZW50Tm9kZSwgY29uZGl0aW9uKTtcbiAgICByZXR1cm4gdW5kZWZpbmVkO1xufVxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZU51bWJlcklucHV0KGlucHV0Q2xhc3NOYW1lLCBvcHRzKSB7XG4gICAgdmFyIHdyYXBwZXIgPSBjcmVhdGVFbGVtZW50KFwiZGl2XCIsIFwibnVtSW5wdXRXcmFwcGVyXCIpLCBudW1JbnB1dCA9IGNyZWF0ZUVsZW1lbnQoXCJpbnB1dFwiLCBcIm51bUlucHV0IFwiICsgaW5wdXRDbGFzc05hbWUpLCBhcnJvd1VwID0gY3JlYXRlRWxlbWVudChcInNwYW5cIiwgXCJhcnJvd1VwXCIpLCBhcnJvd0Rvd24gPSBjcmVhdGVFbGVtZW50KFwic3BhblwiLCBcImFycm93RG93blwiKTtcbiAgICBpZiAobmF2aWdhdG9yLnVzZXJBZ2VudC5pbmRleE9mKFwiTVNJRSA5LjBcIikgPT09IC0xKSB7XG4gICAgICAgIG51bUlucHV0LnR5cGUgPSBcIm51bWJlclwiO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgbnVtSW5wdXQudHlwZSA9IFwidGV4dFwiO1xuICAgICAgICBudW1JbnB1dC5wYXR0ZXJuID0gXCJcXFxcZCpcIjtcbiAgICB9XG4gICAgaWYgKG9wdHMgIT09IHVuZGVmaW5lZClcbiAgICAgICAgZm9yICh2YXIga2V5IGluIG9wdHMpXG4gICAgICAgICAgICBudW1JbnB1dC5zZXRBdHRyaWJ1dGUoa2V5LCBvcHRzW2tleV0pO1xuICAgIHdyYXBwZXIuYXBwZW5kQ2hpbGQobnVtSW5wdXQpO1xuICAgIHdyYXBwZXIuYXBwZW5kQ2hpbGQoYXJyb3dVcCk7XG4gICAgd3JhcHBlci5hcHBlbmRDaGlsZChhcnJvd0Rvd24pO1xuICAgIHJldHVybiB3cmFwcGVyO1xufVxuZXhwb3J0IGZ1bmN0aW9uIGdldEV2ZW50VGFyZ2V0KGV2ZW50KSB7XG4gICAgdHJ5IHtcbiAgICAgICAgaWYgKHR5cGVvZiBldmVudC5jb21wb3NlZFBhdGggPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICAgICAgdmFyIHBhdGggPSBldmVudC5jb21wb3NlZFBhdGgoKTtcbiAgICAgICAgICAgIHJldHVybiBwYXRoWzBdO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBldmVudC50YXJnZXQ7XG4gICAgfVxuICAgIGNhdGNoIChlcnJvcikge1xuICAgICAgICByZXR1cm4gZXZlbnQudGFyZ2V0O1xuICAgIH1cbn1cbiIsICJpbXBvcnQgeyBpbnQsIHBhZCB9IGZyb20gXCIuLi91dGlsc1wiO1xudmFyIGRvTm90aGluZyA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHVuZGVmaW5lZDsgfTtcbmV4cG9ydCB2YXIgbW9udGhUb1N0ciA9IGZ1bmN0aW9uIChtb250aE51bWJlciwgc2hvcnRoYW5kLCBsb2NhbGUpIHsgcmV0dXJuIGxvY2FsZS5tb250aHNbc2hvcnRoYW5kID8gXCJzaG9ydGhhbmRcIiA6IFwibG9uZ2hhbmRcIl1bbW9udGhOdW1iZXJdOyB9O1xuZXhwb3J0IHZhciByZXZGb3JtYXQgPSB7XG4gICAgRDogZG9Ob3RoaW5nLFxuICAgIEY6IGZ1bmN0aW9uIChkYXRlT2JqLCBtb250aE5hbWUsIGxvY2FsZSkge1xuICAgICAgICBkYXRlT2JqLnNldE1vbnRoKGxvY2FsZS5tb250aHMubG9uZ2hhbmQuaW5kZXhPZihtb250aE5hbWUpKTtcbiAgICB9LFxuICAgIEc6IGZ1bmN0aW9uIChkYXRlT2JqLCBob3VyKSB7XG4gICAgICAgIGRhdGVPYmouc2V0SG91cnMoKGRhdGVPYmouZ2V0SG91cnMoKSA+PSAxMiA/IDEyIDogMCkgKyBwYXJzZUZsb2F0KGhvdXIpKTtcbiAgICB9LFxuICAgIEg6IGZ1bmN0aW9uIChkYXRlT2JqLCBob3VyKSB7XG4gICAgICAgIGRhdGVPYmouc2V0SG91cnMocGFyc2VGbG9hdChob3VyKSk7XG4gICAgfSxcbiAgICBKOiBmdW5jdGlvbiAoZGF0ZU9iaiwgZGF5KSB7XG4gICAgICAgIGRhdGVPYmouc2V0RGF0ZShwYXJzZUZsb2F0KGRheSkpO1xuICAgIH0sXG4gICAgSzogZnVuY3Rpb24gKGRhdGVPYmosIGFtUE0sIGxvY2FsZSkge1xuICAgICAgICBkYXRlT2JqLnNldEhvdXJzKChkYXRlT2JqLmdldEhvdXJzKCkgJSAxMikgK1xuICAgICAgICAgICAgMTIgKiBpbnQobmV3IFJlZ0V4cChsb2NhbGUuYW1QTVsxXSwgXCJpXCIpLnRlc3QoYW1QTSkpKTtcbiAgICB9LFxuICAgIE06IGZ1bmN0aW9uIChkYXRlT2JqLCBzaG9ydE1vbnRoLCBsb2NhbGUpIHtcbiAgICAgICAgZGF0ZU9iai5zZXRNb250aChsb2NhbGUubW9udGhzLnNob3J0aGFuZC5pbmRleE9mKHNob3J0TW9udGgpKTtcbiAgICB9LFxuICAgIFM6IGZ1bmN0aW9uIChkYXRlT2JqLCBzZWNvbmRzKSB7XG4gICAgICAgIGRhdGVPYmouc2V0U2Vjb25kcyhwYXJzZUZsb2F0KHNlY29uZHMpKTtcbiAgICB9LFxuICAgIFU6IGZ1bmN0aW9uIChfLCB1bml4U2Vjb25kcykgeyByZXR1cm4gbmV3IERhdGUocGFyc2VGbG9hdCh1bml4U2Vjb25kcykgKiAxMDAwKTsgfSxcbiAgICBXOiBmdW5jdGlvbiAoZGF0ZU9iaiwgd2Vla051bSwgbG9jYWxlKSB7XG4gICAgICAgIHZhciB3ZWVrTnVtYmVyID0gcGFyc2VJbnQod2Vla051bSk7XG4gICAgICAgIHZhciBkYXRlID0gbmV3IERhdGUoZGF0ZU9iai5nZXRGdWxsWWVhcigpLCAwLCAyICsgKHdlZWtOdW1iZXIgLSAxKSAqIDcsIDAsIDAsIDAsIDApO1xuICAgICAgICBkYXRlLnNldERhdGUoZGF0ZS5nZXREYXRlKCkgLSBkYXRlLmdldERheSgpICsgbG9jYWxlLmZpcnN0RGF5T2ZXZWVrKTtcbiAgICAgICAgcmV0dXJuIGRhdGU7XG4gICAgfSxcbiAgICBZOiBmdW5jdGlvbiAoZGF0ZU9iaiwgeWVhcikge1xuICAgICAgICBkYXRlT2JqLnNldEZ1bGxZZWFyKHBhcnNlRmxvYXQoeWVhcikpO1xuICAgIH0sXG4gICAgWjogZnVuY3Rpb24gKF8sIElTT0RhdGUpIHsgcmV0dXJuIG5ldyBEYXRlKElTT0RhdGUpOyB9LFxuICAgIGQ6IGZ1bmN0aW9uIChkYXRlT2JqLCBkYXkpIHtcbiAgICAgICAgZGF0ZU9iai5zZXREYXRlKHBhcnNlRmxvYXQoZGF5KSk7XG4gICAgfSxcbiAgICBoOiBmdW5jdGlvbiAoZGF0ZU9iaiwgaG91cikge1xuICAgICAgICBkYXRlT2JqLnNldEhvdXJzKChkYXRlT2JqLmdldEhvdXJzKCkgPj0gMTIgPyAxMiA6IDApICsgcGFyc2VGbG9hdChob3VyKSk7XG4gICAgfSxcbiAgICBpOiBmdW5jdGlvbiAoZGF0ZU9iaiwgbWludXRlcykge1xuICAgICAgICBkYXRlT2JqLnNldE1pbnV0ZXMocGFyc2VGbG9hdChtaW51dGVzKSk7XG4gICAgfSxcbiAgICBqOiBmdW5jdGlvbiAoZGF0ZU9iaiwgZGF5KSB7XG4gICAgICAgIGRhdGVPYmouc2V0RGF0ZShwYXJzZUZsb2F0KGRheSkpO1xuICAgIH0sXG4gICAgbDogZG9Ob3RoaW5nLFxuICAgIG06IGZ1bmN0aW9uIChkYXRlT2JqLCBtb250aCkge1xuICAgICAgICBkYXRlT2JqLnNldE1vbnRoKHBhcnNlRmxvYXQobW9udGgpIC0gMSk7XG4gICAgfSxcbiAgICBuOiBmdW5jdGlvbiAoZGF0ZU9iaiwgbW9udGgpIHtcbiAgICAgICAgZGF0ZU9iai5zZXRNb250aChwYXJzZUZsb2F0KG1vbnRoKSAtIDEpO1xuICAgIH0sXG4gICAgczogZnVuY3Rpb24gKGRhdGVPYmosIHNlY29uZHMpIHtcbiAgICAgICAgZGF0ZU9iai5zZXRTZWNvbmRzKHBhcnNlRmxvYXQoc2Vjb25kcykpO1xuICAgIH0sXG4gICAgdTogZnVuY3Rpb24gKF8sIHVuaXhNaWxsU2Vjb25kcykge1xuICAgICAgICByZXR1cm4gbmV3IERhdGUocGFyc2VGbG9hdCh1bml4TWlsbFNlY29uZHMpKTtcbiAgICB9LFxuICAgIHc6IGRvTm90aGluZyxcbiAgICB5OiBmdW5jdGlvbiAoZGF0ZU9iaiwgeWVhcikge1xuICAgICAgICBkYXRlT2JqLnNldEZ1bGxZZWFyKDIwMDAgKyBwYXJzZUZsb2F0KHllYXIpKTtcbiAgICB9LFxufTtcbmV4cG9ydCB2YXIgdG9rZW5SZWdleCA9IHtcbiAgICBEOiBcIlwiLFxuICAgIEY6IFwiXCIsXG4gICAgRzogXCIoXFxcXGRcXFxcZHxcXFxcZClcIixcbiAgICBIOiBcIihcXFxcZFxcXFxkfFxcXFxkKVwiLFxuICAgIEo6IFwiKFxcXFxkXFxcXGR8XFxcXGQpXFxcXHcrXCIsXG4gICAgSzogXCJcIixcbiAgICBNOiBcIlwiLFxuICAgIFM6IFwiKFxcXFxkXFxcXGR8XFxcXGQpXCIsXG4gICAgVTogXCIoLispXCIsXG4gICAgVzogXCIoXFxcXGRcXFxcZHxcXFxcZClcIixcbiAgICBZOiBcIihcXFxcZHs0fSlcIixcbiAgICBaOiBcIiguKylcIixcbiAgICBkOiBcIihcXFxcZFxcXFxkfFxcXFxkKVwiLFxuICAgIGg6IFwiKFxcXFxkXFxcXGR8XFxcXGQpXCIsXG4gICAgaTogXCIoXFxcXGRcXFxcZHxcXFxcZClcIixcbiAgICBqOiBcIihcXFxcZFxcXFxkfFxcXFxkKVwiLFxuICAgIGw6IFwiXCIsXG4gICAgbTogXCIoXFxcXGRcXFxcZHxcXFxcZClcIixcbiAgICBuOiBcIihcXFxcZFxcXFxkfFxcXFxkKVwiLFxuICAgIHM6IFwiKFxcXFxkXFxcXGR8XFxcXGQpXCIsXG4gICAgdTogXCIoLispXCIsXG4gICAgdzogXCIoXFxcXGRcXFxcZHxcXFxcZClcIixcbiAgICB5OiBcIihcXFxcZHsyfSlcIixcbn07XG5leHBvcnQgdmFyIGZvcm1hdHMgPSB7XG4gICAgWjogZnVuY3Rpb24gKGRhdGUpIHsgcmV0dXJuIGRhdGUudG9JU09TdHJpbmcoKTsgfSxcbiAgICBEOiBmdW5jdGlvbiAoZGF0ZSwgbG9jYWxlLCBvcHRpb25zKSB7XG4gICAgICAgIHJldHVybiBsb2NhbGUud2Vla2RheXMuc2hvcnRoYW5kW2Zvcm1hdHMudyhkYXRlLCBsb2NhbGUsIG9wdGlvbnMpXTtcbiAgICB9LFxuICAgIEY6IGZ1bmN0aW9uIChkYXRlLCBsb2NhbGUsIG9wdGlvbnMpIHtcbiAgICAgICAgcmV0dXJuIG1vbnRoVG9TdHIoZm9ybWF0cy5uKGRhdGUsIGxvY2FsZSwgb3B0aW9ucykgLSAxLCBmYWxzZSwgbG9jYWxlKTtcbiAgICB9LFxuICAgIEc6IGZ1bmN0aW9uIChkYXRlLCBsb2NhbGUsIG9wdGlvbnMpIHtcbiAgICAgICAgcmV0dXJuIHBhZChmb3JtYXRzLmgoZGF0ZSwgbG9jYWxlLCBvcHRpb25zKSk7XG4gICAgfSxcbiAgICBIOiBmdW5jdGlvbiAoZGF0ZSkgeyByZXR1cm4gcGFkKGRhdGUuZ2V0SG91cnMoKSk7IH0sXG4gICAgSjogZnVuY3Rpb24gKGRhdGUsIGxvY2FsZSkge1xuICAgICAgICByZXR1cm4gbG9jYWxlLm9yZGluYWwgIT09IHVuZGVmaW5lZFxuICAgICAgICAgICAgPyBkYXRlLmdldERhdGUoKSArIGxvY2FsZS5vcmRpbmFsKGRhdGUuZ2V0RGF0ZSgpKVxuICAgICAgICAgICAgOiBkYXRlLmdldERhdGUoKTtcbiAgICB9LFxuICAgIEs6IGZ1bmN0aW9uIChkYXRlLCBsb2NhbGUpIHsgcmV0dXJuIGxvY2FsZS5hbVBNW2ludChkYXRlLmdldEhvdXJzKCkgPiAxMSldOyB9LFxuICAgIE06IGZ1bmN0aW9uIChkYXRlLCBsb2NhbGUpIHtcbiAgICAgICAgcmV0dXJuIG1vbnRoVG9TdHIoZGF0ZS5nZXRNb250aCgpLCB0cnVlLCBsb2NhbGUpO1xuICAgIH0sXG4gICAgUzogZnVuY3Rpb24gKGRhdGUpIHsgcmV0dXJuIHBhZChkYXRlLmdldFNlY29uZHMoKSk7IH0sXG4gICAgVTogZnVuY3Rpb24gKGRhdGUpIHsgcmV0dXJuIGRhdGUuZ2V0VGltZSgpIC8gMTAwMDsgfSxcbiAgICBXOiBmdW5jdGlvbiAoZGF0ZSwgXywgb3B0aW9ucykge1xuICAgICAgICByZXR1cm4gb3B0aW9ucy5nZXRXZWVrKGRhdGUpO1xuICAgIH0sXG4gICAgWTogZnVuY3Rpb24gKGRhdGUpIHsgcmV0dXJuIHBhZChkYXRlLmdldEZ1bGxZZWFyKCksIDQpOyB9LFxuICAgIGQ6IGZ1bmN0aW9uIChkYXRlKSB7IHJldHVybiBwYWQoZGF0ZS5nZXREYXRlKCkpOyB9LFxuICAgIGg6IGZ1bmN0aW9uIChkYXRlKSB7IHJldHVybiAoZGF0ZS5nZXRIb3VycygpICUgMTIgPyBkYXRlLmdldEhvdXJzKCkgJSAxMiA6IDEyKTsgfSxcbiAgICBpOiBmdW5jdGlvbiAoZGF0ZSkgeyByZXR1cm4gcGFkKGRhdGUuZ2V0TWludXRlcygpKTsgfSxcbiAgICBqOiBmdW5jdGlvbiAoZGF0ZSkgeyByZXR1cm4gZGF0ZS5nZXREYXRlKCk7IH0sXG4gICAgbDogZnVuY3Rpb24gKGRhdGUsIGxvY2FsZSkge1xuICAgICAgICByZXR1cm4gbG9jYWxlLndlZWtkYXlzLmxvbmdoYW5kW2RhdGUuZ2V0RGF5KCldO1xuICAgIH0sXG4gICAgbTogZnVuY3Rpb24gKGRhdGUpIHsgcmV0dXJuIHBhZChkYXRlLmdldE1vbnRoKCkgKyAxKTsgfSxcbiAgICBuOiBmdW5jdGlvbiAoZGF0ZSkgeyByZXR1cm4gZGF0ZS5nZXRNb250aCgpICsgMTsgfSxcbiAgICBzOiBmdW5jdGlvbiAoZGF0ZSkgeyByZXR1cm4gZGF0ZS5nZXRTZWNvbmRzKCk7IH0sXG4gICAgdTogZnVuY3Rpb24gKGRhdGUpIHsgcmV0dXJuIGRhdGUuZ2V0VGltZSgpOyB9LFxuICAgIHc6IGZ1bmN0aW9uIChkYXRlKSB7IHJldHVybiBkYXRlLmdldERheSgpOyB9LFxuICAgIHk6IGZ1bmN0aW9uIChkYXRlKSB7IHJldHVybiBTdHJpbmcoZGF0ZS5nZXRGdWxsWWVhcigpKS5zdWJzdHJpbmcoMik7IH0sXG59O1xuIiwgImltcG9ydCB7IHRva2VuUmVnZXgsIHJldkZvcm1hdCwgZm9ybWF0cywgfSBmcm9tIFwiLi9mb3JtYXR0aW5nXCI7XG5pbXBvcnQgeyBkZWZhdWx0cyB9IGZyb20gXCIuLi90eXBlcy9vcHRpb25zXCI7XG5pbXBvcnQgeyBlbmdsaXNoIH0gZnJvbSBcIi4uL2wxMG4vZGVmYXVsdFwiO1xuZXhwb3J0IHZhciBjcmVhdGVEYXRlRm9ybWF0dGVyID0gZnVuY3Rpb24gKF9hKSB7XG4gICAgdmFyIF9iID0gX2EuY29uZmlnLCBjb25maWcgPSBfYiA9PT0gdm9pZCAwID8gZGVmYXVsdHMgOiBfYiwgX2MgPSBfYS5sMTBuLCBsMTBuID0gX2MgPT09IHZvaWQgMCA/IGVuZ2xpc2ggOiBfYywgX2QgPSBfYS5pc01vYmlsZSwgaXNNb2JpbGUgPSBfZCA9PT0gdm9pZCAwID8gZmFsc2UgOiBfZDtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGRhdGVPYmosIGZybXQsIG92ZXJyaWRlTG9jYWxlKSB7XG4gICAgICAgIHZhciBsb2NhbGUgPSBvdmVycmlkZUxvY2FsZSB8fCBsMTBuO1xuICAgICAgICBpZiAoY29uZmlnLmZvcm1hdERhdGUgIT09IHVuZGVmaW5lZCAmJiAhaXNNb2JpbGUpIHtcbiAgICAgICAgICAgIHJldHVybiBjb25maWcuZm9ybWF0RGF0ZShkYXRlT2JqLCBmcm10LCBsb2NhbGUpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmcm10XG4gICAgICAgICAgICAuc3BsaXQoXCJcIilcbiAgICAgICAgICAgIC5tYXAoZnVuY3Rpb24gKGMsIGksIGFycikge1xuICAgICAgICAgICAgcmV0dXJuIGZvcm1hdHNbY10gJiYgYXJyW2kgLSAxXSAhPT0gXCJcXFxcXCJcbiAgICAgICAgICAgICAgICA/IGZvcm1hdHNbY10oZGF0ZU9iaiwgbG9jYWxlLCBjb25maWcpXG4gICAgICAgICAgICAgICAgOiBjICE9PSBcIlxcXFxcIlxuICAgICAgICAgICAgICAgICAgICA/IGNcbiAgICAgICAgICAgICAgICAgICAgOiBcIlwiO1xuICAgICAgICB9KVxuICAgICAgICAgICAgLmpvaW4oXCJcIik7XG4gICAgfTtcbn07XG5leHBvcnQgdmFyIGNyZWF0ZURhdGVQYXJzZXIgPSBmdW5jdGlvbiAoX2EpIHtcbiAgICB2YXIgX2IgPSBfYS5jb25maWcsIGNvbmZpZyA9IF9iID09PSB2b2lkIDAgPyBkZWZhdWx0cyA6IF9iLCBfYyA9IF9hLmwxMG4sIGwxMG4gPSBfYyA9PT0gdm9pZCAwID8gZW5nbGlzaCA6IF9jO1xuICAgIHJldHVybiBmdW5jdGlvbiAoZGF0ZSwgZ2l2ZW5Gb3JtYXQsIHRpbWVsZXNzLCBjdXN0b21Mb2NhbGUpIHtcbiAgICAgICAgaWYgKGRhdGUgIT09IDAgJiYgIWRhdGUpXG4gICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgICB2YXIgbG9jYWxlID0gY3VzdG9tTG9jYWxlIHx8IGwxMG47XG4gICAgICAgIHZhciBwYXJzZWREYXRlO1xuICAgICAgICB2YXIgZGF0ZU9yaWcgPSBkYXRlO1xuICAgICAgICBpZiAoZGF0ZSBpbnN0YW5jZW9mIERhdGUpXG4gICAgICAgICAgICBwYXJzZWREYXRlID0gbmV3IERhdGUoZGF0ZS5nZXRUaW1lKCkpO1xuICAgICAgICBlbHNlIGlmICh0eXBlb2YgZGF0ZSAhPT0gXCJzdHJpbmdcIiAmJlxuICAgICAgICAgICAgZGF0ZS50b0ZpeGVkICE9PSB1bmRlZmluZWQpXG4gICAgICAgICAgICBwYXJzZWREYXRlID0gbmV3IERhdGUoZGF0ZSk7XG4gICAgICAgIGVsc2UgaWYgKHR5cGVvZiBkYXRlID09PSBcInN0cmluZ1wiKSB7XG4gICAgICAgICAgICB2YXIgZm9ybWF0ID0gZ2l2ZW5Gb3JtYXQgfHwgKGNvbmZpZyB8fCBkZWZhdWx0cykuZGF0ZUZvcm1hdDtcbiAgICAgICAgICAgIHZhciBkYXRlc3RyID0gU3RyaW5nKGRhdGUpLnRyaW0oKTtcbiAgICAgICAgICAgIGlmIChkYXRlc3RyID09PSBcInRvZGF5XCIpIHtcbiAgICAgICAgICAgICAgICBwYXJzZWREYXRlID0gbmV3IERhdGUoKTtcbiAgICAgICAgICAgICAgICB0aW1lbGVzcyA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChjb25maWcgJiYgY29uZmlnLnBhcnNlRGF0ZSkge1xuICAgICAgICAgICAgICAgIHBhcnNlZERhdGUgPSBjb25maWcucGFyc2VEYXRlKGRhdGUsIGZvcm1hdCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmICgvWiQvLnRlc3QoZGF0ZXN0cikgfHxcbiAgICAgICAgICAgICAgICAvR01UJC8udGVzdChkYXRlc3RyKSkge1xuICAgICAgICAgICAgICAgIHBhcnNlZERhdGUgPSBuZXcgRGF0ZShkYXRlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHZhciBtYXRjaGVkID0gdm9pZCAwLCBvcHMgPSBbXTtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMCwgbWF0Y2hJbmRleCA9IDAsIHJlZ2V4U3RyID0gXCJcIjsgaSA8IGZvcm1hdC5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgdG9rZW4gPSBmb3JtYXRbaV07XG4gICAgICAgICAgICAgICAgICAgIHZhciBpc0JhY2tTbGFzaCA9IHRva2VuID09PSBcIlxcXFxcIjtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGVzY2FwZWQgPSBmb3JtYXRbaSAtIDFdID09PSBcIlxcXFxcIiB8fCBpc0JhY2tTbGFzaDtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRva2VuUmVnZXhbdG9rZW5dICYmICFlc2NhcGVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZWdleFN0ciArPSB0b2tlblJlZ2V4W3Rva2VuXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBtYXRjaCA9IG5ldyBSZWdFeHAocmVnZXhTdHIpLmV4ZWMoZGF0ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobWF0Y2ggJiYgKG1hdGNoZWQgPSB0cnVlKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wc1t0b2tlbiAhPT0gXCJZXCIgPyBcInB1c2hcIiA6IFwidW5zaGlmdFwiXSh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZuOiByZXZGb3JtYXRbdG9rZW5dLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWw6IG1hdGNoWysrbWF0Y2hJbmRleF0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAoIWlzQmFja1NsYXNoKVxuICAgICAgICAgICAgICAgICAgICAgICAgcmVnZXhTdHIgKz0gXCIuXCI7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHBhcnNlZERhdGUgPVxuICAgICAgICAgICAgICAgICAgICAhY29uZmlnIHx8ICFjb25maWcubm9DYWxlbmRhclxuICAgICAgICAgICAgICAgICAgICAgICAgPyBuZXcgRGF0ZShuZXcgRGF0ZSgpLmdldEZ1bGxZZWFyKCksIDAsIDEsIDAsIDAsIDAsIDApXG4gICAgICAgICAgICAgICAgICAgICAgICA6IG5ldyBEYXRlKG5ldyBEYXRlKCkuc2V0SG91cnMoMCwgMCwgMCwgMCkpO1xuICAgICAgICAgICAgICAgIG9wcy5mb3JFYWNoKGZ1bmN0aW9uIChfYSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgZm4gPSBfYS5mbiwgdmFsID0gX2EudmFsO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gKHBhcnNlZERhdGUgPSBmbihwYXJzZWREYXRlLCB2YWwsIGxvY2FsZSkgfHwgcGFyc2VkRGF0ZSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgcGFyc2VkRGF0ZSA9IG1hdGNoZWQgPyBwYXJzZWREYXRlIDogdW5kZWZpbmVkO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmICghKHBhcnNlZERhdGUgaW5zdGFuY2VvZiBEYXRlICYmICFpc05hTihwYXJzZWREYXRlLmdldFRpbWUoKSkpKSB7XG4gICAgICAgICAgICBjb25maWcuZXJyb3JIYW5kbGVyKG5ldyBFcnJvcihcIkludmFsaWQgZGF0ZSBwcm92aWRlZDogXCIgKyBkYXRlT3JpZykpO1xuICAgICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGltZWxlc3MgPT09IHRydWUpXG4gICAgICAgICAgICBwYXJzZWREYXRlLnNldEhvdXJzKDAsIDAsIDAsIDApO1xuICAgICAgICByZXR1cm4gcGFyc2VkRGF0ZTtcbiAgICB9O1xufTtcbmV4cG9ydCBmdW5jdGlvbiBjb21wYXJlRGF0ZXMoZGF0ZTEsIGRhdGUyLCB0aW1lbGVzcykge1xuICAgIGlmICh0aW1lbGVzcyA9PT0gdm9pZCAwKSB7IHRpbWVsZXNzID0gdHJ1ZTsgfVxuICAgIGlmICh0aW1lbGVzcyAhPT0gZmFsc2UpIHtcbiAgICAgICAgcmV0dXJuIChuZXcgRGF0ZShkYXRlMS5nZXRUaW1lKCkpLnNldEhvdXJzKDAsIDAsIDAsIDApIC1cbiAgICAgICAgICAgIG5ldyBEYXRlKGRhdGUyLmdldFRpbWUoKSkuc2V0SG91cnMoMCwgMCwgMCwgMCkpO1xuICAgIH1cbiAgICByZXR1cm4gZGF0ZTEuZ2V0VGltZSgpIC0gZGF0ZTIuZ2V0VGltZSgpO1xufVxuZXhwb3J0IGZ1bmN0aW9uIGNvbXBhcmVUaW1lcyhkYXRlMSwgZGF0ZTIpIHtcbiAgICByZXR1cm4gKDM2MDAgKiAoZGF0ZTEuZ2V0SG91cnMoKSAtIGRhdGUyLmdldEhvdXJzKCkpICtcbiAgICAgICAgNjAgKiAoZGF0ZTEuZ2V0TWludXRlcygpIC0gZGF0ZTIuZ2V0TWludXRlcygpKSArXG4gICAgICAgIGRhdGUxLmdldFNlY29uZHMoKSAtXG4gICAgICAgIGRhdGUyLmdldFNlY29uZHMoKSk7XG59XG5leHBvcnQgdmFyIGlzQmV0d2VlbiA9IGZ1bmN0aW9uICh0cywgdHMxLCB0czIpIHtcbiAgICByZXR1cm4gdHMgPiBNYXRoLm1pbih0czEsIHRzMikgJiYgdHMgPCBNYXRoLm1heCh0czEsIHRzMik7XG59O1xuZXhwb3J0IHZhciBjYWxjdWxhdGVTZWNvbmRzU2luY2VNaWRuaWdodCA9IGZ1bmN0aW9uIChob3VycywgbWludXRlcywgc2Vjb25kcykge1xuICAgIHJldHVybiBob3VycyAqIDM2MDAgKyBtaW51dGVzICogNjAgKyBzZWNvbmRzO1xufTtcbmV4cG9ydCB2YXIgcGFyc2VTZWNvbmRzID0gZnVuY3Rpb24gKHNlY29uZHNTaW5jZU1pZG5pZ2h0KSB7XG4gICAgdmFyIGhvdXJzID0gTWF0aC5mbG9vcihzZWNvbmRzU2luY2VNaWRuaWdodCAvIDM2MDApLCBtaW51dGVzID0gKHNlY29uZHNTaW5jZU1pZG5pZ2h0IC0gaG91cnMgKiAzNjAwKSAvIDYwO1xuICAgIHJldHVybiBbaG91cnMsIG1pbnV0ZXMsIHNlY29uZHNTaW5jZU1pZG5pZ2h0IC0gaG91cnMgKiAzNjAwIC0gbWludXRlcyAqIDYwXTtcbn07XG5leHBvcnQgdmFyIGR1cmF0aW9uID0ge1xuICAgIERBWTogODY0MDAwMDAsXG59O1xuZXhwb3J0IGZ1bmN0aW9uIGdldERlZmF1bHRIb3Vycyhjb25maWcpIHtcbiAgICB2YXIgaG91cnMgPSBjb25maWcuZGVmYXVsdEhvdXI7XG4gICAgdmFyIG1pbnV0ZXMgPSBjb25maWcuZGVmYXVsdE1pbnV0ZTtcbiAgICB2YXIgc2Vjb25kcyA9IGNvbmZpZy5kZWZhdWx0U2Vjb25kcztcbiAgICBpZiAoY29uZmlnLm1pbkRhdGUgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICB2YXIgbWluSG91ciA9IGNvbmZpZy5taW5EYXRlLmdldEhvdXJzKCk7XG4gICAgICAgIHZhciBtaW5NaW51dGVzID0gY29uZmlnLm1pbkRhdGUuZ2V0TWludXRlcygpO1xuICAgICAgICB2YXIgbWluU2Vjb25kcyA9IGNvbmZpZy5taW5EYXRlLmdldFNlY29uZHMoKTtcbiAgICAgICAgaWYgKGhvdXJzIDwgbWluSG91cikge1xuICAgICAgICAgICAgaG91cnMgPSBtaW5Ib3VyO1xuICAgICAgICB9XG4gICAgICAgIGlmIChob3VycyA9PT0gbWluSG91ciAmJiBtaW51dGVzIDwgbWluTWludXRlcykge1xuICAgICAgICAgICAgbWludXRlcyA9IG1pbk1pbnV0ZXM7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGhvdXJzID09PSBtaW5Ib3VyICYmIG1pbnV0ZXMgPT09IG1pbk1pbnV0ZXMgJiYgc2Vjb25kcyA8IG1pblNlY29uZHMpXG4gICAgICAgICAgICBzZWNvbmRzID0gY29uZmlnLm1pbkRhdGUuZ2V0U2Vjb25kcygpO1xuICAgIH1cbiAgICBpZiAoY29uZmlnLm1heERhdGUgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICB2YXIgbWF4SHIgPSBjb25maWcubWF4RGF0ZS5nZXRIb3VycygpO1xuICAgICAgICB2YXIgbWF4TWludXRlcyA9IGNvbmZpZy5tYXhEYXRlLmdldE1pbnV0ZXMoKTtcbiAgICAgICAgaG91cnMgPSBNYXRoLm1pbihob3VycywgbWF4SHIpO1xuICAgICAgICBpZiAoaG91cnMgPT09IG1heEhyKVxuICAgICAgICAgICAgbWludXRlcyA9IE1hdGgubWluKG1heE1pbnV0ZXMsIG1pbnV0ZXMpO1xuICAgICAgICBpZiAoaG91cnMgPT09IG1heEhyICYmIG1pbnV0ZXMgPT09IG1heE1pbnV0ZXMpXG4gICAgICAgICAgICBzZWNvbmRzID0gY29uZmlnLm1heERhdGUuZ2V0U2Vjb25kcygpO1xuICAgIH1cbiAgICByZXR1cm4geyBob3VyczogaG91cnMsIG1pbnV0ZXM6IG1pbnV0ZXMsIHNlY29uZHM6IHNlY29uZHMgfTtcbn1cbiIsICJcInVzZSBzdHJpY3RcIjtcbmlmICh0eXBlb2YgT2JqZWN0LmFzc2lnbiAhPT0gXCJmdW5jdGlvblwiKSB7XG4gICAgT2JqZWN0LmFzc2lnbiA9IGZ1bmN0aW9uICh0YXJnZXQpIHtcbiAgICAgICAgdmFyIGFyZ3MgPSBbXTtcbiAgICAgICAgZm9yICh2YXIgX2kgPSAxOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgIGFyZ3NbX2kgLSAxXSA9IGFyZ3VtZW50c1tfaV07XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCF0YXJnZXQpIHtcbiAgICAgICAgICAgIHRocm93IFR5cGVFcnJvcihcIkNhbm5vdCBjb252ZXJ0IHVuZGVmaW5lZCBvciBudWxsIHRvIG9iamVjdFwiKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgX2xvb3BfMSA9IGZ1bmN0aW9uIChzb3VyY2UpIHtcbiAgICAgICAgICAgIGlmIChzb3VyY2UpIHtcbiAgICAgICAgICAgICAgICBPYmplY3Qua2V5cyhzb3VyY2UpLmZvckVhY2goZnVuY3Rpb24gKGtleSkgeyByZXR1cm4gKHRhcmdldFtrZXldID0gc291cmNlW2tleV0pOyB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgZm9yICh2YXIgX2EgPSAwLCBhcmdzXzEgPSBhcmdzOyBfYSA8IGFyZ3NfMS5sZW5ndGg7IF9hKyspIHtcbiAgICAgICAgICAgIHZhciBzb3VyY2UgPSBhcmdzXzFbX2FdO1xuICAgICAgICAgICAgX2xvb3BfMShzb3VyY2UpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0YXJnZXQ7XG4gICAgfTtcbn1cbiIsICJ2YXIgX19hc3NpZ24gPSAodGhpcyAmJiB0aGlzLl9fYXNzaWduKSB8fCBmdW5jdGlvbiAoKSB7XG4gICAgX19hc3NpZ24gPSBPYmplY3QuYXNzaWduIHx8IGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgZm9yICh2YXIgcywgaSA9IDEsIG4gPSBhcmd1bWVudHMubGVuZ3RoOyBpIDwgbjsgaSsrKSB7XG4gICAgICAgICAgICBzID0gYXJndW1lbnRzW2ldO1xuICAgICAgICAgICAgZm9yICh2YXIgcCBpbiBzKSBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHMsIHApKVxuICAgICAgICAgICAgICAgIHRbcF0gPSBzW3BdO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0O1xuICAgIH07XG4gICAgcmV0dXJuIF9fYXNzaWduLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG59O1xudmFyIF9fc3ByZWFkQXJyYXlzID0gKHRoaXMgJiYgdGhpcy5fX3NwcmVhZEFycmF5cykgfHwgZnVuY3Rpb24gKCkge1xuICAgIGZvciAodmFyIHMgPSAwLCBpID0gMCwgaWwgPSBhcmd1bWVudHMubGVuZ3RoOyBpIDwgaWw7IGkrKykgcyArPSBhcmd1bWVudHNbaV0ubGVuZ3RoO1xuICAgIGZvciAodmFyIHIgPSBBcnJheShzKSwgayA9IDAsIGkgPSAwOyBpIDwgaWw7IGkrKylcbiAgICAgICAgZm9yICh2YXIgYSA9IGFyZ3VtZW50c1tpXSwgaiA9IDAsIGpsID0gYS5sZW5ndGg7IGogPCBqbDsgaisrLCBrKyspXG4gICAgICAgICAgICByW2tdID0gYVtqXTtcbiAgICByZXR1cm4gcjtcbn07XG5pbXBvcnQgeyBkZWZhdWx0cyBhcyBkZWZhdWx0T3B0aW9ucywgSE9PS1MsIH0gZnJvbSBcIi4vdHlwZXMvb3B0aW9uc1wiO1xuaW1wb3J0IEVuZ2xpc2ggZnJvbSBcIi4vbDEwbi9kZWZhdWx0XCI7XG5pbXBvcnQgeyBhcnJheWlmeSwgZGVib3VuY2UsIGludCwgcGFkIH0gZnJvbSBcIi4vdXRpbHNcIjtcbmltcG9ydCB7IGNsZWFyTm9kZSwgY3JlYXRlRWxlbWVudCwgY3JlYXRlTnVtYmVySW5wdXQsIGZpbmRQYXJlbnQsIHRvZ2dsZUNsYXNzLCBnZXRFdmVudFRhcmdldCwgfSBmcm9tIFwiLi91dGlscy9kb21cIjtcbmltcG9ydCB7IGNvbXBhcmVEYXRlcywgY3JlYXRlRGF0ZVBhcnNlciwgY3JlYXRlRGF0ZUZvcm1hdHRlciwgZHVyYXRpb24sIGlzQmV0d2VlbiwgZ2V0RGVmYXVsdEhvdXJzLCBjYWxjdWxhdGVTZWNvbmRzU2luY2VNaWRuaWdodCwgcGFyc2VTZWNvbmRzLCB9IGZyb20gXCIuL3V0aWxzL2RhdGVzXCI7XG5pbXBvcnQgeyB0b2tlblJlZ2V4LCBtb250aFRvU3RyIH0gZnJvbSBcIi4vdXRpbHMvZm9ybWF0dGluZ1wiO1xuaW1wb3J0IFwiLi91dGlscy9wb2x5ZmlsbHNcIjtcbnZhciBERUJPVU5DRURfQ0hBTkdFX01TID0gMzAwO1xuZnVuY3Rpb24gRmxhdHBpY2tySW5zdGFuY2UoZWxlbWVudCwgaW5zdGFuY2VDb25maWcpIHtcbiAgICB2YXIgc2VsZiA9IHtcbiAgICAgICAgY29uZmlnOiBfX2Fzc2lnbihfX2Fzc2lnbih7fSwgZGVmYXVsdE9wdGlvbnMpLCBmbGF0cGlja3IuZGVmYXVsdENvbmZpZyksXG4gICAgICAgIGwxMG46IEVuZ2xpc2gsXG4gICAgfTtcbiAgICBzZWxmLnBhcnNlRGF0ZSA9IGNyZWF0ZURhdGVQYXJzZXIoeyBjb25maWc6IHNlbGYuY29uZmlnLCBsMTBuOiBzZWxmLmwxMG4gfSk7XG4gICAgc2VsZi5faGFuZGxlcnMgPSBbXTtcbiAgICBzZWxmLnBsdWdpbkVsZW1lbnRzID0gW107XG4gICAgc2VsZi5sb2FkZWRQbHVnaW5zID0gW107XG4gICAgc2VsZi5fYmluZCA9IGJpbmQ7XG4gICAgc2VsZi5fc2V0SG91cnNGcm9tRGF0ZSA9IHNldEhvdXJzRnJvbURhdGU7XG4gICAgc2VsZi5fcG9zaXRpb25DYWxlbmRhciA9IHBvc2l0aW9uQ2FsZW5kYXI7XG4gICAgc2VsZi5jaGFuZ2VNb250aCA9IGNoYW5nZU1vbnRoO1xuICAgIHNlbGYuY2hhbmdlWWVhciA9IGNoYW5nZVllYXI7XG4gICAgc2VsZi5jbGVhciA9IGNsZWFyO1xuICAgIHNlbGYuY2xvc2UgPSBjbG9zZTtcbiAgICBzZWxmLm9uTW91c2VPdmVyID0gb25Nb3VzZU92ZXI7XG4gICAgc2VsZi5fY3JlYXRlRWxlbWVudCA9IGNyZWF0ZUVsZW1lbnQ7XG4gICAgc2VsZi5jcmVhdGVEYXkgPSBjcmVhdGVEYXk7XG4gICAgc2VsZi5kZXN0cm95ID0gZGVzdHJveTtcbiAgICBzZWxmLmlzRW5hYmxlZCA9IGlzRW5hYmxlZDtcbiAgICBzZWxmLmp1bXBUb0RhdGUgPSBqdW1wVG9EYXRlO1xuICAgIHNlbGYudXBkYXRlVmFsdWUgPSB1cGRhdGVWYWx1ZTtcbiAgICBzZWxmLm9wZW4gPSBvcGVuO1xuICAgIHNlbGYucmVkcmF3ID0gcmVkcmF3O1xuICAgIHNlbGYuc2V0ID0gc2V0O1xuICAgIHNlbGYuc2V0RGF0ZSA9IHNldERhdGU7XG4gICAgc2VsZi50b2dnbGUgPSB0b2dnbGU7XG4gICAgZnVuY3Rpb24gc2V0dXBIZWxwZXJGdW5jdGlvbnMoKSB7XG4gICAgICAgIHNlbGYudXRpbHMgPSB7XG4gICAgICAgICAgICBnZXREYXlzSW5Nb250aDogZnVuY3Rpb24gKG1vbnRoLCB5cikge1xuICAgICAgICAgICAgICAgIGlmIChtb250aCA9PT0gdm9pZCAwKSB7IG1vbnRoID0gc2VsZi5jdXJyZW50TW9udGg7IH1cbiAgICAgICAgICAgICAgICBpZiAoeXIgPT09IHZvaWQgMCkgeyB5ciA9IHNlbGYuY3VycmVudFllYXI7IH1cbiAgICAgICAgICAgICAgICBpZiAobW9udGggPT09IDEgJiYgKCh5ciAlIDQgPT09IDAgJiYgeXIgJSAxMDAgIT09IDApIHx8IHlyICUgNDAwID09PSAwKSlcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDI5O1xuICAgICAgICAgICAgICAgIHJldHVybiBzZWxmLmwxMG4uZGF5c0luTW9udGhbbW9udGhdO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgfTtcbiAgICB9XG4gICAgZnVuY3Rpb24gaW5pdCgpIHtcbiAgICAgICAgc2VsZi5lbGVtZW50ID0gc2VsZi5pbnB1dCA9IGVsZW1lbnQ7XG4gICAgICAgIHNlbGYuaXNPcGVuID0gZmFsc2U7XG4gICAgICAgIHBhcnNlQ29uZmlnKCk7XG4gICAgICAgIHNldHVwTG9jYWxlKCk7XG4gICAgICAgIHNldHVwSW5wdXRzKCk7XG4gICAgICAgIHNldHVwRGF0ZXMoKTtcbiAgICAgICAgc2V0dXBIZWxwZXJGdW5jdGlvbnMoKTtcbiAgICAgICAgaWYgKCFzZWxmLmlzTW9iaWxlKVxuICAgICAgICAgICAgYnVpbGQoKTtcbiAgICAgICAgYmluZEV2ZW50cygpO1xuICAgICAgICBpZiAoc2VsZi5zZWxlY3RlZERhdGVzLmxlbmd0aCB8fCBzZWxmLmNvbmZpZy5ub0NhbGVuZGFyKSB7XG4gICAgICAgICAgICBpZiAoc2VsZi5jb25maWcuZW5hYmxlVGltZSkge1xuICAgICAgICAgICAgICAgIHNldEhvdXJzRnJvbURhdGUoc2VsZi5jb25maWcubm9DYWxlbmRhciA/IHNlbGYubGF0ZXN0U2VsZWN0ZWREYXRlT2JqIDogdW5kZWZpbmVkKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHVwZGF0ZVZhbHVlKGZhbHNlKTtcbiAgICAgICAgfVxuICAgICAgICBzZXRDYWxlbmRhcldpZHRoKCk7XG4gICAgICAgIHZhciBpc1NhZmFyaSA9IC9eKCg/IWNocm9tZXxhbmRyb2lkKS4pKnNhZmFyaS9pLnRlc3QobmF2aWdhdG9yLnVzZXJBZ2VudCk7XG4gICAgICAgIGlmICghc2VsZi5pc01vYmlsZSAmJiBpc1NhZmFyaSkge1xuICAgICAgICAgICAgcG9zaXRpb25DYWxlbmRhcigpO1xuICAgICAgICB9XG4gICAgICAgIHRyaWdnZXJFdmVudChcIm9uUmVhZHlcIik7XG4gICAgfVxuICAgIGZ1bmN0aW9uIGdldENsb3Nlc3RBY3RpdmVFbGVtZW50KCkge1xuICAgICAgICB2YXIgX2E7XG4gICAgICAgIHJldHVybiAoKChfYSA9IHNlbGYuY2FsZW5kYXJDb250YWluZXIpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5nZXRSb290Tm9kZSgpKVxuICAgICAgICAgICAgLmFjdGl2ZUVsZW1lbnQgfHwgZG9jdW1lbnQuYWN0aXZlRWxlbWVudCk7XG4gICAgfVxuICAgIGZ1bmN0aW9uIGJpbmRUb0luc3RhbmNlKGZuKSB7XG4gICAgICAgIHJldHVybiBmbi5iaW5kKHNlbGYpO1xuICAgIH1cbiAgICBmdW5jdGlvbiBzZXRDYWxlbmRhcldpZHRoKCkge1xuICAgICAgICB2YXIgY29uZmlnID0gc2VsZi5jb25maWc7XG4gICAgICAgIGlmIChjb25maWcud2Vla051bWJlcnMgPT09IGZhbHNlICYmIGNvbmZpZy5zaG93TW9udGhzID09PSAxKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoY29uZmlnLm5vQ2FsZW5kYXIgIT09IHRydWUpIHtcbiAgICAgICAgICAgIHdpbmRvdy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGlmIChzZWxmLmNhbGVuZGFyQ29udGFpbmVyICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5jYWxlbmRhckNvbnRhaW5lci5zdHlsZS52aXNpYmlsaXR5ID0gXCJoaWRkZW5cIjtcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5jYWxlbmRhckNvbnRhaW5lci5zdHlsZS5kaXNwbGF5ID0gXCJibG9ja1wiO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoc2VsZi5kYXlzQ29udGFpbmVyICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGRheXNXaWR0aCA9IChzZWxmLmRheXMub2Zmc2V0V2lkdGggKyAxKSAqIGNvbmZpZy5zaG93TW9udGhzO1xuICAgICAgICAgICAgICAgICAgICBzZWxmLmRheXNDb250YWluZXIuc3R5bGUud2lkdGggPSBkYXlzV2lkdGggKyBcInB4XCI7XG4gICAgICAgICAgICAgICAgICAgIHNlbGYuY2FsZW5kYXJDb250YWluZXIuc3R5bGUud2lkdGggPVxuICAgICAgICAgICAgICAgICAgICAgICAgZGF5c1dpZHRoICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAoc2VsZi53ZWVrV3JhcHBlciAhPT0gdW5kZWZpbmVkXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gc2VsZi53ZWVrV3JhcHBlci5vZmZzZXRXaWR0aFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IDApICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInB4XCI7XG4gICAgICAgICAgICAgICAgICAgIHNlbGYuY2FsZW5kYXJDb250YWluZXIuc3R5bGUucmVtb3ZlUHJvcGVydHkoXCJ2aXNpYmlsaXR5XCIpO1xuICAgICAgICAgICAgICAgICAgICBzZWxmLmNhbGVuZGFyQ29udGFpbmVyLnN0eWxlLnJlbW92ZVByb3BlcnR5KFwiZGlzcGxheVwiKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBmdW5jdGlvbiB1cGRhdGVUaW1lKGUpIHtcbiAgICAgICAgaWYgKHNlbGYuc2VsZWN0ZWREYXRlcy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgIHZhciBkZWZhdWx0RGF0ZSA9IHNlbGYuY29uZmlnLm1pbkRhdGUgPT09IHVuZGVmaW5lZCB8fFxuICAgICAgICAgICAgICAgIGNvbXBhcmVEYXRlcyhuZXcgRGF0ZSgpLCBzZWxmLmNvbmZpZy5taW5EYXRlKSA+PSAwXG4gICAgICAgICAgICAgICAgPyBuZXcgRGF0ZSgpXG4gICAgICAgICAgICAgICAgOiBuZXcgRGF0ZShzZWxmLmNvbmZpZy5taW5EYXRlLmdldFRpbWUoKSk7XG4gICAgICAgICAgICB2YXIgZGVmYXVsdHMgPSBnZXREZWZhdWx0SG91cnMoc2VsZi5jb25maWcpO1xuICAgICAgICAgICAgZGVmYXVsdERhdGUuc2V0SG91cnMoZGVmYXVsdHMuaG91cnMsIGRlZmF1bHRzLm1pbnV0ZXMsIGRlZmF1bHRzLnNlY29uZHMsIGRlZmF1bHREYXRlLmdldE1pbGxpc2Vjb25kcygpKTtcbiAgICAgICAgICAgIHNlbGYuc2VsZWN0ZWREYXRlcyA9IFtkZWZhdWx0RGF0ZV07XG4gICAgICAgICAgICBzZWxmLmxhdGVzdFNlbGVjdGVkRGF0ZU9iaiA9IGRlZmF1bHREYXRlO1xuICAgICAgICB9XG4gICAgICAgIGlmIChlICE9PSB1bmRlZmluZWQgJiYgZS50eXBlICE9PSBcImJsdXJcIikge1xuICAgICAgICAgICAgdGltZVdyYXBwZXIoZSk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHByZXZWYWx1ZSA9IHNlbGYuX2lucHV0LnZhbHVlO1xuICAgICAgICBzZXRIb3Vyc0Zyb21JbnB1dHMoKTtcbiAgICAgICAgdXBkYXRlVmFsdWUoKTtcbiAgICAgICAgaWYgKHNlbGYuX2lucHV0LnZhbHVlICE9PSBwcmV2VmFsdWUpIHtcbiAgICAgICAgICAgIHNlbGYuX2RlYm91bmNlZENoYW5nZSgpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGZ1bmN0aW9uIGFtcG0ybWlsaXRhcnkoaG91ciwgYW1QTSkge1xuICAgICAgICByZXR1cm4gKGhvdXIgJSAxMikgKyAxMiAqIGludChhbVBNID09PSBzZWxmLmwxMG4uYW1QTVsxXSk7XG4gICAgfVxuICAgIGZ1bmN0aW9uIG1pbGl0YXJ5MmFtcG0oaG91cikge1xuICAgICAgICBzd2l0Y2ggKGhvdXIgJSAyNCkge1xuICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgY2FzZSAxMjpcbiAgICAgICAgICAgICAgICByZXR1cm4gMTI7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiBob3VyICUgMTI7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZnVuY3Rpb24gc2V0SG91cnNGcm9tSW5wdXRzKCkge1xuICAgICAgICBpZiAoc2VsZi5ob3VyRWxlbWVudCA9PT0gdW5kZWZpbmVkIHx8IHNlbGYubWludXRlRWxlbWVudCA9PT0gdW5kZWZpbmVkKVxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB2YXIgaG91cnMgPSAocGFyc2VJbnQoc2VsZi5ob3VyRWxlbWVudC52YWx1ZS5zbGljZSgtMiksIDEwKSB8fCAwKSAlIDI0LCBtaW51dGVzID0gKHBhcnNlSW50KHNlbGYubWludXRlRWxlbWVudC52YWx1ZSwgMTApIHx8IDApICUgNjAsIHNlY29uZHMgPSBzZWxmLnNlY29uZEVsZW1lbnQgIT09IHVuZGVmaW5lZFxuICAgICAgICAgICAgPyAocGFyc2VJbnQoc2VsZi5zZWNvbmRFbGVtZW50LnZhbHVlLCAxMCkgfHwgMCkgJSA2MFxuICAgICAgICAgICAgOiAwO1xuICAgICAgICBpZiAoc2VsZi5hbVBNICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIGhvdXJzID0gYW1wbTJtaWxpdGFyeShob3Vycywgc2VsZi5hbVBNLnRleHRDb250ZW50KTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgbGltaXRNaW5Ib3VycyA9IHNlbGYuY29uZmlnLm1pblRpbWUgIT09IHVuZGVmaW5lZCB8fFxuICAgICAgICAgICAgKHNlbGYuY29uZmlnLm1pbkRhdGUgJiZcbiAgICAgICAgICAgICAgICBzZWxmLm1pbkRhdGVIYXNUaW1lICYmXG4gICAgICAgICAgICAgICAgc2VsZi5sYXRlc3RTZWxlY3RlZERhdGVPYmogJiZcbiAgICAgICAgICAgICAgICBjb21wYXJlRGF0ZXMoc2VsZi5sYXRlc3RTZWxlY3RlZERhdGVPYmosIHNlbGYuY29uZmlnLm1pbkRhdGUsIHRydWUpID09PVxuICAgICAgICAgICAgICAgICAgICAwKTtcbiAgICAgICAgdmFyIGxpbWl0TWF4SG91cnMgPSBzZWxmLmNvbmZpZy5tYXhUaW1lICE9PSB1bmRlZmluZWQgfHxcbiAgICAgICAgICAgIChzZWxmLmNvbmZpZy5tYXhEYXRlICYmXG4gICAgICAgICAgICAgICAgc2VsZi5tYXhEYXRlSGFzVGltZSAmJlxuICAgICAgICAgICAgICAgIHNlbGYubGF0ZXN0U2VsZWN0ZWREYXRlT2JqICYmXG4gICAgICAgICAgICAgICAgY29tcGFyZURhdGVzKHNlbGYubGF0ZXN0U2VsZWN0ZWREYXRlT2JqLCBzZWxmLmNvbmZpZy5tYXhEYXRlLCB0cnVlKSA9PT1cbiAgICAgICAgICAgICAgICAgICAgMCk7XG4gICAgICAgIGlmIChzZWxmLmNvbmZpZy5tYXhUaW1lICE9PSB1bmRlZmluZWQgJiZcbiAgICAgICAgICAgIHNlbGYuY29uZmlnLm1pblRpbWUgIT09IHVuZGVmaW5lZCAmJlxuICAgICAgICAgICAgc2VsZi5jb25maWcubWluVGltZSA+IHNlbGYuY29uZmlnLm1heFRpbWUpIHtcbiAgICAgICAgICAgIHZhciBtaW5Cb3VuZCA9IGNhbGN1bGF0ZVNlY29uZHNTaW5jZU1pZG5pZ2h0KHNlbGYuY29uZmlnLm1pblRpbWUuZ2V0SG91cnMoKSwgc2VsZi5jb25maWcubWluVGltZS5nZXRNaW51dGVzKCksIHNlbGYuY29uZmlnLm1pblRpbWUuZ2V0U2Vjb25kcygpKTtcbiAgICAgICAgICAgIHZhciBtYXhCb3VuZCA9IGNhbGN1bGF0ZVNlY29uZHNTaW5jZU1pZG5pZ2h0KHNlbGYuY29uZmlnLm1heFRpbWUuZ2V0SG91cnMoKSwgc2VsZi5jb25maWcubWF4VGltZS5nZXRNaW51dGVzKCksIHNlbGYuY29uZmlnLm1heFRpbWUuZ2V0U2Vjb25kcygpKTtcbiAgICAgICAgICAgIHZhciBjdXJyZW50VGltZSA9IGNhbGN1bGF0ZVNlY29uZHNTaW5jZU1pZG5pZ2h0KGhvdXJzLCBtaW51dGVzLCBzZWNvbmRzKTtcbiAgICAgICAgICAgIGlmIChjdXJyZW50VGltZSA+IG1heEJvdW5kICYmIGN1cnJlbnRUaW1lIDwgbWluQm91bmQpIHtcbiAgICAgICAgICAgICAgICB2YXIgcmVzdWx0ID0gcGFyc2VTZWNvbmRzKG1pbkJvdW5kKTtcbiAgICAgICAgICAgICAgICBob3VycyA9IHJlc3VsdFswXTtcbiAgICAgICAgICAgICAgICBtaW51dGVzID0gcmVzdWx0WzFdO1xuICAgICAgICAgICAgICAgIHNlY29uZHMgPSByZXN1bHRbMl07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBpZiAobGltaXRNYXhIb3Vycykge1xuICAgICAgICAgICAgICAgIHZhciBtYXhUaW1lID0gc2VsZi5jb25maWcubWF4VGltZSAhPT0gdW5kZWZpbmVkXG4gICAgICAgICAgICAgICAgICAgID8gc2VsZi5jb25maWcubWF4VGltZVxuICAgICAgICAgICAgICAgICAgICA6IHNlbGYuY29uZmlnLm1heERhdGU7XG4gICAgICAgICAgICAgICAgaG91cnMgPSBNYXRoLm1pbihob3VycywgbWF4VGltZS5nZXRIb3VycygpKTtcbiAgICAgICAgICAgICAgICBpZiAoaG91cnMgPT09IG1heFRpbWUuZ2V0SG91cnMoKSlcbiAgICAgICAgICAgICAgICAgICAgbWludXRlcyA9IE1hdGgubWluKG1pbnV0ZXMsIG1heFRpbWUuZ2V0TWludXRlcygpKTtcbiAgICAgICAgICAgICAgICBpZiAobWludXRlcyA9PT0gbWF4VGltZS5nZXRNaW51dGVzKCkpXG4gICAgICAgICAgICAgICAgICAgIHNlY29uZHMgPSBNYXRoLm1pbihzZWNvbmRzLCBtYXhUaW1lLmdldFNlY29uZHMoKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAobGltaXRNaW5Ib3Vycykge1xuICAgICAgICAgICAgICAgIHZhciBtaW5UaW1lID0gc2VsZi5jb25maWcubWluVGltZSAhPT0gdW5kZWZpbmVkXG4gICAgICAgICAgICAgICAgICAgID8gc2VsZi5jb25maWcubWluVGltZVxuICAgICAgICAgICAgICAgICAgICA6IHNlbGYuY29uZmlnLm1pbkRhdGU7XG4gICAgICAgICAgICAgICAgaG91cnMgPSBNYXRoLm1heChob3VycywgbWluVGltZS5nZXRIb3VycygpKTtcbiAgICAgICAgICAgICAgICBpZiAoaG91cnMgPT09IG1pblRpbWUuZ2V0SG91cnMoKSAmJiBtaW51dGVzIDwgbWluVGltZS5nZXRNaW51dGVzKCkpXG4gICAgICAgICAgICAgICAgICAgIG1pbnV0ZXMgPSBtaW5UaW1lLmdldE1pbnV0ZXMoKTtcbiAgICAgICAgICAgICAgICBpZiAobWludXRlcyA9PT0gbWluVGltZS5nZXRNaW51dGVzKCkpXG4gICAgICAgICAgICAgICAgICAgIHNlY29uZHMgPSBNYXRoLm1heChzZWNvbmRzLCBtaW5UaW1lLmdldFNlY29uZHMoKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgc2V0SG91cnMoaG91cnMsIG1pbnV0ZXMsIHNlY29uZHMpO1xuICAgIH1cbiAgICBmdW5jdGlvbiBzZXRIb3Vyc0Zyb21EYXRlKGRhdGVPYmopIHtcbiAgICAgICAgdmFyIGRhdGUgPSBkYXRlT2JqIHx8IHNlbGYubGF0ZXN0U2VsZWN0ZWREYXRlT2JqO1xuICAgICAgICBpZiAoZGF0ZSAmJiBkYXRlIGluc3RhbmNlb2YgRGF0ZSkge1xuICAgICAgICAgICAgc2V0SG91cnMoZGF0ZS5nZXRIb3VycygpLCBkYXRlLmdldE1pbnV0ZXMoKSwgZGF0ZS5nZXRTZWNvbmRzKCkpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGZ1bmN0aW9uIHNldEhvdXJzKGhvdXJzLCBtaW51dGVzLCBzZWNvbmRzKSB7XG4gICAgICAgIGlmIChzZWxmLmxhdGVzdFNlbGVjdGVkRGF0ZU9iaiAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBzZWxmLmxhdGVzdFNlbGVjdGVkRGF0ZU9iai5zZXRIb3Vycyhob3VycyAlIDI0LCBtaW51dGVzLCBzZWNvbmRzIHx8IDAsIDApO1xuICAgICAgICB9XG4gICAgICAgIGlmICghc2VsZi5ob3VyRWxlbWVudCB8fCAhc2VsZi5taW51dGVFbGVtZW50IHx8IHNlbGYuaXNNb2JpbGUpXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIHNlbGYuaG91ckVsZW1lbnQudmFsdWUgPSBwYWQoIXNlbGYuY29uZmlnLnRpbWVfMjRoclxuICAgICAgICAgICAgPyAoKDEyICsgaG91cnMpICUgMTIpICsgMTIgKiBpbnQoaG91cnMgJSAxMiA9PT0gMClcbiAgICAgICAgICAgIDogaG91cnMpO1xuICAgICAgICBzZWxmLm1pbnV0ZUVsZW1lbnQudmFsdWUgPSBwYWQobWludXRlcyk7XG4gICAgICAgIGlmIChzZWxmLmFtUE0gIT09IHVuZGVmaW5lZClcbiAgICAgICAgICAgIHNlbGYuYW1QTS50ZXh0Q29udGVudCA9IHNlbGYubDEwbi5hbVBNW2ludChob3VycyA+PSAxMildO1xuICAgICAgICBpZiAoc2VsZi5zZWNvbmRFbGVtZW50ICE9PSB1bmRlZmluZWQpXG4gICAgICAgICAgICBzZWxmLnNlY29uZEVsZW1lbnQudmFsdWUgPSBwYWQoc2Vjb25kcyk7XG4gICAgfVxuICAgIGZ1bmN0aW9uIG9uWWVhcklucHV0KGV2ZW50KSB7XG4gICAgICAgIHZhciBldmVudFRhcmdldCA9IGdldEV2ZW50VGFyZ2V0KGV2ZW50KTtcbiAgICAgICAgdmFyIHllYXIgPSBwYXJzZUludChldmVudFRhcmdldC52YWx1ZSkgKyAoZXZlbnQuZGVsdGEgfHwgMCk7XG4gICAgICAgIGlmICh5ZWFyIC8gMTAwMCA+IDEgfHxcbiAgICAgICAgICAgIChldmVudC5rZXkgPT09IFwiRW50ZXJcIiAmJiAhL1teXFxkXS8udGVzdCh5ZWFyLnRvU3RyaW5nKCkpKSkge1xuICAgICAgICAgICAgY2hhbmdlWWVhcih5ZWFyKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBmdW5jdGlvbiBiaW5kKGVsZW1lbnQsIGV2ZW50LCBoYW5kbGVyLCBvcHRpb25zKSB7XG4gICAgICAgIGlmIChldmVudCBpbnN0YW5jZW9mIEFycmF5KVxuICAgICAgICAgICAgcmV0dXJuIGV2ZW50LmZvckVhY2goZnVuY3Rpb24gKGV2KSB7IHJldHVybiBiaW5kKGVsZW1lbnQsIGV2LCBoYW5kbGVyLCBvcHRpb25zKTsgfSk7XG4gICAgICAgIGlmIChlbGVtZW50IGluc3RhbmNlb2YgQXJyYXkpXG4gICAgICAgICAgICByZXR1cm4gZWxlbWVudC5mb3JFYWNoKGZ1bmN0aW9uIChlbCkgeyByZXR1cm4gYmluZChlbCwgZXZlbnQsIGhhbmRsZXIsIG9wdGlvbnMpOyB9KTtcbiAgICAgICAgZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKGV2ZW50LCBoYW5kbGVyLCBvcHRpb25zKTtcbiAgICAgICAgc2VsZi5faGFuZGxlcnMucHVzaCh7XG4gICAgICAgICAgICByZW1vdmU6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIGVsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihldmVudCwgaGFuZGxlciwgb3B0aW9ucyk7IH0sXG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBmdW5jdGlvbiB0cmlnZ2VyQ2hhbmdlKCkge1xuICAgICAgICB0cmlnZ2VyRXZlbnQoXCJvbkNoYW5nZVwiKTtcbiAgICB9XG4gICAgZnVuY3Rpb24gYmluZEV2ZW50cygpIHtcbiAgICAgICAgaWYgKHNlbGYuY29uZmlnLndyYXApIHtcbiAgICAgICAgICAgIFtcIm9wZW5cIiwgXCJjbG9zZVwiLCBcInRvZ2dsZVwiLCBcImNsZWFyXCJdLmZvckVhY2goZnVuY3Rpb24gKGV2dCkge1xuICAgICAgICAgICAgICAgIEFycmF5LnByb3RvdHlwZS5mb3JFYWNoLmNhbGwoc2VsZi5lbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCJbZGF0YS1cIiArIGV2dCArIFwiXVwiKSwgZnVuY3Rpb24gKGVsKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBiaW5kKGVsLCBcImNsaWNrXCIsIHNlbGZbZXZ0XSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoc2VsZi5pc01vYmlsZSkge1xuICAgICAgICAgICAgc2V0dXBNb2JpbGUoKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgZGVib3VuY2VkUmVzaXplID0gZGVib3VuY2Uob25SZXNpemUsIDUwKTtcbiAgICAgICAgc2VsZi5fZGVib3VuY2VkQ2hhbmdlID0gZGVib3VuY2UodHJpZ2dlckNoYW5nZSwgREVCT1VOQ0VEX0NIQU5HRV9NUyk7XG4gICAgICAgIGlmIChzZWxmLmRheXNDb250YWluZXIgJiYgIS9pUGhvbmV8aVBhZHxpUG9kL2kudGVzdChuYXZpZ2F0b3IudXNlckFnZW50KSlcbiAgICAgICAgICAgIGJpbmQoc2VsZi5kYXlzQ29udGFpbmVyLCBcIm1vdXNlb3ZlclwiLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgICAgIGlmIChzZWxmLmNvbmZpZy5tb2RlID09PSBcInJhbmdlXCIpXG4gICAgICAgICAgICAgICAgICAgIG9uTW91c2VPdmVyKGdldEV2ZW50VGFyZ2V0KGUpKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICBiaW5kKHNlbGYuX2lucHV0LCBcImtleWRvd25cIiwgb25LZXlEb3duKTtcbiAgICAgICAgaWYgKHNlbGYuY2FsZW5kYXJDb250YWluZXIgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgYmluZChzZWxmLmNhbGVuZGFyQ29udGFpbmVyLCBcImtleWRvd25cIiwgb25LZXlEb3duKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIXNlbGYuY29uZmlnLmlubGluZSAmJiAhc2VsZi5jb25maWcuc3RhdGljKVxuICAgICAgICAgICAgYmluZCh3aW5kb3csIFwicmVzaXplXCIsIGRlYm91bmNlZFJlc2l6ZSk7XG4gICAgICAgIGlmICh3aW5kb3cub250b3VjaHN0YXJ0ICE9PSB1bmRlZmluZWQpXG4gICAgICAgICAgICBiaW5kKHdpbmRvdy5kb2N1bWVudCwgXCJ0b3VjaHN0YXJ0XCIsIGRvY3VtZW50Q2xpY2spO1xuICAgICAgICBlbHNlXG4gICAgICAgICAgICBiaW5kKHdpbmRvdy5kb2N1bWVudCwgXCJtb3VzZWRvd25cIiwgZG9jdW1lbnRDbGljayk7XG4gICAgICAgIGJpbmQod2luZG93LmRvY3VtZW50LCBcImZvY3VzXCIsIGRvY3VtZW50Q2xpY2ssIHsgY2FwdHVyZTogdHJ1ZSB9KTtcbiAgICAgICAgaWYgKHNlbGYuY29uZmlnLmNsaWNrT3BlbnMgPT09IHRydWUpIHtcbiAgICAgICAgICAgIGJpbmQoc2VsZi5faW5wdXQsIFwiZm9jdXNcIiwgc2VsZi5vcGVuKTtcbiAgICAgICAgICAgIGJpbmQoc2VsZi5faW5wdXQsIFwiY2xpY2tcIiwgc2VsZi5vcGVuKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoc2VsZi5kYXlzQ29udGFpbmVyICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIGJpbmQoc2VsZi5tb250aE5hdiwgXCJjbGlja1wiLCBvbk1vbnRoTmF2Q2xpY2spO1xuICAgICAgICAgICAgYmluZChzZWxmLm1vbnRoTmF2LCBbXCJrZXl1cFwiLCBcImluY3JlbWVudFwiXSwgb25ZZWFySW5wdXQpO1xuICAgICAgICAgICAgYmluZChzZWxmLmRheXNDb250YWluZXIsIFwiY2xpY2tcIiwgc2VsZWN0RGF0ZSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHNlbGYudGltZUNvbnRhaW5lciAhPT0gdW5kZWZpbmVkICYmXG4gICAgICAgICAgICBzZWxmLm1pbnV0ZUVsZW1lbnQgIT09IHVuZGVmaW5lZCAmJlxuICAgICAgICAgICAgc2VsZi5ob3VyRWxlbWVudCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICB2YXIgc2VsVGV4dCA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGdldEV2ZW50VGFyZ2V0KGUpLnNlbGVjdCgpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGJpbmQoc2VsZi50aW1lQ29udGFpbmVyLCBbXCJpbmNyZW1lbnRcIl0sIHVwZGF0ZVRpbWUpO1xuICAgICAgICAgICAgYmluZChzZWxmLnRpbWVDb250YWluZXIsIFwiYmx1clwiLCB1cGRhdGVUaW1lLCB7IGNhcHR1cmU6IHRydWUgfSk7XG4gICAgICAgICAgICBiaW5kKHNlbGYudGltZUNvbnRhaW5lciwgXCJjbGlja1wiLCB0aW1lSW5jcmVtZW50KTtcbiAgICAgICAgICAgIGJpbmQoW3NlbGYuaG91ckVsZW1lbnQsIHNlbGYubWludXRlRWxlbWVudF0sIFtcImZvY3VzXCIsIFwiY2xpY2tcIl0sIHNlbFRleHQpO1xuICAgICAgICAgICAgaWYgKHNlbGYuc2Vjb25kRWxlbWVudCAhPT0gdW5kZWZpbmVkKVxuICAgICAgICAgICAgICAgIGJpbmQoc2VsZi5zZWNvbmRFbGVtZW50LCBcImZvY3VzXCIsIGZ1bmN0aW9uICgpIHsgcmV0dXJuIHNlbGYuc2Vjb25kRWxlbWVudCAmJiBzZWxmLnNlY29uZEVsZW1lbnQuc2VsZWN0KCk7IH0pO1xuICAgICAgICAgICAgaWYgKHNlbGYuYW1QTSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgYmluZChzZWxmLmFtUE0sIFwiY2xpY2tcIiwgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgICAgICAgICAgdXBkYXRlVGltZShlKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoc2VsZi5jb25maWcuYWxsb3dJbnB1dCkge1xuICAgICAgICAgICAgYmluZChzZWxmLl9pbnB1dCwgXCJibHVyXCIsIG9uQmx1cik7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZnVuY3Rpb24ganVtcFRvRGF0ZShqdW1wRGF0ZSwgdHJpZ2dlckNoYW5nZSkge1xuICAgICAgICB2YXIganVtcFRvID0ganVtcERhdGUgIT09IHVuZGVmaW5lZFxuICAgICAgICAgICAgPyBzZWxmLnBhcnNlRGF0ZShqdW1wRGF0ZSlcbiAgICAgICAgICAgIDogc2VsZi5sYXRlc3RTZWxlY3RlZERhdGVPYmogfHxcbiAgICAgICAgICAgICAgICAoc2VsZi5jb25maWcubWluRGF0ZSAmJiBzZWxmLmNvbmZpZy5taW5EYXRlID4gc2VsZi5ub3dcbiAgICAgICAgICAgICAgICAgICAgPyBzZWxmLmNvbmZpZy5taW5EYXRlXG4gICAgICAgICAgICAgICAgICAgIDogc2VsZi5jb25maWcubWF4RGF0ZSAmJiBzZWxmLmNvbmZpZy5tYXhEYXRlIDwgc2VsZi5ub3dcbiAgICAgICAgICAgICAgICAgICAgICAgID8gc2VsZi5jb25maWcubWF4RGF0ZVxuICAgICAgICAgICAgICAgICAgICAgICAgOiBzZWxmLm5vdyk7XG4gICAgICAgIHZhciBvbGRZZWFyID0gc2VsZi5jdXJyZW50WWVhcjtcbiAgICAgICAgdmFyIG9sZE1vbnRoID0gc2VsZi5jdXJyZW50TW9udGg7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBpZiAoanVtcFRvICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICBzZWxmLmN1cnJlbnRZZWFyID0ganVtcFRvLmdldEZ1bGxZZWFyKCk7XG4gICAgICAgICAgICAgICAgc2VsZi5jdXJyZW50TW9udGggPSBqdW1wVG8uZ2V0TW9udGgoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZSkge1xuICAgICAgICAgICAgZS5tZXNzYWdlID0gXCJJbnZhbGlkIGRhdGUgc3VwcGxpZWQ6IFwiICsganVtcFRvO1xuICAgICAgICAgICAgc2VsZi5jb25maWcuZXJyb3JIYW5kbGVyKGUpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0cmlnZ2VyQ2hhbmdlICYmIHNlbGYuY3VycmVudFllYXIgIT09IG9sZFllYXIpIHtcbiAgICAgICAgICAgIHRyaWdnZXJFdmVudChcIm9uWWVhckNoYW5nZVwiKTtcbiAgICAgICAgICAgIGJ1aWxkTW9udGhTd2l0Y2goKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodHJpZ2dlckNoYW5nZSAmJlxuICAgICAgICAgICAgKHNlbGYuY3VycmVudFllYXIgIT09IG9sZFllYXIgfHwgc2VsZi5jdXJyZW50TW9udGggIT09IG9sZE1vbnRoKSkge1xuICAgICAgICAgICAgdHJpZ2dlckV2ZW50KFwib25Nb250aENoYW5nZVwiKTtcbiAgICAgICAgfVxuICAgICAgICBzZWxmLnJlZHJhdygpO1xuICAgIH1cbiAgICBmdW5jdGlvbiB0aW1lSW5jcmVtZW50KGUpIHtcbiAgICAgICAgdmFyIGV2ZW50VGFyZ2V0ID0gZ2V0RXZlbnRUYXJnZXQoZSk7XG4gICAgICAgIGlmICh+ZXZlbnRUYXJnZXQuY2xhc3NOYW1lLmluZGV4T2YoXCJhcnJvd1wiKSlcbiAgICAgICAgICAgIGluY3JlbWVudE51bUlucHV0KGUsIGV2ZW50VGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcImFycm93VXBcIikgPyAxIDogLTEpO1xuICAgIH1cbiAgICBmdW5jdGlvbiBpbmNyZW1lbnROdW1JbnB1dChlLCBkZWx0YSwgaW5wdXRFbGVtKSB7XG4gICAgICAgIHZhciB0YXJnZXQgPSBlICYmIGdldEV2ZW50VGFyZ2V0KGUpO1xuICAgICAgICB2YXIgaW5wdXQgPSBpbnB1dEVsZW0gfHxcbiAgICAgICAgICAgICh0YXJnZXQgJiYgdGFyZ2V0LnBhcmVudE5vZGUgJiYgdGFyZ2V0LnBhcmVudE5vZGUuZmlyc3RDaGlsZCk7XG4gICAgICAgIHZhciBldmVudCA9IGNyZWF0ZUV2ZW50KFwiaW5jcmVtZW50XCIpO1xuICAgICAgICBldmVudC5kZWx0YSA9IGRlbHRhO1xuICAgICAgICBpbnB1dCAmJiBpbnB1dC5kaXNwYXRjaEV2ZW50KGV2ZW50KTtcbiAgICB9XG4gICAgZnVuY3Rpb24gYnVpbGQoKSB7XG4gICAgICAgIHZhciBmcmFnbWVudCA9IHdpbmRvdy5kb2N1bWVudC5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCk7XG4gICAgICAgIHNlbGYuY2FsZW5kYXJDb250YWluZXIgPSBjcmVhdGVFbGVtZW50KFwiZGl2XCIsIFwiZmxhdHBpY2tyLWNhbGVuZGFyXCIpO1xuICAgICAgICBzZWxmLmNhbGVuZGFyQ29udGFpbmVyLnRhYkluZGV4ID0gLTE7XG4gICAgICAgIGlmICghc2VsZi5jb25maWcubm9DYWxlbmRhcikge1xuICAgICAgICAgICAgZnJhZ21lbnQuYXBwZW5kQ2hpbGQoYnVpbGRNb250aE5hdigpKTtcbiAgICAgICAgICAgIHNlbGYuaW5uZXJDb250YWluZXIgPSBjcmVhdGVFbGVtZW50KFwiZGl2XCIsIFwiZmxhdHBpY2tyLWlubmVyQ29udGFpbmVyXCIpO1xuICAgICAgICAgICAgaWYgKHNlbGYuY29uZmlnLndlZWtOdW1iZXJzKSB7XG4gICAgICAgICAgICAgICAgdmFyIF9hID0gYnVpbGRXZWVrcygpLCB3ZWVrV3JhcHBlciA9IF9hLndlZWtXcmFwcGVyLCB3ZWVrTnVtYmVycyA9IF9hLndlZWtOdW1iZXJzO1xuICAgICAgICAgICAgICAgIHNlbGYuaW5uZXJDb250YWluZXIuYXBwZW5kQ2hpbGQod2Vla1dyYXBwZXIpO1xuICAgICAgICAgICAgICAgIHNlbGYud2Vla051bWJlcnMgPSB3ZWVrTnVtYmVycztcbiAgICAgICAgICAgICAgICBzZWxmLndlZWtXcmFwcGVyID0gd2Vla1dyYXBwZXI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBzZWxmLnJDb250YWluZXIgPSBjcmVhdGVFbGVtZW50KFwiZGl2XCIsIFwiZmxhdHBpY2tyLXJDb250YWluZXJcIik7XG4gICAgICAgICAgICBzZWxmLnJDb250YWluZXIuYXBwZW5kQ2hpbGQoYnVpbGRXZWVrZGF5cygpKTtcbiAgICAgICAgICAgIGlmICghc2VsZi5kYXlzQ29udGFpbmVyKSB7XG4gICAgICAgICAgICAgICAgc2VsZi5kYXlzQ29udGFpbmVyID0gY3JlYXRlRWxlbWVudChcImRpdlwiLCBcImZsYXRwaWNrci1kYXlzXCIpO1xuICAgICAgICAgICAgICAgIHNlbGYuZGF5c0NvbnRhaW5lci50YWJJbmRleCA9IC0xO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgYnVpbGREYXlzKCk7XG4gICAgICAgICAgICBzZWxmLnJDb250YWluZXIuYXBwZW5kQ2hpbGQoc2VsZi5kYXlzQ29udGFpbmVyKTtcbiAgICAgICAgICAgIHNlbGYuaW5uZXJDb250YWluZXIuYXBwZW5kQ2hpbGQoc2VsZi5yQ29udGFpbmVyKTtcbiAgICAgICAgICAgIGZyYWdtZW50LmFwcGVuZENoaWxkKHNlbGYuaW5uZXJDb250YWluZXIpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChzZWxmLmNvbmZpZy5lbmFibGVUaW1lKSB7XG4gICAgICAgICAgICBmcmFnbWVudC5hcHBlbmRDaGlsZChidWlsZFRpbWUoKSk7XG4gICAgICAgIH1cbiAgICAgICAgdG9nZ2xlQ2xhc3Moc2VsZi5jYWxlbmRhckNvbnRhaW5lciwgXCJyYW5nZU1vZGVcIiwgc2VsZi5jb25maWcubW9kZSA9PT0gXCJyYW5nZVwiKTtcbiAgICAgICAgdG9nZ2xlQ2xhc3Moc2VsZi5jYWxlbmRhckNvbnRhaW5lciwgXCJhbmltYXRlXCIsIHNlbGYuY29uZmlnLmFuaW1hdGUgPT09IHRydWUpO1xuICAgICAgICB0b2dnbGVDbGFzcyhzZWxmLmNhbGVuZGFyQ29udGFpbmVyLCBcIm11bHRpTW9udGhcIiwgc2VsZi5jb25maWcuc2hvd01vbnRocyA+IDEpO1xuICAgICAgICBzZWxmLmNhbGVuZGFyQ29udGFpbmVyLmFwcGVuZENoaWxkKGZyYWdtZW50KTtcbiAgICAgICAgdmFyIGN1c3RvbUFwcGVuZCA9IHNlbGYuY29uZmlnLmFwcGVuZFRvICE9PSB1bmRlZmluZWQgJiZcbiAgICAgICAgICAgIHNlbGYuY29uZmlnLmFwcGVuZFRvLm5vZGVUeXBlICE9PSB1bmRlZmluZWQ7XG4gICAgICAgIGlmIChzZWxmLmNvbmZpZy5pbmxpbmUgfHwgc2VsZi5jb25maWcuc3RhdGljKSB7XG4gICAgICAgICAgICBzZWxmLmNhbGVuZGFyQ29udGFpbmVyLmNsYXNzTGlzdC5hZGQoc2VsZi5jb25maWcuaW5saW5lID8gXCJpbmxpbmVcIiA6IFwic3RhdGljXCIpO1xuICAgICAgICAgICAgaWYgKHNlbGYuY29uZmlnLmlubGluZSkge1xuICAgICAgICAgICAgICAgIGlmICghY3VzdG9tQXBwZW5kICYmIHNlbGYuZWxlbWVudC5wYXJlbnROb2RlKVxuICAgICAgICAgICAgICAgICAgICBzZWxmLmVsZW1lbnQucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUoc2VsZi5jYWxlbmRhckNvbnRhaW5lciwgc2VsZi5faW5wdXQubmV4dFNpYmxpbmcpO1xuICAgICAgICAgICAgICAgIGVsc2UgaWYgKHNlbGYuY29uZmlnLmFwcGVuZFRvICE9PSB1bmRlZmluZWQpXG4gICAgICAgICAgICAgICAgICAgIHNlbGYuY29uZmlnLmFwcGVuZFRvLmFwcGVuZENoaWxkKHNlbGYuY2FsZW5kYXJDb250YWluZXIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHNlbGYuY29uZmlnLnN0YXRpYykge1xuICAgICAgICAgICAgICAgIHZhciB3cmFwcGVyID0gY3JlYXRlRWxlbWVudChcImRpdlwiLCBcImZsYXRwaWNrci13cmFwcGVyXCIpO1xuICAgICAgICAgICAgICAgIGlmIChzZWxmLmVsZW1lbnQucGFyZW50Tm9kZSlcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5lbGVtZW50LnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKHdyYXBwZXIsIHNlbGYuZWxlbWVudCk7XG4gICAgICAgICAgICAgICAgd3JhcHBlci5hcHBlbmRDaGlsZChzZWxmLmVsZW1lbnQpO1xuICAgICAgICAgICAgICAgIGlmIChzZWxmLmFsdElucHV0KVxuICAgICAgICAgICAgICAgICAgICB3cmFwcGVyLmFwcGVuZENoaWxkKHNlbGYuYWx0SW5wdXQpO1xuICAgICAgICAgICAgICAgIHdyYXBwZXIuYXBwZW5kQ2hpbGQoc2VsZi5jYWxlbmRhckNvbnRhaW5lcik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFzZWxmLmNvbmZpZy5zdGF0aWMgJiYgIXNlbGYuY29uZmlnLmlubGluZSlcbiAgICAgICAgICAgIChzZWxmLmNvbmZpZy5hcHBlbmRUbyAhPT0gdW5kZWZpbmVkXG4gICAgICAgICAgICAgICAgPyBzZWxmLmNvbmZpZy5hcHBlbmRUb1xuICAgICAgICAgICAgICAgIDogd2luZG93LmRvY3VtZW50LmJvZHkpLmFwcGVuZENoaWxkKHNlbGYuY2FsZW5kYXJDb250YWluZXIpO1xuICAgIH1cbiAgICBmdW5jdGlvbiBjcmVhdGVEYXkoY2xhc3NOYW1lLCBkYXRlLCBfZGF5TnVtYmVyLCBpKSB7XG4gICAgICAgIHZhciBkYXRlSXNFbmFibGVkID0gaXNFbmFibGVkKGRhdGUsIHRydWUpLCBkYXlFbGVtZW50ID0gY3JlYXRlRWxlbWVudChcInNwYW5cIiwgY2xhc3NOYW1lLCBkYXRlLmdldERhdGUoKS50b1N0cmluZygpKTtcbiAgICAgICAgZGF5RWxlbWVudC5kYXRlT2JqID0gZGF0ZTtcbiAgICAgICAgZGF5RWxlbWVudC4kaSA9IGk7XG4gICAgICAgIGRheUVsZW1lbnQuc2V0QXR0cmlidXRlKFwiYXJpYS1sYWJlbFwiLCBzZWxmLmZvcm1hdERhdGUoZGF0ZSwgc2VsZi5jb25maWcuYXJpYURhdGVGb3JtYXQpKTtcbiAgICAgICAgaWYgKGNsYXNzTmFtZS5pbmRleE9mKFwiaGlkZGVuXCIpID09PSAtMSAmJlxuICAgICAgICAgICAgY29tcGFyZURhdGVzKGRhdGUsIHNlbGYubm93KSA9PT0gMCkge1xuICAgICAgICAgICAgc2VsZi50b2RheURhdGVFbGVtID0gZGF5RWxlbWVudDtcbiAgICAgICAgICAgIGRheUVsZW1lbnQuY2xhc3NMaXN0LmFkZChcInRvZGF5XCIpO1xuICAgICAgICAgICAgZGF5RWxlbWVudC5zZXRBdHRyaWJ1dGUoXCJhcmlhLWN1cnJlbnRcIiwgXCJkYXRlXCIpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChkYXRlSXNFbmFibGVkKSB7XG4gICAgICAgICAgICBkYXlFbGVtZW50LnRhYkluZGV4ID0gLTE7XG4gICAgICAgICAgICBpZiAoaXNEYXRlU2VsZWN0ZWQoZGF0ZSkpIHtcbiAgICAgICAgICAgICAgICBkYXlFbGVtZW50LmNsYXNzTGlzdC5hZGQoXCJzZWxlY3RlZFwiKTtcbiAgICAgICAgICAgICAgICBzZWxmLnNlbGVjdGVkRGF0ZUVsZW0gPSBkYXlFbGVtZW50O1xuICAgICAgICAgICAgICAgIGlmIChzZWxmLmNvbmZpZy5tb2RlID09PSBcInJhbmdlXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgdG9nZ2xlQ2xhc3MoZGF5RWxlbWVudCwgXCJzdGFydFJhbmdlXCIsIHNlbGYuc2VsZWN0ZWREYXRlc1swXSAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgY29tcGFyZURhdGVzKGRhdGUsIHNlbGYuc2VsZWN0ZWREYXRlc1swXSwgdHJ1ZSkgPT09IDApO1xuICAgICAgICAgICAgICAgICAgICB0b2dnbGVDbGFzcyhkYXlFbGVtZW50LCBcImVuZFJhbmdlXCIsIHNlbGYuc2VsZWN0ZWREYXRlc1sxXSAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgY29tcGFyZURhdGVzKGRhdGUsIHNlbGYuc2VsZWN0ZWREYXRlc1sxXSwgdHJ1ZSkgPT09IDApO1xuICAgICAgICAgICAgICAgICAgICBpZiAoY2xhc3NOYW1lID09PSBcIm5leHRNb250aERheVwiKVxuICAgICAgICAgICAgICAgICAgICAgICAgZGF5RWxlbWVudC5jbGFzc0xpc3QuYWRkKFwiaW5SYW5nZVwiKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBkYXlFbGVtZW50LmNsYXNzTGlzdC5hZGQoXCJmbGF0cGlja3ItZGlzYWJsZWRcIik7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHNlbGYuY29uZmlnLm1vZGUgPT09IFwicmFuZ2VcIikge1xuICAgICAgICAgICAgaWYgKGlzRGF0ZUluUmFuZ2UoZGF0ZSkgJiYgIWlzRGF0ZVNlbGVjdGVkKGRhdGUpKVxuICAgICAgICAgICAgICAgIGRheUVsZW1lbnQuY2xhc3NMaXN0LmFkZChcImluUmFuZ2VcIik7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHNlbGYud2Vla051bWJlcnMgJiZcbiAgICAgICAgICAgIHNlbGYuY29uZmlnLnNob3dNb250aHMgPT09IDEgJiZcbiAgICAgICAgICAgIGNsYXNzTmFtZSAhPT0gXCJwcmV2TW9udGhEYXlcIiAmJlxuICAgICAgICAgICAgaSAlIDcgPT09IDYpIHtcbiAgICAgICAgICAgIHNlbGYud2Vla051bWJlcnMuaW5zZXJ0QWRqYWNlbnRIVE1MKFwiYmVmb3JlZW5kXCIsIFwiPHNwYW4gY2xhc3M9J2ZsYXRwaWNrci1kYXknPlwiICsgc2VsZi5jb25maWcuZ2V0V2VlayhkYXRlKSArIFwiPC9zcGFuPlwiKTtcbiAgICAgICAgfVxuICAgICAgICB0cmlnZ2VyRXZlbnQoXCJvbkRheUNyZWF0ZVwiLCBkYXlFbGVtZW50KTtcbiAgICAgICAgcmV0dXJuIGRheUVsZW1lbnQ7XG4gICAgfVxuICAgIGZ1bmN0aW9uIGZvY3VzT25EYXlFbGVtKHRhcmdldE5vZGUpIHtcbiAgICAgICAgdGFyZ2V0Tm9kZS5mb2N1cygpO1xuICAgICAgICBpZiAoc2VsZi5jb25maWcubW9kZSA9PT0gXCJyYW5nZVwiKVxuICAgICAgICAgICAgb25Nb3VzZU92ZXIodGFyZ2V0Tm9kZSk7XG4gICAgfVxuICAgIGZ1bmN0aW9uIGdldEZpcnN0QXZhaWxhYmxlRGF5KGRlbHRhKSB7XG4gICAgICAgIHZhciBzdGFydE1vbnRoID0gZGVsdGEgPiAwID8gMCA6IHNlbGYuY29uZmlnLnNob3dNb250aHMgLSAxO1xuICAgICAgICB2YXIgZW5kTW9udGggPSBkZWx0YSA+IDAgPyBzZWxmLmNvbmZpZy5zaG93TW9udGhzIDogLTE7XG4gICAgICAgIGZvciAodmFyIG0gPSBzdGFydE1vbnRoOyBtICE9IGVuZE1vbnRoOyBtICs9IGRlbHRhKSB7XG4gICAgICAgICAgICB2YXIgbW9udGggPSBzZWxmLmRheXNDb250YWluZXIuY2hpbGRyZW5bbV07XG4gICAgICAgICAgICB2YXIgc3RhcnRJbmRleCA9IGRlbHRhID4gMCA/IDAgOiBtb250aC5jaGlsZHJlbi5sZW5ndGggLSAxO1xuICAgICAgICAgICAgdmFyIGVuZEluZGV4ID0gZGVsdGEgPiAwID8gbW9udGguY2hpbGRyZW4ubGVuZ3RoIDogLTE7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gc3RhcnRJbmRleDsgaSAhPSBlbmRJbmRleDsgaSArPSBkZWx0YSkge1xuICAgICAgICAgICAgICAgIHZhciBjID0gbW9udGguY2hpbGRyZW5baV07XG4gICAgICAgICAgICAgICAgaWYgKGMuY2xhc3NOYW1lLmluZGV4T2YoXCJoaWRkZW5cIikgPT09IC0xICYmIGlzRW5hYmxlZChjLmRhdGVPYmopKVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gYztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgIH1cbiAgICBmdW5jdGlvbiBnZXROZXh0QXZhaWxhYmxlRGF5KGN1cnJlbnQsIGRlbHRhKSB7XG4gICAgICAgIHZhciBnaXZlbk1vbnRoID0gY3VycmVudC5jbGFzc05hbWUuaW5kZXhPZihcIk1vbnRoXCIpID09PSAtMVxuICAgICAgICAgICAgPyBjdXJyZW50LmRhdGVPYmouZ2V0TW9udGgoKVxuICAgICAgICAgICAgOiBzZWxmLmN1cnJlbnRNb250aDtcbiAgICAgICAgdmFyIGVuZE1vbnRoID0gZGVsdGEgPiAwID8gc2VsZi5jb25maWcuc2hvd01vbnRocyA6IC0xO1xuICAgICAgICB2YXIgbG9vcERlbHRhID0gZGVsdGEgPiAwID8gMSA6IC0xO1xuICAgICAgICBmb3IgKHZhciBtID0gZ2l2ZW5Nb250aCAtIHNlbGYuY3VycmVudE1vbnRoOyBtICE9IGVuZE1vbnRoOyBtICs9IGxvb3BEZWx0YSkge1xuICAgICAgICAgICAgdmFyIG1vbnRoID0gc2VsZi5kYXlzQ29udGFpbmVyLmNoaWxkcmVuW21dO1xuICAgICAgICAgICAgdmFyIHN0YXJ0SW5kZXggPSBnaXZlbk1vbnRoIC0gc2VsZi5jdXJyZW50TW9udGggPT09IG1cbiAgICAgICAgICAgICAgICA/IGN1cnJlbnQuJGkgKyBkZWx0YVxuICAgICAgICAgICAgICAgIDogZGVsdGEgPCAwXG4gICAgICAgICAgICAgICAgICAgID8gbW9udGguY2hpbGRyZW4ubGVuZ3RoIC0gMVxuICAgICAgICAgICAgICAgICAgICA6IDA7XG4gICAgICAgICAgICB2YXIgbnVtTW9udGhEYXlzID0gbW9udGguY2hpbGRyZW4ubGVuZ3RoO1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IHN0YXJ0SW5kZXg7IGkgPj0gMCAmJiBpIDwgbnVtTW9udGhEYXlzICYmIGkgIT0gKGRlbHRhID4gMCA/IG51bU1vbnRoRGF5cyA6IC0xKTsgaSArPSBsb29wRGVsdGEpIHtcbiAgICAgICAgICAgICAgICB2YXIgYyA9IG1vbnRoLmNoaWxkcmVuW2ldO1xuICAgICAgICAgICAgICAgIGlmIChjLmNsYXNzTmFtZS5pbmRleE9mKFwiaGlkZGVuXCIpID09PSAtMSAmJlxuICAgICAgICAgICAgICAgICAgICBpc0VuYWJsZWQoYy5kYXRlT2JqKSAmJlxuICAgICAgICAgICAgICAgICAgICBNYXRoLmFicyhjdXJyZW50LiRpIC0gaSkgPj0gTWF0aC5hYnMoZGVsdGEpKVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZm9jdXNPbkRheUVsZW0oYyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgc2VsZi5jaGFuZ2VNb250aChsb29wRGVsdGEpO1xuICAgICAgICBmb2N1c09uRGF5KGdldEZpcnN0QXZhaWxhYmxlRGF5KGxvb3BEZWx0YSksIDApO1xuICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgIH1cbiAgICBmdW5jdGlvbiBmb2N1c09uRGF5KGN1cnJlbnQsIG9mZnNldCkge1xuICAgICAgICB2YXIgYWN0aXZlRWxlbWVudCA9IGdldENsb3Nlc3RBY3RpdmVFbGVtZW50KCk7XG4gICAgICAgIHZhciBkYXlGb2N1c2VkID0gaXNJblZpZXcoYWN0aXZlRWxlbWVudCB8fCBkb2N1bWVudC5ib2R5KTtcbiAgICAgICAgdmFyIHN0YXJ0RWxlbSA9IGN1cnJlbnQgIT09IHVuZGVmaW5lZFxuICAgICAgICAgICAgPyBjdXJyZW50XG4gICAgICAgICAgICA6IGRheUZvY3VzZWRcbiAgICAgICAgICAgICAgICA/IGFjdGl2ZUVsZW1lbnRcbiAgICAgICAgICAgICAgICA6IHNlbGYuc2VsZWN0ZWREYXRlRWxlbSAhPT0gdW5kZWZpbmVkICYmIGlzSW5WaWV3KHNlbGYuc2VsZWN0ZWREYXRlRWxlbSlcbiAgICAgICAgICAgICAgICAgICAgPyBzZWxmLnNlbGVjdGVkRGF0ZUVsZW1cbiAgICAgICAgICAgICAgICAgICAgOiBzZWxmLnRvZGF5RGF0ZUVsZW0gIT09IHVuZGVmaW5lZCAmJiBpc0luVmlldyhzZWxmLnRvZGF5RGF0ZUVsZW0pXG4gICAgICAgICAgICAgICAgICAgICAgICA/IHNlbGYudG9kYXlEYXRlRWxlbVxuICAgICAgICAgICAgICAgICAgICAgICAgOiBnZXRGaXJzdEF2YWlsYWJsZURheShvZmZzZXQgPiAwID8gMSA6IC0xKTtcbiAgICAgICAgaWYgKHN0YXJ0RWxlbSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBzZWxmLl9pbnB1dC5mb2N1cygpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKCFkYXlGb2N1c2VkKSB7XG4gICAgICAgICAgICBmb2N1c09uRGF5RWxlbShzdGFydEVsZW0pO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgZ2V0TmV4dEF2YWlsYWJsZURheShzdGFydEVsZW0sIG9mZnNldCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZnVuY3Rpb24gYnVpbGRNb250aERheXMoeWVhciwgbW9udGgpIHtcbiAgICAgICAgdmFyIGZpcnN0T2ZNb250aCA9IChuZXcgRGF0ZSh5ZWFyLCBtb250aCwgMSkuZ2V0RGF5KCkgLSBzZWxmLmwxMG4uZmlyc3REYXlPZldlZWsgKyA3KSAlIDc7XG4gICAgICAgIHZhciBwcmV2TW9udGhEYXlzID0gc2VsZi51dGlscy5nZXREYXlzSW5Nb250aCgobW9udGggLSAxICsgMTIpICUgMTIsIHllYXIpO1xuICAgICAgICB2YXIgZGF5c0luTW9udGggPSBzZWxmLnV0aWxzLmdldERheXNJbk1vbnRoKG1vbnRoLCB5ZWFyKSwgZGF5cyA9IHdpbmRvdy5kb2N1bWVudC5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCksIGlzTXVsdGlNb250aCA9IHNlbGYuY29uZmlnLnNob3dNb250aHMgPiAxLCBwcmV2TW9udGhEYXlDbGFzcyA9IGlzTXVsdGlNb250aCA/IFwicHJldk1vbnRoRGF5IGhpZGRlblwiIDogXCJwcmV2TW9udGhEYXlcIiwgbmV4dE1vbnRoRGF5Q2xhc3MgPSBpc011bHRpTW9udGggPyBcIm5leHRNb250aERheSBoaWRkZW5cIiA6IFwibmV4dE1vbnRoRGF5XCI7XG4gICAgICAgIHZhciBkYXlOdW1iZXIgPSBwcmV2TW9udGhEYXlzICsgMSAtIGZpcnN0T2ZNb250aCwgZGF5SW5kZXggPSAwO1xuICAgICAgICBmb3IgKDsgZGF5TnVtYmVyIDw9IHByZXZNb250aERheXM7IGRheU51bWJlcisrLCBkYXlJbmRleCsrKSB7XG4gICAgICAgICAgICBkYXlzLmFwcGVuZENoaWxkKGNyZWF0ZURheShcImZsYXRwaWNrci1kYXkgXCIgKyBwcmV2TW9udGhEYXlDbGFzcywgbmV3IERhdGUoeWVhciwgbW9udGggLSAxLCBkYXlOdW1iZXIpLCBkYXlOdW1iZXIsIGRheUluZGV4KSk7XG4gICAgICAgIH1cbiAgICAgICAgZm9yIChkYXlOdW1iZXIgPSAxOyBkYXlOdW1iZXIgPD0gZGF5c0luTW9udGg7IGRheU51bWJlcisrLCBkYXlJbmRleCsrKSB7XG4gICAgICAgICAgICBkYXlzLmFwcGVuZENoaWxkKGNyZWF0ZURheShcImZsYXRwaWNrci1kYXlcIiwgbmV3IERhdGUoeWVhciwgbW9udGgsIGRheU51bWJlciksIGRheU51bWJlciwgZGF5SW5kZXgpKTtcbiAgICAgICAgfVxuICAgICAgICBmb3IgKHZhciBkYXlOdW0gPSBkYXlzSW5Nb250aCArIDE7IGRheU51bSA8PSA0MiAtIGZpcnN0T2ZNb250aCAmJlxuICAgICAgICAgICAgKHNlbGYuY29uZmlnLnNob3dNb250aHMgPT09IDEgfHwgZGF5SW5kZXggJSA3ICE9PSAwKTsgZGF5TnVtKyssIGRheUluZGV4KyspIHtcbiAgICAgICAgICAgIGRheXMuYXBwZW5kQ2hpbGQoY3JlYXRlRGF5KFwiZmxhdHBpY2tyLWRheSBcIiArIG5leHRNb250aERheUNsYXNzLCBuZXcgRGF0ZSh5ZWFyLCBtb250aCArIDEsIGRheU51bSAlIGRheXNJbk1vbnRoKSwgZGF5TnVtLCBkYXlJbmRleCkpO1xuICAgICAgICB9XG4gICAgICAgIHZhciBkYXlDb250YWluZXIgPSBjcmVhdGVFbGVtZW50KFwiZGl2XCIsIFwiZGF5Q29udGFpbmVyXCIpO1xuICAgICAgICBkYXlDb250YWluZXIuYXBwZW5kQ2hpbGQoZGF5cyk7XG4gICAgICAgIHJldHVybiBkYXlDb250YWluZXI7XG4gICAgfVxuICAgIGZ1bmN0aW9uIGJ1aWxkRGF5cygpIHtcbiAgICAgICAgaWYgKHNlbGYuZGF5c0NvbnRhaW5lciA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgY2xlYXJOb2RlKHNlbGYuZGF5c0NvbnRhaW5lcik7XG4gICAgICAgIGlmIChzZWxmLndlZWtOdW1iZXJzKVxuICAgICAgICAgICAgY2xlYXJOb2RlKHNlbGYud2Vla051bWJlcnMpO1xuICAgICAgICB2YXIgZnJhZyA9IGRvY3VtZW50LmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzZWxmLmNvbmZpZy5zaG93TW9udGhzOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBkID0gbmV3IERhdGUoc2VsZi5jdXJyZW50WWVhciwgc2VsZi5jdXJyZW50TW9udGgsIDEpO1xuICAgICAgICAgICAgZC5zZXRNb250aChzZWxmLmN1cnJlbnRNb250aCArIGkpO1xuICAgICAgICAgICAgZnJhZy5hcHBlbmRDaGlsZChidWlsZE1vbnRoRGF5cyhkLmdldEZ1bGxZZWFyKCksIGQuZ2V0TW9udGgoKSkpO1xuICAgICAgICB9XG4gICAgICAgIHNlbGYuZGF5c0NvbnRhaW5lci5hcHBlbmRDaGlsZChmcmFnKTtcbiAgICAgICAgc2VsZi5kYXlzID0gc2VsZi5kYXlzQ29udGFpbmVyLmZpcnN0Q2hpbGQ7XG4gICAgICAgIGlmIChzZWxmLmNvbmZpZy5tb2RlID09PSBcInJhbmdlXCIgJiYgc2VsZi5zZWxlY3RlZERhdGVzLmxlbmd0aCA9PT0gMSkge1xuICAgICAgICAgICAgb25Nb3VzZU92ZXIoKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBmdW5jdGlvbiBidWlsZE1vbnRoU3dpdGNoKCkge1xuICAgICAgICBpZiAoc2VsZi5jb25maWcuc2hvd01vbnRocyA+IDEgfHxcbiAgICAgICAgICAgIHNlbGYuY29uZmlnLm1vbnRoU2VsZWN0b3JUeXBlICE9PSBcImRyb3Bkb3duXCIpXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIHZhciBzaG91bGRCdWlsZE1vbnRoID0gZnVuY3Rpb24gKG1vbnRoKSB7XG4gICAgICAgICAgICBpZiAoc2VsZi5jb25maWcubWluRGF0ZSAhPT0gdW5kZWZpbmVkICYmXG4gICAgICAgICAgICAgICAgc2VsZi5jdXJyZW50WWVhciA9PT0gc2VsZi5jb25maWcubWluRGF0ZS5nZXRGdWxsWWVhcigpICYmXG4gICAgICAgICAgICAgICAgbW9udGggPCBzZWxmLmNvbmZpZy5taW5EYXRlLmdldE1vbnRoKCkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gIShzZWxmLmNvbmZpZy5tYXhEYXRlICE9PSB1bmRlZmluZWQgJiZcbiAgICAgICAgICAgICAgICBzZWxmLmN1cnJlbnRZZWFyID09PSBzZWxmLmNvbmZpZy5tYXhEYXRlLmdldEZ1bGxZZWFyKCkgJiZcbiAgICAgICAgICAgICAgICBtb250aCA+IHNlbGYuY29uZmlnLm1heERhdGUuZ2V0TW9udGgoKSk7XG4gICAgICAgIH07XG4gICAgICAgIHNlbGYubW9udGhzRHJvcGRvd25Db250YWluZXIudGFiSW5kZXggPSAtMTtcbiAgICAgICAgc2VsZi5tb250aHNEcm9wZG93bkNvbnRhaW5lci5pbm5lckhUTUwgPSBcIlwiO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IDEyOyBpKyspIHtcbiAgICAgICAgICAgIGlmICghc2hvdWxkQnVpbGRNb250aChpKSlcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgIHZhciBtb250aCA9IGNyZWF0ZUVsZW1lbnQoXCJvcHRpb25cIiwgXCJmbGF0cGlja3ItbW9udGhEcm9wZG93bi1tb250aFwiKTtcbiAgICAgICAgICAgIG1vbnRoLnZhbHVlID0gbmV3IERhdGUoc2VsZi5jdXJyZW50WWVhciwgaSkuZ2V0TW9udGgoKS50b1N0cmluZygpO1xuICAgICAgICAgICAgbW9udGgudGV4dENvbnRlbnQgPSBtb250aFRvU3RyKGksIHNlbGYuY29uZmlnLnNob3J0aGFuZEN1cnJlbnRNb250aCwgc2VsZi5sMTBuKTtcbiAgICAgICAgICAgIG1vbnRoLnRhYkluZGV4ID0gLTE7XG4gICAgICAgICAgICBpZiAoc2VsZi5jdXJyZW50TW9udGggPT09IGkpIHtcbiAgICAgICAgICAgICAgICBtb250aC5zZWxlY3RlZCA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBzZWxmLm1vbnRoc0Ryb3Bkb3duQ29udGFpbmVyLmFwcGVuZENoaWxkKG1vbnRoKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBmdW5jdGlvbiBidWlsZE1vbnRoKCkge1xuICAgICAgICB2YXIgY29udGFpbmVyID0gY3JlYXRlRWxlbWVudChcImRpdlwiLCBcImZsYXRwaWNrci1tb250aFwiKTtcbiAgICAgICAgdmFyIG1vbnRoTmF2RnJhZ21lbnQgPSB3aW5kb3cuZG9jdW1lbnQuY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpO1xuICAgICAgICB2YXIgbW9udGhFbGVtZW50O1xuICAgICAgICBpZiAoc2VsZi5jb25maWcuc2hvd01vbnRocyA+IDEgfHxcbiAgICAgICAgICAgIHNlbGYuY29uZmlnLm1vbnRoU2VsZWN0b3JUeXBlID09PSBcInN0YXRpY1wiKSB7XG4gICAgICAgICAgICBtb250aEVsZW1lbnQgPSBjcmVhdGVFbGVtZW50KFwic3BhblwiLCBcImN1ci1tb250aFwiKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHNlbGYubW9udGhzRHJvcGRvd25Db250YWluZXIgPSBjcmVhdGVFbGVtZW50KFwic2VsZWN0XCIsIFwiZmxhdHBpY2tyLW1vbnRoRHJvcGRvd24tbW9udGhzXCIpO1xuICAgICAgICAgICAgc2VsZi5tb250aHNEcm9wZG93bkNvbnRhaW5lci5zZXRBdHRyaWJ1dGUoXCJhcmlhLWxhYmVsXCIsIHNlbGYubDEwbi5tb250aEFyaWFMYWJlbCk7XG4gICAgICAgICAgICBiaW5kKHNlbGYubW9udGhzRHJvcGRvd25Db250YWluZXIsIFwiY2hhbmdlXCIsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRhcmdldCA9IGdldEV2ZW50VGFyZ2V0KGUpO1xuICAgICAgICAgICAgICAgIHZhciBzZWxlY3RlZE1vbnRoID0gcGFyc2VJbnQodGFyZ2V0LnZhbHVlLCAxMCk7XG4gICAgICAgICAgICAgICAgc2VsZi5jaGFuZ2VNb250aChzZWxlY3RlZE1vbnRoIC0gc2VsZi5jdXJyZW50TW9udGgpO1xuICAgICAgICAgICAgICAgIHRyaWdnZXJFdmVudChcIm9uTW9udGhDaGFuZ2VcIik7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGJ1aWxkTW9udGhTd2l0Y2goKTtcbiAgICAgICAgICAgIG1vbnRoRWxlbWVudCA9IHNlbGYubW9udGhzRHJvcGRvd25Db250YWluZXI7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHllYXJJbnB1dCA9IGNyZWF0ZU51bWJlcklucHV0KFwiY3VyLXllYXJcIiwgeyB0YWJpbmRleDogXCItMVwiIH0pO1xuICAgICAgICB2YXIgeWVhckVsZW1lbnQgPSB5ZWFySW5wdXQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCJpbnB1dFwiKVswXTtcbiAgICAgICAgeWVhckVsZW1lbnQuc2V0QXR0cmlidXRlKFwiYXJpYS1sYWJlbFwiLCBzZWxmLmwxMG4ueWVhckFyaWFMYWJlbCk7XG4gICAgICAgIGlmIChzZWxmLmNvbmZpZy5taW5EYXRlKSB7XG4gICAgICAgICAgICB5ZWFyRWxlbWVudC5zZXRBdHRyaWJ1dGUoXCJtaW5cIiwgc2VsZi5jb25maWcubWluRGF0ZS5nZXRGdWxsWWVhcigpLnRvU3RyaW5nKCkpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChzZWxmLmNvbmZpZy5tYXhEYXRlKSB7XG4gICAgICAgICAgICB5ZWFyRWxlbWVudC5zZXRBdHRyaWJ1dGUoXCJtYXhcIiwgc2VsZi5jb25maWcubWF4RGF0ZS5nZXRGdWxsWWVhcigpLnRvU3RyaW5nKCkpO1xuICAgICAgICAgICAgeWVhckVsZW1lbnQuZGlzYWJsZWQgPVxuICAgICAgICAgICAgICAgICEhc2VsZi5jb25maWcubWluRGF0ZSAmJlxuICAgICAgICAgICAgICAgICAgICBzZWxmLmNvbmZpZy5taW5EYXRlLmdldEZ1bGxZZWFyKCkgPT09IHNlbGYuY29uZmlnLm1heERhdGUuZ2V0RnVsbFllYXIoKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgY3VycmVudE1vbnRoID0gY3JlYXRlRWxlbWVudChcImRpdlwiLCBcImZsYXRwaWNrci1jdXJyZW50LW1vbnRoXCIpO1xuICAgICAgICBjdXJyZW50TW9udGguYXBwZW5kQ2hpbGQobW9udGhFbGVtZW50KTtcbiAgICAgICAgY3VycmVudE1vbnRoLmFwcGVuZENoaWxkKHllYXJJbnB1dCk7XG4gICAgICAgIG1vbnRoTmF2RnJhZ21lbnQuYXBwZW5kQ2hpbGQoY3VycmVudE1vbnRoKTtcbiAgICAgICAgY29udGFpbmVyLmFwcGVuZENoaWxkKG1vbnRoTmF2RnJhZ21lbnQpO1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgY29udGFpbmVyOiBjb250YWluZXIsXG4gICAgICAgICAgICB5ZWFyRWxlbWVudDogeWVhckVsZW1lbnQsXG4gICAgICAgICAgICBtb250aEVsZW1lbnQ6IG1vbnRoRWxlbWVudCxcbiAgICAgICAgfTtcbiAgICB9XG4gICAgZnVuY3Rpb24gYnVpbGRNb250aHMoKSB7XG4gICAgICAgIGNsZWFyTm9kZShzZWxmLm1vbnRoTmF2KTtcbiAgICAgICAgc2VsZi5tb250aE5hdi5hcHBlbmRDaGlsZChzZWxmLnByZXZNb250aE5hdik7XG4gICAgICAgIGlmIChzZWxmLmNvbmZpZy5zaG93TW9udGhzKSB7XG4gICAgICAgICAgICBzZWxmLnllYXJFbGVtZW50cyA9IFtdO1xuICAgICAgICAgICAgc2VsZi5tb250aEVsZW1lbnRzID0gW107XG4gICAgICAgIH1cbiAgICAgICAgZm9yICh2YXIgbSA9IHNlbGYuY29uZmlnLnNob3dNb250aHM7IG0tLTspIHtcbiAgICAgICAgICAgIHZhciBtb250aCA9IGJ1aWxkTW9udGgoKTtcbiAgICAgICAgICAgIHNlbGYueWVhckVsZW1lbnRzLnB1c2gobW9udGgueWVhckVsZW1lbnQpO1xuICAgICAgICAgICAgc2VsZi5tb250aEVsZW1lbnRzLnB1c2gobW9udGgubW9udGhFbGVtZW50KTtcbiAgICAgICAgICAgIHNlbGYubW9udGhOYXYuYXBwZW5kQ2hpbGQobW9udGguY29udGFpbmVyKTtcbiAgICAgICAgfVxuICAgICAgICBzZWxmLm1vbnRoTmF2LmFwcGVuZENoaWxkKHNlbGYubmV4dE1vbnRoTmF2KTtcbiAgICB9XG4gICAgZnVuY3Rpb24gYnVpbGRNb250aE5hdigpIHtcbiAgICAgICAgc2VsZi5tb250aE5hdiA9IGNyZWF0ZUVsZW1lbnQoXCJkaXZcIiwgXCJmbGF0cGlja3ItbW9udGhzXCIpO1xuICAgICAgICBzZWxmLnllYXJFbGVtZW50cyA9IFtdO1xuICAgICAgICBzZWxmLm1vbnRoRWxlbWVudHMgPSBbXTtcbiAgICAgICAgc2VsZi5wcmV2TW9udGhOYXYgPSBjcmVhdGVFbGVtZW50KFwic3BhblwiLCBcImZsYXRwaWNrci1wcmV2LW1vbnRoXCIpO1xuICAgICAgICBzZWxmLnByZXZNb250aE5hdi5pbm5lckhUTUwgPSBzZWxmLmNvbmZpZy5wcmV2QXJyb3c7XG4gICAgICAgIHNlbGYubmV4dE1vbnRoTmF2ID0gY3JlYXRlRWxlbWVudChcInNwYW5cIiwgXCJmbGF0cGlja3ItbmV4dC1tb250aFwiKTtcbiAgICAgICAgc2VsZi5uZXh0TW9udGhOYXYuaW5uZXJIVE1MID0gc2VsZi5jb25maWcubmV4dEFycm93O1xuICAgICAgICBidWlsZE1vbnRocygpO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoc2VsZiwgXCJfaGlkZVByZXZNb250aEFycm93XCIsIHtcbiAgICAgICAgICAgIGdldDogZnVuY3Rpb24gKCkgeyByZXR1cm4gc2VsZi5fX2hpZGVQcmV2TW9udGhBcnJvdzsgfSxcbiAgICAgICAgICAgIHNldDogZnVuY3Rpb24gKGJvb2wpIHtcbiAgICAgICAgICAgICAgICBpZiAoc2VsZi5fX2hpZGVQcmV2TW9udGhBcnJvdyAhPT0gYm9vbCkge1xuICAgICAgICAgICAgICAgICAgICB0b2dnbGVDbGFzcyhzZWxmLnByZXZNb250aE5hdiwgXCJmbGF0cGlja3ItZGlzYWJsZWRcIiwgYm9vbCk7XG4gICAgICAgICAgICAgICAgICAgIHNlbGYuX19oaWRlUHJldk1vbnRoQXJyb3cgPSBib29sO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgIH0pO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoc2VsZiwgXCJfaGlkZU5leHRNb250aEFycm93XCIsIHtcbiAgICAgICAgICAgIGdldDogZnVuY3Rpb24gKCkgeyByZXR1cm4gc2VsZi5fX2hpZGVOZXh0TW9udGhBcnJvdzsgfSxcbiAgICAgICAgICAgIHNldDogZnVuY3Rpb24gKGJvb2wpIHtcbiAgICAgICAgICAgICAgICBpZiAoc2VsZi5fX2hpZGVOZXh0TW9udGhBcnJvdyAhPT0gYm9vbCkge1xuICAgICAgICAgICAgICAgICAgICB0b2dnbGVDbGFzcyhzZWxmLm5leHRNb250aE5hdiwgXCJmbGF0cGlja3ItZGlzYWJsZWRcIiwgYm9vbCk7XG4gICAgICAgICAgICAgICAgICAgIHNlbGYuX19oaWRlTmV4dE1vbnRoQXJyb3cgPSBib29sO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgIH0pO1xuICAgICAgICBzZWxmLmN1cnJlbnRZZWFyRWxlbWVudCA9IHNlbGYueWVhckVsZW1lbnRzWzBdO1xuICAgICAgICB1cGRhdGVOYXZpZ2F0aW9uQ3VycmVudE1vbnRoKCk7XG4gICAgICAgIHJldHVybiBzZWxmLm1vbnRoTmF2O1xuICAgIH1cbiAgICBmdW5jdGlvbiBidWlsZFRpbWUoKSB7XG4gICAgICAgIHNlbGYuY2FsZW5kYXJDb250YWluZXIuY2xhc3NMaXN0LmFkZChcImhhc1RpbWVcIik7XG4gICAgICAgIGlmIChzZWxmLmNvbmZpZy5ub0NhbGVuZGFyKVxuICAgICAgICAgICAgc2VsZi5jYWxlbmRhckNvbnRhaW5lci5jbGFzc0xpc3QuYWRkKFwibm9DYWxlbmRhclwiKTtcbiAgICAgICAgdmFyIGRlZmF1bHRzID0gZ2V0RGVmYXVsdEhvdXJzKHNlbGYuY29uZmlnKTtcbiAgICAgICAgc2VsZi50aW1lQ29udGFpbmVyID0gY3JlYXRlRWxlbWVudChcImRpdlwiLCBcImZsYXRwaWNrci10aW1lXCIpO1xuICAgICAgICBzZWxmLnRpbWVDb250YWluZXIudGFiSW5kZXggPSAtMTtcbiAgICAgICAgdmFyIHNlcGFyYXRvciA9IGNyZWF0ZUVsZW1lbnQoXCJzcGFuXCIsIFwiZmxhdHBpY2tyLXRpbWUtc2VwYXJhdG9yXCIsIFwiOlwiKTtcbiAgICAgICAgdmFyIGhvdXJJbnB1dCA9IGNyZWF0ZU51bWJlcklucHV0KFwiZmxhdHBpY2tyLWhvdXJcIiwge1xuICAgICAgICAgICAgXCJhcmlhLWxhYmVsXCI6IHNlbGYubDEwbi5ob3VyQXJpYUxhYmVsLFxuICAgICAgICB9KTtcbiAgICAgICAgc2VsZi5ob3VyRWxlbWVudCA9IGhvdXJJbnB1dC5nZXRFbGVtZW50c0J5VGFnTmFtZShcImlucHV0XCIpWzBdO1xuICAgICAgICB2YXIgbWludXRlSW5wdXQgPSBjcmVhdGVOdW1iZXJJbnB1dChcImZsYXRwaWNrci1taW51dGVcIiwge1xuICAgICAgICAgICAgXCJhcmlhLWxhYmVsXCI6IHNlbGYubDEwbi5taW51dGVBcmlhTGFiZWwsXG4gICAgICAgIH0pO1xuICAgICAgICBzZWxmLm1pbnV0ZUVsZW1lbnQgPSBtaW51dGVJbnB1dC5nZXRFbGVtZW50c0J5VGFnTmFtZShcImlucHV0XCIpWzBdO1xuICAgICAgICBzZWxmLmhvdXJFbGVtZW50LnRhYkluZGV4ID0gc2VsZi5taW51dGVFbGVtZW50LnRhYkluZGV4ID0gLTE7XG4gICAgICAgIHNlbGYuaG91ckVsZW1lbnQudmFsdWUgPSBwYWQoc2VsZi5sYXRlc3RTZWxlY3RlZERhdGVPYmpcbiAgICAgICAgICAgID8gc2VsZi5sYXRlc3RTZWxlY3RlZERhdGVPYmouZ2V0SG91cnMoKVxuICAgICAgICAgICAgOiBzZWxmLmNvbmZpZy50aW1lXzI0aHJcbiAgICAgICAgICAgICAgICA/IGRlZmF1bHRzLmhvdXJzXG4gICAgICAgICAgICAgICAgOiBtaWxpdGFyeTJhbXBtKGRlZmF1bHRzLmhvdXJzKSk7XG4gICAgICAgIHNlbGYubWludXRlRWxlbWVudC52YWx1ZSA9IHBhZChzZWxmLmxhdGVzdFNlbGVjdGVkRGF0ZU9ialxuICAgICAgICAgICAgPyBzZWxmLmxhdGVzdFNlbGVjdGVkRGF0ZU9iai5nZXRNaW51dGVzKClcbiAgICAgICAgICAgIDogZGVmYXVsdHMubWludXRlcyk7XG4gICAgICAgIHNlbGYuaG91ckVsZW1lbnQuc2V0QXR0cmlidXRlKFwic3RlcFwiLCBzZWxmLmNvbmZpZy5ob3VySW5jcmVtZW50LnRvU3RyaW5nKCkpO1xuICAgICAgICBzZWxmLm1pbnV0ZUVsZW1lbnQuc2V0QXR0cmlidXRlKFwic3RlcFwiLCBzZWxmLmNvbmZpZy5taW51dGVJbmNyZW1lbnQudG9TdHJpbmcoKSk7XG4gICAgICAgIHNlbGYuaG91ckVsZW1lbnQuc2V0QXR0cmlidXRlKFwibWluXCIsIHNlbGYuY29uZmlnLnRpbWVfMjRociA/IFwiMFwiIDogXCIxXCIpO1xuICAgICAgICBzZWxmLmhvdXJFbGVtZW50LnNldEF0dHJpYnV0ZShcIm1heFwiLCBzZWxmLmNvbmZpZy50aW1lXzI0aHIgPyBcIjIzXCIgOiBcIjEyXCIpO1xuICAgICAgICBzZWxmLmhvdXJFbGVtZW50LnNldEF0dHJpYnV0ZShcIm1heGxlbmd0aFwiLCBcIjJcIik7XG4gICAgICAgIHNlbGYubWludXRlRWxlbWVudC5zZXRBdHRyaWJ1dGUoXCJtaW5cIiwgXCIwXCIpO1xuICAgICAgICBzZWxmLm1pbnV0ZUVsZW1lbnQuc2V0QXR0cmlidXRlKFwibWF4XCIsIFwiNTlcIik7XG4gICAgICAgIHNlbGYubWludXRlRWxlbWVudC5zZXRBdHRyaWJ1dGUoXCJtYXhsZW5ndGhcIiwgXCIyXCIpO1xuICAgICAgICBzZWxmLnRpbWVDb250YWluZXIuYXBwZW5kQ2hpbGQoaG91cklucHV0KTtcbiAgICAgICAgc2VsZi50aW1lQ29udGFpbmVyLmFwcGVuZENoaWxkKHNlcGFyYXRvcik7XG4gICAgICAgIHNlbGYudGltZUNvbnRhaW5lci5hcHBlbmRDaGlsZChtaW51dGVJbnB1dCk7XG4gICAgICAgIGlmIChzZWxmLmNvbmZpZy50aW1lXzI0aHIpXG4gICAgICAgICAgICBzZWxmLnRpbWVDb250YWluZXIuY2xhc3NMaXN0LmFkZChcInRpbWUyNGhyXCIpO1xuICAgICAgICBpZiAoc2VsZi5jb25maWcuZW5hYmxlU2Vjb25kcykge1xuICAgICAgICAgICAgc2VsZi50aW1lQ29udGFpbmVyLmNsYXNzTGlzdC5hZGQoXCJoYXNTZWNvbmRzXCIpO1xuICAgICAgICAgICAgdmFyIHNlY29uZElucHV0ID0gY3JlYXRlTnVtYmVySW5wdXQoXCJmbGF0cGlja3Itc2Vjb25kXCIpO1xuICAgICAgICAgICAgc2VsZi5zZWNvbmRFbGVtZW50ID0gc2Vjb25kSW5wdXQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCJpbnB1dFwiKVswXTtcbiAgICAgICAgICAgIHNlbGYuc2Vjb25kRWxlbWVudC52YWx1ZSA9IHBhZChzZWxmLmxhdGVzdFNlbGVjdGVkRGF0ZU9ialxuICAgICAgICAgICAgICAgID8gc2VsZi5sYXRlc3RTZWxlY3RlZERhdGVPYmouZ2V0U2Vjb25kcygpXG4gICAgICAgICAgICAgICAgOiBkZWZhdWx0cy5zZWNvbmRzKTtcbiAgICAgICAgICAgIHNlbGYuc2Vjb25kRWxlbWVudC5zZXRBdHRyaWJ1dGUoXCJzdGVwXCIsIHNlbGYubWludXRlRWxlbWVudC5nZXRBdHRyaWJ1dGUoXCJzdGVwXCIpKTtcbiAgICAgICAgICAgIHNlbGYuc2Vjb25kRWxlbWVudC5zZXRBdHRyaWJ1dGUoXCJtaW5cIiwgXCIwXCIpO1xuICAgICAgICAgICAgc2VsZi5zZWNvbmRFbGVtZW50LnNldEF0dHJpYnV0ZShcIm1heFwiLCBcIjU5XCIpO1xuICAgICAgICAgICAgc2VsZi5zZWNvbmRFbGVtZW50LnNldEF0dHJpYnV0ZShcIm1heGxlbmd0aFwiLCBcIjJcIik7XG4gICAgICAgICAgICBzZWxmLnRpbWVDb250YWluZXIuYXBwZW5kQ2hpbGQoY3JlYXRlRWxlbWVudChcInNwYW5cIiwgXCJmbGF0cGlja3ItdGltZS1zZXBhcmF0b3JcIiwgXCI6XCIpKTtcbiAgICAgICAgICAgIHNlbGYudGltZUNvbnRhaW5lci5hcHBlbmRDaGlsZChzZWNvbmRJbnB1dCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFzZWxmLmNvbmZpZy50aW1lXzI0aHIpIHtcbiAgICAgICAgICAgIHNlbGYuYW1QTSA9IGNyZWF0ZUVsZW1lbnQoXCJzcGFuXCIsIFwiZmxhdHBpY2tyLWFtLXBtXCIsIHNlbGYubDEwbi5hbVBNW2ludCgoc2VsZi5sYXRlc3RTZWxlY3RlZERhdGVPYmpcbiAgICAgICAgICAgICAgICA/IHNlbGYuaG91ckVsZW1lbnQudmFsdWVcbiAgICAgICAgICAgICAgICA6IHNlbGYuY29uZmlnLmRlZmF1bHRIb3VyKSA+IDExKV0pO1xuICAgICAgICAgICAgc2VsZi5hbVBNLnRpdGxlID0gc2VsZi5sMTBuLnRvZ2dsZVRpdGxlO1xuICAgICAgICAgICAgc2VsZi5hbVBNLnRhYkluZGV4ID0gLTE7XG4gICAgICAgICAgICBzZWxmLnRpbWVDb250YWluZXIuYXBwZW5kQ2hpbGQoc2VsZi5hbVBNKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gc2VsZi50aW1lQ29udGFpbmVyO1xuICAgIH1cbiAgICBmdW5jdGlvbiBidWlsZFdlZWtkYXlzKCkge1xuICAgICAgICBpZiAoIXNlbGYud2Vla2RheUNvbnRhaW5lcilcbiAgICAgICAgICAgIHNlbGYud2Vla2RheUNvbnRhaW5lciA9IGNyZWF0ZUVsZW1lbnQoXCJkaXZcIiwgXCJmbGF0cGlja3Itd2Vla2RheXNcIik7XG4gICAgICAgIGVsc2VcbiAgICAgICAgICAgIGNsZWFyTm9kZShzZWxmLndlZWtkYXlDb250YWluZXIpO1xuICAgICAgICBmb3IgKHZhciBpID0gc2VsZi5jb25maWcuc2hvd01vbnRoczsgaS0tOykge1xuICAgICAgICAgICAgdmFyIGNvbnRhaW5lciA9IGNyZWF0ZUVsZW1lbnQoXCJkaXZcIiwgXCJmbGF0cGlja3Itd2Vla2RheWNvbnRhaW5lclwiKTtcbiAgICAgICAgICAgIHNlbGYud2Vla2RheUNvbnRhaW5lci5hcHBlbmRDaGlsZChjb250YWluZXIpO1xuICAgICAgICB9XG4gICAgICAgIHVwZGF0ZVdlZWtkYXlzKCk7XG4gICAgICAgIHJldHVybiBzZWxmLndlZWtkYXlDb250YWluZXI7XG4gICAgfVxuICAgIGZ1bmN0aW9uIHVwZGF0ZVdlZWtkYXlzKCkge1xuICAgICAgICBpZiAoIXNlbGYud2Vla2RheUNvbnRhaW5lcikge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHZhciBmaXJzdERheU9mV2VlayA9IHNlbGYubDEwbi5maXJzdERheU9mV2VlaztcbiAgICAgICAgdmFyIHdlZWtkYXlzID0gX19zcHJlYWRBcnJheXMoc2VsZi5sMTBuLndlZWtkYXlzLnNob3J0aGFuZCk7XG4gICAgICAgIGlmIChmaXJzdERheU9mV2VlayA+IDAgJiYgZmlyc3REYXlPZldlZWsgPCB3ZWVrZGF5cy5sZW5ndGgpIHtcbiAgICAgICAgICAgIHdlZWtkYXlzID0gX19zcHJlYWRBcnJheXMod2Vla2RheXMuc3BsaWNlKGZpcnN0RGF5T2ZXZWVrLCB3ZWVrZGF5cy5sZW5ndGgpLCB3ZWVrZGF5cy5zcGxpY2UoMCwgZmlyc3REYXlPZldlZWspKTtcbiAgICAgICAgfVxuICAgICAgICBmb3IgKHZhciBpID0gc2VsZi5jb25maWcuc2hvd01vbnRoczsgaS0tOykge1xuICAgICAgICAgICAgc2VsZi53ZWVrZGF5Q29udGFpbmVyLmNoaWxkcmVuW2ldLmlubmVySFRNTCA9IFwiXFxuICAgICAgPHNwYW4gY2xhc3M9J2ZsYXRwaWNrci13ZWVrZGF5Jz5cXG4gICAgICAgIFwiICsgd2Vla2RheXMuam9pbihcIjwvc3Bhbj48c3BhbiBjbGFzcz0nZmxhdHBpY2tyLXdlZWtkYXknPlwiKSArIFwiXFxuICAgICAgPC9zcGFuPlxcbiAgICAgIFwiO1xuICAgICAgICB9XG4gICAgfVxuICAgIGZ1bmN0aW9uIGJ1aWxkV2Vla3MoKSB7XG4gICAgICAgIHNlbGYuY2FsZW5kYXJDb250YWluZXIuY2xhc3NMaXN0LmFkZChcImhhc1dlZWtzXCIpO1xuICAgICAgICB2YXIgd2Vla1dyYXBwZXIgPSBjcmVhdGVFbGVtZW50KFwiZGl2XCIsIFwiZmxhdHBpY2tyLXdlZWt3cmFwcGVyXCIpO1xuICAgICAgICB3ZWVrV3JhcHBlci5hcHBlbmRDaGlsZChjcmVhdGVFbGVtZW50KFwic3BhblwiLCBcImZsYXRwaWNrci13ZWVrZGF5XCIsIHNlbGYubDEwbi53ZWVrQWJicmV2aWF0aW9uKSk7XG4gICAgICAgIHZhciB3ZWVrTnVtYmVycyA9IGNyZWF0ZUVsZW1lbnQoXCJkaXZcIiwgXCJmbGF0cGlja3Itd2Vla3NcIik7XG4gICAgICAgIHdlZWtXcmFwcGVyLmFwcGVuZENoaWxkKHdlZWtOdW1iZXJzKTtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHdlZWtXcmFwcGVyOiB3ZWVrV3JhcHBlcixcbiAgICAgICAgICAgIHdlZWtOdW1iZXJzOiB3ZWVrTnVtYmVycyxcbiAgICAgICAgfTtcbiAgICB9XG4gICAgZnVuY3Rpb24gY2hhbmdlTW9udGgodmFsdWUsIGlzT2Zmc2V0KSB7XG4gICAgICAgIGlmIChpc09mZnNldCA9PT0gdm9pZCAwKSB7IGlzT2Zmc2V0ID0gdHJ1ZTsgfVxuICAgICAgICB2YXIgZGVsdGEgPSBpc09mZnNldCA/IHZhbHVlIDogdmFsdWUgLSBzZWxmLmN1cnJlbnRNb250aDtcbiAgICAgICAgaWYgKChkZWx0YSA8IDAgJiYgc2VsZi5faGlkZVByZXZNb250aEFycm93ID09PSB0cnVlKSB8fFxuICAgICAgICAgICAgKGRlbHRhID4gMCAmJiBzZWxmLl9oaWRlTmV4dE1vbnRoQXJyb3cgPT09IHRydWUpKVxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICBzZWxmLmN1cnJlbnRNb250aCArPSBkZWx0YTtcbiAgICAgICAgaWYgKHNlbGYuY3VycmVudE1vbnRoIDwgMCB8fCBzZWxmLmN1cnJlbnRNb250aCA+IDExKSB7XG4gICAgICAgICAgICBzZWxmLmN1cnJlbnRZZWFyICs9IHNlbGYuY3VycmVudE1vbnRoID4gMTEgPyAxIDogLTE7XG4gICAgICAgICAgICBzZWxmLmN1cnJlbnRNb250aCA9IChzZWxmLmN1cnJlbnRNb250aCArIDEyKSAlIDEyO1xuICAgICAgICAgICAgdHJpZ2dlckV2ZW50KFwib25ZZWFyQ2hhbmdlXCIpO1xuICAgICAgICAgICAgYnVpbGRNb250aFN3aXRjaCgpO1xuICAgICAgICB9XG4gICAgICAgIGJ1aWxkRGF5cygpO1xuICAgICAgICB0cmlnZ2VyRXZlbnQoXCJvbk1vbnRoQ2hhbmdlXCIpO1xuICAgICAgICB1cGRhdGVOYXZpZ2F0aW9uQ3VycmVudE1vbnRoKCk7XG4gICAgfVxuICAgIGZ1bmN0aW9uIGNsZWFyKHRyaWdnZXJDaGFuZ2VFdmVudCwgdG9Jbml0aWFsKSB7XG4gICAgICAgIGlmICh0cmlnZ2VyQ2hhbmdlRXZlbnQgPT09IHZvaWQgMCkgeyB0cmlnZ2VyQ2hhbmdlRXZlbnQgPSB0cnVlOyB9XG4gICAgICAgIGlmICh0b0luaXRpYWwgPT09IHZvaWQgMCkgeyB0b0luaXRpYWwgPSB0cnVlOyB9XG4gICAgICAgIHNlbGYuaW5wdXQudmFsdWUgPSBcIlwiO1xuICAgICAgICBpZiAoc2VsZi5hbHRJbnB1dCAhPT0gdW5kZWZpbmVkKVxuICAgICAgICAgICAgc2VsZi5hbHRJbnB1dC52YWx1ZSA9IFwiXCI7XG4gICAgICAgIGlmIChzZWxmLm1vYmlsZUlucHV0ICE9PSB1bmRlZmluZWQpXG4gICAgICAgICAgICBzZWxmLm1vYmlsZUlucHV0LnZhbHVlID0gXCJcIjtcbiAgICAgICAgc2VsZi5zZWxlY3RlZERhdGVzID0gW107XG4gICAgICAgIHNlbGYubGF0ZXN0U2VsZWN0ZWREYXRlT2JqID0gdW5kZWZpbmVkO1xuICAgICAgICBpZiAodG9Jbml0aWFsID09PSB0cnVlKSB7XG4gICAgICAgICAgICBzZWxmLmN1cnJlbnRZZWFyID0gc2VsZi5faW5pdGlhbERhdGUuZ2V0RnVsbFllYXIoKTtcbiAgICAgICAgICAgIHNlbGYuY3VycmVudE1vbnRoID0gc2VsZi5faW5pdGlhbERhdGUuZ2V0TW9udGgoKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoc2VsZi5jb25maWcuZW5hYmxlVGltZSA9PT0gdHJ1ZSkge1xuICAgICAgICAgICAgdmFyIF9hID0gZ2V0RGVmYXVsdEhvdXJzKHNlbGYuY29uZmlnKSwgaG91cnMgPSBfYS5ob3VycywgbWludXRlcyA9IF9hLm1pbnV0ZXMsIHNlY29uZHMgPSBfYS5zZWNvbmRzO1xuICAgICAgICAgICAgc2V0SG91cnMoaG91cnMsIG1pbnV0ZXMsIHNlY29uZHMpO1xuICAgICAgICB9XG4gICAgICAgIHNlbGYucmVkcmF3KCk7XG4gICAgICAgIGlmICh0cmlnZ2VyQ2hhbmdlRXZlbnQpXG4gICAgICAgICAgICB0cmlnZ2VyRXZlbnQoXCJvbkNoYW5nZVwiKTtcbiAgICB9XG4gICAgZnVuY3Rpb24gY2xvc2UoKSB7XG4gICAgICAgIHNlbGYuaXNPcGVuID0gZmFsc2U7XG4gICAgICAgIGlmICghc2VsZi5pc01vYmlsZSkge1xuICAgICAgICAgICAgaWYgKHNlbGYuY2FsZW5kYXJDb250YWluZXIgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIHNlbGYuY2FsZW5kYXJDb250YWluZXIuY2xhc3NMaXN0LnJlbW92ZShcIm9wZW5cIik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoc2VsZi5faW5wdXQgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIHNlbGYuX2lucHV0LmNsYXNzTGlzdC5yZW1vdmUoXCJhY3RpdmVcIik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdHJpZ2dlckV2ZW50KFwib25DbG9zZVwiKTtcbiAgICB9XG4gICAgZnVuY3Rpb24gZGVzdHJveSgpIHtcbiAgICAgICAgaWYgKHNlbGYuY29uZmlnICE9PSB1bmRlZmluZWQpXG4gICAgICAgICAgICB0cmlnZ2VyRXZlbnQoXCJvbkRlc3Ryb3lcIik7XG4gICAgICAgIGZvciAodmFyIGkgPSBzZWxmLl9oYW5kbGVycy5sZW5ndGg7IGktLTspIHtcbiAgICAgICAgICAgIHNlbGYuX2hhbmRsZXJzW2ldLnJlbW92ZSgpO1xuICAgICAgICB9XG4gICAgICAgIHNlbGYuX2hhbmRsZXJzID0gW107XG4gICAgICAgIGlmIChzZWxmLm1vYmlsZUlucHV0KSB7XG4gICAgICAgICAgICBpZiAoc2VsZi5tb2JpbGVJbnB1dC5wYXJlbnROb2RlKVxuICAgICAgICAgICAgICAgIHNlbGYubW9iaWxlSW5wdXQucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChzZWxmLm1vYmlsZUlucHV0KTtcbiAgICAgICAgICAgIHNlbGYubW9iaWxlSW5wdXQgPSB1bmRlZmluZWQ7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoc2VsZi5jYWxlbmRhckNvbnRhaW5lciAmJiBzZWxmLmNhbGVuZGFyQ29udGFpbmVyLnBhcmVudE5vZGUpIHtcbiAgICAgICAgICAgIGlmIChzZWxmLmNvbmZpZy5zdGF0aWMgJiYgc2VsZi5jYWxlbmRhckNvbnRhaW5lci5wYXJlbnROb2RlKSB7XG4gICAgICAgICAgICAgICAgdmFyIHdyYXBwZXIgPSBzZWxmLmNhbGVuZGFyQ29udGFpbmVyLnBhcmVudE5vZGU7XG4gICAgICAgICAgICAgICAgd3JhcHBlci5sYXN0Q2hpbGQgJiYgd3JhcHBlci5yZW1vdmVDaGlsZCh3cmFwcGVyLmxhc3RDaGlsZCk7XG4gICAgICAgICAgICAgICAgaWYgKHdyYXBwZXIucGFyZW50Tm9kZSkge1xuICAgICAgICAgICAgICAgICAgICB3aGlsZSAod3JhcHBlci5maXJzdENoaWxkKVxuICAgICAgICAgICAgICAgICAgICAgICAgd3JhcHBlci5wYXJlbnROb2RlLmluc2VydEJlZm9yZSh3cmFwcGVyLmZpcnN0Q2hpbGQsIHdyYXBwZXIpO1xuICAgICAgICAgICAgICAgICAgICB3cmFwcGVyLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQod3JhcHBlcik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgIHNlbGYuY2FsZW5kYXJDb250YWluZXIucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChzZWxmLmNhbGVuZGFyQ29udGFpbmVyKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoc2VsZi5hbHRJbnB1dCkge1xuICAgICAgICAgICAgc2VsZi5pbnB1dC50eXBlID0gXCJ0ZXh0XCI7XG4gICAgICAgICAgICBpZiAoc2VsZi5hbHRJbnB1dC5wYXJlbnROb2RlKVxuICAgICAgICAgICAgICAgIHNlbGYuYWx0SW5wdXQucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChzZWxmLmFsdElucHV0KTtcbiAgICAgICAgICAgIGRlbGV0ZSBzZWxmLmFsdElucHV0O1xuICAgICAgICB9XG4gICAgICAgIGlmIChzZWxmLmlucHV0KSB7XG4gICAgICAgICAgICBzZWxmLmlucHV0LnR5cGUgPSBzZWxmLmlucHV0Ll90eXBlO1xuICAgICAgICAgICAgc2VsZi5pbnB1dC5jbGFzc0xpc3QucmVtb3ZlKFwiZmxhdHBpY2tyLWlucHV0XCIpO1xuICAgICAgICAgICAgc2VsZi5pbnB1dC5yZW1vdmVBdHRyaWJ1dGUoXCJyZWFkb25seVwiKTtcbiAgICAgICAgfVxuICAgICAgICBbXG4gICAgICAgICAgICBcIl9zaG93VGltZUlucHV0XCIsXG4gICAgICAgICAgICBcImxhdGVzdFNlbGVjdGVkRGF0ZU9ialwiLFxuICAgICAgICAgICAgXCJfaGlkZU5leHRNb250aEFycm93XCIsXG4gICAgICAgICAgICBcIl9oaWRlUHJldk1vbnRoQXJyb3dcIixcbiAgICAgICAgICAgIFwiX19oaWRlTmV4dE1vbnRoQXJyb3dcIixcbiAgICAgICAgICAgIFwiX19oaWRlUHJldk1vbnRoQXJyb3dcIixcbiAgICAgICAgICAgIFwiaXNNb2JpbGVcIixcbiAgICAgICAgICAgIFwiaXNPcGVuXCIsXG4gICAgICAgICAgICBcInNlbGVjdGVkRGF0ZUVsZW1cIixcbiAgICAgICAgICAgIFwibWluRGF0ZUhhc1RpbWVcIixcbiAgICAgICAgICAgIFwibWF4RGF0ZUhhc1RpbWVcIixcbiAgICAgICAgICAgIFwiZGF5c1wiLFxuICAgICAgICAgICAgXCJkYXlzQ29udGFpbmVyXCIsXG4gICAgICAgICAgICBcIl9pbnB1dFwiLFxuICAgICAgICAgICAgXCJfcG9zaXRpb25FbGVtZW50XCIsXG4gICAgICAgICAgICBcImlubmVyQ29udGFpbmVyXCIsXG4gICAgICAgICAgICBcInJDb250YWluZXJcIixcbiAgICAgICAgICAgIFwibW9udGhOYXZcIixcbiAgICAgICAgICAgIFwidG9kYXlEYXRlRWxlbVwiLFxuICAgICAgICAgICAgXCJjYWxlbmRhckNvbnRhaW5lclwiLFxuICAgICAgICAgICAgXCJ3ZWVrZGF5Q29udGFpbmVyXCIsXG4gICAgICAgICAgICBcInByZXZNb250aE5hdlwiLFxuICAgICAgICAgICAgXCJuZXh0TW9udGhOYXZcIixcbiAgICAgICAgICAgIFwibW9udGhzRHJvcGRvd25Db250YWluZXJcIixcbiAgICAgICAgICAgIFwiY3VycmVudE1vbnRoRWxlbWVudFwiLFxuICAgICAgICAgICAgXCJjdXJyZW50WWVhckVsZW1lbnRcIixcbiAgICAgICAgICAgIFwibmF2aWdhdGlvbkN1cnJlbnRNb250aFwiLFxuICAgICAgICAgICAgXCJzZWxlY3RlZERhdGVFbGVtXCIsXG4gICAgICAgICAgICBcImNvbmZpZ1wiLFxuICAgICAgICBdLmZvckVhY2goZnVuY3Rpb24gKGspIHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgZGVsZXRlIHNlbGZba107XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXRjaCAoXykgeyB9XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBmdW5jdGlvbiBpc0NhbGVuZGFyRWxlbShlbGVtKSB7XG4gICAgICAgIHJldHVybiBzZWxmLmNhbGVuZGFyQ29udGFpbmVyLmNvbnRhaW5zKGVsZW0pO1xuICAgIH1cbiAgICBmdW5jdGlvbiBkb2N1bWVudENsaWNrKGUpIHtcbiAgICAgICAgaWYgKHNlbGYuaXNPcGVuICYmICFzZWxmLmNvbmZpZy5pbmxpbmUpIHtcbiAgICAgICAgICAgIHZhciBldmVudFRhcmdldF8xID0gZ2V0RXZlbnRUYXJnZXQoZSk7XG4gICAgICAgICAgICB2YXIgaXNDYWxlbmRhckVsZW1lbnQgPSBpc0NhbGVuZGFyRWxlbShldmVudFRhcmdldF8xKTtcbiAgICAgICAgICAgIHZhciBpc0lucHV0ID0gZXZlbnRUYXJnZXRfMSA9PT0gc2VsZi5pbnB1dCB8fFxuICAgICAgICAgICAgICAgIGV2ZW50VGFyZ2V0XzEgPT09IHNlbGYuYWx0SW5wdXQgfHxcbiAgICAgICAgICAgICAgICBzZWxmLmVsZW1lbnQuY29udGFpbnMoZXZlbnRUYXJnZXRfMSkgfHxcbiAgICAgICAgICAgICAgICAoZS5wYXRoICYmXG4gICAgICAgICAgICAgICAgICAgIGUucGF0aC5pbmRleE9mICYmXG4gICAgICAgICAgICAgICAgICAgICh+ZS5wYXRoLmluZGV4T2Yoc2VsZi5pbnB1dCkgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgIH5lLnBhdGguaW5kZXhPZihzZWxmLmFsdElucHV0KSkpO1xuICAgICAgICAgICAgdmFyIGxvc3RGb2N1cyA9ICFpc0lucHV0ICYmXG4gICAgICAgICAgICAgICAgIWlzQ2FsZW5kYXJFbGVtZW50ICYmXG4gICAgICAgICAgICAgICAgIWlzQ2FsZW5kYXJFbGVtKGUucmVsYXRlZFRhcmdldCk7XG4gICAgICAgICAgICB2YXIgaXNJZ25vcmVkID0gIXNlbGYuY29uZmlnLmlnbm9yZWRGb2N1c0VsZW1lbnRzLnNvbWUoZnVuY3Rpb24gKGVsZW0pIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZWxlbS5jb250YWlucyhldmVudFRhcmdldF8xKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgaWYgKGxvc3RGb2N1cyAmJiBpc0lnbm9yZWQpIHtcbiAgICAgICAgICAgICAgICBpZiAoc2VsZi5jb25maWcuYWxsb3dJbnB1dCkge1xuICAgICAgICAgICAgICAgICAgICBzZWxmLnNldERhdGUoc2VsZi5faW5wdXQudmFsdWUsIGZhbHNlLCBzZWxmLmNvbmZpZy5hbHRJbnB1dFxuICAgICAgICAgICAgICAgICAgICAgICAgPyBzZWxmLmNvbmZpZy5hbHRGb3JtYXRcbiAgICAgICAgICAgICAgICAgICAgICAgIDogc2VsZi5jb25maWcuZGF0ZUZvcm1hdCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChzZWxmLnRpbWVDb250YWluZXIgIT09IHVuZGVmaW5lZCAmJlxuICAgICAgICAgICAgICAgICAgICBzZWxmLm1pbnV0ZUVsZW1lbnQgIT09IHVuZGVmaW5lZCAmJlxuICAgICAgICAgICAgICAgICAgICBzZWxmLmhvdXJFbGVtZW50ICE9PSB1bmRlZmluZWQgJiZcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5pbnB1dC52YWx1ZSAhPT0gXCJcIiAmJlxuICAgICAgICAgICAgICAgICAgICBzZWxmLmlucHV0LnZhbHVlICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgdXBkYXRlVGltZSgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBzZWxmLmNsb3NlKCk7XG4gICAgICAgICAgICAgICAgaWYgKHNlbGYuY29uZmlnICYmXG4gICAgICAgICAgICAgICAgICAgIHNlbGYuY29uZmlnLm1vZGUgPT09IFwicmFuZ2VcIiAmJlxuICAgICAgICAgICAgICAgICAgICBzZWxmLnNlbGVjdGVkRGF0ZXMubGVuZ3RoID09PSAxKVxuICAgICAgICAgICAgICAgICAgICBzZWxmLmNsZWFyKGZhbHNlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBmdW5jdGlvbiBjaGFuZ2VZZWFyKG5ld1llYXIpIHtcbiAgICAgICAgaWYgKCFuZXdZZWFyIHx8XG4gICAgICAgICAgICAoc2VsZi5jb25maWcubWluRGF0ZSAmJiBuZXdZZWFyIDwgc2VsZi5jb25maWcubWluRGF0ZS5nZXRGdWxsWWVhcigpKSB8fFxuICAgICAgICAgICAgKHNlbGYuY29uZmlnLm1heERhdGUgJiYgbmV3WWVhciA+IHNlbGYuY29uZmlnLm1heERhdGUuZ2V0RnVsbFllYXIoKSkpXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIHZhciBuZXdZZWFyTnVtID0gbmV3WWVhciwgaXNOZXdZZWFyID0gc2VsZi5jdXJyZW50WWVhciAhPT0gbmV3WWVhck51bTtcbiAgICAgICAgc2VsZi5jdXJyZW50WWVhciA9IG5ld1llYXJOdW0gfHwgc2VsZi5jdXJyZW50WWVhcjtcbiAgICAgICAgaWYgKHNlbGYuY29uZmlnLm1heERhdGUgJiZcbiAgICAgICAgICAgIHNlbGYuY3VycmVudFllYXIgPT09IHNlbGYuY29uZmlnLm1heERhdGUuZ2V0RnVsbFllYXIoKSkge1xuICAgICAgICAgICAgc2VsZi5jdXJyZW50TW9udGggPSBNYXRoLm1pbihzZWxmLmNvbmZpZy5tYXhEYXRlLmdldE1vbnRoKCksIHNlbGYuY3VycmVudE1vbnRoKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChzZWxmLmNvbmZpZy5taW5EYXRlICYmXG4gICAgICAgICAgICBzZWxmLmN1cnJlbnRZZWFyID09PSBzZWxmLmNvbmZpZy5taW5EYXRlLmdldEZ1bGxZZWFyKCkpIHtcbiAgICAgICAgICAgIHNlbGYuY3VycmVudE1vbnRoID0gTWF0aC5tYXgoc2VsZi5jb25maWcubWluRGF0ZS5nZXRNb250aCgpLCBzZWxmLmN1cnJlbnRNb250aCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGlzTmV3WWVhcikge1xuICAgICAgICAgICAgc2VsZi5yZWRyYXcoKTtcbiAgICAgICAgICAgIHRyaWdnZXJFdmVudChcIm9uWWVhckNoYW5nZVwiKTtcbiAgICAgICAgICAgIGJ1aWxkTW9udGhTd2l0Y2goKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBmdW5jdGlvbiBpc0VuYWJsZWQoZGF0ZSwgdGltZWxlc3MpIHtcbiAgICAgICAgdmFyIF9hO1xuICAgICAgICBpZiAodGltZWxlc3MgPT09IHZvaWQgMCkgeyB0aW1lbGVzcyA9IHRydWU7IH1cbiAgICAgICAgdmFyIGRhdGVUb0NoZWNrID0gc2VsZi5wYXJzZURhdGUoZGF0ZSwgdW5kZWZpbmVkLCB0aW1lbGVzcyk7XG4gICAgICAgIGlmICgoc2VsZi5jb25maWcubWluRGF0ZSAmJlxuICAgICAgICAgICAgZGF0ZVRvQ2hlY2sgJiZcbiAgICAgICAgICAgIGNvbXBhcmVEYXRlcyhkYXRlVG9DaGVjaywgc2VsZi5jb25maWcubWluRGF0ZSwgdGltZWxlc3MgIT09IHVuZGVmaW5lZCA/IHRpbWVsZXNzIDogIXNlbGYubWluRGF0ZUhhc1RpbWUpIDwgMCkgfHxcbiAgICAgICAgICAgIChzZWxmLmNvbmZpZy5tYXhEYXRlICYmXG4gICAgICAgICAgICAgICAgZGF0ZVRvQ2hlY2sgJiZcbiAgICAgICAgICAgICAgICBjb21wYXJlRGF0ZXMoZGF0ZVRvQ2hlY2ssIHNlbGYuY29uZmlnLm1heERhdGUsIHRpbWVsZXNzICE9PSB1bmRlZmluZWQgPyB0aW1lbGVzcyA6ICFzZWxmLm1heERhdGVIYXNUaW1lKSA+IDApKVxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICBpZiAoIXNlbGYuY29uZmlnLmVuYWJsZSAmJiBzZWxmLmNvbmZpZy5kaXNhYmxlLmxlbmd0aCA9PT0gMClcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICBpZiAoZGF0ZVRvQ2hlY2sgPT09IHVuZGVmaW5lZClcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgdmFyIGJvb2wgPSAhIXNlbGYuY29uZmlnLmVuYWJsZSwgYXJyYXkgPSAoX2EgPSBzZWxmLmNvbmZpZy5lbmFibGUpICE9PSBudWxsICYmIF9hICE9PSB2b2lkIDAgPyBfYSA6IHNlbGYuY29uZmlnLmRpc2FibGU7XG4gICAgICAgIGZvciAodmFyIGkgPSAwLCBkID0gdm9pZCAwOyBpIDwgYXJyYXkubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGQgPSBhcnJheVtpXTtcbiAgICAgICAgICAgIGlmICh0eXBlb2YgZCA9PT0gXCJmdW5jdGlvblwiICYmXG4gICAgICAgICAgICAgICAgZChkYXRlVG9DaGVjaykpXG4gICAgICAgICAgICAgICAgcmV0dXJuIGJvb2w7XG4gICAgICAgICAgICBlbHNlIGlmIChkIGluc3RhbmNlb2YgRGF0ZSAmJlxuICAgICAgICAgICAgICAgIGRhdGVUb0NoZWNrICE9PSB1bmRlZmluZWQgJiZcbiAgICAgICAgICAgICAgICBkLmdldFRpbWUoKSA9PT0gZGF0ZVRvQ2hlY2suZ2V0VGltZSgpKVxuICAgICAgICAgICAgICAgIHJldHVybiBib29sO1xuICAgICAgICAgICAgZWxzZSBpZiAodHlwZW9mIGQgPT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgICAgICAgICB2YXIgcGFyc2VkID0gc2VsZi5wYXJzZURhdGUoZCwgdW5kZWZpbmVkLCB0cnVlKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gcGFyc2VkICYmIHBhcnNlZC5nZXRUaW1lKCkgPT09IGRhdGVUb0NoZWNrLmdldFRpbWUoKVxuICAgICAgICAgICAgICAgICAgICA/IGJvb2xcbiAgICAgICAgICAgICAgICAgICAgOiAhYm9vbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKHR5cGVvZiBkID09PSBcIm9iamVjdFwiICYmXG4gICAgICAgICAgICAgICAgZGF0ZVRvQ2hlY2sgIT09IHVuZGVmaW5lZCAmJlxuICAgICAgICAgICAgICAgIGQuZnJvbSAmJlxuICAgICAgICAgICAgICAgIGQudG8gJiZcbiAgICAgICAgICAgICAgICBkYXRlVG9DaGVjay5nZXRUaW1lKCkgPj0gZC5mcm9tLmdldFRpbWUoKSAmJlxuICAgICAgICAgICAgICAgIGRhdGVUb0NoZWNrLmdldFRpbWUoKSA8PSBkLnRvLmdldFRpbWUoKSlcbiAgICAgICAgICAgICAgICByZXR1cm4gYm9vbDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gIWJvb2w7XG4gICAgfVxuICAgIGZ1bmN0aW9uIGlzSW5WaWV3KGVsZW0pIHtcbiAgICAgICAgaWYgKHNlbGYuZGF5c0NvbnRhaW5lciAhPT0gdW5kZWZpbmVkKVxuICAgICAgICAgICAgcmV0dXJuIChlbGVtLmNsYXNzTmFtZS5pbmRleE9mKFwiaGlkZGVuXCIpID09PSAtMSAmJlxuICAgICAgICAgICAgICAgIGVsZW0uY2xhc3NOYW1lLmluZGV4T2YoXCJmbGF0cGlja3ItZGlzYWJsZWRcIikgPT09IC0xICYmXG4gICAgICAgICAgICAgICAgc2VsZi5kYXlzQ29udGFpbmVyLmNvbnRhaW5zKGVsZW0pKTtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICBmdW5jdGlvbiBvbkJsdXIoZSkge1xuICAgICAgICB2YXIgaXNJbnB1dCA9IGUudGFyZ2V0ID09PSBzZWxmLl9pbnB1dDtcbiAgICAgICAgdmFyIHZhbHVlQ2hhbmdlZCA9IHNlbGYuX2lucHV0LnZhbHVlLnRyaW1FbmQoKSAhPT0gZ2V0RGF0ZVN0cigpO1xuICAgICAgICBpZiAoaXNJbnB1dCAmJlxuICAgICAgICAgICAgdmFsdWVDaGFuZ2VkICYmXG4gICAgICAgICAgICAhKGUucmVsYXRlZFRhcmdldCAmJiBpc0NhbGVuZGFyRWxlbShlLnJlbGF0ZWRUYXJnZXQpKSkge1xuICAgICAgICAgICAgc2VsZi5zZXREYXRlKHNlbGYuX2lucHV0LnZhbHVlLCB0cnVlLCBlLnRhcmdldCA9PT0gc2VsZi5hbHRJbnB1dFxuICAgICAgICAgICAgICAgID8gc2VsZi5jb25maWcuYWx0Rm9ybWF0XG4gICAgICAgICAgICAgICAgOiBzZWxmLmNvbmZpZy5kYXRlRm9ybWF0KTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBmdW5jdGlvbiBvbktleURvd24oZSkge1xuICAgICAgICB2YXIgZXZlbnRUYXJnZXQgPSBnZXRFdmVudFRhcmdldChlKTtcbiAgICAgICAgdmFyIGlzSW5wdXQgPSBzZWxmLmNvbmZpZy53cmFwXG4gICAgICAgICAgICA/IGVsZW1lbnQuY29udGFpbnMoZXZlbnRUYXJnZXQpXG4gICAgICAgICAgICA6IGV2ZW50VGFyZ2V0ID09PSBzZWxmLl9pbnB1dDtcbiAgICAgICAgdmFyIGFsbG93SW5wdXQgPSBzZWxmLmNvbmZpZy5hbGxvd0lucHV0O1xuICAgICAgICB2YXIgYWxsb3dLZXlkb3duID0gc2VsZi5pc09wZW4gJiYgKCFhbGxvd0lucHV0IHx8ICFpc0lucHV0KTtcbiAgICAgICAgdmFyIGFsbG93SW5saW5lS2V5ZG93biA9IHNlbGYuY29uZmlnLmlubGluZSAmJiBpc0lucHV0ICYmICFhbGxvd0lucHV0O1xuICAgICAgICBpZiAoZS5rZXlDb2RlID09PSAxMyAmJiBpc0lucHV0KSB7XG4gICAgICAgICAgICBpZiAoYWxsb3dJbnB1dCkge1xuICAgICAgICAgICAgICAgIHNlbGYuc2V0RGF0ZShzZWxmLl9pbnB1dC52YWx1ZSwgdHJ1ZSwgZXZlbnRUYXJnZXQgPT09IHNlbGYuYWx0SW5wdXRcbiAgICAgICAgICAgICAgICAgICAgPyBzZWxmLmNvbmZpZy5hbHRGb3JtYXRcbiAgICAgICAgICAgICAgICAgICAgOiBzZWxmLmNvbmZpZy5kYXRlRm9ybWF0KTtcbiAgICAgICAgICAgICAgICBzZWxmLmNsb3NlKCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGV2ZW50VGFyZ2V0LmJsdXIoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHNlbGYub3BlbigpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGlzQ2FsZW5kYXJFbGVtKGV2ZW50VGFyZ2V0KSB8fFxuICAgICAgICAgICAgYWxsb3dLZXlkb3duIHx8XG4gICAgICAgICAgICBhbGxvd0lubGluZUtleWRvd24pIHtcbiAgICAgICAgICAgIHZhciBpc1RpbWVPYmogPSAhIXNlbGYudGltZUNvbnRhaW5lciAmJlxuICAgICAgICAgICAgICAgIHNlbGYudGltZUNvbnRhaW5lci5jb250YWlucyhldmVudFRhcmdldCk7XG4gICAgICAgICAgICBzd2l0Y2ggKGUua2V5Q29kZSkge1xuICAgICAgICAgICAgICAgIGNhc2UgMTM6XG4gICAgICAgICAgICAgICAgICAgIGlmIChpc1RpbWVPYmopIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHVwZGF0ZVRpbWUoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvY3VzQW5kQ2xvc2UoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3REYXRlKGUpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIDI3OlxuICAgICAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgICAgIGZvY3VzQW5kQ2xvc2UoKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSA4OlxuICAgICAgICAgICAgICAgIGNhc2UgNDY6XG4gICAgICAgICAgICAgICAgICAgIGlmIChpc0lucHV0ICYmICFzZWxmLmNvbmZpZy5hbGxvd0lucHV0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmNsZWFyKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAzNzpcbiAgICAgICAgICAgICAgICBjYXNlIDM5OlxuICAgICAgICAgICAgICAgICAgICBpZiAoIWlzVGltZU9iaiAmJiAhaXNJbnB1dCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFjdGl2ZUVsZW1lbnQgPSBnZXRDbG9zZXN0QWN0aXZlRWxlbWVudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNlbGYuZGF5c0NvbnRhaW5lciAhPT0gdW5kZWZpbmVkICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKGFsbG93SW5wdXQgPT09IGZhbHNlIHx8XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIChhY3RpdmVFbGVtZW50ICYmIGlzSW5WaWV3KGFjdGl2ZUVsZW1lbnQpKSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZGVsdGFfMSA9IGUua2V5Q29kZSA9PT0gMzkgPyAxIDogLTE7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFlLmN0cmxLZXkpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvY3VzT25EYXkodW5kZWZpbmVkLCBkZWx0YV8xKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2hhbmdlTW9udGgoZGVsdGFfMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvY3VzT25EYXkoZ2V0Rmlyc3RBdmFpbGFibGVEYXkoMSksIDApO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIGlmIChzZWxmLmhvdXJFbGVtZW50KVxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5ob3VyRWxlbWVudC5mb2N1cygpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIDM4OlxuICAgICAgICAgICAgICAgIGNhc2UgNDA6XG4gICAgICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGRlbHRhID0gZS5rZXlDb2RlID09PSA0MCA/IDEgOiAtMTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKChzZWxmLmRheXNDb250YWluZXIgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgIGV2ZW50VGFyZ2V0LiRpICE9PSB1bmRlZmluZWQpIHx8XG4gICAgICAgICAgICAgICAgICAgICAgICBldmVudFRhcmdldCA9PT0gc2VsZi5pbnB1dCB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgZXZlbnRUYXJnZXQgPT09IHNlbGYuYWx0SW5wdXQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlLmN0cmxLZXkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoYW5nZVllYXIoc2VsZi5jdXJyZW50WWVhciAtIGRlbHRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb2N1c09uRGF5KGdldEZpcnN0QXZhaWxhYmxlRGF5KDEpLCAwKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKCFpc1RpbWVPYmopXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9jdXNPbkRheSh1bmRlZmluZWQsIGRlbHRhICogNyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAoZXZlbnRUYXJnZXQgPT09IHNlbGYuY3VycmVudFllYXJFbGVtZW50KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjaGFuZ2VZZWFyKHNlbGYuY3VycmVudFllYXIgLSBkZWx0YSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAoc2VsZi5jb25maWcuZW5hYmxlVGltZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFpc1RpbWVPYmogJiYgc2VsZi5ob3VyRWxlbWVudClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmhvdXJFbGVtZW50LmZvY3VzKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB1cGRhdGVUaW1lKGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5fZGVib3VuY2VkQ2hhbmdlKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSA5OlxuICAgICAgICAgICAgICAgICAgICBpZiAoaXNUaW1lT2JqKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZWxlbXMgPSBbXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5ob3VyRWxlbWVudCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLm1pbnV0ZUVsZW1lbnQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5zZWNvbmRFbGVtZW50LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuYW1QTSxcbiAgICAgICAgICAgICAgICAgICAgICAgIF1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuY29uY2F0KHNlbGYucGx1Z2luRWxlbWVudHMpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLmZpbHRlcihmdW5jdGlvbiAoeCkgeyByZXR1cm4geDsgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgaSA9IGVsZW1zLmluZGV4T2YoZXZlbnRUYXJnZXQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGkgIT09IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRhcmdldCA9IGVsZW1zW2kgKyAoZS5zaGlmdEtleSA/IC0xIDogMSldO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAodGFyZ2V0IHx8IHNlbGYuX2lucHV0KS5mb2N1cygpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKCFzZWxmLmNvbmZpZy5ub0NhbGVuZGFyICYmXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmRheXNDb250YWluZXIgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuZGF5c0NvbnRhaW5lci5jb250YWlucyhldmVudFRhcmdldCkgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgIGUuc2hpZnRLZXkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuX2lucHV0LmZvY3VzKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHNlbGYuYW1QTSAhPT0gdW5kZWZpbmVkICYmIGV2ZW50VGFyZ2V0ID09PSBzZWxmLmFtUE0pIHtcbiAgICAgICAgICAgIHN3aXRjaCAoZS5rZXkpIHtcbiAgICAgICAgICAgICAgICBjYXNlIHNlbGYubDEwbi5hbVBNWzBdLmNoYXJBdCgwKTpcbiAgICAgICAgICAgICAgICBjYXNlIHNlbGYubDEwbi5hbVBNWzBdLmNoYXJBdCgwKS50b0xvd2VyQ2FzZSgpOlxuICAgICAgICAgICAgICAgICAgICBzZWxmLmFtUE0udGV4dENvbnRlbnQgPSBzZWxmLmwxMG4uYW1QTVswXTtcbiAgICAgICAgICAgICAgICAgICAgc2V0SG91cnNGcm9tSW5wdXRzKCk7XG4gICAgICAgICAgICAgICAgICAgIHVwZGF0ZVZhbHVlKCk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2Ugc2VsZi5sMTBuLmFtUE1bMV0uY2hhckF0KDApOlxuICAgICAgICAgICAgICAgIGNhc2Ugc2VsZi5sMTBuLmFtUE1bMV0uY2hhckF0KDApLnRvTG93ZXJDYXNlKCk6XG4gICAgICAgICAgICAgICAgICAgIHNlbGYuYW1QTS50ZXh0Q29udGVudCA9IHNlbGYubDEwbi5hbVBNWzFdO1xuICAgICAgICAgICAgICAgICAgICBzZXRIb3Vyc0Zyb21JbnB1dHMoKTtcbiAgICAgICAgICAgICAgICAgICAgdXBkYXRlVmFsdWUoKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGlzSW5wdXQgfHwgaXNDYWxlbmRhckVsZW0oZXZlbnRUYXJnZXQpKSB7XG4gICAgICAgICAgICB0cmlnZ2VyRXZlbnQoXCJvbktleURvd25cIiwgZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZnVuY3Rpb24gb25Nb3VzZU92ZXIoZWxlbSwgY2VsbENsYXNzKSB7XG4gICAgICAgIGlmIChjZWxsQ2xhc3MgPT09IHZvaWQgMCkgeyBjZWxsQ2xhc3MgPSBcImZsYXRwaWNrci1kYXlcIjsgfVxuICAgICAgICBpZiAoc2VsZi5zZWxlY3RlZERhdGVzLmxlbmd0aCAhPT0gMSB8fFxuICAgICAgICAgICAgKGVsZW0gJiZcbiAgICAgICAgICAgICAgICAoIWVsZW0uY2xhc3NMaXN0LmNvbnRhaW5zKGNlbGxDbGFzcykgfHxcbiAgICAgICAgICAgICAgICAgICAgZWxlbS5jbGFzc0xpc3QuY29udGFpbnMoXCJmbGF0cGlja3ItZGlzYWJsZWRcIikpKSlcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgdmFyIGhvdmVyRGF0ZSA9IGVsZW1cbiAgICAgICAgICAgID8gZWxlbS5kYXRlT2JqLmdldFRpbWUoKVxuICAgICAgICAgICAgOiBzZWxmLmRheXMuZmlyc3RFbGVtZW50Q2hpbGQuZGF0ZU9iai5nZXRUaW1lKCksIGluaXRpYWxEYXRlID0gc2VsZi5wYXJzZURhdGUoc2VsZi5zZWxlY3RlZERhdGVzWzBdLCB1bmRlZmluZWQsIHRydWUpLmdldFRpbWUoKSwgcmFuZ2VTdGFydERhdGUgPSBNYXRoLm1pbihob3ZlckRhdGUsIHNlbGYuc2VsZWN0ZWREYXRlc1swXS5nZXRUaW1lKCkpLCByYW5nZUVuZERhdGUgPSBNYXRoLm1heChob3ZlckRhdGUsIHNlbGYuc2VsZWN0ZWREYXRlc1swXS5nZXRUaW1lKCkpO1xuICAgICAgICB2YXIgY29udGFpbnNEaXNhYmxlZCA9IGZhbHNlO1xuICAgICAgICB2YXIgbWluUmFuZ2UgPSAwLCBtYXhSYW5nZSA9IDA7XG4gICAgICAgIGZvciAodmFyIHQgPSByYW5nZVN0YXJ0RGF0ZTsgdCA8IHJhbmdlRW5kRGF0ZTsgdCArPSBkdXJhdGlvbi5EQVkpIHtcbiAgICAgICAgICAgIGlmICghaXNFbmFibGVkKG5ldyBEYXRlKHQpLCB0cnVlKSkge1xuICAgICAgICAgICAgICAgIGNvbnRhaW5zRGlzYWJsZWQgPVxuICAgICAgICAgICAgICAgICAgICBjb250YWluc0Rpc2FibGVkIHx8ICh0ID4gcmFuZ2VTdGFydERhdGUgJiYgdCA8IHJhbmdlRW5kRGF0ZSk7XG4gICAgICAgICAgICAgICAgaWYgKHQgPCBpbml0aWFsRGF0ZSAmJiAoIW1pblJhbmdlIHx8IHQgPiBtaW5SYW5nZSkpXG4gICAgICAgICAgICAgICAgICAgIG1pblJhbmdlID0gdDtcbiAgICAgICAgICAgICAgICBlbHNlIGlmICh0ID4gaW5pdGlhbERhdGUgJiYgKCFtYXhSYW5nZSB8fCB0IDwgbWF4UmFuZ2UpKVxuICAgICAgICAgICAgICAgICAgICBtYXhSYW5nZSA9IHQ7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGhvdmVyYWJsZUNlbGxzID0gQXJyYXkuZnJvbShzZWxmLnJDb250YWluZXIucXVlcnlTZWxlY3RvckFsbChcIio6bnRoLWNoaWxkKC1uK1wiICsgc2VsZi5jb25maWcuc2hvd01vbnRocyArIFwiKSA+IC5cIiArIGNlbGxDbGFzcykpO1xuICAgICAgICBob3ZlcmFibGVDZWxscy5mb3JFYWNoKGZ1bmN0aW9uIChkYXlFbGVtKSB7XG4gICAgICAgICAgICB2YXIgZGF0ZSA9IGRheUVsZW0uZGF0ZU9iajtcbiAgICAgICAgICAgIHZhciB0aW1lc3RhbXAgPSBkYXRlLmdldFRpbWUoKTtcbiAgICAgICAgICAgIHZhciBvdXRPZlJhbmdlID0gKG1pblJhbmdlID4gMCAmJiB0aW1lc3RhbXAgPCBtaW5SYW5nZSkgfHxcbiAgICAgICAgICAgICAgICAobWF4UmFuZ2UgPiAwICYmIHRpbWVzdGFtcCA+IG1heFJhbmdlKTtcbiAgICAgICAgICAgIGlmIChvdXRPZlJhbmdlKSB7XG4gICAgICAgICAgICAgICAgZGF5RWxlbS5jbGFzc0xpc3QuYWRkKFwibm90QWxsb3dlZFwiKTtcbiAgICAgICAgICAgICAgICBbXCJpblJhbmdlXCIsIFwic3RhcnRSYW5nZVwiLCBcImVuZFJhbmdlXCJdLmZvckVhY2goZnVuY3Rpb24gKGMpIHtcbiAgICAgICAgICAgICAgICAgICAgZGF5RWxlbS5jbGFzc0xpc3QucmVtb3ZlKGMpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKGNvbnRhaW5zRGlzYWJsZWQgJiYgIW91dE9mUmFuZ2UpXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgW1wic3RhcnRSYW5nZVwiLCBcImluUmFuZ2VcIiwgXCJlbmRSYW5nZVwiLCBcIm5vdEFsbG93ZWRcIl0uZm9yRWFjaChmdW5jdGlvbiAoYykge1xuICAgICAgICAgICAgICAgIGRheUVsZW0uY2xhc3NMaXN0LnJlbW92ZShjKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgaWYgKGVsZW0gIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIGVsZW0uY2xhc3NMaXN0LmFkZChob3ZlckRhdGUgPD0gc2VsZi5zZWxlY3RlZERhdGVzWzBdLmdldFRpbWUoKVxuICAgICAgICAgICAgICAgICAgICA/IFwic3RhcnRSYW5nZVwiXG4gICAgICAgICAgICAgICAgICAgIDogXCJlbmRSYW5nZVwiKTtcbiAgICAgICAgICAgICAgICBpZiAoaW5pdGlhbERhdGUgPCBob3ZlckRhdGUgJiYgdGltZXN0YW1wID09PSBpbml0aWFsRGF0ZSlcbiAgICAgICAgICAgICAgICAgICAgZGF5RWxlbS5jbGFzc0xpc3QuYWRkKFwic3RhcnRSYW5nZVwiKTtcbiAgICAgICAgICAgICAgICBlbHNlIGlmIChpbml0aWFsRGF0ZSA+IGhvdmVyRGF0ZSAmJiB0aW1lc3RhbXAgPT09IGluaXRpYWxEYXRlKVxuICAgICAgICAgICAgICAgICAgICBkYXlFbGVtLmNsYXNzTGlzdC5hZGQoXCJlbmRSYW5nZVwiKTtcbiAgICAgICAgICAgICAgICBpZiAodGltZXN0YW1wID49IG1pblJhbmdlICYmXG4gICAgICAgICAgICAgICAgICAgIChtYXhSYW5nZSA9PT0gMCB8fCB0aW1lc3RhbXAgPD0gbWF4UmFuZ2UpICYmXG4gICAgICAgICAgICAgICAgICAgIGlzQmV0d2Vlbih0aW1lc3RhbXAsIGluaXRpYWxEYXRlLCBob3ZlckRhdGUpKVxuICAgICAgICAgICAgICAgICAgICBkYXlFbGVtLmNsYXNzTGlzdC5hZGQoXCJpblJhbmdlXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG4gICAgZnVuY3Rpb24gb25SZXNpemUoKSB7XG4gICAgICAgIGlmIChzZWxmLmlzT3BlbiAmJiAhc2VsZi5jb25maWcuc3RhdGljICYmICFzZWxmLmNvbmZpZy5pbmxpbmUpXG4gICAgICAgICAgICBwb3NpdGlvbkNhbGVuZGFyKCk7XG4gICAgfVxuICAgIGZ1bmN0aW9uIG9wZW4oZSwgcG9zaXRpb25FbGVtZW50KSB7XG4gICAgICAgIGlmIChwb3NpdGlvbkVsZW1lbnQgPT09IHZvaWQgMCkgeyBwb3NpdGlvbkVsZW1lbnQgPSBzZWxmLl9wb3NpdGlvbkVsZW1lbnQ7IH1cbiAgICAgICAgaWYgKHNlbGYuaXNNb2JpbGUgPT09IHRydWUpIHtcbiAgICAgICAgICAgIGlmIChlKSB7XG4gICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgIHZhciBldmVudFRhcmdldCA9IGdldEV2ZW50VGFyZ2V0KGUpO1xuICAgICAgICAgICAgICAgIGlmIChldmVudFRhcmdldCkge1xuICAgICAgICAgICAgICAgICAgICBldmVudFRhcmdldC5ibHVyKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHNlbGYubW9iaWxlSW5wdXQgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIHNlbGYubW9iaWxlSW5wdXQuZm9jdXMoKTtcbiAgICAgICAgICAgICAgICBzZWxmLm1vYmlsZUlucHV0LmNsaWNrKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0cmlnZ2VyRXZlbnQoXCJvbk9wZW5cIik7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoc2VsZi5faW5wdXQuZGlzYWJsZWQgfHwgc2VsZi5jb25maWcuaW5saW5lKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHdhc09wZW4gPSBzZWxmLmlzT3BlbjtcbiAgICAgICAgc2VsZi5pc09wZW4gPSB0cnVlO1xuICAgICAgICBpZiAoIXdhc09wZW4pIHtcbiAgICAgICAgICAgIHNlbGYuY2FsZW5kYXJDb250YWluZXIuY2xhc3NMaXN0LmFkZChcIm9wZW5cIik7XG4gICAgICAgICAgICBzZWxmLl9pbnB1dC5jbGFzc0xpc3QuYWRkKFwiYWN0aXZlXCIpO1xuICAgICAgICAgICAgdHJpZ2dlckV2ZW50KFwib25PcGVuXCIpO1xuICAgICAgICAgICAgcG9zaXRpb25DYWxlbmRhcihwb3NpdGlvbkVsZW1lbnQpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChzZWxmLmNvbmZpZy5lbmFibGVUaW1lID09PSB0cnVlICYmIHNlbGYuY29uZmlnLm5vQ2FsZW5kYXIgPT09IHRydWUpIHtcbiAgICAgICAgICAgIGlmIChzZWxmLmNvbmZpZy5hbGxvd0lucHV0ID09PSBmYWxzZSAmJlxuICAgICAgICAgICAgICAgIChlID09PSB1bmRlZmluZWQgfHxcbiAgICAgICAgICAgICAgICAgICAgIXNlbGYudGltZUNvbnRhaW5lci5jb250YWlucyhlLnJlbGF0ZWRUYXJnZXQpKSkge1xuICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgeyByZXR1cm4gc2VsZi5ob3VyRWxlbWVudC5zZWxlY3QoKTsgfSwgNTApO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIGZ1bmN0aW9uIG1pbk1heERhdGVTZXR0ZXIodHlwZSkge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGRhdGUpIHtcbiAgICAgICAgICAgIHZhciBkYXRlT2JqID0gKHNlbGYuY29uZmlnW1wiX1wiICsgdHlwZSArIFwiRGF0ZVwiXSA9IHNlbGYucGFyc2VEYXRlKGRhdGUsIHNlbGYuY29uZmlnLmRhdGVGb3JtYXQpKTtcbiAgICAgICAgICAgIHZhciBpbnZlcnNlRGF0ZU9iaiA9IHNlbGYuY29uZmlnW1wiX1wiICsgKHR5cGUgPT09IFwibWluXCIgPyBcIm1heFwiIDogXCJtaW5cIikgKyBcIkRhdGVcIl07XG4gICAgICAgICAgICBpZiAoZGF0ZU9iaiAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgc2VsZlt0eXBlID09PSBcIm1pblwiID8gXCJtaW5EYXRlSGFzVGltZVwiIDogXCJtYXhEYXRlSGFzVGltZVwiXSA9XG4gICAgICAgICAgICAgICAgICAgIGRhdGVPYmouZ2V0SG91cnMoKSA+IDAgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGVPYmouZ2V0TWludXRlcygpID4gMCB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZU9iai5nZXRTZWNvbmRzKCkgPiAwO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHNlbGYuc2VsZWN0ZWREYXRlcykge1xuICAgICAgICAgICAgICAgIHNlbGYuc2VsZWN0ZWREYXRlcyA9IHNlbGYuc2VsZWN0ZWREYXRlcy5maWx0ZXIoZnVuY3Rpb24gKGQpIHsgcmV0dXJuIGlzRW5hYmxlZChkKTsgfSk7XG4gICAgICAgICAgICAgICAgaWYgKCFzZWxmLnNlbGVjdGVkRGF0ZXMubGVuZ3RoICYmIHR5cGUgPT09IFwibWluXCIpXG4gICAgICAgICAgICAgICAgICAgIHNldEhvdXJzRnJvbURhdGUoZGF0ZU9iaik7XG4gICAgICAgICAgICAgICAgdXBkYXRlVmFsdWUoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChzZWxmLmRheXNDb250YWluZXIpIHtcbiAgICAgICAgICAgICAgICByZWRyYXcoKTtcbiAgICAgICAgICAgICAgICBpZiAoZGF0ZU9iaiAhPT0gdW5kZWZpbmVkKVxuICAgICAgICAgICAgICAgICAgICBzZWxmLmN1cnJlbnRZZWFyRWxlbWVudFt0eXBlXSA9IGRhdGVPYmouZ2V0RnVsbFllYXIoKS50b1N0cmluZygpO1xuICAgICAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5jdXJyZW50WWVhckVsZW1lbnQucmVtb3ZlQXR0cmlidXRlKHR5cGUpO1xuICAgICAgICAgICAgICAgIHNlbGYuY3VycmVudFllYXJFbGVtZW50LmRpc2FibGVkID1cbiAgICAgICAgICAgICAgICAgICAgISFpbnZlcnNlRGF0ZU9iaiAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZU9iaiAhPT0gdW5kZWZpbmVkICYmXG4gICAgICAgICAgICAgICAgICAgICAgICBpbnZlcnNlRGF0ZU9iai5nZXRGdWxsWWVhcigpID09PSBkYXRlT2JqLmdldEZ1bGxZZWFyKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgfVxuICAgIGZ1bmN0aW9uIHBhcnNlQ29uZmlnKCkge1xuICAgICAgICB2YXIgYm9vbE9wdHMgPSBbXG4gICAgICAgICAgICBcIndyYXBcIixcbiAgICAgICAgICAgIFwid2Vla051bWJlcnNcIixcbiAgICAgICAgICAgIFwiYWxsb3dJbnB1dFwiLFxuICAgICAgICAgICAgXCJhbGxvd0ludmFsaWRQcmVsb2FkXCIsXG4gICAgICAgICAgICBcImNsaWNrT3BlbnNcIixcbiAgICAgICAgICAgIFwidGltZV8yNGhyXCIsXG4gICAgICAgICAgICBcImVuYWJsZVRpbWVcIixcbiAgICAgICAgICAgIFwibm9DYWxlbmRhclwiLFxuICAgICAgICAgICAgXCJhbHRJbnB1dFwiLFxuICAgICAgICAgICAgXCJzaG9ydGhhbmRDdXJyZW50TW9udGhcIixcbiAgICAgICAgICAgIFwiaW5saW5lXCIsXG4gICAgICAgICAgICBcInN0YXRpY1wiLFxuICAgICAgICAgICAgXCJlbmFibGVTZWNvbmRzXCIsXG4gICAgICAgICAgICBcImRpc2FibGVNb2JpbGVcIixcbiAgICAgICAgXTtcbiAgICAgICAgdmFyIHVzZXJDb25maWcgPSBfX2Fzc2lnbihfX2Fzc2lnbih7fSwgSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShlbGVtZW50LmRhdGFzZXQgfHwge30pKSksIGluc3RhbmNlQ29uZmlnKTtcbiAgICAgICAgdmFyIGZvcm1hdHMgPSB7fTtcbiAgICAgICAgc2VsZi5jb25maWcucGFyc2VEYXRlID0gdXNlckNvbmZpZy5wYXJzZURhdGU7XG4gICAgICAgIHNlbGYuY29uZmlnLmZvcm1hdERhdGUgPSB1c2VyQ29uZmlnLmZvcm1hdERhdGU7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzZWxmLmNvbmZpZywgXCJlbmFibGVcIiwge1xuICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7IHJldHVybiBzZWxmLmNvbmZpZy5fZW5hYmxlOyB9LFxuICAgICAgICAgICAgc2V0OiBmdW5jdGlvbiAoZGF0ZXMpIHtcbiAgICAgICAgICAgICAgICBzZWxmLmNvbmZpZy5fZW5hYmxlID0gcGFyc2VEYXRlUnVsZXMoZGF0ZXMpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgfSk7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzZWxmLmNvbmZpZywgXCJkaXNhYmxlXCIsIHtcbiAgICAgICAgICAgIGdldDogZnVuY3Rpb24gKCkgeyByZXR1cm4gc2VsZi5jb25maWcuX2Rpc2FibGU7IH0sXG4gICAgICAgICAgICBzZXQ6IGZ1bmN0aW9uIChkYXRlcykge1xuICAgICAgICAgICAgICAgIHNlbGYuY29uZmlnLl9kaXNhYmxlID0gcGFyc2VEYXRlUnVsZXMoZGF0ZXMpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgfSk7XG4gICAgICAgIHZhciB0aW1lTW9kZSA9IHVzZXJDb25maWcubW9kZSA9PT0gXCJ0aW1lXCI7XG4gICAgICAgIGlmICghdXNlckNvbmZpZy5kYXRlRm9ybWF0ICYmICh1c2VyQ29uZmlnLmVuYWJsZVRpbWUgfHwgdGltZU1vZGUpKSB7XG4gICAgICAgICAgICB2YXIgZGVmYXVsdERhdGVGb3JtYXQgPSBmbGF0cGlja3IuZGVmYXVsdENvbmZpZy5kYXRlRm9ybWF0IHx8IGRlZmF1bHRPcHRpb25zLmRhdGVGb3JtYXQ7XG4gICAgICAgICAgICBmb3JtYXRzLmRhdGVGb3JtYXQgPVxuICAgICAgICAgICAgICAgIHVzZXJDb25maWcubm9DYWxlbmRhciB8fCB0aW1lTW9kZVxuICAgICAgICAgICAgICAgICAgICA/IFwiSDppXCIgKyAodXNlckNvbmZpZy5lbmFibGVTZWNvbmRzID8gXCI6U1wiIDogXCJcIilcbiAgICAgICAgICAgICAgICAgICAgOiBkZWZhdWx0RGF0ZUZvcm1hdCArIFwiIEg6aVwiICsgKHVzZXJDb25maWcuZW5hYmxlU2Vjb25kcyA/IFwiOlNcIiA6IFwiXCIpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh1c2VyQ29uZmlnLmFsdElucHV0ICYmXG4gICAgICAgICAgICAodXNlckNvbmZpZy5lbmFibGVUaW1lIHx8IHRpbWVNb2RlKSAmJlxuICAgICAgICAgICAgIXVzZXJDb25maWcuYWx0Rm9ybWF0KSB7XG4gICAgICAgICAgICB2YXIgZGVmYXVsdEFsdEZvcm1hdCA9IGZsYXRwaWNrci5kZWZhdWx0Q29uZmlnLmFsdEZvcm1hdCB8fCBkZWZhdWx0T3B0aW9ucy5hbHRGb3JtYXQ7XG4gICAgICAgICAgICBmb3JtYXRzLmFsdEZvcm1hdCA9XG4gICAgICAgICAgICAgICAgdXNlckNvbmZpZy5ub0NhbGVuZGFyIHx8IHRpbWVNb2RlXG4gICAgICAgICAgICAgICAgICAgID8gXCJoOmlcIiArICh1c2VyQ29uZmlnLmVuYWJsZVNlY29uZHMgPyBcIjpTIEtcIiA6IFwiIEtcIilcbiAgICAgICAgICAgICAgICAgICAgOiBkZWZhdWx0QWx0Rm9ybWF0ICsgKFwiIGg6aVwiICsgKHVzZXJDb25maWcuZW5hYmxlU2Vjb25kcyA/IFwiOlNcIiA6IFwiXCIpICsgXCIgS1wiKTtcbiAgICAgICAgfVxuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoc2VsZi5jb25maWcsIFwibWluRGF0ZVwiLCB7XG4gICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHNlbGYuY29uZmlnLl9taW5EYXRlOyB9LFxuICAgICAgICAgICAgc2V0OiBtaW5NYXhEYXRlU2V0dGVyKFwibWluXCIpLFxuICAgICAgICB9KTtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHNlbGYuY29uZmlnLCBcIm1heERhdGVcIiwge1xuICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7IHJldHVybiBzZWxmLmNvbmZpZy5fbWF4RGF0ZTsgfSxcbiAgICAgICAgICAgIHNldDogbWluTWF4RGF0ZVNldHRlcihcIm1heFwiKSxcbiAgICAgICAgfSk7XG4gICAgICAgIHZhciBtaW5NYXhUaW1lU2V0dGVyID0gZnVuY3Rpb24gKHR5cGUpIHsgcmV0dXJuIGZ1bmN0aW9uICh2YWwpIHtcbiAgICAgICAgICAgIHNlbGYuY29uZmlnW3R5cGUgPT09IFwibWluXCIgPyBcIl9taW5UaW1lXCIgOiBcIl9tYXhUaW1lXCJdID0gc2VsZi5wYXJzZURhdGUodmFsLCBcIkg6aTpTXCIpO1xuICAgICAgICB9OyB9O1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoc2VsZi5jb25maWcsIFwibWluVGltZVwiLCB7XG4gICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHNlbGYuY29uZmlnLl9taW5UaW1lOyB9LFxuICAgICAgICAgICAgc2V0OiBtaW5NYXhUaW1lU2V0dGVyKFwibWluXCIpLFxuICAgICAgICB9KTtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHNlbGYuY29uZmlnLCBcIm1heFRpbWVcIiwge1xuICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7IHJldHVybiBzZWxmLmNvbmZpZy5fbWF4VGltZTsgfSxcbiAgICAgICAgICAgIHNldDogbWluTWF4VGltZVNldHRlcihcIm1heFwiKSxcbiAgICAgICAgfSk7XG4gICAgICAgIGlmICh1c2VyQ29uZmlnLm1vZGUgPT09IFwidGltZVwiKSB7XG4gICAgICAgICAgICBzZWxmLmNvbmZpZy5ub0NhbGVuZGFyID0gdHJ1ZTtcbiAgICAgICAgICAgIHNlbGYuY29uZmlnLmVuYWJsZVRpbWUgPSB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIE9iamVjdC5hc3NpZ24oc2VsZi5jb25maWcsIGZvcm1hdHMsIHVzZXJDb25maWcpO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGJvb2xPcHRzLmxlbmd0aDsgaSsrKVxuICAgICAgICAgICAgc2VsZi5jb25maWdbYm9vbE9wdHNbaV1dID1cbiAgICAgICAgICAgICAgICBzZWxmLmNvbmZpZ1tib29sT3B0c1tpXV0gPT09IHRydWUgfHxcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5jb25maWdbYm9vbE9wdHNbaV1dID09PSBcInRydWVcIjtcbiAgICAgICAgSE9PS1MuZmlsdGVyKGZ1bmN0aW9uIChob29rKSB7IHJldHVybiBzZWxmLmNvbmZpZ1tob29rXSAhPT0gdW5kZWZpbmVkOyB9KS5mb3JFYWNoKGZ1bmN0aW9uIChob29rKSB7XG4gICAgICAgICAgICBzZWxmLmNvbmZpZ1tob29rXSA9IGFycmF5aWZ5KHNlbGYuY29uZmlnW2hvb2tdIHx8IFtdKS5tYXAoYmluZFRvSW5zdGFuY2UpO1xuICAgICAgICB9KTtcbiAgICAgICAgc2VsZi5pc01vYmlsZSA9XG4gICAgICAgICAgICAhc2VsZi5jb25maWcuZGlzYWJsZU1vYmlsZSAmJlxuICAgICAgICAgICAgICAgICFzZWxmLmNvbmZpZy5pbmxpbmUgJiZcbiAgICAgICAgICAgICAgICBzZWxmLmNvbmZpZy5tb2RlID09PSBcInNpbmdsZVwiICYmXG4gICAgICAgICAgICAgICAgIXNlbGYuY29uZmlnLmRpc2FibGUubGVuZ3RoICYmXG4gICAgICAgICAgICAgICAgIXNlbGYuY29uZmlnLmVuYWJsZSAmJlxuICAgICAgICAgICAgICAgICFzZWxmLmNvbmZpZy53ZWVrTnVtYmVycyAmJlxuICAgICAgICAgICAgICAgIC9BbmRyb2lkfHdlYk9TfGlQaG9uZXxpUGFkfGlQb2R8QmxhY2tCZXJyeXxJRU1vYmlsZXxPcGVyYSBNaW5pL2kudGVzdChuYXZpZ2F0b3IudXNlckFnZW50KTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzZWxmLmNvbmZpZy5wbHVnaW5zLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgcGx1Z2luQ29uZiA9IHNlbGYuY29uZmlnLnBsdWdpbnNbaV0oc2VsZikgfHwge307XG4gICAgICAgICAgICBmb3IgKHZhciBrZXkgaW4gcGx1Z2luQ29uZikge1xuICAgICAgICAgICAgICAgIGlmIChIT09LUy5pbmRleE9mKGtleSkgPiAtMSkge1xuICAgICAgICAgICAgICAgICAgICBzZWxmLmNvbmZpZ1trZXldID0gYXJyYXlpZnkocGx1Z2luQ29uZltrZXldKVxuICAgICAgICAgICAgICAgICAgICAgICAgLm1hcChiaW5kVG9JbnN0YW5jZSlcbiAgICAgICAgICAgICAgICAgICAgICAgIC5jb25jYXQoc2VsZi5jb25maWdba2V5XSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKHR5cGVvZiB1c2VyQ29uZmlnW2tleV0gPT09IFwidW5kZWZpbmVkXCIpXG4gICAgICAgICAgICAgICAgICAgIHNlbGYuY29uZmlnW2tleV0gPSBwbHVnaW5Db25mW2tleV07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCF1c2VyQ29uZmlnLmFsdElucHV0Q2xhc3MpIHtcbiAgICAgICAgICAgIHNlbGYuY29uZmlnLmFsdElucHV0Q2xhc3MgPVxuICAgICAgICAgICAgICAgIGdldElucHV0RWxlbSgpLmNsYXNzTmFtZSArIFwiIFwiICsgc2VsZi5jb25maWcuYWx0SW5wdXRDbGFzcztcbiAgICAgICAgfVxuICAgICAgICB0cmlnZ2VyRXZlbnQoXCJvblBhcnNlQ29uZmlnXCIpO1xuICAgIH1cbiAgICBmdW5jdGlvbiBnZXRJbnB1dEVsZW0oKSB7XG4gICAgICAgIHJldHVybiBzZWxmLmNvbmZpZy53cmFwXG4gICAgICAgICAgICA/IGVsZW1lbnQucXVlcnlTZWxlY3RvcihcIltkYXRhLWlucHV0XVwiKVxuICAgICAgICAgICAgOiBlbGVtZW50O1xuICAgIH1cbiAgICBmdW5jdGlvbiBzZXR1cExvY2FsZSgpIHtcbiAgICAgICAgaWYgKHR5cGVvZiBzZWxmLmNvbmZpZy5sb2NhbGUgIT09IFwib2JqZWN0XCIgJiZcbiAgICAgICAgICAgIHR5cGVvZiBmbGF0cGlja3IubDEwbnNbc2VsZi5jb25maWcubG9jYWxlXSA9PT0gXCJ1bmRlZmluZWRcIilcbiAgICAgICAgICAgIHNlbGYuY29uZmlnLmVycm9ySGFuZGxlcihuZXcgRXJyb3IoXCJmbGF0cGlja3I6IGludmFsaWQgbG9jYWxlIFwiICsgc2VsZi5jb25maWcubG9jYWxlKSk7XG4gICAgICAgIHNlbGYubDEwbiA9IF9fYXNzaWduKF9fYXNzaWduKHt9LCBmbGF0cGlja3IubDEwbnMuZGVmYXVsdCksICh0eXBlb2Ygc2VsZi5jb25maWcubG9jYWxlID09PSBcIm9iamVjdFwiXG4gICAgICAgICAgICA/IHNlbGYuY29uZmlnLmxvY2FsZVxuICAgICAgICAgICAgOiBzZWxmLmNvbmZpZy5sb2NhbGUgIT09IFwiZGVmYXVsdFwiXG4gICAgICAgICAgICAgICAgPyBmbGF0cGlja3IubDEwbnNbc2VsZi5jb25maWcubG9jYWxlXVxuICAgICAgICAgICAgICAgIDogdW5kZWZpbmVkKSk7XG4gICAgICAgIHRva2VuUmVnZXguRCA9IFwiKFwiICsgc2VsZi5sMTBuLndlZWtkYXlzLnNob3J0aGFuZC5qb2luKFwifFwiKSArIFwiKVwiO1xuICAgICAgICB0b2tlblJlZ2V4LmwgPSBcIihcIiArIHNlbGYubDEwbi53ZWVrZGF5cy5sb25naGFuZC5qb2luKFwifFwiKSArIFwiKVwiO1xuICAgICAgICB0b2tlblJlZ2V4Lk0gPSBcIihcIiArIHNlbGYubDEwbi5tb250aHMuc2hvcnRoYW5kLmpvaW4oXCJ8XCIpICsgXCIpXCI7XG4gICAgICAgIHRva2VuUmVnZXguRiA9IFwiKFwiICsgc2VsZi5sMTBuLm1vbnRocy5sb25naGFuZC5qb2luKFwifFwiKSArIFwiKVwiO1xuICAgICAgICB0b2tlblJlZ2V4LksgPSBcIihcIiArIHNlbGYubDEwbi5hbVBNWzBdICsgXCJ8XCIgKyBzZWxmLmwxMG4uYW1QTVsxXSArIFwifFwiICsgc2VsZi5sMTBuLmFtUE1bMF0udG9Mb3dlckNhc2UoKSArIFwifFwiICsgc2VsZi5sMTBuLmFtUE1bMV0udG9Mb3dlckNhc2UoKSArIFwiKVwiO1xuICAgICAgICB2YXIgdXNlckNvbmZpZyA9IF9fYXNzaWduKF9fYXNzaWduKHt9LCBpbnN0YW5jZUNvbmZpZyksIEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoZWxlbWVudC5kYXRhc2V0IHx8IHt9KSkpO1xuICAgICAgICBpZiAodXNlckNvbmZpZy50aW1lXzI0aHIgPT09IHVuZGVmaW5lZCAmJlxuICAgICAgICAgICAgZmxhdHBpY2tyLmRlZmF1bHRDb25maWcudGltZV8yNGhyID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHNlbGYuY29uZmlnLnRpbWVfMjRociA9IHNlbGYubDEwbi50aW1lXzI0aHI7XG4gICAgICAgIH1cbiAgICAgICAgc2VsZi5mb3JtYXREYXRlID0gY3JlYXRlRGF0ZUZvcm1hdHRlcihzZWxmKTtcbiAgICAgICAgc2VsZi5wYXJzZURhdGUgPSBjcmVhdGVEYXRlUGFyc2VyKHsgY29uZmlnOiBzZWxmLmNvbmZpZywgbDEwbjogc2VsZi5sMTBuIH0pO1xuICAgIH1cbiAgICBmdW5jdGlvbiBwb3NpdGlvbkNhbGVuZGFyKGN1c3RvbVBvc2l0aW9uRWxlbWVudCkge1xuICAgICAgICBpZiAodHlwZW9mIHNlbGYuY29uZmlnLnBvc2l0aW9uID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgICAgIHJldHVybiB2b2lkIHNlbGYuY29uZmlnLnBvc2l0aW9uKHNlbGYsIGN1c3RvbVBvc2l0aW9uRWxlbWVudCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHNlbGYuY2FsZW5kYXJDb250YWluZXIgPT09IHVuZGVmaW5lZClcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgdHJpZ2dlckV2ZW50KFwib25QcmVDYWxlbmRhclBvc2l0aW9uXCIpO1xuICAgICAgICB2YXIgcG9zaXRpb25FbGVtZW50ID0gY3VzdG9tUG9zaXRpb25FbGVtZW50IHx8IHNlbGYuX3Bvc2l0aW9uRWxlbWVudDtcbiAgICAgICAgdmFyIGNhbGVuZGFySGVpZ2h0ID0gQXJyYXkucHJvdG90eXBlLnJlZHVjZS5jYWxsKHNlbGYuY2FsZW5kYXJDb250YWluZXIuY2hpbGRyZW4sIChmdW5jdGlvbiAoYWNjLCBjaGlsZCkgeyByZXR1cm4gYWNjICsgY2hpbGQub2Zmc2V0SGVpZ2h0OyB9KSwgMCksIGNhbGVuZGFyV2lkdGggPSBzZWxmLmNhbGVuZGFyQ29udGFpbmVyLm9mZnNldFdpZHRoLCBjb25maWdQb3MgPSBzZWxmLmNvbmZpZy5wb3NpdGlvbi5zcGxpdChcIiBcIiksIGNvbmZpZ1Bvc1ZlcnRpY2FsID0gY29uZmlnUG9zWzBdLCBjb25maWdQb3NIb3Jpem9udGFsID0gY29uZmlnUG9zLmxlbmd0aCA+IDEgPyBjb25maWdQb3NbMV0gOiBudWxsLCBpbnB1dEJvdW5kcyA9IHBvc2l0aW9uRWxlbWVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKSwgZGlzdGFuY2VGcm9tQm90dG9tID0gd2luZG93LmlubmVySGVpZ2h0IC0gaW5wdXRCb3VuZHMuYm90dG9tLCBzaG93T25Ub3AgPSBjb25maWdQb3NWZXJ0aWNhbCA9PT0gXCJhYm92ZVwiIHx8XG4gICAgICAgICAgICAoY29uZmlnUG9zVmVydGljYWwgIT09IFwiYmVsb3dcIiAmJlxuICAgICAgICAgICAgICAgIGRpc3RhbmNlRnJvbUJvdHRvbSA8IGNhbGVuZGFySGVpZ2h0ICYmXG4gICAgICAgICAgICAgICAgaW5wdXRCb3VuZHMudG9wID4gY2FsZW5kYXJIZWlnaHQpO1xuICAgICAgICB2YXIgdG9wID0gd2luZG93LnBhZ2VZT2Zmc2V0ICtcbiAgICAgICAgICAgIGlucHV0Qm91bmRzLnRvcCArXG4gICAgICAgICAgICAoIXNob3dPblRvcCA/IHBvc2l0aW9uRWxlbWVudC5vZmZzZXRIZWlnaHQgKyAyIDogLWNhbGVuZGFySGVpZ2h0IC0gMik7XG4gICAgICAgIHRvZ2dsZUNsYXNzKHNlbGYuY2FsZW5kYXJDb250YWluZXIsIFwiYXJyb3dUb3BcIiwgIXNob3dPblRvcCk7XG4gICAgICAgIHRvZ2dsZUNsYXNzKHNlbGYuY2FsZW5kYXJDb250YWluZXIsIFwiYXJyb3dCb3R0b21cIiwgc2hvd09uVG9wKTtcbiAgICAgICAgaWYgKHNlbGYuY29uZmlnLmlubGluZSlcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgdmFyIGxlZnQgPSB3aW5kb3cucGFnZVhPZmZzZXQgKyBpbnB1dEJvdW5kcy5sZWZ0O1xuICAgICAgICB2YXIgaXNDZW50ZXIgPSBmYWxzZTtcbiAgICAgICAgdmFyIGlzUmlnaHQgPSBmYWxzZTtcbiAgICAgICAgaWYgKGNvbmZpZ1Bvc0hvcml6b250YWwgPT09IFwiY2VudGVyXCIpIHtcbiAgICAgICAgICAgIGxlZnQgLT0gKGNhbGVuZGFyV2lkdGggLSBpbnB1dEJvdW5kcy53aWR0aCkgLyAyO1xuICAgICAgICAgICAgaXNDZW50ZXIgPSB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGNvbmZpZ1Bvc0hvcml6b250YWwgPT09IFwicmlnaHRcIikge1xuICAgICAgICAgICAgbGVmdCAtPSBjYWxlbmRhcldpZHRoIC0gaW5wdXRCb3VuZHMud2lkdGg7XG4gICAgICAgICAgICBpc1JpZ2h0ID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICB0b2dnbGVDbGFzcyhzZWxmLmNhbGVuZGFyQ29udGFpbmVyLCBcImFycm93TGVmdFwiLCAhaXNDZW50ZXIgJiYgIWlzUmlnaHQpO1xuICAgICAgICB0b2dnbGVDbGFzcyhzZWxmLmNhbGVuZGFyQ29udGFpbmVyLCBcImFycm93Q2VudGVyXCIsIGlzQ2VudGVyKTtcbiAgICAgICAgdG9nZ2xlQ2xhc3Moc2VsZi5jYWxlbmRhckNvbnRhaW5lciwgXCJhcnJvd1JpZ2h0XCIsIGlzUmlnaHQpO1xuICAgICAgICB2YXIgcmlnaHQgPSB3aW5kb3cuZG9jdW1lbnQuYm9keS5vZmZzZXRXaWR0aCAtXG4gICAgICAgICAgICAod2luZG93LnBhZ2VYT2Zmc2V0ICsgaW5wdXRCb3VuZHMucmlnaHQpO1xuICAgICAgICB2YXIgcmlnaHRNb3N0ID0gbGVmdCArIGNhbGVuZGFyV2lkdGggPiB3aW5kb3cuZG9jdW1lbnQuYm9keS5vZmZzZXRXaWR0aDtcbiAgICAgICAgdmFyIGNlbnRlck1vc3QgPSByaWdodCArIGNhbGVuZGFyV2lkdGggPiB3aW5kb3cuZG9jdW1lbnQuYm9keS5vZmZzZXRXaWR0aDtcbiAgICAgICAgdG9nZ2xlQ2xhc3Moc2VsZi5jYWxlbmRhckNvbnRhaW5lciwgXCJyaWdodE1vc3RcIiwgcmlnaHRNb3N0KTtcbiAgICAgICAgaWYgKHNlbGYuY29uZmlnLnN0YXRpYylcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgc2VsZi5jYWxlbmRhckNvbnRhaW5lci5zdHlsZS50b3AgPSB0b3AgKyBcInB4XCI7XG4gICAgICAgIGlmICghcmlnaHRNb3N0KSB7XG4gICAgICAgICAgICBzZWxmLmNhbGVuZGFyQ29udGFpbmVyLnN0eWxlLmxlZnQgPSBsZWZ0ICsgXCJweFwiO1xuICAgICAgICAgICAgc2VsZi5jYWxlbmRhckNvbnRhaW5lci5zdHlsZS5yaWdodCA9IFwiYXV0b1wiO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKCFjZW50ZXJNb3N0KSB7XG4gICAgICAgICAgICBzZWxmLmNhbGVuZGFyQ29udGFpbmVyLnN0eWxlLmxlZnQgPSBcImF1dG9cIjtcbiAgICAgICAgICAgIHNlbGYuY2FsZW5kYXJDb250YWluZXIuc3R5bGUucmlnaHQgPSByaWdodCArIFwicHhcIjtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHZhciBkb2MgPSBnZXREb2N1bWVudFN0eWxlU2hlZXQoKTtcbiAgICAgICAgICAgIGlmIChkb2MgPT09IHVuZGVmaW5lZClcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB2YXIgYm9keVdpZHRoID0gd2luZG93LmRvY3VtZW50LmJvZHkub2Zmc2V0V2lkdGg7XG4gICAgICAgICAgICB2YXIgY2VudGVyTGVmdCA9IE1hdGgubWF4KDAsIGJvZHlXaWR0aCAvIDIgLSBjYWxlbmRhcldpZHRoIC8gMik7XG4gICAgICAgICAgICB2YXIgY2VudGVyQmVmb3JlID0gXCIuZmxhdHBpY2tyLWNhbGVuZGFyLmNlbnRlck1vc3Q6YmVmb3JlXCI7XG4gICAgICAgICAgICB2YXIgY2VudGVyQWZ0ZXIgPSBcIi5mbGF0cGlja3ItY2FsZW5kYXIuY2VudGVyTW9zdDphZnRlclwiO1xuICAgICAgICAgICAgdmFyIGNlbnRlckluZGV4ID0gZG9jLmNzc1J1bGVzLmxlbmd0aDtcbiAgICAgICAgICAgIHZhciBjZW50ZXJTdHlsZSA9IFwie2xlZnQ6XCIgKyBpbnB1dEJvdW5kcy5sZWZ0ICsgXCJweDtyaWdodDphdXRvO31cIjtcbiAgICAgICAgICAgIHRvZ2dsZUNsYXNzKHNlbGYuY2FsZW5kYXJDb250YWluZXIsIFwicmlnaHRNb3N0XCIsIGZhbHNlKTtcbiAgICAgICAgICAgIHRvZ2dsZUNsYXNzKHNlbGYuY2FsZW5kYXJDb250YWluZXIsIFwiY2VudGVyTW9zdFwiLCB0cnVlKTtcbiAgICAgICAgICAgIGRvYy5pbnNlcnRSdWxlKGNlbnRlckJlZm9yZSArIFwiLFwiICsgY2VudGVyQWZ0ZXIgKyBjZW50ZXJTdHlsZSwgY2VudGVySW5kZXgpO1xuICAgICAgICAgICAgc2VsZi5jYWxlbmRhckNvbnRhaW5lci5zdHlsZS5sZWZ0ID0gY2VudGVyTGVmdCArIFwicHhcIjtcbiAgICAgICAgICAgIHNlbGYuY2FsZW5kYXJDb250YWluZXIuc3R5bGUucmlnaHQgPSBcImF1dG9cIjtcbiAgICAgICAgfVxuICAgIH1cbiAgICBmdW5jdGlvbiBnZXREb2N1bWVudFN0eWxlU2hlZXQoKSB7XG4gICAgICAgIHZhciBlZGl0YWJsZVNoZWV0ID0gbnVsbDtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBkb2N1bWVudC5zdHlsZVNoZWV0cy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIHNoZWV0ID0gZG9jdW1lbnQuc3R5bGVTaGVldHNbaV07XG4gICAgICAgICAgICBpZiAoIXNoZWV0LmNzc1J1bGVzKVxuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBzaGVldC5jc3NSdWxlcztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhdGNoIChlcnIpIHtcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVkaXRhYmxlU2hlZXQgPSBzaGVldDtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBlZGl0YWJsZVNoZWV0ICE9IG51bGwgPyBlZGl0YWJsZVNoZWV0IDogY3JlYXRlU3R5bGVTaGVldCgpO1xuICAgIH1cbiAgICBmdW5jdGlvbiBjcmVhdGVTdHlsZVNoZWV0KCkge1xuICAgICAgICB2YXIgc3R5bGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwic3R5bGVcIik7XG4gICAgICAgIGRvY3VtZW50LmhlYWQuYXBwZW5kQ2hpbGQoc3R5bGUpO1xuICAgICAgICByZXR1cm4gc3R5bGUuc2hlZXQ7XG4gICAgfVxuICAgIGZ1bmN0aW9uIHJlZHJhdygpIHtcbiAgICAgICAgaWYgKHNlbGYuY29uZmlnLm5vQ2FsZW5kYXIgfHwgc2VsZi5pc01vYmlsZSlcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgYnVpbGRNb250aFN3aXRjaCgpO1xuICAgICAgICB1cGRhdGVOYXZpZ2F0aW9uQ3VycmVudE1vbnRoKCk7XG4gICAgICAgIGJ1aWxkRGF5cygpO1xuICAgIH1cbiAgICBmdW5jdGlvbiBmb2N1c0FuZENsb3NlKCkge1xuICAgICAgICBzZWxmLl9pbnB1dC5mb2N1cygpO1xuICAgICAgICBpZiAod2luZG93Lm5hdmlnYXRvci51c2VyQWdlbnQuaW5kZXhPZihcIk1TSUVcIikgIT09IC0xIHx8XG4gICAgICAgICAgICBuYXZpZ2F0b3IubXNNYXhUb3VjaFBvaW50cyAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBzZXRUaW1lb3V0KHNlbGYuY2xvc2UsIDApO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgc2VsZi5jbG9zZSgpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGZ1bmN0aW9uIHNlbGVjdERhdGUoZSkge1xuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgIHZhciBpc1NlbGVjdGFibGUgPSBmdW5jdGlvbiAoZGF5KSB7XG4gICAgICAgICAgICByZXR1cm4gZGF5LmNsYXNzTGlzdCAmJlxuICAgICAgICAgICAgICAgIGRheS5jbGFzc0xpc3QuY29udGFpbnMoXCJmbGF0cGlja3ItZGF5XCIpICYmXG4gICAgICAgICAgICAgICAgIWRheS5jbGFzc0xpc3QuY29udGFpbnMoXCJmbGF0cGlja3ItZGlzYWJsZWRcIikgJiZcbiAgICAgICAgICAgICAgICAhZGF5LmNsYXNzTGlzdC5jb250YWlucyhcIm5vdEFsbG93ZWRcIik7XG4gICAgICAgIH07XG4gICAgICAgIHZhciB0ID0gZmluZFBhcmVudChnZXRFdmVudFRhcmdldChlKSwgaXNTZWxlY3RhYmxlKTtcbiAgICAgICAgaWYgKHQgPT09IHVuZGVmaW5lZClcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgdmFyIHRhcmdldCA9IHQ7XG4gICAgICAgIHZhciBzZWxlY3RlZERhdGUgPSAoc2VsZi5sYXRlc3RTZWxlY3RlZERhdGVPYmogPSBuZXcgRGF0ZSh0YXJnZXQuZGF0ZU9iai5nZXRUaW1lKCkpKTtcbiAgICAgICAgdmFyIHNob3VsZENoYW5nZU1vbnRoID0gKHNlbGVjdGVkRGF0ZS5nZXRNb250aCgpIDwgc2VsZi5jdXJyZW50TW9udGggfHxcbiAgICAgICAgICAgIHNlbGVjdGVkRGF0ZS5nZXRNb250aCgpID5cbiAgICAgICAgICAgICAgICBzZWxmLmN1cnJlbnRNb250aCArIHNlbGYuY29uZmlnLnNob3dNb250aHMgLSAxKSAmJlxuICAgICAgICAgICAgc2VsZi5jb25maWcubW9kZSAhPT0gXCJyYW5nZVwiO1xuICAgICAgICBzZWxmLnNlbGVjdGVkRGF0ZUVsZW0gPSB0YXJnZXQ7XG4gICAgICAgIGlmIChzZWxmLmNvbmZpZy5tb2RlID09PSBcInNpbmdsZVwiKVxuICAgICAgICAgICAgc2VsZi5zZWxlY3RlZERhdGVzID0gW3NlbGVjdGVkRGF0ZV07XG4gICAgICAgIGVsc2UgaWYgKHNlbGYuY29uZmlnLm1vZGUgPT09IFwibXVsdGlwbGVcIikge1xuICAgICAgICAgICAgdmFyIHNlbGVjdGVkSW5kZXggPSBpc0RhdGVTZWxlY3RlZChzZWxlY3RlZERhdGUpO1xuICAgICAgICAgICAgaWYgKHNlbGVjdGVkSW5kZXgpXG4gICAgICAgICAgICAgICAgc2VsZi5zZWxlY3RlZERhdGVzLnNwbGljZShwYXJzZUludChzZWxlY3RlZEluZGV4KSwgMSk7XG4gICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgc2VsZi5zZWxlY3RlZERhdGVzLnB1c2goc2VsZWN0ZWREYXRlKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChzZWxmLmNvbmZpZy5tb2RlID09PSBcInJhbmdlXCIpIHtcbiAgICAgICAgICAgIGlmIChzZWxmLnNlbGVjdGVkRGF0ZXMubGVuZ3RoID09PSAyKSB7XG4gICAgICAgICAgICAgICAgc2VsZi5jbGVhcihmYWxzZSwgZmFsc2UpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgc2VsZi5sYXRlc3RTZWxlY3RlZERhdGVPYmogPSBzZWxlY3RlZERhdGU7XG4gICAgICAgICAgICBzZWxmLnNlbGVjdGVkRGF0ZXMucHVzaChzZWxlY3RlZERhdGUpO1xuICAgICAgICAgICAgaWYgKGNvbXBhcmVEYXRlcyhzZWxlY3RlZERhdGUsIHNlbGYuc2VsZWN0ZWREYXRlc1swXSwgdHJ1ZSkgIT09IDApXG4gICAgICAgICAgICAgICAgc2VsZi5zZWxlY3RlZERhdGVzLnNvcnQoZnVuY3Rpb24gKGEsIGIpIHsgcmV0dXJuIGEuZ2V0VGltZSgpIC0gYi5nZXRUaW1lKCk7IH0pO1xuICAgICAgICB9XG4gICAgICAgIHNldEhvdXJzRnJvbUlucHV0cygpO1xuICAgICAgICBpZiAoc2hvdWxkQ2hhbmdlTW9udGgpIHtcbiAgICAgICAgICAgIHZhciBpc05ld1llYXIgPSBzZWxmLmN1cnJlbnRZZWFyICE9PSBzZWxlY3RlZERhdGUuZ2V0RnVsbFllYXIoKTtcbiAgICAgICAgICAgIHNlbGYuY3VycmVudFllYXIgPSBzZWxlY3RlZERhdGUuZ2V0RnVsbFllYXIoKTtcbiAgICAgICAgICAgIHNlbGYuY3VycmVudE1vbnRoID0gc2VsZWN0ZWREYXRlLmdldE1vbnRoKCk7XG4gICAgICAgICAgICBpZiAoaXNOZXdZZWFyKSB7XG4gICAgICAgICAgICAgICAgdHJpZ2dlckV2ZW50KFwib25ZZWFyQ2hhbmdlXCIpO1xuICAgICAgICAgICAgICAgIGJ1aWxkTW9udGhTd2l0Y2goKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRyaWdnZXJFdmVudChcIm9uTW9udGhDaGFuZ2VcIik7XG4gICAgICAgIH1cbiAgICAgICAgdXBkYXRlTmF2aWdhdGlvbkN1cnJlbnRNb250aCgpO1xuICAgICAgICBidWlsZERheXMoKTtcbiAgICAgICAgdXBkYXRlVmFsdWUoKTtcbiAgICAgICAgaWYgKCFzaG91bGRDaGFuZ2VNb250aCAmJlxuICAgICAgICAgICAgc2VsZi5jb25maWcubW9kZSAhPT0gXCJyYW5nZVwiICYmXG4gICAgICAgICAgICBzZWxmLmNvbmZpZy5zaG93TW9udGhzID09PSAxKVxuICAgICAgICAgICAgZm9jdXNPbkRheUVsZW0odGFyZ2V0KTtcbiAgICAgICAgZWxzZSBpZiAoc2VsZi5zZWxlY3RlZERhdGVFbGVtICE9PSB1bmRlZmluZWQgJiZcbiAgICAgICAgICAgIHNlbGYuaG91ckVsZW1lbnQgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgc2VsZi5zZWxlY3RlZERhdGVFbGVtICYmIHNlbGYuc2VsZWN0ZWREYXRlRWxlbS5mb2N1cygpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChzZWxmLmhvdXJFbGVtZW50ICE9PSB1bmRlZmluZWQpXG4gICAgICAgICAgICBzZWxmLmhvdXJFbGVtZW50ICE9PSB1bmRlZmluZWQgJiYgc2VsZi5ob3VyRWxlbWVudC5mb2N1cygpO1xuICAgICAgICBpZiAoc2VsZi5jb25maWcuY2xvc2VPblNlbGVjdCkge1xuICAgICAgICAgICAgdmFyIHNpbmdsZSA9IHNlbGYuY29uZmlnLm1vZGUgPT09IFwic2luZ2xlXCIgJiYgIXNlbGYuY29uZmlnLmVuYWJsZVRpbWU7XG4gICAgICAgICAgICB2YXIgcmFuZ2UgPSBzZWxmLmNvbmZpZy5tb2RlID09PSBcInJhbmdlXCIgJiZcbiAgICAgICAgICAgICAgICBzZWxmLnNlbGVjdGVkRGF0ZXMubGVuZ3RoID09PSAyICYmXG4gICAgICAgICAgICAgICAgIXNlbGYuY29uZmlnLmVuYWJsZVRpbWU7XG4gICAgICAgICAgICBpZiAoc2luZ2xlIHx8IHJhbmdlKSB7XG4gICAgICAgICAgICAgICAgZm9jdXNBbmRDbG9zZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHRyaWdnZXJDaGFuZ2UoKTtcbiAgICB9XG4gICAgdmFyIENBTExCQUNLUyA9IHtcbiAgICAgICAgbG9jYWxlOiBbc2V0dXBMb2NhbGUsIHVwZGF0ZVdlZWtkYXlzXSxcbiAgICAgICAgc2hvd01vbnRoczogW2J1aWxkTW9udGhzLCBzZXRDYWxlbmRhcldpZHRoLCBidWlsZFdlZWtkYXlzXSxcbiAgICAgICAgbWluRGF0ZTogW2p1bXBUb0RhdGVdLFxuICAgICAgICBtYXhEYXRlOiBbanVtcFRvRGF0ZV0sXG4gICAgICAgIHBvc2l0aW9uRWxlbWVudDogW3VwZGF0ZVBvc2l0aW9uRWxlbWVudF0sXG4gICAgICAgIGNsaWNrT3BlbnM6IFtcbiAgICAgICAgICAgIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBpZiAoc2VsZi5jb25maWcuY2xpY2tPcGVucyA9PT0gdHJ1ZSkge1xuICAgICAgICAgICAgICAgICAgICBiaW5kKHNlbGYuX2lucHV0LCBcImZvY3VzXCIsIHNlbGYub3Blbik7XG4gICAgICAgICAgICAgICAgICAgIGJpbmQoc2VsZi5faW5wdXQsIFwiY2xpY2tcIiwgc2VsZi5vcGVuKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHNlbGYuX2lucHV0LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJmb2N1c1wiLCBzZWxmLm9wZW4pO1xuICAgICAgICAgICAgICAgICAgICBzZWxmLl9pbnB1dC5yZW1vdmVFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgc2VsZi5vcGVuKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuICAgICAgICBdLFxuICAgIH07XG4gICAgZnVuY3Rpb24gc2V0KG9wdGlvbiwgdmFsdWUpIHtcbiAgICAgICAgaWYgKG9wdGlvbiAhPT0gbnVsbCAmJiB0eXBlb2Ygb3B0aW9uID09PSBcIm9iamVjdFwiKSB7XG4gICAgICAgICAgICBPYmplY3QuYXNzaWduKHNlbGYuY29uZmlnLCBvcHRpb24pO1xuICAgICAgICAgICAgZm9yICh2YXIga2V5IGluIG9wdGlvbikge1xuICAgICAgICAgICAgICAgIGlmIChDQUxMQkFDS1Nba2V5XSAhPT0gdW5kZWZpbmVkKVxuICAgICAgICAgICAgICAgICAgICBDQUxMQkFDS1Nba2V5XS5mb3JFYWNoKGZ1bmN0aW9uICh4KSB7IHJldHVybiB4KCk7IH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgc2VsZi5jb25maWdbb3B0aW9uXSA9IHZhbHVlO1xuICAgICAgICAgICAgaWYgKENBTExCQUNLU1tvcHRpb25dICE9PSB1bmRlZmluZWQpXG4gICAgICAgICAgICAgICAgQ0FMTEJBQ0tTW29wdGlvbl0uZm9yRWFjaChmdW5jdGlvbiAoeCkgeyByZXR1cm4geCgpOyB9KTtcbiAgICAgICAgICAgIGVsc2UgaWYgKEhPT0tTLmluZGV4T2Yob3B0aW9uKSA+IC0xKVxuICAgICAgICAgICAgICAgIHNlbGYuY29uZmlnW29wdGlvbl0gPSBhcnJheWlmeSh2YWx1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgc2VsZi5yZWRyYXcoKTtcbiAgICAgICAgdXBkYXRlVmFsdWUodHJ1ZSk7XG4gICAgfVxuICAgIGZ1bmN0aW9uIHNldFNlbGVjdGVkRGF0ZShpbnB1dERhdGUsIGZvcm1hdCkge1xuICAgICAgICB2YXIgZGF0ZXMgPSBbXTtcbiAgICAgICAgaWYgKGlucHV0RGF0ZSBpbnN0YW5jZW9mIEFycmF5KVxuICAgICAgICAgICAgZGF0ZXMgPSBpbnB1dERhdGUubWFwKGZ1bmN0aW9uIChkKSB7IHJldHVybiBzZWxmLnBhcnNlRGF0ZShkLCBmb3JtYXQpOyB9KTtcbiAgICAgICAgZWxzZSBpZiAoaW5wdXREYXRlIGluc3RhbmNlb2YgRGF0ZSB8fCB0eXBlb2YgaW5wdXREYXRlID09PSBcIm51bWJlclwiKVxuICAgICAgICAgICAgZGF0ZXMgPSBbc2VsZi5wYXJzZURhdGUoaW5wdXREYXRlLCBmb3JtYXQpXTtcbiAgICAgICAgZWxzZSBpZiAodHlwZW9mIGlucHV0RGF0ZSA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICAgICAgc3dpdGNoIChzZWxmLmNvbmZpZy5tb2RlKSB7XG4gICAgICAgICAgICAgICAgY2FzZSBcInNpbmdsZVwiOlxuICAgICAgICAgICAgICAgIGNhc2UgXCJ0aW1lXCI6XG4gICAgICAgICAgICAgICAgICAgIGRhdGVzID0gW3NlbGYucGFyc2VEYXRlKGlucHV0RGF0ZSwgZm9ybWF0KV07XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgXCJtdWx0aXBsZVwiOlxuICAgICAgICAgICAgICAgICAgICBkYXRlcyA9IGlucHV0RGF0ZVxuICAgICAgICAgICAgICAgICAgICAgICAgLnNwbGl0KHNlbGYuY29uZmlnLmNvbmp1bmN0aW9uKVxuICAgICAgICAgICAgICAgICAgICAgICAgLm1hcChmdW5jdGlvbiAoZGF0ZSkgeyByZXR1cm4gc2VsZi5wYXJzZURhdGUoZGF0ZSwgZm9ybWF0KTsgfSk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgXCJyYW5nZVwiOlxuICAgICAgICAgICAgICAgICAgICBkYXRlcyA9IGlucHV0RGF0ZVxuICAgICAgICAgICAgICAgICAgICAgICAgLnNwbGl0KHNlbGYubDEwbi5yYW5nZVNlcGFyYXRvcilcbiAgICAgICAgICAgICAgICAgICAgICAgIC5tYXAoZnVuY3Rpb24gKGRhdGUpIHsgcmV0dXJuIHNlbGYucGFyc2VEYXRlKGRhdGUsIGZvcm1hdCk7IH0pO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlXG4gICAgICAgICAgICBzZWxmLmNvbmZpZy5lcnJvckhhbmRsZXIobmV3IEVycm9yKFwiSW52YWxpZCBkYXRlIHN1cHBsaWVkOiBcIiArIEpTT04uc3RyaW5naWZ5KGlucHV0RGF0ZSkpKTtcbiAgICAgICAgc2VsZi5zZWxlY3RlZERhdGVzID0gKHNlbGYuY29uZmlnLmFsbG93SW52YWxpZFByZWxvYWRcbiAgICAgICAgICAgID8gZGF0ZXNcbiAgICAgICAgICAgIDogZGF0ZXMuZmlsdGVyKGZ1bmN0aW9uIChkKSB7IHJldHVybiBkIGluc3RhbmNlb2YgRGF0ZSAmJiBpc0VuYWJsZWQoZCwgZmFsc2UpOyB9KSk7XG4gICAgICAgIGlmIChzZWxmLmNvbmZpZy5tb2RlID09PSBcInJhbmdlXCIpXG4gICAgICAgICAgICBzZWxmLnNlbGVjdGVkRGF0ZXMuc29ydChmdW5jdGlvbiAoYSwgYikgeyByZXR1cm4gYS5nZXRUaW1lKCkgLSBiLmdldFRpbWUoKTsgfSk7XG4gICAgfVxuICAgIGZ1bmN0aW9uIHNldERhdGUoZGF0ZSwgdHJpZ2dlckNoYW5nZSwgZm9ybWF0KSB7XG4gICAgICAgIGlmICh0cmlnZ2VyQ2hhbmdlID09PSB2b2lkIDApIHsgdHJpZ2dlckNoYW5nZSA9IGZhbHNlOyB9XG4gICAgICAgIGlmIChmb3JtYXQgPT09IHZvaWQgMCkgeyBmb3JtYXQgPSBzZWxmLmNvbmZpZy5kYXRlRm9ybWF0OyB9XG4gICAgICAgIGlmICgoZGF0ZSAhPT0gMCAmJiAhZGF0ZSkgfHwgKGRhdGUgaW5zdGFuY2VvZiBBcnJheSAmJiBkYXRlLmxlbmd0aCA9PT0gMCkpXG4gICAgICAgICAgICByZXR1cm4gc2VsZi5jbGVhcih0cmlnZ2VyQ2hhbmdlKTtcbiAgICAgICAgc2V0U2VsZWN0ZWREYXRlKGRhdGUsIGZvcm1hdCk7XG4gICAgICAgIHNlbGYubGF0ZXN0U2VsZWN0ZWREYXRlT2JqID1cbiAgICAgICAgICAgIHNlbGYuc2VsZWN0ZWREYXRlc1tzZWxmLnNlbGVjdGVkRGF0ZXMubGVuZ3RoIC0gMV07XG4gICAgICAgIHNlbGYucmVkcmF3KCk7XG4gICAgICAgIGp1bXBUb0RhdGUodW5kZWZpbmVkLCB0cmlnZ2VyQ2hhbmdlKTtcbiAgICAgICAgc2V0SG91cnNGcm9tRGF0ZSgpO1xuICAgICAgICBpZiAoc2VsZi5zZWxlY3RlZERhdGVzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgc2VsZi5jbGVhcihmYWxzZSk7XG4gICAgICAgIH1cbiAgICAgICAgdXBkYXRlVmFsdWUodHJpZ2dlckNoYW5nZSk7XG4gICAgICAgIGlmICh0cmlnZ2VyQ2hhbmdlKVxuICAgICAgICAgICAgdHJpZ2dlckV2ZW50KFwib25DaGFuZ2VcIik7XG4gICAgfVxuICAgIGZ1bmN0aW9uIHBhcnNlRGF0ZVJ1bGVzKGFycikge1xuICAgICAgICByZXR1cm4gYXJyXG4gICAgICAgICAgICAuc2xpY2UoKVxuICAgICAgICAgICAgLm1hcChmdW5jdGlvbiAocnVsZSkge1xuICAgICAgICAgICAgaWYgKHR5cGVvZiBydWxlID09PSBcInN0cmluZ1wiIHx8XG4gICAgICAgICAgICAgICAgdHlwZW9mIHJ1bGUgPT09IFwibnVtYmVyXCIgfHxcbiAgICAgICAgICAgICAgICBydWxlIGluc3RhbmNlb2YgRGF0ZSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBzZWxmLnBhcnNlRGF0ZShydWxlLCB1bmRlZmluZWQsIHRydWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAocnVsZSAmJlxuICAgICAgICAgICAgICAgIHR5cGVvZiBydWxlID09PSBcIm9iamVjdFwiICYmXG4gICAgICAgICAgICAgICAgcnVsZS5mcm9tICYmXG4gICAgICAgICAgICAgICAgcnVsZS50bylcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBmcm9tOiBzZWxmLnBhcnNlRGF0ZShydWxlLmZyb20sIHVuZGVmaW5lZCksXG4gICAgICAgICAgICAgICAgICAgIHRvOiBzZWxmLnBhcnNlRGF0ZShydWxlLnRvLCB1bmRlZmluZWQpLFxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICByZXR1cm4gcnVsZTtcbiAgICAgICAgfSlcbiAgICAgICAgICAgIC5maWx0ZXIoZnVuY3Rpb24gKHgpIHsgcmV0dXJuIHg7IH0pO1xuICAgIH1cbiAgICBmdW5jdGlvbiBzZXR1cERhdGVzKCkge1xuICAgICAgICBzZWxmLnNlbGVjdGVkRGF0ZXMgPSBbXTtcbiAgICAgICAgc2VsZi5ub3cgPSBzZWxmLnBhcnNlRGF0ZShzZWxmLmNvbmZpZy5ub3cpIHx8IG5ldyBEYXRlKCk7XG4gICAgICAgIHZhciBwcmVsb2FkZWREYXRlID0gc2VsZi5jb25maWcuZGVmYXVsdERhdGUgfHxcbiAgICAgICAgICAgICgoc2VsZi5pbnB1dC5ub2RlTmFtZSA9PT0gXCJJTlBVVFwiIHx8XG4gICAgICAgICAgICAgICAgc2VsZi5pbnB1dC5ub2RlTmFtZSA9PT0gXCJURVhUQVJFQVwiKSAmJlxuICAgICAgICAgICAgICAgIHNlbGYuaW5wdXQucGxhY2Vob2xkZXIgJiZcbiAgICAgICAgICAgICAgICBzZWxmLmlucHV0LnZhbHVlID09PSBzZWxmLmlucHV0LnBsYWNlaG9sZGVyXG4gICAgICAgICAgICAgICAgPyBudWxsXG4gICAgICAgICAgICAgICAgOiBzZWxmLmlucHV0LnZhbHVlKTtcbiAgICAgICAgaWYgKHByZWxvYWRlZERhdGUpXG4gICAgICAgICAgICBzZXRTZWxlY3RlZERhdGUocHJlbG9hZGVkRGF0ZSwgc2VsZi5jb25maWcuZGF0ZUZvcm1hdCk7XG4gICAgICAgIHNlbGYuX2luaXRpYWxEYXRlID1cbiAgICAgICAgICAgIHNlbGYuc2VsZWN0ZWREYXRlcy5sZW5ndGggPiAwXG4gICAgICAgICAgICAgICAgPyBzZWxmLnNlbGVjdGVkRGF0ZXNbMF1cbiAgICAgICAgICAgICAgICA6IHNlbGYuY29uZmlnLm1pbkRhdGUgJiZcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5jb25maWcubWluRGF0ZS5nZXRUaW1lKCkgPiBzZWxmLm5vdy5nZXRUaW1lKClcbiAgICAgICAgICAgICAgICAgICAgPyBzZWxmLmNvbmZpZy5taW5EYXRlXG4gICAgICAgICAgICAgICAgICAgIDogc2VsZi5jb25maWcubWF4RGF0ZSAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5jb25maWcubWF4RGF0ZS5nZXRUaW1lKCkgPCBzZWxmLm5vdy5nZXRUaW1lKClcbiAgICAgICAgICAgICAgICAgICAgICAgID8gc2VsZi5jb25maWcubWF4RGF0ZVxuICAgICAgICAgICAgICAgICAgICAgICAgOiBzZWxmLm5vdztcbiAgICAgICAgc2VsZi5jdXJyZW50WWVhciA9IHNlbGYuX2luaXRpYWxEYXRlLmdldEZ1bGxZZWFyKCk7XG4gICAgICAgIHNlbGYuY3VycmVudE1vbnRoID0gc2VsZi5faW5pdGlhbERhdGUuZ2V0TW9udGgoKTtcbiAgICAgICAgaWYgKHNlbGYuc2VsZWN0ZWREYXRlcy5sZW5ndGggPiAwKVxuICAgICAgICAgICAgc2VsZi5sYXRlc3RTZWxlY3RlZERhdGVPYmogPSBzZWxmLnNlbGVjdGVkRGF0ZXNbMF07XG4gICAgICAgIGlmIChzZWxmLmNvbmZpZy5taW5UaW1lICE9PSB1bmRlZmluZWQpXG4gICAgICAgICAgICBzZWxmLmNvbmZpZy5taW5UaW1lID0gc2VsZi5wYXJzZURhdGUoc2VsZi5jb25maWcubWluVGltZSwgXCJIOmlcIik7XG4gICAgICAgIGlmIChzZWxmLmNvbmZpZy5tYXhUaW1lICE9PSB1bmRlZmluZWQpXG4gICAgICAgICAgICBzZWxmLmNvbmZpZy5tYXhUaW1lID0gc2VsZi5wYXJzZURhdGUoc2VsZi5jb25maWcubWF4VGltZSwgXCJIOmlcIik7XG4gICAgICAgIHNlbGYubWluRGF0ZUhhc1RpbWUgPVxuICAgICAgICAgICAgISFzZWxmLmNvbmZpZy5taW5EYXRlICYmXG4gICAgICAgICAgICAgICAgKHNlbGYuY29uZmlnLm1pbkRhdGUuZ2V0SG91cnMoKSA+IDAgfHxcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5jb25maWcubWluRGF0ZS5nZXRNaW51dGVzKCkgPiAwIHx8XG4gICAgICAgICAgICAgICAgICAgIHNlbGYuY29uZmlnLm1pbkRhdGUuZ2V0U2Vjb25kcygpID4gMCk7XG4gICAgICAgIHNlbGYubWF4RGF0ZUhhc1RpbWUgPVxuICAgICAgICAgICAgISFzZWxmLmNvbmZpZy5tYXhEYXRlICYmXG4gICAgICAgICAgICAgICAgKHNlbGYuY29uZmlnLm1heERhdGUuZ2V0SG91cnMoKSA+IDAgfHxcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5jb25maWcubWF4RGF0ZS5nZXRNaW51dGVzKCkgPiAwIHx8XG4gICAgICAgICAgICAgICAgICAgIHNlbGYuY29uZmlnLm1heERhdGUuZ2V0U2Vjb25kcygpID4gMCk7XG4gICAgfVxuICAgIGZ1bmN0aW9uIHNldHVwSW5wdXRzKCkge1xuICAgICAgICBzZWxmLmlucHV0ID0gZ2V0SW5wdXRFbGVtKCk7XG4gICAgICAgIGlmICghc2VsZi5pbnB1dCkge1xuICAgICAgICAgICAgc2VsZi5jb25maWcuZXJyb3JIYW5kbGVyKG5ldyBFcnJvcihcIkludmFsaWQgaW5wdXQgZWxlbWVudCBzcGVjaWZpZWRcIikpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHNlbGYuaW5wdXQuX3R5cGUgPSBzZWxmLmlucHV0LnR5cGU7XG4gICAgICAgIHNlbGYuaW5wdXQudHlwZSA9IFwidGV4dFwiO1xuICAgICAgICBzZWxmLmlucHV0LmNsYXNzTGlzdC5hZGQoXCJmbGF0cGlja3ItaW5wdXRcIik7XG4gICAgICAgIHNlbGYuX2lucHV0ID0gc2VsZi5pbnB1dDtcbiAgICAgICAgaWYgKHNlbGYuY29uZmlnLmFsdElucHV0KSB7XG4gICAgICAgICAgICBzZWxmLmFsdElucHV0ID0gY3JlYXRlRWxlbWVudChzZWxmLmlucHV0Lm5vZGVOYW1lLCBzZWxmLmNvbmZpZy5hbHRJbnB1dENsYXNzKTtcbiAgICAgICAgICAgIHNlbGYuX2lucHV0ID0gc2VsZi5hbHRJbnB1dDtcbiAgICAgICAgICAgIHNlbGYuYWx0SW5wdXQucGxhY2Vob2xkZXIgPSBzZWxmLmlucHV0LnBsYWNlaG9sZGVyO1xuICAgICAgICAgICAgc2VsZi5hbHRJbnB1dC5kaXNhYmxlZCA9IHNlbGYuaW5wdXQuZGlzYWJsZWQ7XG4gICAgICAgICAgICBzZWxmLmFsdElucHV0LnJlcXVpcmVkID0gc2VsZi5pbnB1dC5yZXF1aXJlZDtcbiAgICAgICAgICAgIHNlbGYuYWx0SW5wdXQudGFiSW5kZXggPSBzZWxmLmlucHV0LnRhYkluZGV4O1xuICAgICAgICAgICAgc2VsZi5hbHRJbnB1dC50eXBlID0gXCJ0ZXh0XCI7XG4gICAgICAgICAgICBzZWxmLmlucHV0LnNldEF0dHJpYnV0ZShcInR5cGVcIiwgXCJoaWRkZW5cIik7XG4gICAgICAgICAgICBpZiAoIXNlbGYuY29uZmlnLnN0YXRpYyAmJiBzZWxmLmlucHV0LnBhcmVudE5vZGUpXG4gICAgICAgICAgICAgICAgc2VsZi5pbnB1dC5wYXJlbnROb2RlLmluc2VydEJlZm9yZShzZWxmLmFsdElucHV0LCBzZWxmLmlucHV0Lm5leHRTaWJsaW5nKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIXNlbGYuY29uZmlnLmFsbG93SW5wdXQpXG4gICAgICAgICAgICBzZWxmLl9pbnB1dC5zZXRBdHRyaWJ1dGUoXCJyZWFkb25seVwiLCBcInJlYWRvbmx5XCIpO1xuICAgICAgICB1cGRhdGVQb3NpdGlvbkVsZW1lbnQoKTtcbiAgICB9XG4gICAgZnVuY3Rpb24gdXBkYXRlUG9zaXRpb25FbGVtZW50KCkge1xuICAgICAgICBzZWxmLl9wb3NpdGlvbkVsZW1lbnQgPSBzZWxmLmNvbmZpZy5wb3NpdGlvbkVsZW1lbnQgfHwgc2VsZi5faW5wdXQ7XG4gICAgfVxuICAgIGZ1bmN0aW9uIHNldHVwTW9iaWxlKCkge1xuICAgICAgICB2YXIgaW5wdXRUeXBlID0gc2VsZi5jb25maWcuZW5hYmxlVGltZVxuICAgICAgICAgICAgPyBzZWxmLmNvbmZpZy5ub0NhbGVuZGFyXG4gICAgICAgICAgICAgICAgPyBcInRpbWVcIlxuICAgICAgICAgICAgICAgIDogXCJkYXRldGltZS1sb2NhbFwiXG4gICAgICAgICAgICA6IFwiZGF0ZVwiO1xuICAgICAgICBzZWxmLm1vYmlsZUlucHV0ID0gY3JlYXRlRWxlbWVudChcImlucHV0XCIsIHNlbGYuaW5wdXQuY2xhc3NOYW1lICsgXCIgZmxhdHBpY2tyLW1vYmlsZVwiKTtcbiAgICAgICAgc2VsZi5tb2JpbGVJbnB1dC50YWJJbmRleCA9IDE7XG4gICAgICAgIHNlbGYubW9iaWxlSW5wdXQudHlwZSA9IGlucHV0VHlwZTtcbiAgICAgICAgc2VsZi5tb2JpbGVJbnB1dC5kaXNhYmxlZCA9IHNlbGYuaW5wdXQuZGlzYWJsZWQ7XG4gICAgICAgIHNlbGYubW9iaWxlSW5wdXQucmVxdWlyZWQgPSBzZWxmLmlucHV0LnJlcXVpcmVkO1xuICAgICAgICBzZWxmLm1vYmlsZUlucHV0LnBsYWNlaG9sZGVyID0gc2VsZi5pbnB1dC5wbGFjZWhvbGRlcjtcbiAgICAgICAgc2VsZi5tb2JpbGVGb3JtYXRTdHIgPVxuICAgICAgICAgICAgaW5wdXRUeXBlID09PSBcImRhdGV0aW1lLWxvY2FsXCJcbiAgICAgICAgICAgICAgICA/IFwiWS1tLWRcXFxcVEg6aTpTXCJcbiAgICAgICAgICAgICAgICA6IGlucHV0VHlwZSA9PT0gXCJkYXRlXCJcbiAgICAgICAgICAgICAgICAgICAgPyBcIlktbS1kXCJcbiAgICAgICAgICAgICAgICAgICAgOiBcIkg6aTpTXCI7XG4gICAgICAgIGlmIChzZWxmLnNlbGVjdGVkRGF0ZXMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgc2VsZi5tb2JpbGVJbnB1dC5kZWZhdWx0VmFsdWUgPSBzZWxmLm1vYmlsZUlucHV0LnZhbHVlID0gc2VsZi5mb3JtYXREYXRlKHNlbGYuc2VsZWN0ZWREYXRlc1swXSwgc2VsZi5tb2JpbGVGb3JtYXRTdHIpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChzZWxmLmNvbmZpZy5taW5EYXRlKVxuICAgICAgICAgICAgc2VsZi5tb2JpbGVJbnB1dC5taW4gPSBzZWxmLmZvcm1hdERhdGUoc2VsZi5jb25maWcubWluRGF0ZSwgXCJZLW0tZFwiKTtcbiAgICAgICAgaWYgKHNlbGYuY29uZmlnLm1heERhdGUpXG4gICAgICAgICAgICBzZWxmLm1vYmlsZUlucHV0Lm1heCA9IHNlbGYuZm9ybWF0RGF0ZShzZWxmLmNvbmZpZy5tYXhEYXRlLCBcIlktbS1kXCIpO1xuICAgICAgICBpZiAoc2VsZi5pbnB1dC5nZXRBdHRyaWJ1dGUoXCJzdGVwXCIpKVxuICAgICAgICAgICAgc2VsZi5tb2JpbGVJbnB1dC5zdGVwID0gU3RyaW5nKHNlbGYuaW5wdXQuZ2V0QXR0cmlidXRlKFwic3RlcFwiKSk7XG4gICAgICAgIHNlbGYuaW5wdXQudHlwZSA9IFwiaGlkZGVuXCI7XG4gICAgICAgIGlmIChzZWxmLmFsdElucHV0ICE9PSB1bmRlZmluZWQpXG4gICAgICAgICAgICBzZWxmLmFsdElucHV0LnR5cGUgPSBcImhpZGRlblwiO1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgaWYgKHNlbGYuaW5wdXQucGFyZW50Tm9kZSlcbiAgICAgICAgICAgICAgICBzZWxmLmlucHV0LnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKHNlbGYubW9iaWxlSW5wdXQsIHNlbGYuaW5wdXQubmV4dFNpYmxpbmcpO1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChfYSkgeyB9XG4gICAgICAgIGJpbmQoc2VsZi5tb2JpbGVJbnB1dCwgXCJjaGFuZ2VcIiwgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgIHNlbGYuc2V0RGF0ZShnZXRFdmVudFRhcmdldChlKS52YWx1ZSwgZmFsc2UsIHNlbGYubW9iaWxlRm9ybWF0U3RyKTtcbiAgICAgICAgICAgIHRyaWdnZXJFdmVudChcIm9uQ2hhbmdlXCIpO1xuICAgICAgICAgICAgdHJpZ2dlckV2ZW50KFwib25DbG9zZVwiKTtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGZ1bmN0aW9uIHRvZ2dsZShlKSB7XG4gICAgICAgIGlmIChzZWxmLmlzT3BlbiA9PT0gdHJ1ZSlcbiAgICAgICAgICAgIHJldHVybiBzZWxmLmNsb3NlKCk7XG4gICAgICAgIHNlbGYub3BlbihlKTtcbiAgICB9XG4gICAgZnVuY3Rpb24gdHJpZ2dlckV2ZW50KGV2ZW50LCBkYXRhKSB7XG4gICAgICAgIGlmIChzZWxmLmNvbmZpZyA9PT0gdW5kZWZpbmVkKVxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB2YXIgaG9va3MgPSBzZWxmLmNvbmZpZ1tldmVudF07XG4gICAgICAgIGlmIChob29rcyAhPT0gdW5kZWZpbmVkICYmIGhvb2tzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBob29rc1tpXSAmJiBpIDwgaG9va3MubGVuZ3RoOyBpKyspXG4gICAgICAgICAgICAgICAgaG9va3NbaV0oc2VsZi5zZWxlY3RlZERhdGVzLCBzZWxmLmlucHV0LnZhbHVlLCBzZWxmLCBkYXRhKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoZXZlbnQgPT09IFwib25DaGFuZ2VcIikge1xuICAgICAgICAgICAgc2VsZi5pbnB1dC5kaXNwYXRjaEV2ZW50KGNyZWF0ZUV2ZW50KFwiY2hhbmdlXCIpKTtcbiAgICAgICAgICAgIHNlbGYuaW5wdXQuZGlzcGF0Y2hFdmVudChjcmVhdGVFdmVudChcImlucHV0XCIpKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBmdW5jdGlvbiBjcmVhdGVFdmVudChuYW1lKSB7XG4gICAgICAgIHZhciBlID0gZG9jdW1lbnQuY3JlYXRlRXZlbnQoXCJFdmVudFwiKTtcbiAgICAgICAgZS5pbml0RXZlbnQobmFtZSwgdHJ1ZSwgdHJ1ZSk7XG4gICAgICAgIHJldHVybiBlO1xuICAgIH1cbiAgICBmdW5jdGlvbiBpc0RhdGVTZWxlY3RlZChkYXRlKSB7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2VsZi5zZWxlY3RlZERhdGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgc2VsZWN0ZWREYXRlID0gc2VsZi5zZWxlY3RlZERhdGVzW2ldO1xuICAgICAgICAgICAgaWYgKHNlbGVjdGVkRGF0ZSBpbnN0YW5jZW9mIERhdGUgJiZcbiAgICAgICAgICAgICAgICBjb21wYXJlRGF0ZXMoc2VsZWN0ZWREYXRlLCBkYXRlKSA9PT0gMClcbiAgICAgICAgICAgICAgICByZXR1cm4gXCJcIiArIGk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICBmdW5jdGlvbiBpc0RhdGVJblJhbmdlKGRhdGUpIHtcbiAgICAgICAgaWYgKHNlbGYuY29uZmlnLm1vZGUgIT09IFwicmFuZ2VcIiB8fCBzZWxmLnNlbGVjdGVkRGF0ZXMubGVuZ3RoIDwgMilcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgcmV0dXJuIChjb21wYXJlRGF0ZXMoZGF0ZSwgc2VsZi5zZWxlY3RlZERhdGVzWzBdKSA+PSAwICYmXG4gICAgICAgICAgICBjb21wYXJlRGF0ZXMoZGF0ZSwgc2VsZi5zZWxlY3RlZERhdGVzWzFdKSA8PSAwKTtcbiAgICB9XG4gICAgZnVuY3Rpb24gdXBkYXRlTmF2aWdhdGlvbkN1cnJlbnRNb250aCgpIHtcbiAgICAgICAgaWYgKHNlbGYuY29uZmlnLm5vQ2FsZW5kYXIgfHwgc2VsZi5pc01vYmlsZSB8fCAhc2VsZi5tb250aE5hdilcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgc2VsZi55ZWFyRWxlbWVudHMuZm9yRWFjaChmdW5jdGlvbiAoeWVhckVsZW1lbnQsIGkpIHtcbiAgICAgICAgICAgIHZhciBkID0gbmV3IERhdGUoc2VsZi5jdXJyZW50WWVhciwgc2VsZi5jdXJyZW50TW9udGgsIDEpO1xuICAgICAgICAgICAgZC5zZXRNb250aChzZWxmLmN1cnJlbnRNb250aCArIGkpO1xuICAgICAgICAgICAgaWYgKHNlbGYuY29uZmlnLnNob3dNb250aHMgPiAxIHx8XG4gICAgICAgICAgICAgICAgc2VsZi5jb25maWcubW9udGhTZWxlY3RvclR5cGUgPT09IFwic3RhdGljXCIpIHtcbiAgICAgICAgICAgICAgICBzZWxmLm1vbnRoRWxlbWVudHNbaV0udGV4dENvbnRlbnQgPVxuICAgICAgICAgICAgICAgICAgICBtb250aFRvU3RyKGQuZ2V0TW9udGgoKSwgc2VsZi5jb25maWcuc2hvcnRoYW5kQ3VycmVudE1vbnRoLCBzZWxmLmwxMG4pICsgXCIgXCI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBzZWxmLm1vbnRoc0Ryb3Bkb3duQ29udGFpbmVyLnZhbHVlID0gZC5nZXRNb250aCgpLnRvU3RyaW5nKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB5ZWFyRWxlbWVudC52YWx1ZSA9IGQuZ2V0RnVsbFllYXIoKS50b1N0cmluZygpO1xuICAgICAgICB9KTtcbiAgICAgICAgc2VsZi5faGlkZVByZXZNb250aEFycm93ID1cbiAgICAgICAgICAgIHNlbGYuY29uZmlnLm1pbkRhdGUgIT09IHVuZGVmaW5lZCAmJlxuICAgICAgICAgICAgICAgIChzZWxmLmN1cnJlbnRZZWFyID09PSBzZWxmLmNvbmZpZy5taW5EYXRlLmdldEZ1bGxZZWFyKClcbiAgICAgICAgICAgICAgICAgICAgPyBzZWxmLmN1cnJlbnRNb250aCA8PSBzZWxmLmNvbmZpZy5taW5EYXRlLmdldE1vbnRoKClcbiAgICAgICAgICAgICAgICAgICAgOiBzZWxmLmN1cnJlbnRZZWFyIDwgc2VsZi5jb25maWcubWluRGF0ZS5nZXRGdWxsWWVhcigpKTtcbiAgICAgICAgc2VsZi5faGlkZU5leHRNb250aEFycm93ID1cbiAgICAgICAgICAgIHNlbGYuY29uZmlnLm1heERhdGUgIT09IHVuZGVmaW5lZCAmJlxuICAgICAgICAgICAgICAgIChzZWxmLmN1cnJlbnRZZWFyID09PSBzZWxmLmNvbmZpZy5tYXhEYXRlLmdldEZ1bGxZZWFyKClcbiAgICAgICAgICAgICAgICAgICAgPyBzZWxmLmN1cnJlbnRNb250aCArIDEgPiBzZWxmLmNvbmZpZy5tYXhEYXRlLmdldE1vbnRoKClcbiAgICAgICAgICAgICAgICAgICAgOiBzZWxmLmN1cnJlbnRZZWFyID4gc2VsZi5jb25maWcubWF4RGF0ZS5nZXRGdWxsWWVhcigpKTtcbiAgICB9XG4gICAgZnVuY3Rpb24gZ2V0RGF0ZVN0cihzcGVjaWZpY0Zvcm1hdCkge1xuICAgICAgICB2YXIgZm9ybWF0ID0gc3BlY2lmaWNGb3JtYXQgfHxcbiAgICAgICAgICAgIChzZWxmLmNvbmZpZy5hbHRJbnB1dCA/IHNlbGYuY29uZmlnLmFsdEZvcm1hdCA6IHNlbGYuY29uZmlnLmRhdGVGb3JtYXQpO1xuICAgICAgICByZXR1cm4gc2VsZi5zZWxlY3RlZERhdGVzXG4gICAgICAgICAgICAubWFwKGZ1bmN0aW9uIChkT2JqKSB7IHJldHVybiBzZWxmLmZvcm1hdERhdGUoZE9iaiwgZm9ybWF0KTsgfSlcbiAgICAgICAgICAgIC5maWx0ZXIoZnVuY3Rpb24gKGQsIGksIGFycikge1xuICAgICAgICAgICAgcmV0dXJuIHNlbGYuY29uZmlnLm1vZGUgIT09IFwicmFuZ2VcIiB8fFxuICAgICAgICAgICAgICAgIHNlbGYuY29uZmlnLmVuYWJsZVRpbWUgfHxcbiAgICAgICAgICAgICAgICBhcnIuaW5kZXhPZihkKSA9PT0gaTtcbiAgICAgICAgfSlcbiAgICAgICAgICAgIC5qb2luKHNlbGYuY29uZmlnLm1vZGUgIT09IFwicmFuZ2VcIlxuICAgICAgICAgICAgPyBzZWxmLmNvbmZpZy5jb25qdW5jdGlvblxuICAgICAgICAgICAgOiBzZWxmLmwxMG4ucmFuZ2VTZXBhcmF0b3IpO1xuICAgIH1cbiAgICBmdW5jdGlvbiB1cGRhdGVWYWx1ZSh0cmlnZ2VyQ2hhbmdlKSB7XG4gICAgICAgIGlmICh0cmlnZ2VyQ2hhbmdlID09PSB2b2lkIDApIHsgdHJpZ2dlckNoYW5nZSA9IHRydWU7IH1cbiAgICAgICAgaWYgKHNlbGYubW9iaWxlSW5wdXQgIT09IHVuZGVmaW5lZCAmJiBzZWxmLm1vYmlsZUZvcm1hdFN0cikge1xuICAgICAgICAgICAgc2VsZi5tb2JpbGVJbnB1dC52YWx1ZSA9XG4gICAgICAgICAgICAgICAgc2VsZi5sYXRlc3RTZWxlY3RlZERhdGVPYmogIT09IHVuZGVmaW5lZFxuICAgICAgICAgICAgICAgICAgICA/IHNlbGYuZm9ybWF0RGF0ZShzZWxmLmxhdGVzdFNlbGVjdGVkRGF0ZU9iaiwgc2VsZi5tb2JpbGVGb3JtYXRTdHIpXG4gICAgICAgICAgICAgICAgICAgIDogXCJcIjtcbiAgICAgICAgfVxuICAgICAgICBzZWxmLmlucHV0LnZhbHVlID0gZ2V0RGF0ZVN0cihzZWxmLmNvbmZpZy5kYXRlRm9ybWF0KTtcbiAgICAgICAgaWYgKHNlbGYuYWx0SW5wdXQgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgc2VsZi5hbHRJbnB1dC52YWx1ZSA9IGdldERhdGVTdHIoc2VsZi5jb25maWcuYWx0Rm9ybWF0KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodHJpZ2dlckNoYW5nZSAhPT0gZmFsc2UpXG4gICAgICAgICAgICB0cmlnZ2VyRXZlbnQoXCJvblZhbHVlVXBkYXRlXCIpO1xuICAgIH1cbiAgICBmdW5jdGlvbiBvbk1vbnRoTmF2Q2xpY2soZSkge1xuICAgICAgICB2YXIgZXZlbnRUYXJnZXQgPSBnZXRFdmVudFRhcmdldChlKTtcbiAgICAgICAgdmFyIGlzUHJldk1vbnRoID0gc2VsZi5wcmV2TW9udGhOYXYuY29udGFpbnMoZXZlbnRUYXJnZXQpO1xuICAgICAgICB2YXIgaXNOZXh0TW9udGggPSBzZWxmLm5leHRNb250aE5hdi5jb250YWlucyhldmVudFRhcmdldCk7XG4gICAgICAgIGlmIChpc1ByZXZNb250aCB8fCBpc05leHRNb250aCkge1xuICAgICAgICAgICAgY2hhbmdlTW9udGgoaXNQcmV2TW9udGggPyAtMSA6IDEpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHNlbGYueWVhckVsZW1lbnRzLmluZGV4T2YoZXZlbnRUYXJnZXQpID49IDApIHtcbiAgICAgICAgICAgIGV2ZW50VGFyZ2V0LnNlbGVjdCgpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGV2ZW50VGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcImFycm93VXBcIikpIHtcbiAgICAgICAgICAgIHNlbGYuY2hhbmdlWWVhcihzZWxmLmN1cnJlbnRZZWFyICsgMSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoZXZlbnRUYXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwiYXJyb3dEb3duXCIpKSB7XG4gICAgICAgICAgICBzZWxmLmNoYW5nZVllYXIoc2VsZi5jdXJyZW50WWVhciAtIDEpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGZ1bmN0aW9uIHRpbWVXcmFwcGVyKGUpIHtcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICB2YXIgaXNLZXlEb3duID0gZS50eXBlID09PSBcImtleWRvd25cIiwgZXZlbnRUYXJnZXQgPSBnZXRFdmVudFRhcmdldChlKSwgaW5wdXQgPSBldmVudFRhcmdldDtcbiAgICAgICAgaWYgKHNlbGYuYW1QTSAhPT0gdW5kZWZpbmVkICYmIGV2ZW50VGFyZ2V0ID09PSBzZWxmLmFtUE0pIHtcbiAgICAgICAgICAgIHNlbGYuYW1QTS50ZXh0Q29udGVudCA9XG4gICAgICAgICAgICAgICAgc2VsZi5sMTBuLmFtUE1baW50KHNlbGYuYW1QTS50ZXh0Q29udGVudCA9PT0gc2VsZi5sMTBuLmFtUE1bMF0pXTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgbWluID0gcGFyc2VGbG9hdChpbnB1dC5nZXRBdHRyaWJ1dGUoXCJtaW5cIikpLCBtYXggPSBwYXJzZUZsb2F0KGlucHV0LmdldEF0dHJpYnV0ZShcIm1heFwiKSksIHN0ZXAgPSBwYXJzZUZsb2F0KGlucHV0LmdldEF0dHJpYnV0ZShcInN0ZXBcIikpLCBjdXJWYWx1ZSA9IHBhcnNlSW50KGlucHV0LnZhbHVlLCAxMCksIGRlbHRhID0gZS5kZWx0YSB8fFxuICAgICAgICAgICAgKGlzS2V5RG93biA/IChlLndoaWNoID09PSAzOCA/IDEgOiAtMSkgOiAwKTtcbiAgICAgICAgdmFyIG5ld1ZhbHVlID0gY3VyVmFsdWUgKyBzdGVwICogZGVsdGE7XG4gICAgICAgIGlmICh0eXBlb2YgaW5wdXQudmFsdWUgIT09IFwidW5kZWZpbmVkXCIgJiYgaW5wdXQudmFsdWUubGVuZ3RoID09PSAyKSB7XG4gICAgICAgICAgICB2YXIgaXNIb3VyRWxlbSA9IGlucHV0ID09PSBzZWxmLmhvdXJFbGVtZW50LCBpc01pbnV0ZUVsZW0gPSBpbnB1dCA9PT0gc2VsZi5taW51dGVFbGVtZW50O1xuICAgICAgICAgICAgaWYgKG5ld1ZhbHVlIDwgbWluKSB7XG4gICAgICAgICAgICAgICAgbmV3VmFsdWUgPVxuICAgICAgICAgICAgICAgICAgICBtYXggK1xuICAgICAgICAgICAgICAgICAgICAgICAgbmV3VmFsdWUgK1xuICAgICAgICAgICAgICAgICAgICAgICAgaW50KCFpc0hvdXJFbGVtKSArXG4gICAgICAgICAgICAgICAgICAgICAgICAoaW50KGlzSG91ckVsZW0pICYmIGludCghc2VsZi5hbVBNKSk7XG4gICAgICAgICAgICAgICAgaWYgKGlzTWludXRlRWxlbSlcbiAgICAgICAgICAgICAgICAgICAgaW5jcmVtZW50TnVtSW5wdXQodW5kZWZpbmVkLCAtMSwgc2VsZi5ob3VyRWxlbWVudCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChuZXdWYWx1ZSA+IG1heCkge1xuICAgICAgICAgICAgICAgIG5ld1ZhbHVlID1cbiAgICAgICAgICAgICAgICAgICAgaW5wdXQgPT09IHNlbGYuaG91ckVsZW1lbnQgPyBuZXdWYWx1ZSAtIG1heCAtIGludCghc2VsZi5hbVBNKSA6IG1pbjtcbiAgICAgICAgICAgICAgICBpZiAoaXNNaW51dGVFbGVtKVxuICAgICAgICAgICAgICAgICAgICBpbmNyZW1lbnROdW1JbnB1dCh1bmRlZmluZWQsIDEsIHNlbGYuaG91ckVsZW1lbnQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHNlbGYuYW1QTSAmJlxuICAgICAgICAgICAgICAgIGlzSG91ckVsZW0gJiZcbiAgICAgICAgICAgICAgICAoc3RlcCA9PT0gMVxuICAgICAgICAgICAgICAgICAgICA/IG5ld1ZhbHVlICsgY3VyVmFsdWUgPT09IDIzXG4gICAgICAgICAgICAgICAgICAgIDogTWF0aC5hYnMobmV3VmFsdWUgLSBjdXJWYWx1ZSkgPiBzdGVwKSkge1xuICAgICAgICAgICAgICAgIHNlbGYuYW1QTS50ZXh0Q29udGVudCA9XG4gICAgICAgICAgICAgICAgICAgIHNlbGYubDEwbi5hbVBNW2ludChzZWxmLmFtUE0udGV4dENvbnRlbnQgPT09IHNlbGYubDEwbi5hbVBNWzBdKV07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpbnB1dC52YWx1ZSA9IHBhZChuZXdWYWx1ZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgaW5pdCgpO1xuICAgIHJldHVybiBzZWxmO1xufVxuZnVuY3Rpb24gX2ZsYXRwaWNrcihub2RlTGlzdCwgY29uZmlnKSB7XG4gICAgdmFyIG5vZGVzID0gQXJyYXkucHJvdG90eXBlLnNsaWNlXG4gICAgICAgIC5jYWxsKG5vZGVMaXN0KVxuICAgICAgICAuZmlsdGVyKGZ1bmN0aW9uICh4KSB7IHJldHVybiB4IGluc3RhbmNlb2YgSFRNTEVsZW1lbnQ7IH0pO1xuICAgIHZhciBpbnN0YW5jZXMgPSBbXTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IG5vZGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIHZhciBub2RlID0gbm9kZXNbaV07XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBpZiAobm9kZS5nZXRBdHRyaWJ1dGUoXCJkYXRhLWZwLW9taXRcIikgIT09IG51bGwpXG4gICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICBpZiAobm9kZS5fZmxhdHBpY2tyICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICBub2RlLl9mbGF0cGlja3IuZGVzdHJveSgpO1xuICAgICAgICAgICAgICAgIG5vZGUuX2ZsYXRwaWNrciA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIG5vZGUuX2ZsYXRwaWNrciA9IEZsYXRwaWNrckluc3RhbmNlKG5vZGUsIGNvbmZpZyB8fCB7fSk7XG4gICAgICAgICAgICBpbnN0YW5jZXMucHVzaChub2RlLl9mbGF0cGlja3IpO1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKGUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBpbnN0YW5jZXMubGVuZ3RoID09PSAxID8gaW5zdGFuY2VzWzBdIDogaW5zdGFuY2VzO1xufVxuaWYgKHR5cGVvZiBIVE1MRWxlbWVudCAhPT0gXCJ1bmRlZmluZWRcIiAmJlxuICAgIHR5cGVvZiBIVE1MQ29sbGVjdGlvbiAhPT0gXCJ1bmRlZmluZWRcIiAmJlxuICAgIHR5cGVvZiBOb2RlTGlzdCAhPT0gXCJ1bmRlZmluZWRcIikge1xuICAgIEhUTUxDb2xsZWN0aW9uLnByb3RvdHlwZS5mbGF0cGlja3IgPSBOb2RlTGlzdC5wcm90b3R5cGUuZmxhdHBpY2tyID0gZnVuY3Rpb24gKGNvbmZpZykge1xuICAgICAgICByZXR1cm4gX2ZsYXRwaWNrcih0aGlzLCBjb25maWcpO1xuICAgIH07XG4gICAgSFRNTEVsZW1lbnQucHJvdG90eXBlLmZsYXRwaWNrciA9IGZ1bmN0aW9uIChjb25maWcpIHtcbiAgICAgICAgcmV0dXJuIF9mbGF0cGlja3IoW3RoaXNdLCBjb25maWcpO1xuICAgIH07XG59XG52YXIgZmxhdHBpY2tyID0gZnVuY3Rpb24gKHNlbGVjdG9yLCBjb25maWcpIHtcbiAgICBpZiAodHlwZW9mIHNlbGVjdG9yID09PSBcInN0cmluZ1wiKSB7XG4gICAgICAgIHJldHVybiBfZmxhdHBpY2tyKHdpbmRvdy5kb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKHNlbGVjdG9yKSwgY29uZmlnKTtcbiAgICB9XG4gICAgZWxzZSBpZiAoc2VsZWN0b3IgaW5zdGFuY2VvZiBOb2RlKSB7XG4gICAgICAgIHJldHVybiBfZmxhdHBpY2tyKFtzZWxlY3Rvcl0sIGNvbmZpZyk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICByZXR1cm4gX2ZsYXRwaWNrcihzZWxlY3RvciwgY29uZmlnKTtcbiAgICB9XG59O1xuZmxhdHBpY2tyLmRlZmF1bHRDb25maWcgPSB7fTtcbmZsYXRwaWNrci5sMTBucyA9IHtcbiAgICBlbjogX19hc3NpZ24oe30sIEVuZ2xpc2gpLFxuICAgIGRlZmF1bHQ6IF9fYXNzaWduKHt9LCBFbmdsaXNoKSxcbn07XG5mbGF0cGlja3IubG9jYWxpemUgPSBmdW5jdGlvbiAobDEwbikge1xuICAgIGZsYXRwaWNrci5sMTBucy5kZWZhdWx0ID0gX19hc3NpZ24oX19hc3NpZ24oe30sIGZsYXRwaWNrci5sMTBucy5kZWZhdWx0KSwgbDEwbik7XG59O1xuZmxhdHBpY2tyLnNldERlZmF1bHRzID0gZnVuY3Rpb24gKGNvbmZpZykge1xuICAgIGZsYXRwaWNrci5kZWZhdWx0Q29uZmlnID0gX19hc3NpZ24oX19hc3NpZ24oe30sIGZsYXRwaWNrci5kZWZhdWx0Q29uZmlnKSwgY29uZmlnKTtcbn07XG5mbGF0cGlja3IucGFyc2VEYXRlID0gY3JlYXRlRGF0ZVBhcnNlcih7fSk7XG5mbGF0cGlja3IuZm9ybWF0RGF0ZSA9IGNyZWF0ZURhdGVGb3JtYXR0ZXIoe30pO1xuZmxhdHBpY2tyLmNvbXBhcmVEYXRlcyA9IGNvbXBhcmVEYXRlcztcbmlmICh0eXBlb2YgalF1ZXJ5ICE9PSBcInVuZGVmaW5lZFwiICYmIHR5cGVvZiBqUXVlcnkuZm4gIT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICBqUXVlcnkuZm4uZmxhdHBpY2tyID0gZnVuY3Rpb24gKGNvbmZpZykge1xuICAgICAgICByZXR1cm4gX2ZsYXRwaWNrcih0aGlzLCBjb25maWcpO1xuICAgIH07XG59XG5EYXRlLnByb3RvdHlwZS5mcF9pbmNyID0gZnVuY3Rpb24gKGRheXMpIHtcbiAgICByZXR1cm4gbmV3IERhdGUodGhpcy5nZXRGdWxsWWVhcigpLCB0aGlzLmdldE1vbnRoKCksIHRoaXMuZ2V0RGF0ZSgpICsgKHR5cGVvZiBkYXlzID09PSBcInN0cmluZ1wiID8gcGFyc2VJbnQoZGF5cywgMTApIDogZGF5cykpO1xufTtcbmlmICh0eXBlb2Ygd2luZG93ICE9PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgd2luZG93LmZsYXRwaWNrciA9IGZsYXRwaWNrcjtcbn1cbmV4cG9ydCBkZWZhdWx0IGZsYXRwaWNrcjtcbiIsICJpbXBvcnQgTWV0YWRhdGFNZW51IGZyb20gXCJtYWluXCI7XG5pbXBvcnQgRmllbGQgZnJvbSBcInNyYy9maWVsZHMvRmllbGRcIjtcbmltcG9ydCB7IEZpbGVDbGFzcyB9IGZyb20gXCJzcmMvZmlsZUNsYXNzL2ZpbGVDbGFzc1wiO1xuXG5leHBvcnQgZnVuY3Rpb24gZ2V0RmllbGQocGx1Z2luOiBNZXRhZGF0YU1lbnUsIHByb3BlcnR5TmFtZTogc3RyaW5nLCBmaWxlQ2xhc3M/OiBGaWxlQ2xhc3MpOiBGaWVsZCB8IHVuZGVmaW5lZCB7XG4gICAgY29uc3QgbWF0Y2hpbmdTZXR0aW5ncyA9IHBsdWdpbi5zZXR0aW5ncy5wcmVzZXRGaWVsZHMuZmlsdGVyKHAgPT4gcC5uYW1lID09IHByb3BlcnR5TmFtZSk7XG4gICAgaWYgKGZpbGVDbGFzcykge1xuICAgICAgICBjb25zdCBmaWxlQ2xhc3NBdHRyaWJ1dGVzV2l0aE5hbWUgPSBmaWxlQ2xhc3MuYXR0cmlidXRlcy5maWx0ZXIoYXR0ciA9PiBhdHRyLm5hbWUgPT0gcHJvcGVydHlOYW1lKTtcbiAgICAgICAgaWYgKGZpbGVDbGFzc0F0dHJpYnV0ZXNXaXRoTmFtZS5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICBjb25zdCBmaWxlQ2xhc3NBdHRyaWJ1dGUgPSBmaWxlQ2xhc3NBdHRyaWJ1dGVzV2l0aE5hbWVbMF07XG4gICAgICAgICAgICBpZiAoZmlsZUNsYXNzQXR0cmlidXRlLnR5cGUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmlsZUNsYXNzQXR0cmlidXRlLmdldEZpZWxkKCk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKG1hdGNoaW5nU2V0dGluZ3MubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBtYXRjaGluZ1NldHRpbmdzWzBdO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH0gZWxzZSBpZiAobWF0Y2hpbmdTZXR0aW5ncy5sZW5ndGggPiAwKSB7XG4gICAgICAgIHJldHVybiBtYXRjaGluZ1NldHRpbmdzWzBdO1xuICAgIH07XG59OyIsICJpbXBvcnQgRmllbGQgZnJvbSBcInNyYy9maWVsZHMvRmllbGRcIjtcbmltcG9ydCB7IEZpZWxkVHlwZSB9IGZyb20gXCJzcmMvdHlwZXMvZmllbGRUeXBlc1wiO1xuXG5jbGFzcyBGaWxlQ2xhc3NBdHRyaWJ1dGUge1xuXG4gICAgY29uc3RydWN0b3IoXG4gICAgICAgIHB1YmxpYyBvcmlnaW46IHN0cmluZyxcbiAgICAgICAgcHVibGljIG5hbWU6IHN0cmluZyxcbiAgICAgICAgcHVibGljIHR5cGU6IEZpZWxkVHlwZSA9IEZpZWxkVHlwZS5JbnB1dCxcbiAgICAgICAgcHVibGljIG9wdGlvbnM6IHN0cmluZ1tdIHwgUmVjb3JkPHN0cmluZywgYW55PiA9IFtdXG4gICAgKSB7IH1cblxuICAgIHB1YmxpYyBnZXRGaWVsZCgpIHtcbiAgICAgICAgbGV0IG9wdGlvbnM6IFJlY29yZDxzdHJpbmcsIHN0cmluZz4gPSB7fTtcbiAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkodGhpcy5vcHRpb25zKSkge1xuICAgICAgICAgICAgdGhpcy5vcHRpb25zPy5mb3JFYWNoKChvcHRpb24sIGluZGV4KSA9PiB7XG4gICAgICAgICAgICAgICAgb3B0aW9uc1tpbmRleF0gPSBvcHRpb247XG4gICAgICAgICAgICB9KVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgb3B0aW9ucyA9IHRoaXMub3B0aW9uc1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBuZXcgRmllbGQodGhpcy5uYW1lLCBvcHRpb25zLCB0aGlzLm5hbWUsIHRoaXMudHlwZSk7XG4gICAgfVxufVxuXG5leHBvcnQgeyBGaWxlQ2xhc3NBdHRyaWJ1dGUgfTsiLCAiaW1wb3J0IHsgRmlsZUNsYXNzQXR0cmlidXRlIH0gZnJvbSBcIi4vZmlsZUNsYXNzQXR0cmlidXRlXCI7XG5pbXBvcnQgTWV0YWRhdGFNZW51IGZyb20gXCJtYWluXCI7XG5pbXBvcnQgeyBURmlsZSB9IGZyb20gXCJvYnNpZGlhblwiO1xuaW1wb3J0IHsgRmllbGRUeXBlLCBGaWVsZFR5cGVMYWJlbE1hcHBpbmcgfSBmcm9tIFwic3JjL3R5cGVzL2ZpZWxkVHlwZXNcIjtcbmltcG9ydCB7IGNhcGl0YWxpemUgfSBmcm9tIFwic3JjL3V0aWxzL3RleHRVdGlsc1wiO1xuaW1wb3J0IHsgZ2VudWluZUtleXMgfSBmcm9tIFwic3JjL3V0aWxzL2RhdGF2aWV3VXRpbHNcIjtcblxuaW50ZXJmYWNlIEZpbGVDbGFzcyB7XG4gICAgYXR0cmlidXRlczogQXJyYXk8RmlsZUNsYXNzQXR0cmlidXRlPjtcbiAgICBvYmplY3RzOiBGaWxlQ2xhc3NNYW5hZ2VyO1xuICAgIGVycm9yczogc3RyaW5nW107XG4gICAgcGFyZW50PzogRmlsZUNsYXNzO1xuICAgIGV4Y2x1ZGVzPzogQXJyYXk8RmlsZUNsYXNzQXR0cmlidXRlPjtcbn1cblxuY2xhc3MgRmlsZUNsYXNzTWFuYWdlciB7XG5cbiAgICBjb25zdHJ1Y3RvcihwdWJsaWMgaW5zdGFuY2U6IEZpbGVDbGFzcykgeyB9XG5cbiAgICBwdWJsaWMgYWxsKCkge1xuICAgICAgICBjb25zdCBmaWxlc1dpdGhGaWxlQ2xhc3NOYW1lID0gdGhpcy5pbnN0YW5jZS5wbHVnaW4uYXBwLnZhdWx0LmdldE1hcmtkb3duRmlsZXMoKS5maWx0ZXIoZmlsZSA9PiB7XG4gICAgICAgICAgICBjb25zdCBjYWNoZSA9IHRoaXMuaW5zdGFuY2UucGx1Z2luLmFwcC5tZXRhZGF0YUNhY2hlLmdldEZpbGVDYWNoZShmaWxlKTtcbiAgICAgICAgICAgIGNvbnN0IGZpbGVDbGFzc0FsaWFzID0gdGhpcy5pbnN0YW5jZS5wbHVnaW4uc2V0dGluZ3MuZmlsZUNsYXNzQWxpYXM7XG4gICAgICAgICAgICByZXR1cm4gY2FjaGU/LmZyb250bWF0dGVyXG4gICAgICAgICAgICAgICAgJiYgT2JqZWN0LmtleXMoY2FjaGUuZnJvbnRtYXR0ZXIpLmluY2x1ZGVzKGZpbGVDbGFzc0FsaWFzKVxuICAgICAgICAgICAgICAgICYmIGNhY2hlLmZyb250bWF0dGVyW2ZpbGVDbGFzc0FsaWFzXSA9PSB0aGlzLmluc3RhbmNlLm5hbWU7XG4gICAgICAgIH0pXG4gICAgICAgIHJldHVybiBmaWxlc1dpdGhGaWxlQ2xhc3NOYW1lO1xuICAgIH1cblxuICAgIHB1YmxpYyBnZXQobmFtZTogc3RyaW5nKSB7XG4gICAgICAgIGNvbnN0IGZpbGVzV2l0aE5hbWUgPSB0aGlzLmFsbCgpLmZpbHRlcihmaWxlID0+IGZpbGUuYmFzZW5hbWUgPT0gbmFtZSk7XG4gICAgICAgIGlmIChmaWxlc1dpdGhOYW1lLmxlbmd0aCA+IDEpIHtcbiAgICAgICAgICAgIGNvbnN0IGVycm9yID0gbmV3IEVycm9yKFwiTW9yZSB0aGFuIG9uZSB2YWx1ZSBmb3VuZFwiKTtcbiAgICAgICAgICAgIHRocm93IGVycm9yO1xuICAgICAgICB9XG4gICAgICAgIGlmIChmaWxlc1dpdGhOYW1lLmxlbmd0aCA9PSAwKSB7XG4gICAgICAgICAgICBjb25zdCBlcnJvciA9IG5ldyBFcnJvcihcIk5vIGZpbGUgdmFsdWUgZm91bmRcIik7XG4gICAgICAgICAgICB0aHJvdyBlcnJvcjtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmlsZXNXaXRoTmFtZVswXTtcblxuICAgIH1cblxuICAgIHB1YmxpYyBnZXRQYXRoKHBhdGg6IHN0cmluZykge1xuICAgICAgICBjb25zdCBmaWxlc1dpdGhOYW1lID0gdGhpcy5hbGwoKS5maWx0ZXIoZmlsZSA9PiBmaWxlLnBhdGggPT0gcGF0aCk7XG4gICAgICAgIGlmIChmaWxlc1dpdGhOYW1lLmxlbmd0aCA+IDEpIHtcbiAgICAgICAgICAgIGNvbnN0IGVycm9yID0gbmV3IEVycm9yKFwiTW9yZSB0aGFuIG9uZSB2YWx1ZSBmb3VuZFwiKTtcbiAgICAgICAgICAgIHRocm93IGVycm9yO1xuICAgICAgICB9XG4gICAgICAgIGlmIChmaWxlc1dpdGhOYW1lLmxlbmd0aCA9PSAwKSB7XG4gICAgICAgICAgICBjb25zdCBlcnJvciA9IG5ldyBFcnJvcihcIk5vIGZpbGUgdmFsdWUgZm91bmRcIik7XG4gICAgICAgICAgICB0aHJvdyBlcnJvcjtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmlsZXNXaXRoTmFtZVswXTtcblxuICAgIH1cbn1cblxuY2xhc3MgRmlsZUNsYXNzIHtcbiAgICBjb25zdHJ1Y3RvcihwdWJsaWMgcGx1Z2luOiBNZXRhZGF0YU1lbnUsIHB1YmxpYyBuYW1lOiBzdHJpbmcpIHtcbiAgICAgICAgdGhpcy5vYmplY3RzID0gbmV3IEZpbGVDbGFzc01hbmFnZXIodGhpcyk7XG4gICAgICAgIHRoaXMuYXR0cmlidXRlcyA9IFtdO1xuICAgIH1cblxuICAgIHB1YmxpYyBnZXRDbGFzc0ZpbGUoKTogVEZpbGUge1xuICAgICAgICBjb25zdCBmaWxlc0NsYXNzUGF0aCA9IHRoaXMucGx1Z2luLnNldHRpbmdzLmNsYXNzRmlsZXNQYXRoO1xuICAgICAgICBjb25zdCBmaWxlID0gdGhpcy5wbHVnaW4uYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChgJHtmaWxlc0NsYXNzUGF0aH0ke3RoaXMubmFtZX0ubWRgKTtcbiAgICAgICAgaWYgKGZpbGUgaW5zdGFuY2VvZiBURmlsZSAmJiBmaWxlLmV4dGVuc2lvbiA9PSBcIm1kXCIpIHtcbiAgICAgICAgICAgIHJldHVybiBmaWxlO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29uc3QgZXJyb3IgPSBuZXcgRXJyb3IoXG4gICAgICAgICAgICAgICAgYG5vIGZpbGUgbmFtZWQgPCR7dGhpcy5uYW1lfS5tZD4gaW4gPCR7ZmlsZXNDbGFzc1BhdGh9PiBmb2xkZXIgdG8gbWF0Y2ggPCR7dGhpcy5wbHVnaW4uc2V0dGluZ3MuZmlsZUNsYXNzQWxpYXN9OiAke3RoaXMubmFtZX0+IGluIG9uZSBvZiB0aGVzZSBub3Rlc2BcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICB0aHJvdyBlcnJvcjtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHB1YmxpYyBnZXRQYXJlbnRDbGFzcygpOiBGaWxlQ2xhc3MgfCB1bmRlZmluZWQge1xuICAgICAgICByZXR1cm5cbiAgICB9XG5cbiAgICBwdWJsaWMgZ2V0QXR0cmlidXRlcyhleGNsdWRlUGFyZW50czogYm9vbGVhbiA9IGZhbHNlKTogdm9pZCB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCBmaWxlID0gdGhpcy5nZXRDbGFzc0ZpbGUoKTtcbiAgICAgICAgICAgIGxldCBwYXJlbnRBdHRyaWJ1dGVzOiBBcnJheTxGaWxlQ2xhc3NBdHRyaWJ1dGU+ID0gW107XG4gICAgICAgICAgICBsZXQgZXJyb3JzOiBzdHJpbmdbXSA9IFtdO1xuICAgICAgICAgICAgY29uc3QgcGFyZW50ID0gdGhpcy5wbHVnaW4uYXBwLm1ldGFkYXRhQ2FjaGUuZ2V0RmlsZUNhY2hlKGZpbGUpPy5mcm9udG1hdHRlcj8uZXh0ZW5kc1xuICAgICAgICAgICAgY29uc3QgZXhjbHVkZWRGaWVsZHMgPSB0aGlzLnBsdWdpbi5hcHAubWV0YWRhdGFDYWNoZS5nZXRGaWxlQ2FjaGUoZmlsZSk/LmZyb250bWF0dGVyPy5leGNsdWRlc1xuICAgICAgICAgICAgaWYgKHBhcmVudCAmJiAhZXhjbHVkZVBhcmVudHMpIHtcbiAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBwYXJlbnRGaWxlQ2xhc3MgPSBGaWxlQ2xhc3MuY3JlYXRlRmlsZUNsYXNzKHRoaXMucGx1Z2luLCBwYXJlbnQpO1xuICAgICAgICAgICAgICAgICAgICBwYXJlbnRGaWxlQ2xhc3MuZ2V0QXR0cmlidXRlcygpO1xuICAgICAgICAgICAgICAgICAgICBwYXJlbnRBdHRyaWJ1dGVzID0gQXJyYXkuaXNBcnJheShleGNsdWRlZEZpZWxkcykgPyBbLi4ucGFyZW50RmlsZUNsYXNzLmF0dHJpYnV0ZXMuZmlsdGVyKGF0dHIgPT4gIWV4Y2x1ZGVkRmllbGRzLmluY2x1ZGVzKGF0dHIubmFtZSkpXSA6IFsuLi5wYXJlbnRGaWxlQ2xhc3MuYXR0cmlidXRlc11cbiAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICBlcnJvcnMucHVzaChlcnJvcilcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBsZXQgYXR0cmlidXRlczogQXJyYXk8RmlsZUNsYXNzQXR0cmlidXRlPiA9IFtdO1xuICAgICAgICAgICAgY29uc3QgZGF0YXZpZXcgPSB0aGlzLnBsdWdpbi5hcHAucGx1Z2lucy5wbHVnaW5zW1wiZGF0YXZpZXdcIl1cbiAgICAgICAgICAgIC8vQHRzLWlnbm9yZVxuICAgICAgICAgICAgaWYgKGRhdGF2aWV3KSB7XG4gICAgICAgICAgICAgICAgY29uc3QgZHZGaWxlID0gZGF0YXZpZXcuYXBpLnBhZ2UoZmlsZS5wYXRoKVxuICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgIGdlbnVpbmVLZXlzKGR2RmlsZSkuZm9yRWFjaChrZXkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGtleSAhPT0gXCJmaWxlXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBpdGVtID0gdHlwZW9mIGR2RmlsZVtrZXldICE9PSBcInN0cmluZ1wiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gSlNPTi5zdHJpbmdpZnkoZHZGaWxlW2tleV0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogZHZGaWxlW2tleV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgeyB0eXBlLCBvcHRpb25zIH0gPSBKU09OLnBhcnNlKGl0ZW0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBmaWVsZFR5cGUgPSBGaWVsZFR5cGVMYWJlbE1hcHBpbmdbY2FwaXRhbGl6ZSh0eXBlKSBhcyBrZXlvZiB0eXBlb2YgRmllbGRUeXBlXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgYXR0ciA9IG5ldyBGaWxlQ2xhc3NBdHRyaWJ1dGUodGhpcy5uYW1lLCBrZXksIGZpZWxkVHlwZSwgb3B0aW9ucylcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9kZWR1cGxpY2F0ZSBmaWVsZHNcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXR0cmlidXRlcy5wdXNoKGF0dHIpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL2RvIG5vdGhpbmdcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgKGVycm9yKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLmF0dHJpYnV0ZXMgPSBwYXJlbnRBdHRyaWJ1dGVzXG4gICAgICAgICAgICAgICAgLmZpbHRlcihhdHRyID0+ICFhdHRyaWJ1dGVzXG4gICAgICAgICAgICAgICAgICAgIC5tYXAoX2F0dHIgPT4gX2F0dHIubmFtZSlcbiAgICAgICAgICAgICAgICAgICAgLmluY2x1ZGVzKGF0dHIubmFtZSlcbiAgICAgICAgICAgICAgICApLmNvbmNhdChhdHRyaWJ1dGVzLmZpbHRlcihwID0+ICFPYmplY3Qua2V5cyh0aGlzLnBsdWdpbi5hcHAubWV0YWRhdGFDYWNoZS5nZXRGaWxlQ2FjaGUoZmlsZSk/LmZyb250bWF0dGVyIHx8IHt9KS5pbmNsdWRlcyhwLm5hbWUpKSk7XG4gICAgICAgICAgICB0aGlzLmVycm9ycyA9IGVycm9ycztcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIHRocm93IChlcnJvcik7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwdWJsaWMgYXN5bmMgdXBkYXRlQXR0cmlidXRlKG5ld1R5cGU6IGtleW9mIHR5cGVvZiBGaWVsZFR5cGUsIG5ld05hbWU6IHN0cmluZywgbmV3T3B0aW9ucz86IHN0cmluZ1tdIHwgUmVjb3JkPHN0cmluZywgc3RyaW5nPiwgYXR0cj86IEZpbGVDbGFzc0F0dHJpYnV0ZSk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICBjb25zdCBmaWxlID0gdGhpcy5nZXRDbGFzc0ZpbGUoKTtcbiAgICAgICAgbGV0IHJlc3VsdCA9IGF3YWl0IHRoaXMucGx1Z2luLmFwcC52YXVsdC5yZWFkKGZpbGUpXG4gICAgICAgIGlmIChhdHRyKSB7XG4gICAgICAgICAgICBsZXQgbmV3Q29udGVudDogc3RyaW5nW10gPSBbXTtcbiAgICAgICAgICAgIHJlc3VsdC5zcGxpdCgnXFxuJykuZm9yRWFjaChsaW5lID0+IHtcbiAgICAgICAgICAgICAgICBpZiAobGluZS5zdGFydHNXaXRoKGF0dHIubmFtZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgbGV0IHNldHRpbmdzOiBSZWNvcmQ8c3RyaW5nLCBhbnk+ID0ge307XG4gICAgICAgICAgICAgICAgICAgIHNldHRpbmdzW1widHlwZVwiXSA9IG5ld1R5cGU7XG4gICAgICAgICAgICAgICAgICAgIGlmIChuZXdPcHRpb25zKSBzZXR0aW5nc1tcIm9wdGlvbnNcIl0gPSBuZXdPcHRpb25zO1xuICAgICAgICAgICAgICAgICAgICBuZXdDb250ZW50LnB1c2goYCR7bmV3TmFtZX06OiAke0pTT04uc3RyaW5naWZ5KHNldHRpbmdzKX1gKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBuZXdDb250ZW50LnB1c2gobGluZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIHRoaXMucGx1Z2luLmFwcC52YXVsdC5tb2RpZnkoZmlsZSwgbmV3Q29udGVudC5qb2luKCdcXG4nKSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBsZXQgc2V0dGluZ3M6IFJlY29yZDxzdHJpbmcsIGFueT4gPSB7fTtcbiAgICAgICAgICAgIHNldHRpbmdzW1widHlwZVwiXSA9IG5ld1R5cGU7XG4gICAgICAgICAgICBpZiAobmV3T3B0aW9ucykgc2V0dGluZ3NbXCJvcHRpb25zXCJdID0gbmV3T3B0aW9ucztcbiAgICAgICAgICAgIHJlc3VsdCArPSAoYFxcbiR7bmV3TmFtZX06OiAke0pTT04uc3RyaW5naWZ5KHNldHRpbmdzKX1gKTtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLmFwcC52YXVsdC5tb2RpZnkoZmlsZSwgcmVzdWx0KTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHB1YmxpYyBhc3luYyByZW1vdmVBdHRyaWJ1dGUoYXR0cjogRmlsZUNsYXNzQXR0cmlidXRlKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIGNvbnN0IGZpbGUgPSB0aGlzLmdldENsYXNzRmlsZSgpO1xuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLnBsdWdpbi5hcHAudmF1bHQucmVhZChmaWxlKVxuICAgICAgICBsZXQgbmV3Q29udGVudDogc3RyaW5nW10gPSBbXTtcbiAgICAgICAgcmVzdWx0LnNwbGl0KCdcXG4nKS5mb3JFYWNoKGxpbmUgPT4ge1xuICAgICAgICAgICAgaWYgKCFsaW5lLnN0YXJ0c1dpdGgoYXR0ci5uYW1lKSkge1xuICAgICAgICAgICAgICAgIG5ld0NvbnRlbnQucHVzaChsaW5lKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSlcbiAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uYXBwLnZhdWx0Lm1vZGlmeShmaWxlLCBuZXdDb250ZW50LmpvaW4oJ1xcbicpKTtcbiAgICB9XG5cbiAgICBzdGF0aWMgY3JlYXRlRmlsZUNsYXNzKHBsdWdpbjogTWV0YWRhdGFNZW51LCBuYW1lOiBzdHJpbmcsIGV4Y2x1ZGVQYXJlbnQ6IGJvb2xlYW4gPSBmYWxzZSk6IEZpbGVDbGFzcyB7XG4gICAgICAgIGNvbnN0IGZpbGVDbGFzcyA9IG5ldyBGaWxlQ2xhc3MocGx1Z2luLCBuYW1lKTtcbiAgICAgICAgZmlsZUNsYXNzLmdldEF0dHJpYnV0ZXMoZXhjbHVkZVBhcmVudClcbiAgICAgICAgcmV0dXJuIGZpbGVDbGFzc1xuICAgIH1cbn1cblxuXG5leHBvcnQgeyBGaWxlQ2xhc3MgfTsiLCAiZXhwb3J0IGNvbnN0IGNhcGl0YWxpemUgPSAoczogc3RyaW5nKSA9PiB7XG4gICAgcmV0dXJuIHMgJiYgc1swXS50b1VwcGVyQ2FzZSgpICsgcy5zbGljZSgxKTtcbn0iLCAiZXhwb3J0IGZ1bmN0aW9uIGdlbnVpbmVLZXlzKGR2RmlsZTogYW55KTogc3RyaW5nW10ge1xuICAgIGNvbnN0IGdlbnVpbmVLZXlzOiBzdHJpbmdbXSA9IFtdXG4gICAgT2JqZWN0LmtleXMoZHZGaWxlKS5mb3JFYWNoKGtleSA9PiB7XG4gICAgICAgIGlmICghZ2VudWluZUtleXMubWFwKGsgPT4gay50b0xvd2VyQ2FzZSgpLnJlcGxhY2UoL1xccy9nLCBcIi1cIikpLmluY2x1ZGVzKGtleS50b0xvd2VyQ2FzZSgpLnJlcGxhY2UoL1xccy9nLCBcIi1cIikpKSB7XG4gICAgICAgICAgICBnZW51aW5lS2V5cy5wdXNoKGtleSlcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGlmIChrZXkgIT09IGtleS50b0xvd2VyQ2FzZSgpLnJlcGxhY2UoL1xccy9nLCBcIi1cIikpIHtcbiAgICAgICAgICAgICAgICBnZW51aW5lS2V5c1tnZW51aW5lS2V5cy5pbmRleE9mKGtleS50b0xvd2VyQ2FzZSgpLnJlcGxhY2UoL1xccy9nLCBcIi1cIikpXSA9IGtleVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSlcbiAgICByZXR1cm4gZ2VudWluZUtleXNcbn0iLCAiaW1wb3J0IE1ldGFkYXRhTWVudSBmcm9tIFwibWFpblwiO1xuaW1wb3J0IHsgTWVudSwgTm90aWNlLCBzZXRJY29uLCBUZXh0QXJlYUNvbXBvbmVudCwgVEZpbGUgfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCBGaWVsZENvbW1hbmRTdWdnZXN0TW9kYWwgZnJvbSBcInNyYy9vcHRpb25zL0ZpZWxkQ29tbWFuZFN1Z2dlc3RNb2RhbFwiO1xuaW1wb3J0IE11bHRpRmlsZU1vZGFsIGZyb20gXCJzcmMvb3B0aW9uTW9kYWxzL2ZpZWxkcy9NdWx0aUZpbGVNb2RhbFwiO1xuaW1wb3J0IEZpZWxkU2V0dGluZ3NNb2RhbCBmcm9tIFwic3JjL3NldHRpbmdzL0ZpZWxkU2V0dGluZ3NNb2RhbFwiO1xuaW1wb3J0IHsgRmllbGRJY29uLCBGaWVsZFR5cGUgfSBmcm9tIFwic3JjL3R5cGVzL2ZpZWxkVHlwZXNcIjtcbmltcG9ydCBGaWVsZCBmcm9tIFwiLi4vRmllbGRcIjtcbmltcG9ydCB7IEZpZWxkTWFuYWdlciwgU2V0dGluZ0xvY2F0aW9uIH0gZnJvbSBcIi4uL0ZpZWxkTWFuYWdlclwiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBNdWx0aUZpbGVGaWVsZCBleHRlbmRzIEZpZWxkTWFuYWdlciB7XG5cbiAgICBwcml2YXRlIGZpbGVWYWxpZGF0b3JGaWVsZDogSFRNTERpdkVsZW1lbnRcbiAgICBwcml2YXRlIGR2UXVlcnlTdHJpbmc6IFRleHRBcmVhQ29tcG9uZW50XG5cbiAgICBjb25zdHJ1Y3RvcihwbHVnaW46IE1ldGFkYXRhTWVudSwgZmllbGQ6IEZpZWxkKSB7XG4gICAgICAgIHN1cGVyKHBsdWdpbiwgZmllbGQsIEZpZWxkVHlwZS5NdWx0aUZpbGUpXG4gICAgfVxuXG4gICAgc3RhdGljIGJ1aWxkTWFya0Rvd25MaW5rKHBsdWdpbjogTWV0YWRhdGFNZW51LCBmaWxlOiBURmlsZSwgcGF0aDogc3RyaW5nKTogc3RyaW5nIHtcbiAgICAgICAgY29uc3QgZGVzdEZpbGUgPSBwbHVnaW4uYXBwLm1ldGFkYXRhQ2FjaGUuZ2V0Rmlyc3RMaW5rcGF0aERlc3QocGF0aCwgZmlsZS5wYXRoKVxuICAgICAgICBpZiAoZGVzdEZpbGUpIHtcbiAgICAgICAgICAgIHJldHVybiBwbHVnaW4uYXBwLmZpbGVNYW5hZ2VyLmdlbmVyYXRlTWFya2Rvd25MaW5rKFxuICAgICAgICAgICAgICAgIGRlc3RGaWxlLFxuICAgICAgICAgICAgICAgIGZpbGUucGF0aCxcbiAgICAgICAgICAgICAgICB1bmRlZmluZWQsXG4gICAgICAgICAgICAgICAgZGVzdEZpbGUuYmFzZW5hbWVcbiAgICAgICAgICAgIClcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gXCJcIlxuICAgIH1cblxuICAgIHByaXZhdGUgZ2V0RmlsZXMgPSAoY3VycmVudEZpbGU/OiBURmlsZSk6IFRGaWxlW10gPT4ge1xuICAgICAgICAvL0B0cy1pZ25vcmVcbiAgICAgICAgY29uc3QgZ2V0UmVzdWx0cyA9IChhcGk6IERhdGF2aWV3UGx1Z2luW1wiYXBpXCJdKSA9PiB7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIHJldHVybiAobmV3IEZ1bmN0aW9uKFwiZHZcIiwgXCJjdXJyZW50XCIsIGByZXR1cm4gJHt0aGlzLmZpZWxkLm9wdGlvbnMuZHZRdWVyeVN0cmluZ31gKSkoYXBpLCBhcGkucGFnZShjdXJyZW50RmlsZT8ucGF0aCkpXG4gICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgIG5ldyBOb3RpY2UoYFdyb25nIHF1ZXJ5IGZvciBmaWVsZCA8JHt0aGlzLmZpZWxkLm5hbWV9PlxcbmNoZWNrIHlvdXIgc2V0dGluZ3NgLCAzMDAwKVxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBjb25zdCBkYXRhdmlldyA9IHRoaXMucGx1Z2luLmFwcC5wbHVnaW5zLnBsdWdpbnNbXCJkYXRhdmlld1wiXVxuICAgICAgICAvL0B0cy1pZ25vcmVcbiAgICAgICAgaWYgKHRoaXMuZmllbGQub3B0aW9ucy5kdlF1ZXJ5U3RyaW5nICYmIGRhdGF2aWV3Py5zZXR0aW5ncy5lbmFibGVEYXRhdmlld0pzICYmIGRhdGF2aWV3Py5zZXR0aW5ncy5lbmFibGVJbmxpbmVEYXRhdmlld0pzKSB7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGZpbGVzUGF0aCA9IGdldFJlc3VsdHMoZGF0YXZpZXcuYXBpKS52YWx1ZXMubWFwKCh2OiBhbnkpID0+IHYuZmlsZS5wYXRoKVxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnBsdWdpbi5hcHAudmF1bHQuZ2V0TWFya2Rvd25GaWxlcygpLmZpbHRlcihmID0+IGZpbGVzUGF0aC5pbmNsdWRlcyhmLnBhdGgpKTtcbiAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgKGVycm9yKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnBsdWdpbi5hcHAudmF1bHQuZ2V0TWFya2Rvd25GaWxlcygpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHVibGljIGFkZEZpZWxkT3B0aW9uKG5hbWU6IHN0cmluZywgdmFsdWU6IGFueSwgZmlsZTogVEZpbGUsIGxvY2F0aW9uOiBNZW51IHwgRmllbGRDb21tYW5kU3VnZ2VzdE1vZGFsKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IG1vZGFsID0gbmV3IE11bHRpRmlsZU1vZGFsKHRoaXMucGx1Z2luLCBmaWxlLCB0aGlzLmZpZWxkLCB2YWx1ZSlcbiAgICAgICAgaWYgKE11bHRpRmlsZUZpZWxkLmlzTWVudShsb2NhdGlvbikpIHtcbiAgICAgICAgICAgIGxvY2F0aW9uLmFkZEl0ZW0oKGl0ZW0pID0+IHtcbiAgICAgICAgICAgICAgICBpdGVtLnNldFRpdGxlKGBVcGRhdGUgJHtuYW1lfWApO1xuICAgICAgICAgICAgICAgIGl0ZW0uc2V0SWNvbihGaWVsZEljb25bRmllbGRUeXBlLkZpbGVdKTtcbiAgICAgICAgICAgICAgICBpdGVtLm9uQ2xpY2soKCkgPT4gbW9kYWwub3BlbigpKTtcbiAgICAgICAgICAgICAgICBpdGVtLnNldFNlY3Rpb24oXCJtZXRhZGF0YS1tZW51LmZpZWxkc1wiKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9IGVsc2UgaWYgKE11bHRpRmlsZUZpZWxkLmlzU3VnZ2VzdChsb2NhdGlvbikpIHtcbiAgICAgICAgICAgIGxvY2F0aW9uLm9wdGlvbnMucHVzaCh7XG4gICAgICAgICAgICAgICAgaWQ6IGB1cGRhdGVfJHtuYW1lfWAsXG4gICAgICAgICAgICAgICAgYWN0aW9uTGFiZWw6IGA8c3Bhbj5VcGRhdGUgPGI+JHtuYW1lfTwvYj48L3NwYW4+YCxcbiAgICAgICAgICAgICAgICBhY3Rpb246ICgpID0+IG1vZGFsLm9wZW4oKSxcbiAgICAgICAgICAgICAgICBpY29uOiBGaWVsZEljb25bRmllbGRUeXBlLkZpbGVdXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICBwdWJsaWMgY3JlYXRlQW5kT3BlbkZpZWxkTW9kYWwoZmlsZTogVEZpbGUsIHNlbGVjdGVkRmllbGROYW1lOiBzdHJpbmcsIHZhbHVlPzogc3RyaW5nLCBsaW5lTnVtYmVyPzogbnVtYmVyLCBpbkZyb250bWF0dGVyPzogYm9vbGVhbiwgYWZ0ZXI/OiBib29sZWFuKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IGZpZWxkTW9kYWwgPSBuZXcgTXVsdGlGaWxlTW9kYWwodGhpcy5wbHVnaW4sIGZpbGUsIHRoaXMuZmllbGQsIHZhbHVlLCBsaW5lTnVtYmVyLCBpbkZyb250bWF0dGVyLCBhZnRlcik7XG4gICAgICAgIGZpZWxkTW9kYWwudGl0bGVFbC5zZXRUZXh0KGBFbnRlciB2YWx1ZSBmb3IgJHtzZWxlY3RlZEZpZWxkTmFtZX1gKTtcbiAgICAgICAgZmllbGRNb2RhbC5vcGVuKCk7XG4gICAgfVxuXG4gICAgcHVibGljIGNyZWF0ZUR2RmllbGQoXG4gICAgICAgIGR2OiBhbnksXG4gICAgICAgIHA6IGFueSxcbiAgICAgICAgZmllbGRDb250YWluZXI6IEhUTUxFbGVtZW50LFxuICAgICAgICBhdHRycz86IHsgY2xzPzogc3RyaW5nLCBhdHRyPzogUmVjb3JkPHN0cmluZywgc3RyaW5nPiwgb3B0aW9ucz86IFJlY29yZDxzdHJpbmcsIHN0cmluZz4gfVxuICAgICk6IHZvaWQge1xuICAgICAgICBjb25zdCBmaWVsZFZhbHVlID0gZHYuZWwoJ3NwYW4nLCBwW3RoaXMuZmllbGQubmFtZV0sIGF0dHJzKTtcbiAgICAgICAgY29uc3Qgc2VhcmNoQnRuID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImJ1dHRvblwiKVxuICAgICAgICBzZXRJY29uKHNlYXJjaEJ0biwgRmllbGRJY29uW0ZpZWxkVHlwZS5GaWxlXSlcbiAgICAgICAgc2VhcmNoQnRuLmFkZENsYXNzKFwibWV0YWRhdGEtbWVudS1kdi1maWVsZC1idXR0b25cIilcbiAgICAgICAgLyogZW5kIHNwYWNlciAqL1xuICAgICAgICBjb25zdCBzcGFjZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpXG4gICAgICAgIHNwYWNlci5zZXRBdHRyKFwiY2xhc3NcIiwgXCJtZXRhZGF0YS1tZW51LWR2LWZpZWxkLXNwYWNlclwiKVxuXG4gICAgICAgIGNvbnN0IGZpbGUgPSB0aGlzLnBsdWdpbi5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKHBbXCJmaWxlXCJdW1wicGF0aFwiXSlcbiAgICAgICAgLy9sZXQgZmllbGRNb2RhbDogU2luZ2xlRmlsZU1vZGFsO1xuICAgICAgICBsZXQgZmllbGRNb2RhbDogTXVsdGlGaWxlTW9kYWw7XG4gICAgICAgIGlmIChmaWxlIGluc3RhbmNlb2YgVEZpbGUgJiYgZmlsZS5leHRlbnNpb24gPT0gXCJtZFwiKSB7XG4gICAgICAgICAgICBmaWVsZE1vZGFsID0gbmV3IE11bHRpRmlsZU1vZGFsKHRoaXMucGx1Z2luLCBmaWxlLCB0aGlzLmZpZWxkLCBwW3RoaXMuZmllbGQubmFtZV0pXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aHJvdyBFcnJvcihcInBhdGggZG9lc24ndCBjb3JyZXNwb25kIHRvIGEgcHJvcGVyIGZpbGVcIik7XG4gICAgICAgIH1cbiAgICAgICAgc2VhcmNoQnRuLm9uY2xpY2sgPSAoKSA9PiB7XG4gICAgICAgICAgICBmaWVsZE1vZGFsLm9wZW4oKVxuICAgICAgICB9XG5cbiAgICAgICAgaWYgKCFhdHRycz8ub3B0aW9ucz8uYWx3YXlzT24pIHtcbiAgICAgICAgICAgIHNlYXJjaEJ0bi5oaWRlKClcbiAgICAgICAgICAgIHNwYWNlci5zaG93KClcbiAgICAgICAgICAgIGZpZWxkQ29udGFpbmVyLm9ubW91c2VvdmVyID0gKCkgPT4ge1xuICAgICAgICAgICAgICAgIHNlYXJjaEJ0bi5zaG93KClcbiAgICAgICAgICAgICAgICBzcGFjZXIuaGlkZSgpXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmaWVsZENvbnRhaW5lci5vbm1vdXNlb3V0ID0gKCkgPT4ge1xuICAgICAgICAgICAgICAgIHNlYXJjaEJ0bi5oaWRlKClcbiAgICAgICAgICAgICAgICBzcGFjZXIuc2hvdygpXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvKiBpbml0aWFsIHN0YXRlICovXG4gICAgICAgIGZpZWxkQ29udGFpbmVyLmFwcGVuZENoaWxkKGZpZWxkVmFsdWUpO1xuICAgICAgICBmaWVsZENvbnRhaW5lci5hcHBlbmRDaGlsZChzZWFyY2hCdG4pO1xuICAgICAgICBmaWVsZENvbnRhaW5lci5hcHBlbmRDaGlsZChzcGFjZXIpO1xuICAgIH1cblxuICAgIHByaXZhdGUgY3JlYXRlRmlsZUNvbnRhaW5lcihwYXJlbnRDb250YWluZXI6IEhUTUxEaXZFbGVtZW50KTogdm9pZCB7XG4gICAgICAgIGNvbnN0IGR2UXVlcnlTdHJpbmdDb250YWluZXIgPSBwYXJlbnRDb250YWluZXIuY3JlYXRlRGl2KCk7XG4gICAgICAgIGR2UXVlcnlTdHJpbmdDb250YWluZXIuY3JlYXRlRWwoXCJzcGFuXCIsIHsgdGV4dDogXCJEYXRhdmlldyBRdWVyeSAob3B0aW9uYWwpXCIsIGNsczogJ21ldGFkYXRhLW1lbnUtZmllbGQtb3B0aW9uJyB9KTtcbiAgICAgICAgdGhpcy5kdlF1ZXJ5U3RyaW5nID0gbmV3IFRleHRBcmVhQ29tcG9uZW50KGR2UXVlcnlTdHJpbmdDb250YWluZXIpO1xuICAgICAgICB0aGlzLmR2UXVlcnlTdHJpbmcuaW5wdXRFbC5jb2xzID0gNTA7XG4gICAgICAgIHRoaXMuZHZRdWVyeVN0cmluZy5pbnB1dEVsLnJvd3MgPSA0O1xuICAgICAgICB0aGlzLmR2UXVlcnlTdHJpbmcuc2V0VmFsdWUodGhpcy5maWVsZC5vcHRpb25zLmR2UXVlcnlTdHJpbmcgfHwgXCJcIik7XG5cbiAgICAgICAgdGhpcy5kdlF1ZXJ5U3RyaW5nLm9uQ2hhbmdlKHZhbHVlID0+IHtcbiAgICAgICAgICAgIHRoaXMuZmllbGQub3B0aW9ucy5kdlF1ZXJ5U3RyaW5nID0gdmFsdWU7XG4gICAgICAgICAgICBGaWVsZFNldHRpbmdzTW9kYWwucmVtb3ZlVmFsaWRhdGlvbkVycm9yKHRoaXMuZHZRdWVyeVN0cmluZyk7XG4gICAgICAgIH0pXG5cbiAgICAgICAgY29uc3QgY3VzdG9tZVJlbmRlcmluZ0NvbnRhaW5lciA9IHBhcmVudENvbnRhaW5lci5jcmVhdGVEaXYoKTtcbiAgICAgICAgY3VzdG9tZVJlbmRlcmluZ0NvbnRhaW5lci5jcmVhdGVFbChcInNwYW5cIiwgeyB0ZXh0OiBcIkFsaWFzXCIsIGNsczogJ21ldGFkYXRhLW1lbnUtZmllbGQtb3B0aW9uJyB9KTtcbiAgICAgICAgY3VzdG9tZVJlbmRlcmluZ0NvbnRhaW5lci5jcmVhdGVFbChcInNwYW5cIiwgeyB0ZXh0OiBcIlBlcnNvbmFsaXNlIHRoZSByZW5kZXJpbmcgb2YgeW91ciBsaW5rcycgYWxpYXNlcyB3aXRoIGEgZnVuY3Rpb24gcmV0dXJuaW5nIGEgc3RyaW5nICg8cGFnZT4gb2JqZWN0IGlzIGF2YWlsYWJsZSlcIiwgY2xzOiAnbWV0YWRhdGEtbWVudS1maWVsZC1vcHRpb24tc3VidGV4dCcgfSk7XG4gICAgICAgIGN1c3RvbWVSZW5kZXJpbmdDb250YWluZXIuY3JlYXRlRWwoXCJjb2RlXCIsIHtcbiAgICAgICAgICAgIHRleHQ6IGBmdW5jdGlvbihwYWdlKSB7IHJldHVybiA8ZnVuY3Rpb24gdXNpbmcgXCJwYWdlXCI+OyB9YFxuICAgICAgICB9KVxuICAgICAgICBjb25zdCBjdXN0b21SZW5kZXJpbmcgPSBuZXcgVGV4dEFyZWFDb21wb25lbnQoY3VzdG9tZVJlbmRlcmluZ0NvbnRhaW5lcik7XG4gICAgICAgIGN1c3RvbVJlbmRlcmluZy5pbnB1dEVsLmNvbHMgPSA1MDtcbiAgICAgICAgY3VzdG9tUmVuZGVyaW5nLmlucHV0RWwucm93cyA9IDQ7XG4gICAgICAgIGN1c3RvbVJlbmRlcmluZy5zZXRWYWx1ZSh0aGlzLmZpZWxkLm9wdGlvbnMuY3VzdG9tUmVuZGVyaW5nIHx8IFwiXCIpO1xuICAgICAgICBjdXN0b21SZW5kZXJpbmcuc2V0UGxhY2Vob2xkZXIoXCJKYXZhc2NyaXB0IHN0cmluZywgXCIgK1xuICAgICAgICAgICAgXCJ0aGUgXFxcInBhZ2VcXFwiIChkYXRhdmlldyBwYWdlIHR5cGUpIHZhcmlhYmxlIGlzIGF2YWlsYWJsZVxcblwiICtcbiAgICAgICAgICAgIFwiZXhhbXBsZSAxOiBwYWdlLmZpbGUubmFtZVxcbmV4YW1wbGUgMjogYCR7cGFnZS5maWxlLm5hbWV9IG9mIGdlbmRlciAke3BhZ2UuZ2VuZGVyfWBcIilcbiAgICAgICAgY3VzdG9tUmVuZGVyaW5nLm9uQ2hhbmdlKHZhbHVlID0+IHtcbiAgICAgICAgICAgIHRoaXMuZmllbGQub3B0aW9ucy5jdXN0b21SZW5kZXJpbmcgPSB2YWx1ZTtcbiAgICAgICAgICAgIEZpZWxkU2V0dGluZ3NNb2RhbC5yZW1vdmVWYWxpZGF0aW9uRXJyb3IoY3VzdG9tUmVuZGVyaW5nKTtcbiAgICAgICAgfSlcbiAgICB9XG5cbiAgICBwdWJsaWMgY3JlYXRlU2V0dGluZ0NvbnRhaW5lcihwYXJlbnRDb250YWluZXI6IEhUTUxEaXZFbGVtZW50LCBwbHVnaW46IE1ldGFkYXRhTWVudSwgbG9jYXRpb24/OiBTZXR0aW5nTG9jYXRpb24pOiB2b2lkIHtcbiAgICAgICAgdGhpcy5maWxlVmFsaWRhdG9yRmllbGQgPSBwYXJlbnRDb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcIm1ldGFkYXRhLW1lbnUtbnVtYmVyLW9wdGlvbnNcIiB9KVxuICAgICAgICB0aGlzLmNyZWF0ZUZpbGVDb250YWluZXIodGhpcy5maWxlVmFsaWRhdG9yRmllbGQpXG4gICAgICAgIHRoaXMuZmlsZVZhbGlkYXRvckZpZWxkLmNyZWF0ZURpdih7IGNsczogJ21ldGFkYXRhLW1lbnUtc2VwYXJhdG9yJyB9KS5jcmVhdGVFbChcImhyXCIpO1xuICAgIH1cblxuICAgIHB1YmxpYyBnZXRPcHRpb25zU3RyKCk6IHN0cmluZyB7XG4gICAgICAgIHJldHVybiB0aGlzLmZpZWxkLm9wdGlvbnMuZHZRdWVyeVN0cmluZyB8fCBcIlwiO1xuICAgIH1cblxuICAgIHB1YmxpYyB2YWxpZGF0ZU9wdGlvbnMoKTogYm9vbGVhbiB7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cblxuICAgIHB1YmxpYyB2YWxpZGF0ZVZhbHVlKHZhbHVlOiBzdHJpbmcgfCB7IHBhdGg6IHN0cmluZyB9IHwgeyBwYXRoOiBzdHJpbmcgfVtdKTogYm9vbGVhbiB7XG4gICAgICAgIGxldCBpc1ZhbGlkOiBib29sZWFuID0gdHJ1ZVxuICAgICAgICBpZiAoQXJyYXkuaXNBcnJheSh2YWx1ZSkpIHtcbiAgICAgICAgICAgIHZhbHVlLmZvckVhY2goKGxpbms6IHsgcGF0aDogc3RyaW5nIH0pID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBiYXNlbmFtZSA9IGxpbmsucGF0aC50cmltKCkucmVwbGFjZSgvXlxcW1xcWy9nLCBcIlwiKS5yZXBsYWNlKC9cXF1cXF0kL2csIFwiXCIpO1xuICAgICAgICAgICAgICAgIGlmICghdGhpcy5nZXRGaWxlcygpLm1hcChmID0+IGYuYmFzZW5hbWUpLmZpbmQoaXRlbSA9PiBpdGVtID09PSBiYXNlbmFtZSkpIGlzVmFsaWQgPSBpc1ZhbGlkICYmIGZhbHNlXG4gICAgICAgICAgICB9KVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29uc3QgYmFzZW5hbWUgPSAodmFsdWUgYXMgeyBwYXRoOiBzdHJpbmcgfSkucGF0aC50cmltKCkucmVwbGFjZSgvXlxcW1xcWy9nLCBcIlwiKS5yZXBsYWNlKC9cXF1cXF0kL2csIFwiXCIpO1xuICAgICAgICAgICAgaWYgKCF0aGlzLmdldEZpbGVzKCkubWFwKGYgPT4gZi5iYXNlbmFtZSkuZmluZChpdGVtID0+IGl0ZW0gPT09IGJhc2VuYW1lKSkgaXNWYWxpZCA9IGlzVmFsaWQgJiYgZmFsc2VcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gaXNWYWxpZFxuICAgIH1cbn0iLCAiaW1wb3J0IHsgVEZpbGUsIEZ1enp5U3VnZ2VzdE1vZGFsLCBGdXp6eU1hdGNoLCBCdXR0b25Db21wb25lbnQsIHNldEljb24gfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCBGaWVsZCBmcm9tIFwic3JjL2ZpZWxkcy9GaWVsZFwiO1xuaW1wb3J0IHsgcmVwbGFjZVZhbHVlcyB9IGZyb20gXCJzcmMvY29tbWFuZHMvcmVwbGFjZVZhbHVlc1wiO1xuaW1wb3J0IHsgaW5zZXJ0VmFsdWVzIH0gZnJvbSBcInNyYy9jb21tYW5kcy9pbnNlcnRWYWx1ZXNcIjtcbmltcG9ydCB7IEZpZWxkTWFuYWdlciB9IGZyb20gXCJzcmMvdHlwZXMvZmllbGRUeXBlc1wiO1xuaW1wb3J0IHsgRmllbGRNYW5hZ2VyIGFzIEZNIH0gZnJvbSBcInNyYy9maWVsZHMvRmllbGRNYW5hZ2VyXCI7XG5pbXBvcnQgTWV0YWRhdGFNZW51IGZyb20gXCJtYWluXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIE11bHRpRmlsZUZ1enp5U3VnZ2VzdGVyIGV4dGVuZHMgRnV6enlTdWdnZXN0TW9kYWw8VEZpbGU+IHtcblxuICAgIHByaXZhdGUgc2VsZWN0ZWRGaWxlczogVEZpbGVbXSA9IFtdO1xuXG4gICAgY29uc3RydWN0b3IoXG4gICAgICAgIHByaXZhdGUgcGx1Z2luOiBNZXRhZGF0YU1lbnUsXG4gICAgICAgIHByaXZhdGUgZmlsZTogVEZpbGUsXG4gICAgICAgIHByaXZhdGUgZmllbGQ6IEZpZWxkLFxuICAgICAgICBpbml0aWFsVmFsdWVPYmplY3Q6IGFueSxcbiAgICAgICAgcHJpdmF0ZSBsaW5lTnVtYmVyOiBudW1iZXIgPSAtMSxcbiAgICAgICAgcHJpdmF0ZSBpbkZyb250bWF0dGVyOiBib29sZWFuID0gZmFsc2UsXG4gICAgICAgIHByaXZhdGUgYWZ0ZXI6IGJvb2xlYW4gPSBmYWxzZVxuICAgICkge1xuICAgICAgICBzdXBlcihwbHVnaW4uYXBwKTtcbiAgICAgICAgY29uc3QgZHZBcGkgPSB0aGlzLnBsdWdpbi5hcHAucGx1Z2lucy5wbHVnaW5zW1wiZGF0YXZpZXdcIl0/LmFwaVxuICAgICAgICBpZiAoZHZBcGkpIHtcbiAgICAgICAgICAgIGNvbnN0IHNlbGVjdGVkVmFsdWVzOiBBcnJheTxhbnk+ID0gQXJyYXkuaXNBcnJheShpbml0aWFsVmFsdWVPYmplY3QpID8gaW5pdGlhbFZhbHVlT2JqZWN0IDogW2luaXRpYWxWYWx1ZU9iamVjdF1cbiAgICAgICAgICAgIHNlbGVjdGVkVmFsdWVzLmZvckVhY2godmFsdWUgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChkdkFwaS52YWx1ZS5pc0xpbmsodmFsdWUpKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGZpbGUgPSB0aGlzLnBsdWdpbi5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKHZhbHVlLnBhdGgpXG4gICAgICAgICAgICAgICAgICAgIGlmIChmaWxlIGluc3RhbmNlb2YgVEZpbGUpIHRoaXMuc2VsZWN0ZWRGaWxlcy5wdXNoKGZpbGUpXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSlcbiAgICAgICAgfVxuICAgIH1cblxuICAgIG9uT3BlbigpIHtcbiAgICAgICAgc3VwZXIub25PcGVuKClcbiAgICAgICAgdGhpcy5jb250YWluZXJFbC5vbmtleWRvd24gPSBhc3luYyAoZSkgPT4ge1xuICAgICAgICAgICAgaWYgKGUua2V5ID09IFwiRW50ZXJcIiAmJiBlLmFsdEtleSkge1xuICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucmVwbGFjZVZhbHVlcygpO1xuICAgICAgICAgICAgICAgIHRoaXMuY2xvc2UoKVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGJ1dHRvbkNvbnRhaW5lciA9IHRoaXMuY29udGFpbmVyRWwuY3JlYXRlRGl2KHsgY2xzOiBcIm1ldGFkYXRhLW1lbnUtdmFsdWUtc3VnZ2VzdGVyLWFjdGlvbnNcIiB9KVxuICAgICAgICBidXR0b25Db250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcIm1ldGFkYXRhLW1lbnUtdmFsdWUtc3VnZ2VzdGVyLWFjdGlvbnMtc3BhY2VyXCIgfSlcbiAgICAgICAgY29uc3QgaW5mb0NvbnRhaW5lciA9IGJ1dHRvbkNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IFwibWV0YWRhdGEtbWVudS12YWx1ZS1zdWdnZXN0ZXItaW5mb1wiIH0pXG4gICAgICAgIGluZm9Db250YWluZXIuc2V0VGV4dChcIkFsdCtFbnRlciB0byBzYXZlXCIpXG4gICAgICAgIC8vY29uZmlybSBidXR0b25cbiAgICAgICAgY29uc3QgY29uZmlybUJ1dHRvbiA9IG5ldyBCdXR0b25Db21wb25lbnQoYnV0dG9uQ29udGFpbmVyKVxuICAgICAgICBjb25maXJtQnV0dG9uLnNldEljb24oXCJjaGVja21hcmtcIilcbiAgICAgICAgY29uZmlybUJ1dHRvbi5vbkNsaWNrKGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMucmVwbGFjZVZhbHVlcygpO1xuICAgICAgICAgICAgdGhpcy5jbG9zZSgpXG4gICAgICAgIH0pXG4gICAgICAgIGNvbmZpcm1CdXR0b24uYnV0dG9uRWwuYWRkQ2xhc3MoXCJtZXRhZGF0YS1tZW51LXZhbHVlLXN1Z2dlc3Rlci1idXR0b25cIilcbiAgICAgICAgLy9jYW5jZWwgYnV0dG9uXG4gICAgICAgIGNvbnN0IGNhbmNlbEJ1dHRvbiA9IG5ldyBCdXR0b25Db21wb25lbnQoYnV0dG9uQ29udGFpbmVyKVxuICAgICAgICBjYW5jZWxCdXR0b24uc2V0SWNvbihcImNyb3NzXCIpXG4gICAgICAgIGNhbmNlbEJ1dHRvbi5vbkNsaWNrKCgpID0+IHsgdGhpcy5jbG9zZSgpOyB9KVxuICAgICAgICBjYW5jZWxCdXR0b24uYnV0dG9uRWwuYWRkQ2xhc3MoXCJtZXRhZGF0YS1tZW51LXZhbHVlLXN1Z2dlc3Rlci1idXR0b25cIilcbiAgICAgICAgLy9jbGVhciB2YWx1ZSBidXR0b25cbiAgICAgICAgY29uc3QgY2xlYXJCdXR0b24gPSBuZXcgQnV0dG9uQ29tcG9uZW50KGJ1dHRvbkNvbnRhaW5lcilcbiAgICAgICAgY2xlYXJCdXR0b24uc2V0SWNvbihcInRyYXNoXCIpXG4gICAgICAgIGNsZWFyQnV0dG9uLm9uQ2xpY2soYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgYXdhaXQgdGhpcy5jbGVhclZhbHVlcygpO1xuICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgICB9KVxuICAgICAgICBjbGVhckJ1dHRvbi5idXR0b25FbC5hZGRDbGFzcyhcIm1ldGFkYXRhLW1lbnUtdmFsdWUtc3VnZ2VzdGVyLWJ1dHRvblwiKVxuICAgICAgICBjbGVhckJ1dHRvbi5idXR0b25FbC5hZGRDbGFzcyhcImRhbmdlclwiKVxuXG4gICAgICAgIHRoaXMubW9kYWxFbC5hcHBlbmRDaGlsZChidXR0b25Db250YWluZXIpXG4gICAgfVxuXG4gICAgZ2V0SXRlbXMoKTogVEZpbGVbXSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCBmaWxlTWFuYWdlciA9IG5ldyBGaWVsZE1hbmFnZXJbdGhpcy5maWVsZC50eXBlXSh0aGlzLnBsdWdpbiwgdGhpcy5maWVsZCk7XG4gICAgICAgICAgICByZXR1cm4gZmlsZU1hbmFnZXIuZ2V0RmlsZXModGhpcy5maWxlKTtcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgICAgICAgIHRocm93IChlcnJvcik7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBnZXRJdGVtVGV4dChpdGVtOiBURmlsZSk6IHN0cmluZyB7XG4gICAgICAgIHJldHVybiBpdGVtLmJhc2VuYW1lO1xuICAgIH1cblxuICAgIGFzeW5jIHJlcGxhY2VWYWx1ZXMoKSB7XG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IHRoaXMuc2VsZWN0ZWRGaWxlcy5tYXAoZmlsZSA9PiB7XG4gICAgICAgICAgICBjb25zdCBkdkFwaSA9IHRoaXMucGx1Z2luLmFwcC5wbHVnaW5zLnBsdWdpbnMuZGF0YXZpZXc/LmFwaVxuICAgICAgICAgICAgbGV0IGFsaWFzOiBzdHJpbmcgfCB1bmRlZmluZWQgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICBpZiAoZHZBcGkgJiYgdGhpcy5maWVsZC5vcHRpb25zLmN1c3RvbVJlbmRlcmluZykge1xuICAgICAgICAgICAgICAgIGFsaWFzID0gbmV3IEZ1bmN0aW9uKFwicGFnZVwiLCBgcmV0dXJuICR7dGhpcy5maWVsZC5vcHRpb25zLmN1c3RvbVJlbmRlcmluZ31gKShkdkFwaS5wYWdlKGZpbGUucGF0aCkpXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gRk0uYnVpbGRNYXJrRG93bkxpbmsodGhpcy5wbHVnaW4sIHRoaXMuZmlsZSwgZmlsZS5iYXNlbmFtZSwgYWxpYXMpXG4gICAgICAgIH0pXG4gICAgICAgIGlmICh0aGlzLmxpbmVOdW1iZXIgPT0gLTEpIHtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLmZpbGVUYXNrTWFuYWdlclxuICAgICAgICAgICAgICAgIC5wdXNoVGFzaygoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHJlcGxhY2VWYWx1ZXMoXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbixcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZmlsZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZmllbGQubmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdC5qb2luKFwiLCBcIilcbiAgICAgICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uZmlsZVRhc2tNYW5hZ2VyXG4gICAgICAgICAgICAgICAgLnB1c2hUYXNrKCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgaW5zZXJ0VmFsdWVzKFxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4sXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmZpbGUsXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmZpZWxkLm5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQuam9pbihcIiwgXCIpLFxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5saW5lTnVtYmVyLFxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5pbkZyb250bWF0dGVyLFxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hZnRlclxuICAgICAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgYXN5bmMgY2xlYXJWYWx1ZXMoKSB7XG4gICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLmZpbGVUYXNrTWFuYWdlclxuICAgICAgICAgICAgLnB1c2hUYXNrKCgpID0+IHtcbiAgICAgICAgICAgICAgICByZXBsYWNlVmFsdWVzKFxuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbixcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5maWxlLFxuICAgICAgICAgICAgICAgICAgICB0aGlzLmZpZWxkLm5hbWUsXG4gICAgICAgICAgICAgICAgICAgIFwiXCJcbiAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICB9KTtcbiAgICB9XG5cbiAgICByZW5kZXJTdWdnZXN0aW9uKHZhbHVlOiBGdXp6eU1hdGNoPFRGaWxlPiwgZWw6IEhUTUxFbGVtZW50KSB7XG4gICAgICAgIGNvbnN0IGR2QXBpID0gdGhpcy5wbHVnaW4uYXBwLnBsdWdpbnMucGx1Z2lucy5kYXRhdmlldz8uYXBpXG4gICAgICAgIGlmIChkdkFwaSAmJiB0aGlzLmZpZWxkLm9wdGlvbnMuY3VzdG9tUmVuZGVyaW5nKSB7XG4gICAgICAgICAgICBjb25zdCBzdWdnZXN0aW9uQ29udGFpbmVyID0gZWwuY3JlYXRlRGl2KHsgY2xzOiBcIm1ldGFkYXRhLW1lbnUtc3VnZ2VzdGVyLWl0ZW0td2l0aC1hbGlhc1wiIH0pO1xuICAgICAgICAgICAgY29uc3QgbGFiZWwgPSBzdWdnZXN0aW9uQ29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJtZXRhZGF0YS1tZW51LXN1Z2dlc3Rlci1pdGVtLXdpdGgtYWxpYXMtbGFiZWxcIiB9KVxuICAgICAgICAgICAgbGFiZWwuc2V0VGV4dChuZXcgRnVuY3Rpb24oXCJwYWdlXCIsIGByZXR1cm4gJHt0aGlzLmZpZWxkLm9wdGlvbnMuY3VzdG9tUmVuZGVyaW5nfWApKGR2QXBpLnBhZ2UodmFsdWUuaXRlbS5wYXRoKSkpXG4gICAgICAgICAgICBjb25zdCBmaWxlUGF0aCA9IHN1Z2dlc3Rpb25Db250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcIm1ldGFkYXRhLW1lbnUtc3VnZ2VzdGVyLWl0ZW0td2l0aC1hbGlhcy1maWxlcGF0aFwiIH0pXG4gICAgICAgICAgICBmaWxlUGF0aC5zZXRUZXh0KHZhbHVlLml0ZW0ucGF0aClcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGVsLnNldFRleHQodmFsdWUuaXRlbS5iYXNlbmFtZSlcbiAgICAgICAgfVxuICAgICAgICBlbC5hZGRDbGFzcyhcIm1ldGFkYXRhLW1lbnUtdmFsdWUtc3VnZ2VzdGVyLXZhbHVlLWNvbnRhaW5lclwiKVxuICAgICAgICBjb25zdCBzcGFjZXIgPSB0aGlzLmNvbnRhaW5lckVsLmNyZWF0ZURpdih7IGNsczogXCJtZXRhZGF0YS1tZW51LXZhbHVlLXN1Z2dlc3Rlci12YWx1ZS1jb250YWluZXItc3BhY2VyXCIgfSlcbiAgICAgICAgZWwuYXBwZW5kQ2hpbGQoc3BhY2VyKVxuXG4gICAgICAgIGlmICh0aGlzLnNlbGVjdGVkRmlsZXMuc29tZShmaWxlID0+IGZpbGUucGF0aCA9PT0gdmFsdWUuaXRlbS5wYXRoKSkge1xuICAgICAgICAgICAgZWwuYWRkQ2xhc3MoXCJtZXRhZGF0YS1tZW51LXZhbHVlLXNlbGVjdGVkXCIpXG4gICAgICAgICAgICBjb25zdCBpY29uQ29udGFpbmVyID0gZWwuY3JlYXRlRGl2KHsgY2xzOiBcIm1ldGFkYXRhLW1lbnUtY29tbWFuZC1zdWdnZXN0LWljb25cIiB9KVxuICAgICAgICAgICAgc2V0SWNvbihpY29uQ29udGFpbmVyLCBcImNoZWNrLWNpcmNsZVwiKVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgcmVuZGVyU2VsZWN0ZWQoKSB7XG4gICAgICAgIC8vQHRzLWlnbm9yZVxuICAgICAgICBjb25zdCBjaG9vc2VyID0gdGhpcy5jaG9vc2VyXG4gICAgICAgIGNvbnN0IHN1Z2dlc3Rpb25zOiBIVE1MRGl2RWxlbWVudFtdID0gY2hvb3Nlci5zdWdnZXN0aW9uc1xuICAgICAgICBjb25zdCB2YWx1ZXM6IEZ1enp5TWF0Y2g8VEZpbGU+W10gPSBjaG9vc2VyLnZhbHVlc1xuXG4gICAgICAgIHN1Z2dlc3Rpb25zLmZvckVhY2goKHMsIGkpID0+IHtcbiAgICAgICAgICAgIGlmICh0aGlzLnNlbGVjdGVkRmlsZXMuc29tZShmaWxlID0+IGZpbGUucGF0aCA9PT0gdmFsdWVzW2ldLml0ZW0ucGF0aCkpIHtcbiAgICAgICAgICAgICAgICBzLmFkZENsYXNzKFwibWV0YWRhdGEtbWVudS12YWx1ZS1zZWxlY3RlZFwiKVxuICAgICAgICAgICAgICAgIGlmIChzLnF1ZXJ5U2VsZWN0b3JBbGwoXCIubWV0YWRhdGEtbWVudS1jb21tYW5kLXN1Z2dlc3QtaWNvblwiKS5sZW5ndGggPT0gMCkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBpY29uQ29udGFpbmVyID0gcy5jcmVhdGVEaXYoeyBjbHM6IFwibWV0YWRhdGEtbWVudS1jb21tYW5kLXN1Z2dlc3QtaWNvblwiIH0pXG4gICAgICAgICAgICAgICAgICAgIHNldEljb24oaWNvbkNvbnRhaW5lciwgXCJjaGVjay1jaXJjbGVcIilcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHMucmVtb3ZlQ2xhc3MoXCJtZXRhZGF0YS1tZW51LXZhbHVlLXNlbGVjdGVkXCIpXG4gICAgICAgICAgICAgICAgcy5xdWVyeVNlbGVjdG9yQWxsKFwiLm1ldGFkYXRhLW1lbnUtY29tbWFuZC1zdWdnZXN0LWljb25cIikuZm9yRWFjaChpY29uID0+IGljb24ucmVtb3ZlKCkpXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pXG5cbiAgICB9XG5cbiAgICBzZWxlY3RTdWdnZXN0aW9uKHZhbHVlOiBGdXp6eU1hdGNoPFRGaWxlPiwgZXZ0OiBNb3VzZUV2ZW50IHwgS2V5Ym9hcmRFdmVudCk6IHZvaWQge1xuICAgICAgICBpZiAodGhpcy5zZWxlY3RlZEZpbGVzLmluY2x1ZGVzKHZhbHVlLml0ZW0pKSB7XG4gICAgICAgICAgICB0aGlzLnNlbGVjdGVkRmlsZXMucmVtb3ZlKHZhbHVlLml0ZW0pXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLnNlbGVjdGVkRmlsZXMucHVzaCh2YWx1ZS5pdGVtKVxuICAgICAgICB9XG4gICAgICAgIHRoaXMucmVuZGVyU2VsZWN0ZWQoKVxuICAgIH1cblxuICAgIGFzeW5jIG9uQ2hvb3NlSXRlbShpdGVtOiBURmlsZSk6IFByb21pc2U8dm9pZD4geyB9XG5cbn0iLCAiaW1wb3J0IE1ldGFkYXRhTWVudSBmcm9tIFwibWFpblwiO1xuaW1wb3J0IHsgVEZpbGUsIE1lbnUsIFRleHRBcmVhQ29tcG9uZW50LCBUZXh0Q29tcG9uZW50LCBEcm9wZG93bkNvbXBvbmVudCwgTm90aWNlIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgRmllbGRDb21tYW5kU3VnZ2VzdE1vZGFsIGZyb20gXCJzcmMvb3B0aW9ucy9GaWVsZENvbW1hbmRTdWdnZXN0TW9kYWxcIjtcbmltcG9ydCBGaWVsZFNldHRpbmdzTW9kYWwgZnJvbSBcInNyYy9zZXR0aW5ncy9GaWVsZFNldHRpbmdzTW9kYWxcIjtcbmltcG9ydCB7IEZpZWxkVHlwZSB9IGZyb20gXCJzcmMvdHlwZXMvZmllbGRUeXBlc1wiO1xuaW1wb3J0IEZpZWxkIGZyb20gXCIuLi9GaWVsZFwiO1xuaW1wb3J0IHsgU2V0dGluZ0xvY2F0aW9uIH0gZnJvbSBcIi4uL0ZpZWxkTWFuYWdlclwiO1xuaW1wb3J0IHsgRmllbGRNYW5hZ2VyIH0gZnJvbSBcIi4uL0ZpZWxkTWFuYWdlclwiO1xuaW1wb3J0ICogYXMgTG9va3VwIGZyb20gXCJzcmMvdHlwZXMvbG9va3VwVHlwZXNcIjtcbmltcG9ydCB7IHJlcGxhY2VWYWx1ZXMgfSBmcm9tIFwic3JjL2NvbW1hbmRzL3JlcGxhY2VWYWx1ZXNcIjtcbmltcG9ydCB7IGluc2VydFZhbHVlcyB9IGZyb20gXCJzcmMvY29tbWFuZHMvaW5zZXJ0VmFsdWVzXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIExvb2t1cEZpZWxkIGV4dGVuZHMgRmllbGRNYW5hZ2VyIHtcblxuICAgIHByaXZhdGUgbG9va3VwVmFsaWRhdG9yRmllbGQ6IEhUTUxEaXZFbGVtZW50O1xuXG4gICAgY29uc3RydWN0b3IocGx1Z2luOiBNZXRhZGF0YU1lbnUsIGZpZWxkOiBGaWVsZCkge1xuICAgICAgICBzdXBlcihwbHVnaW4sIGZpZWxkLCBGaWVsZFR5cGUuTG9va3VwKVxuICAgIH1cblxuICAgIGFkZEZpZWxkT3B0aW9uKG5hbWU6IHN0cmluZywgdmFsdWU6IHN0cmluZywgZmlsZTogVEZpbGUsIGxvY2F0aW9uOiBNZW51IHwgRmllbGRDb21tYW5kU3VnZ2VzdE1vZGFsKTogdm9pZCB7XG5cbiAgICB9XG5cbiAgICBhc3luYyBjcmVhdGVBbmRPcGVuRmllbGRNb2RhbChmaWxlOiBURmlsZSwgc2VsZWN0ZWRGaWVsZE5hbWU6IHN0cmluZywgdmFsdWU/OiBzdHJpbmcsIGxpbmVOdW1iZXI/OiBudW1iZXIsIGluRnJvbnRtYXR0ZXI/OiBib29sZWFuLCBhZnRlcj86IGJvb2xlYW4pOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgLy9ubyBmaWVsZCBtb2RhbCwgd2UgaW5jbHVkZSB0aGUgZmllbGQgZGlyZWN0bHlcbiAgICAgICAgaWYgKGxpbmVOdW1iZXIgPT0gLTEpIHtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLmZpbGVUYXNrTWFuYWdlclxuICAgICAgICAgICAgICAgIC5wdXNoVGFzaygoKSA9PiB7IHJlcGxhY2VWYWx1ZXModGhpcy5wbHVnaW4sIGZpbGUsIHRoaXMuZmllbGQubmFtZSwgXCJcIikgfSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5maWxlVGFza01hbmFnZXJcbiAgICAgICAgICAgICAgICAucHVzaFRhc2soKCkgPT4geyBpbnNlcnRWYWx1ZXModGhpcy5wbHVnaW4sIGZpbGUsIHRoaXMuZmllbGQubmFtZSwgXCJcIiwgbGluZU51bWJlciwgaW5Gcm9udG1hdHRlciwgYWZ0ZXIpIH0pO1xuICAgICAgICB9O1xuICAgIH1cblxuICAgIGNyZWF0ZUR2RmllbGQoZHY6IGFueSwgcDogYW55LCBmaWVsZENvbnRhaW5lcjogSFRNTEVsZW1lbnQsIGF0dHJzPzogeyBjbHM/OiBzdHJpbmcgfCB1bmRlZmluZWQ7IGF0dHI/OiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+IHwgdW5kZWZpbmVkOyBvcHRpb25zPzogUmVjb3JkPHN0cmluZywgc3RyaW5nPiB8IHVuZGVmaW5lZDsgfSk6IHZvaWQge1xuXG4gICAgfVxuXG4gICAgcHJpdmF0ZSBkaXNwbGF5U2VsZWN0ZWRPdXRwdXRPcHRpb25Db250YWluZXIob3B0aW9uQ29udGFpbmVyczogW0FycmF5PGtleW9mIHR5cGVvZiBMb29rdXAuVHlwZT4sIEhUTUxFbGVtZW50IHwgdW5kZWZpbmVkXVtdLCB2YWx1ZToga2V5b2YgdHlwZW9mIExvb2t1cC5UeXBlKSB7XG4gICAgICAgIG9wdGlvbkNvbnRhaW5lcnMuZm9yRWFjaChvcHRpb25zX3NldCA9PiB7XG4gICAgICAgICAgICBpZiAob3B0aW9uc19zZXRbMF0uaW5jbHVkZXModmFsdWUpKSB7XG4gICAgICAgICAgICAgICAgb3B0aW9uc19zZXRbMV0/LnNob3coKVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBvcHRpb25zX3NldFsxXT8uaGlkZSgpXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pXG4gICAgfVxuXG4gICAgcHJpdmF0ZSBkaXNwbGF5U2VsZWN0ZWRPdXRwdXRXYXJuaW5nQ29udGFpbmVyKG9wdGlvbldhcm5pbmdDb250YWluZXI6IEhUTUxEaXZFbGVtZW50LCB2YWx1ZToga2V5b2YgdHlwZW9mIExvb2t1cC5UeXBlKSB7XG4gICAgICAgIFtMb29rdXAuVHlwZS5MaW5rc0J1bGxldExpc3QudG9TdHJpbmcoKSwgTG9va3VwLlR5cGUuQ3VzdG9tQnVsbGV0TGlzdC50b1N0cmluZygpXS5pbmNsdWRlcyh2YWx1ZSkgP1xuICAgICAgICAgICAgb3B0aW9uV2FybmluZ0NvbnRhaW5lci5zaG93KCkgOiBvcHRpb25XYXJuaW5nQ29udGFpbmVyLmhpZGUoKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGNyZWF0ZUxvb2t1cENvbnRhaW5lcihwYXJlbnRDb250YWluZXI6IEhUTUxEaXZFbGVtZW50KTogdm9pZCB7XG5cbiAgICAgICAgY29uc3QgZHZRdWVyeVN0cmluZ0NvbnRhaW5lciA9IHBhcmVudENvbnRhaW5lci5jcmVhdGVEaXYoKTtcbiAgICAgICAgZHZRdWVyeVN0cmluZ0NvbnRhaW5lci5jcmVhdGVFbChcInNwYW5cIiwgeyB0ZXh0OiBcIlBhZ2VzIHRvIGxvb2sgZm9yIGluIHlvdXIgdmF1bHQgKERhdGF2aWV3SlMgUXVlcnkpXCIsIGNsczogJ21ldGFkYXRhLW1lbnUtZmllbGQtb3B0aW9uJyB9KTtcbiAgICAgICAgZHZRdWVyeVN0cmluZ0NvbnRhaW5lci5jcmVhdGVFbChcInNwYW5cIiwgeyB0ZXh0OiBcIkRhdGF2aWV3SlMgcXVlcnkgb2YgdGhlIGZvcm0gYGR2LnBhZ2VzKC4uLilgXCIsIGNsczogJ21ldGFkYXRhLW1lbnUtZmllbGQtb3B0aW9uLXN1YnRleHQnIH0pO1xuICAgICAgICBjb25zdCBkdlF1ZXJ5U3RyaW5nID0gbmV3IFRleHRBcmVhQ29tcG9uZW50KGR2UXVlcnlTdHJpbmdDb250YWluZXIpO1xuICAgICAgICBkdlF1ZXJ5U3RyaW5nLmlucHV0RWwuY29scyA9IDUwO1xuICAgICAgICBkdlF1ZXJ5U3RyaW5nLmlucHV0RWwucm93cyA9IDQ7XG4gICAgICAgIGR2UXVlcnlTdHJpbmcuc2V0VmFsdWUodGhpcy5maWVsZC5vcHRpb25zLmR2UXVlcnlTdHJpbmcgfHwgXCJcIik7XG4gICAgICAgIGR2UXVlcnlTdHJpbmcuc2V0UGxhY2Vob2xkZXIoXCJleGFtcGU6IGR2LnBhZ2VzKCcjc3R1ZGVudCcpXCIpXG5cbiAgICAgICAgZHZRdWVyeVN0cmluZy5vbkNoYW5nZSh2YWx1ZSA9PiB7XG4gICAgICAgICAgICB0aGlzLmZpZWxkLm9wdGlvbnMuZHZRdWVyeVN0cmluZyA9IHZhbHVlO1xuICAgICAgICAgICAgRmllbGRTZXR0aW5nc01vZGFsLnJlbW92ZVZhbGlkYXRpb25FcnJvcihkdlF1ZXJ5U3RyaW5nKTtcbiAgICAgICAgfSlcblxuICAgICAgICBjb25zdCB0YXJnZXRGaWVsZENvbnRhaW5lciA9IHBhcmVudENvbnRhaW5lci5jcmVhdGVEaXYoKTtcbiAgICAgICAgdGFyZ2V0RmllbGRDb250YWluZXIuY3JlYXRlRWwoXCJzcGFuXCIsIHsgdGV4dDogXCJOYW1lIG9mIHRoZSByZWxhdGVkIGZpZWxkXCIsIGNsczogJ21ldGFkYXRhLW1lbnUtZmllbGQtb3B0aW9uJyB9KTtcbiAgICAgICAgdGFyZ2V0RmllbGRDb250YWluZXIuY3JlYXRlRWwoXCJzcGFuXCIsIHsgdGV4dDogXCJmaWVsZCBpbiB0aGUgdGFyZ2V0IHBhZ2VzIHRoYXQgY29udGFpbnMgYSBsaW5rIHRvIHRoZSBwYWdlIHdoZXJlIHRoaXMgbG9va3VwIGZpZWxkIGlzXCIsIGNsczogJ21ldGFkYXRhLW1lbnUtZmllbGQtb3B0aW9uLXN1YnRleHQnIH0pO1xuICAgICAgICBjb25zdCB0YXJnZXRGaWVsZE5hbWUgPSBuZXcgVGV4dENvbXBvbmVudCh0YXJnZXRGaWVsZENvbnRhaW5lcik7XG4gICAgICAgIHRhcmdldEZpZWxkTmFtZS5zZXRWYWx1ZSh0aGlzLmZpZWxkLm9wdGlvbnMudGFyZ2V0RmllbGROYW1lIHx8IFwiXCIpO1xuICAgICAgICB0YXJnZXRGaWVsZE5hbWUub25DaGFuZ2UodmFsdWUgPT4ge1xuICAgICAgICAgICAgdGhpcy5maWVsZC5vcHRpb25zLnRhcmdldEZpZWxkTmFtZSA9IHZhbHVlO1xuICAgICAgICAgICAgRmllbGRTZXR0aW5nc01vZGFsLnJlbW92ZVZhbGlkYXRpb25FcnJvcih0YXJnZXRGaWVsZE5hbWUpXG4gICAgICAgIH0pXG5cbiAgICAgICAgLy9sb29rdXAgdHlwZSBzZWxlY3RvclxuICAgICAgICBjb25zdCBvdXRwdXRUeXBlQ29udGFpbmVyID0gcGFyZW50Q29udGFpbmVyLmNyZWF0ZURpdigpO1xuICAgICAgICB0aGlzLmZpZWxkLm9wdGlvbnMub3V0cHV0VHlwZSA9IHRoaXMuZmllbGQub3B0aW9ucy5vdXRwdXRUeXBlIHx8IExvb2t1cC5UeXBlLkxpbmtzTGlzdFxuICAgICAgICBvdXRwdXRUeXBlQ29udGFpbmVyLmNyZWF0ZUVsKFwic3BhblwiLCB7IHRleHQ6IFwiVHlwZSBvZiBvdXRwdXRcIiwgY2xzOiAnbWV0YWRhdGEtbWVudS1maWVsZC1vcHRpb24nIH0pO1xuICAgICAgICBjb25zdCBvdXRwdXRUeXBlTGlzdCA9IG5ldyBEcm9wZG93bkNvbXBvbmVudChvdXRwdXRUeXBlQ29udGFpbmVyKTtcbiAgICAgICAgT2JqZWN0LmtleXMoTG9va3VwLlR5cGUpLmZvckVhY2goKG91dHB1dFR5cGU6IGtleW9mIHR5cGVvZiBMb29rdXAuVHlwZSkgPT4ge1xuICAgICAgICAgICAgb3V0cHV0VHlwZUxpc3QuYWRkT3B0aW9uKG91dHB1dFR5cGUsIExvb2t1cC5EZXNjcmlwdGlvbltvdXRwdXRUeXBlXSlcbiAgICAgICAgfSlcbiAgICAgICAgb3V0cHV0VHlwZUxpc3Quc2V0VmFsdWUodGhpcy5maWVsZC5vcHRpb25zLm91dHB1dFR5cGUpXG5cbiAgICAgICAgY29uc3Qgb3V0cHV0V2FybmluZ0NvbnRhaW5lciA9IHBhcmVudENvbnRhaW5lci5jcmVhdGVEaXYoKTtcbiAgICAgICAgb3V0cHV0V2FybmluZ0NvbnRhaW5lci5jcmVhdGVFbChcInBcIiwge1xuICAgICAgICAgICAgdGV4dDpcbiAgICAgICAgICAgICAgICBcIldhcm5pbmc6IHRoaXMgbWF5IG92ZXJyaWRlIHNvbWUgbGluZXMgdW5kZXIgeW91ciBsaXN0LiBcIiArXG4gICAgICAgICAgICAgICAgXCJUaGVyZSBzaG91bGRuJ3QgYmUgYW4gZXh0cmEgbWFudWFsIGl0ZW0gaW4gdGhlIGxpc3QgdGhhdCBpcyBhdXRvbWF0aWNhbGx5IFwiICtcbiAgICAgICAgICAgICAgICBcInJlbmRlcmVkIGJ5IHRoaXMgZmllbGQ6IGl0IHdvdWxkIGJlIG92ZXJyaWRlbiBhZnRlciBlYWNoIGZpZWxkIGluZGV4aW5nXCIsXG4gICAgICAgICAgICBjbHM6IFwibWV0YWRhdGEtbWVudS1maWVsZC1vcHRpb24td2FybmluZ1wiXG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vQnVpbHQgaW4gc3VtbWFyaXpuZyBmdW5jdGlvbiBvcHRpb25zXG4gICAgICAgIGNvbnN0IGJ1aWx0aW5PcHRpb25zQ29udGFpbmVyID0gcGFyZW50Q29udGFpbmVyLmNyZWF0ZURpdigpO1xuICAgICAgICBjb25zdCBidWlsdGluU3VtbWFyaXplRnVuY3Rpb25Db250YWluZXIgPSBidWlsdGluT3B0aW9uc0NvbnRhaW5lci5jcmVhdGVEaXYoKTtcbiAgICAgICAgdGhpcy5maWVsZC5vcHRpb25zLmJ1aWx0aW5TdW1tYXJpemluZ0Z1bmN0aW9uID0gdGhpcy5maWVsZC5vcHRpb25zLmJ1aWx0aW5TdW1tYXJpemluZ0Z1bmN0aW9uIHx8IExvb2t1cC5EZWZhdWx0LkJ1aWx0aW5TdW1tYXJpemluZ1xuICAgICAgICBidWlsdGluU3VtbWFyaXplRnVuY3Rpb25Db250YWluZXIuY3JlYXRlRWwoXCJzcGFuXCIsIHsgdGV4dDogTG9va3VwLk9wdGlvbkxhYmVsLkJ1aWx0aW5TdW1tYXJpemluZywgY2xzOiBcIm1ldGFkYXRhLW1lbnUtZmllbGQtb3B0aW9uXCIgfSk7XG4gICAgICAgIGNvbnN0IGJ1aWx0aW5TdW1tYXJpemVGdW5jdGlvbkxpc3QgPSBuZXcgRHJvcGRvd25Db21wb25lbnQoYnVpbHRpblN1bW1hcml6ZUZ1bmN0aW9uQ29udGFpbmVyKTtcbiAgICAgICAgT2JqZWN0LmtleXMoTG9va3VwLkJ1aWx0aW5TdW1tYXJpemluZykuZm9yRWFjaCgoYnVpbHRpbkZ1bmN0aW9uOiBrZXlvZiB0eXBlb2YgTG9va3VwLkJ1aWx0aW5TdW1tYXJpemluZykgPT4ge1xuICAgICAgICAgICAgYnVpbHRpblN1bW1hcml6ZUZ1bmN0aW9uTGlzdC5hZGRPcHRpb24oYnVpbHRpbkZ1bmN0aW9uLCBMb29rdXAuQnVpbHRpblN1bW1hcml6aW5nW2J1aWx0aW5GdW5jdGlvbl0pXG4gICAgICAgIH0pXG5cbiAgICAgICAgY29uc3QgYnVpbHRpbk9wdGlvbnNEZXNjcmlwdGlvbkNvbnRhaW5lciA9IGJ1aWx0aW5PcHRpb25zQ29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJtZXRhZGF0YS1tZW51LWZpZWxkLW9wdGlvbi1zdWJ0ZXh0XCIgfSk7XG4gICAgICAgIGNvbnN0IGJ1aWx0aW5GdW5jdGlvbiA9IHRoaXMuZmllbGQub3B0aW9ucy5idWlsdGluU3VtbWFyaXppbmdGdW5jdGlvbiBhcyBrZXlvZiB0eXBlb2YgTG9va3VwLkJ1aWx0aW5TdW1tYXJpemluZ1xuICAgICAgICBidWlsdGluT3B0aW9uc0Rlc2NyaXB0aW9uQ29udGFpbmVyLnNldFRleHQoTG9va3VwLkJ1aWx0aW5TdW1tYXJpemluZ0Z1bmN0aW9uRGVzY3JpcHRpb25bYnVpbHRpbkZ1bmN0aW9uXS5yZXBsYWNlKFwie3tzdW1tYXJpemVkRmllbGROYW1lfX1cIiwgdGhpcy5maWVsZC5vcHRpb25zLnN1bW1hcml6ZWRGaWVsZE5hbWUpKVxuXG4gICAgICAgIGJ1aWx0aW5TdW1tYXJpemVGdW5jdGlvbkxpc3Quc2V0VmFsdWUodGhpcy5maWVsZC5vcHRpb25zLmJ1aWx0aW5TdW1tYXJpemluZ0Z1bmN0aW9uKVxuICAgICAgICBidWlsdGluU3VtbWFyaXplRnVuY3Rpb25MaXN0Lm9uQ2hhbmdlKCh2YWx1ZToga2V5b2YgdHlwZW9mIExvb2t1cC5CdWlsdGluU3VtbWFyaXppbmcpID0+IHtcbiAgICAgICAgICAgIHRoaXMuZmllbGQub3B0aW9ucy5idWlsdGluU3VtbWFyaXppbmdGdW5jdGlvbiA9IHZhbHVlXG4gICAgICAgICAgICBidWlsdGluT3B0aW9uc0Rlc2NyaXB0aW9uQ29udGFpbmVyLnNldFRleHQoTG9va3VwLkJ1aWx0aW5TdW1tYXJpemluZ0Z1bmN0aW9uRGVzY3JpcHRpb25bdmFsdWVdLnJlcGxhY2UoXCJ7e3N1bW1hcml6ZWRGaWVsZE5hbWV9fVwiLCB0aGlzLmZpZWxkLm9wdGlvbnMuc3VtbWFyaXplZEZpZWxkTmFtZSkpXG4gICAgICAgIH0pXG5cbiAgICAgICAgY29uc3Qgc3VtbWFyaXplZEZpZWxkTmFtZUNvbnRhaW5lciA9IGJ1aWx0aW5PcHRpb25zQ29udGFpbmVyLmNyZWF0ZURpdigpO1xuICAgICAgICB0aGlzLmZpZWxkLm9wdGlvbnMuc3VtbWFyaXplZEZpZWxkTmFtZSA9IHRoaXMuZmllbGQub3B0aW9ucy5zdW1tYXJpemVkRmllbGROYW1lXG4gICAgICAgIHN1bW1hcml6ZWRGaWVsZE5hbWVDb250YWluZXIuY3JlYXRlRWwoXCJzcGFuXCIsIHsgdGV4dDogXCJTdW1tYXJpemVkIGZpZWxkIG5hbWVcIiwgY2xzOiBcIm1ldGFkYXRhLW1lbnUtZmllbGQtb3B0aW9uXCIgfSk7XG4gICAgICAgIHN1bW1hcml6ZWRGaWVsZE5hbWVDb250YWluZXIuY3JlYXRlRWwoXCJzcGFuXCIsIHsgdGV4dDogXCJOYW1lIG9mIHRoZSBmaWVsZCBjb250YWluaW5nIHN1bW1hcml6ZWQgdmFsdWUgdXNlZCBmb3IgdGhlIHN1bW1hcml6aW5nIGZ1bmN0aW9uXCIsIGNsczogXCJtZXRhZGF0YS1tZW51LWZpZWxkLW9wdGlvbi1zdWJ0ZXh0XCIgfSk7XG4gICAgICAgIGNvbnN0IHN1bW1hcml6ZWRGaWVsZE5hbWUgPSBuZXcgVGV4dENvbXBvbmVudChzdW1tYXJpemVkRmllbGROYW1lQ29udGFpbmVyKTtcbiAgICAgICAgc3VtbWFyaXplZEZpZWxkTmFtZS5zZXRWYWx1ZSh0aGlzLmZpZWxkLm9wdGlvbnMuc3VtbWFyaXplZEZpZWxkTmFtZSlcbiAgICAgICAgc3VtbWFyaXplZEZpZWxkTmFtZS5vbkNoYW5nZSh2YWx1ZSA9PiB7XG4gICAgICAgICAgICB0aGlzLmZpZWxkLm9wdGlvbnMuc3VtbWFyaXplZEZpZWxkTmFtZSA9IHZhbHVlXG4gICAgICAgIH0pXG5cbiAgICAgICAgLy8gQ3VzdG9tIGxpc3QgZnVuY3Rpb24gb3B0aW9uc1xuICAgICAgICBjb25zdCBvdXRwdXRSZW5kZXJpbmdGdW5jdGlvbkNvbnRhaW5lciA9IHBhcmVudENvbnRhaW5lci5jcmVhdGVEaXYoKTtcbiAgICAgICAgdGhpcy5maWVsZC5vcHRpb25zLmN1c3RvbUxpc3RGdW5jdGlvbiA9IHRoaXMuZmllbGQub3B0aW9ucy5jdXN0b21MaXN0RnVuY3Rpb24gfHwgTG9va3VwLkRlZmF1bHQuQ3VzdG9tTGlzdFxuICAgICAgICBvdXRwdXRSZW5kZXJpbmdGdW5jdGlvbkNvbnRhaW5lci5jcmVhdGVFbChcInNwYW5cIiwgeyB0ZXh0OiBMb29rdXAuT3B0aW9uTGFiZWwuQ3VzdG9tTGlzdCwgY2xzOiBcIm1ldGFkYXRhLW1lbnUtZmllbGQtb3B0aW9uXCIgfSk7XG4gICAgICAgIG91dHB1dFJlbmRlcmluZ0Z1bmN0aW9uQ29udGFpbmVyLmNyZWF0ZUVsKFwiY29kZVwiLCB7IHRleHQ6IExvb2t1cC5PcHRpb25TdWJMYWJlbC5DdXN0b21MaXN0LCBjbHM6IFwibWV0YWRhdGEtbWVudS1maWVsZC1vcHRpb24tc3VidGV4dFwiIH0pXG4gICAgICAgIGNvbnN0IG91dHB1dFJlbmRlcmluZ0Z1bmN0aW9uID0gbmV3IFRleHRBcmVhQ29tcG9uZW50KG91dHB1dFJlbmRlcmluZ0Z1bmN0aW9uQ29udGFpbmVyKTtcbiAgICAgICAgb3V0cHV0UmVuZGVyaW5nRnVuY3Rpb24uc2V0UGxhY2Vob2xkZXIoTG9va3VwLkhlbHBlci5DdXN0b21MaXN0KVxuICAgICAgICBvdXRwdXRSZW5kZXJpbmdGdW5jdGlvbi5zZXRWYWx1ZSh0aGlzLmZpZWxkLm9wdGlvbnMuY3VzdG9tTGlzdEZ1bmN0aW9uKVxuICAgICAgICBvdXRwdXRSZW5kZXJpbmdGdW5jdGlvbi5pbnB1dEVsLmNvbHMgPSA2NTtcbiAgICAgICAgb3V0cHV0UmVuZGVyaW5nRnVuY3Rpb24uaW5wdXRFbC5yb3dzID0gNDtcbiAgICAgICAgb3V0cHV0UmVuZGVyaW5nRnVuY3Rpb24ub25DaGFuZ2UodmFsdWUgPT4ge1xuICAgICAgICAgICAgdGhpcy5maWVsZC5vcHRpb25zLmN1c3RvbUxpc3RGdW5jdGlvbiA9IHZhbHVlXG4gICAgICAgIH0pXG5cblxuICAgICAgICBjb25zdCBvdXRwdXRTdW1tYXJpemluZ0Z1bmN0aW9uQ29udGFpbmVyID0gcGFyZW50Q29udGFpbmVyLmNyZWF0ZURpdigpO1xuICAgICAgICB0aGlzLmZpZWxkLm9wdGlvbnMuY3VzdG9tU3VtbWFyaXppbmdGdW5jdGlvbiA9IHRoaXMuZmllbGQub3B0aW9ucy5jdXN0b21TdW1tYXJpemluZ0Z1bmN0aW9uIHx8IExvb2t1cC5EZWZhdWx0LkN1c3RvbVN1bW1hcml6aW5nXG4gICAgICAgIG91dHB1dFN1bW1hcml6aW5nRnVuY3Rpb25Db250YWluZXIuY3JlYXRlRWwoXCJzcGFuXCIsIHsgdGV4dDogTG9va3VwLk9wdGlvbkxhYmVsLkN1c3RvbVN1bW1hcml6aW5nLCBjbHM6IFwibWV0YWRhdGEtbWVudS1maWVsZC1vcHRpb25cIiB9KTtcbiAgICAgICAgb3V0cHV0U3VtbWFyaXppbmdGdW5jdGlvbkNvbnRhaW5lci5jcmVhdGVFbChcImNvZGVcIiwgeyB0ZXh0OiBMb29rdXAuT3B0aW9uU3ViTGFiZWwuQ3VzdG9tU3VtbWFyaXppbmcsIGNsczogXCJtZXRhZGF0YS1tZW51LWZpZWxkLW9wdGlvbi1zdWJ0ZXh0XCIgfSlcbiAgICAgICAgY29uc3Qgb3V0cHV0U3VtbWFyaXppbmdGdW5jdGlvbiA9IG5ldyBUZXh0QXJlYUNvbXBvbmVudChvdXRwdXRTdW1tYXJpemluZ0Z1bmN0aW9uQ29udGFpbmVyKTtcbiAgICAgICAgb3V0cHV0U3VtbWFyaXppbmdGdW5jdGlvbi5zZXRQbGFjZWhvbGRlcihMb29rdXAuSGVscGVyLkN1c3RvbVN1bW1hcml6aW5nKVxuICAgICAgICBvdXRwdXRTdW1tYXJpemluZ0Z1bmN0aW9uLnNldFZhbHVlKHRoaXMuZmllbGQub3B0aW9ucy5jdXN0b21TdW1tYXJpemluZ0Z1bmN0aW9uKVxuICAgICAgICBvdXRwdXRTdW1tYXJpemluZ0Z1bmN0aW9uLmlucHV0RWwuY29scyA9IDY1O1xuICAgICAgICBvdXRwdXRTdW1tYXJpemluZ0Z1bmN0aW9uLmlucHV0RWwucm93cyA9IDg7XG4gICAgICAgIG91dHB1dFN1bW1hcml6aW5nRnVuY3Rpb24ub25DaGFuZ2UodmFsdWUgPT4ge1xuICAgICAgICAgICAgdGhpcy5maWVsZC5vcHRpb25zLmN1c3RvbVN1bW1hcml6aW5nRnVuY3Rpb24gPSB2YWx1ZVxuICAgICAgICB9KVxuXG4gICAgICAgIGNvbnN0IG9wdGlvbkNvbnRhaW5lcnM6IFtBcnJheTxrZXlvZiB0eXBlb2YgTG9va3VwLlR5cGU+LCBIVE1MRWxlbWVudCB8IHVuZGVmaW5lZF1bXSA9IFtcbiAgICAgICAgICAgIFtbXCJMaW5rc0xpc3RcIiwgXCJMaW5rc0J1bGxldExpc3RcIl0sIHVuZGVmaW5lZF0sXG4gICAgICAgICAgICBbW1wiQnVpbHRpblN1bW1hcml6aW5nXCJdLCBidWlsdGluT3B0aW9uc0NvbnRhaW5lcl0sXG4gICAgICAgICAgICBbW1wiQ3VzdG9tTGlzdFwiLCBcIkN1c3RvbUJ1bGxldExpc3RcIl0sIG91dHB1dFJlbmRlcmluZ0Z1bmN0aW9uQ29udGFpbmVyXSxcbiAgICAgICAgICAgIFtbXCJDdXN0b21TdW1tYXJpemluZ1wiXSwgb3V0cHV0U3VtbWFyaXppbmdGdW5jdGlvbkNvbnRhaW5lcl1cbiAgICAgICAgXVxuXG4gICAgICAgIHRoaXMuZGlzcGxheVNlbGVjdGVkT3V0cHV0T3B0aW9uQ29udGFpbmVyKG9wdGlvbkNvbnRhaW5lcnMsIG91dHB1dFR5cGVMaXN0LmdldFZhbHVlKCkgYXMga2V5b2YgdHlwZW9mIExvb2t1cC5UeXBlKVxuICAgICAgICB0aGlzLmRpc3BsYXlTZWxlY3RlZE91dHB1dFdhcm5pbmdDb250YWluZXIob3V0cHV0V2FybmluZ0NvbnRhaW5lciwgb3V0cHV0VHlwZUxpc3QuZ2V0VmFsdWUoKSBhcyBrZXlvZiB0eXBlb2YgTG9va3VwLlR5cGUpXG5cbiAgICAgICAgb3V0cHV0VHlwZUxpc3Qub25DaGFuZ2UoKHZhbHVlOiBrZXlvZiB0eXBlb2YgTG9va3VwLlR5cGUpID0+IHtcbiAgICAgICAgICAgIHRoaXMuZmllbGQub3B0aW9ucy5vdXRwdXRUeXBlID0gdmFsdWU7XG4gICAgICAgICAgICB0aGlzLmRpc3BsYXlTZWxlY3RlZE91dHB1dE9wdGlvbkNvbnRhaW5lcihvcHRpb25Db250YWluZXJzLCB2YWx1ZSlcbiAgICAgICAgICAgIHRoaXMuZGlzcGxheVNlbGVjdGVkT3V0cHV0V2FybmluZ0NvbnRhaW5lcihvdXRwdXRXYXJuaW5nQ29udGFpbmVyLCB2YWx1ZSlcbiAgICAgICAgfSlcbiAgICB9XG5cbiAgICBwdWJsaWMgY3JlYXRlU2V0dGluZ0NvbnRhaW5lcihwYXJlbnRDb250YWluZXI6IEhUTUxEaXZFbGVtZW50LCBwbHVnaW46IE1ldGFkYXRhTWVudSwgbG9jYXRpb24/OiBTZXR0aW5nTG9jYXRpb24pOiB2b2lkIHtcbiAgICAgICAgdGhpcy5sb29rdXBWYWxpZGF0b3JGaWVsZCA9IHBhcmVudENvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IFwibWV0YWRhdGEtbWVudS1udW1iZXItb3B0aW9uc1wiIH0pXG4gICAgICAgIHRoaXMuY3JlYXRlTG9va3VwQ29udGFpbmVyKHRoaXMubG9va3VwVmFsaWRhdG9yRmllbGQpXG4gICAgICAgIHRoaXMubG9va3VwVmFsaWRhdG9yRmllbGQuY3JlYXRlRGl2KHsgY2xzOiAnbWV0YWRhdGEtbWVudS1zZXBhcmF0b3InIH0pLmNyZWF0ZUVsKFwiaHJcIik7XG4gICAgfVxuXG4gICAgZ2V0T3B0aW9uc1N0cigpOiBzdHJpbmcge1xuICAgICAgICBjb25zdCBzaG9ydERlc2NyaXB0aW9uID0gTG9va3VwLlNob3J0RGVzY3JpcHRpb25bdGhpcy5maWVsZC5vcHRpb25zLm91dHB1dFR5cGUgYXMgTG9va3VwLlR5cGVdXG4gICAgICAgIGxldCBjb21wbGVtZW50OiBzdHJpbmcgPSBcIlwiXG4gICAgICAgIGlmICh0aGlzLmZpZWxkLm9wdGlvbnMub3V0cHV0VHlwZSA9PT0gTG9va3VwLlR5cGUuQnVpbHRpblN1bW1hcml6aW5nKSB7XG4gICAgICAgICAgICBjb21wbGVtZW50ID0gYCAke3RoaXMuZmllbGQub3B0aW9ucy5idWlsdGluU3VtbWFyaXppbmdGdW5jdGlvbn1gICtcbiAgICAgICAgICAgICAgICBgJHt0aGlzLmZpZWxkLm9wdGlvbnMuYnVpbHRpblN1bW1hcml6aW5nRnVuY3Rpb24gIT09IExvb2t1cC5CdWlsdGluU3VtbWFyaXppbmcuQ291bnRBbGwgPyBcIiBcIiArIHRoaXMuZmllbGQub3B0aW9ucy5zdW1tYXJpemVkRmllbGROYW1lIDogXCJcIn1gXG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHNob3J0RGVzY3JpcHRpb24gKyBjb21wbGVtZW50XG4gICAgfVxuXG4gICAgdmFsaWRhdGVPcHRpb25zKCk6IGJvb2xlYW4ge1xuICAgICAgICByZXR1cm4gdHJ1ZVxuICAgIH1cbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZUxvb2t1cHMocGx1Z2luOiBNZXRhZGF0YU1lbnUsIGZvcmNlX3VwZGF0ZTogYm9vbGVhbiA9IGZhbHNlLCBzb3VyY2U6IHN0cmluZyA9IFwiXCIpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAvL2NvbnNvbGUubG9nKFwic3RhcnQgdXBkYXRlIGxvb2t1cHMgW1wiLCBzb3VyY2UsIFwiXVwiLCBwbHVnaW4uZmllbGRJbmRleC5sYXN0UmV2aXNpb24sIFwiLT5cIiwgcGx1Z2luLmZpZWxkSW5kZXguZHY/LmFwaS5pbmRleC5yZXZpc2lvbilcbiAgICBjb25zdCBmID0gcGx1Z2luLmZpZWxkSW5kZXg7XG4gICAgbGV0IHJlbmRlcmluZ0Vycm9yczogc3RyaW5nW10gPSBbXVxuICAgIGZvciAobGV0IGlkIG9mIGYuZmlsZUxvb2t1cEZpbGVzLmtleXMoKSkge1xuICAgICAgICBjb25zdCBbZmlsZVBhdGgsIGZpZWxkTmFtZV0gPSBpZC5zcGxpdChcIl9fcmVsYXRlZF9fXCIpXG4gICAgICAgIGNvbnN0IHRGaWxlID0gcGx1Z2luLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgoZmlsZVBhdGgpIGFzIFRGaWxlXG4gICAgICAgIGlmICh0RmlsZSkge1xuICAgICAgICAgICAgbGV0IG5ld1ZhbHVlID0gXCJcIjtcbiAgICAgICAgICAgIGNvbnN0IHBhZ2VzID0gZi5maWxlTG9va3VwRmlsZXMuZ2V0KGlkKVxuICAgICAgICAgICAgY29uc3QgZmllbGQgPSBmLmZpbGVzRmllbGRzLmdldChmaWxlUGF0aCk/LmZpbmQoZmllbGQgPT4gZmllbGQubmFtZSA9PSBmaWVsZE5hbWUpXG4gICAgICAgICAgICBzd2l0Y2ggKGZpZWxkPy5vcHRpb25zLm91dHB1dFR5cGUpIHtcbiAgICAgICAgICAgICAgICBjYXNlIExvb2t1cC5UeXBlLkxpbmtzTGlzdDpcbiAgICAgICAgICAgICAgICBjYXNlIExvb2t1cC5UeXBlLkxpbmtzQnVsbGV0TGlzdDpcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbmV3VmFsdWVzQXJyYXkgPSBwYWdlcz8ubWFwKChkdkZpbGU6IGFueSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBGaWVsZE1hbmFnZXIuYnVpbGRNYXJrRG93bkxpbmsocGx1Z2luLCB0RmlsZSwgZHZGaWxlLmZpbGUucGF0aCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ld1ZhbHVlID0gKG5ld1ZhbHVlc0FycmF5IHx8IFtdKS5qb2luKFwiLCBcIik7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWtcbiAgICAgICAgICAgICAgICBjYXNlIExvb2t1cC5UeXBlLkN1c3RvbUxpc3Q6XG4gICAgICAgICAgICAgICAgY2FzZSBMb29rdXAuVHlwZS5DdXN0b21CdWxsZXRMaXN0OlxuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCByZW5kZXJpbmdGdW5jdGlvbiA9IG5ldyBGdW5jdGlvbihcInBhZ2VcIiwgYHJldHVybiAke2ZpZWxkLm9wdGlvbnMuY3VzdG9tTGlzdEZ1bmN0aW9ufWApXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBuZXdWYWx1ZXNBcnJheSA9IHBhZ2VzPy5tYXAoKGR2RmlsZTogYW55KSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlbmRlcmluZ0Z1bmN0aW9uKGR2RmlsZSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFyZW5kZXJpbmdFcnJvcnMuaW5jbHVkZXMoZmllbGQubmFtZSkpIHJlbmRlcmluZ0Vycm9ycy5wdXNoKGZpZWxkLm5hbWUpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBcIlwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ld1ZhbHVlID0gKG5ld1ZhbHVlc0FycmF5IHx8IFtdKS5qb2luKFwiLCBcIik7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWtcbiAgICAgICAgICAgICAgICBjYXNlIExvb2t1cC5UeXBlLkN1c3RvbVN1bW1hcml6aW5nOlxuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjdXN0b21TdW1tYXJpemluZ0Z1bmN0aW9uID0gZmllbGQub3B0aW9ucy5jdXN0b21TdW1tYXJpemluZ0Z1bmN0aW9uXG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHN1bW1hcml6aW5nRnVuY3Rpb24gPSBuZXcgRnVuY3Rpb24oXCJwYWdlc1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1c3RvbVN1bW1hcml6aW5nRnVuY3Rpb25cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLnJlcGxhY2UoL1xce1xce3N1bW1hcml6ZWRGaWVsZE5hbWVcXH1cXH0vZywgZmllbGQub3B0aW9ucy5zdW1tYXJpemVkRmllbGROYW1lKSlcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3VmFsdWUgPSBzdW1tYXJpemluZ0Z1bmN0aW9uKHBhZ2VzKS50b1N0cmluZygpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFyZW5kZXJpbmdFcnJvcnMuaW5jbHVkZXMoZmllbGQubmFtZSkpIHJlbmRlcmluZ0Vycm9ycy5wdXNoKGZpZWxkLm5hbWUpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3VmFsdWUgPSBcIlwiXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWtcbiAgICAgICAgICAgICAgICBjYXNlIExvb2t1cC5UeXBlLkJ1aWx0aW5TdW1tYXJpemluZzpcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgYnVpbHRpbkZ1bmN0aW9uID0gZmllbGQub3B0aW9ucy5idWlsdGluU3VtbWFyaXppbmdGdW5jdGlvbiBhcyBrZXlvZiB0eXBlb2YgTG9va3VwLkJ1aWx0aW5TdW1tYXJpemluZ1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc3VtbWFyaXppbmdGdW5jdGlvbiA9IG5ldyBGdW5jdGlvbihcInBhZ2VzXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgTG9va3VwLkJ1aWx0aW5TdW1tYXJpemluZ0Z1bmN0aW9uW2J1aWx0aW5GdW5jdGlvbl1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLnJlcGxhY2UoL1xce1xce3N1bW1hcml6ZWRGaWVsZE5hbWVcXH1cXH0vZywgZmllbGQub3B0aW9ucy5zdW1tYXJpemVkRmllbGROYW1lKSlcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3VmFsdWUgPSBzdW1tYXJpemluZ0Z1bmN0aW9uKHBhZ2VzKS50b1N0cmluZygpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFyZW5kZXJpbmdFcnJvcnMuaW5jbHVkZXMoZmllbGQubmFtZSkpIHJlbmRlcmluZ0Vycm9ycy5wdXNoKGZpZWxkLm5hbWUpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3VmFsdWUgPSBcIlwiXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWtcbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICBicmVha1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy9jaGVjayBpZiB2YWx1ZSBoYXMgY2hhbmdlZCBpbiBvcmRlciBub3QgdG8gY3JlYXRlIGFuIGluZmluaXRlIGxvb3BcbiAgICAgICAgICAgIGNvbnN0IGN1cnJlbnRWYWx1ZSA9IGYuZmlsZUxvb2t1cEZpZWxkTGFzdFZhbHVlLmdldChpZClcbiAgICAgICAgICAgIGlmIChmb3JjZV91cGRhdGUgfHwgKCFjdXJyZW50VmFsdWUgJiYgbmV3VmFsdWUgIT09IFwiXCIpIHx8IGN1cnJlbnRWYWx1ZSAhPT0gbmV3VmFsdWUpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBwcmV2aW91c1ZhbHVlc0NvdW50ID0gcGx1Z2luLmZpZWxkSW5kZXgucHJldmlvdXNGaWxlTG9va3VwRmlsZXNWYWx1ZXMuZ2V0KHRGaWxlLnBhdGggKyBcIl9fcmVsYXRlZF9fXCIgKyBmaWVsZE5hbWUpIHx8IDBcbiAgICAgICAgICAgICAgICBhd2FpdCBwbHVnaW4uZmlsZVRhc2tNYW5hZ2VyLnB1c2hUYXNrKCgpID0+IHJlcGxhY2VWYWx1ZXMocGx1Z2luLCB0RmlsZSwgZmllbGROYW1lLCBuZXdWYWx1ZSwgcHJldmlvdXNWYWx1ZXNDb3VudCkpO1xuICAgICAgICAgICAgICAgIC8vYXdhaXQgcmVwbGFjZVZhbHVlcyhwbHVnaW4sIHRGaWxlLCBmaWVsZE5hbWUsIG5ld1ZhbHVlKTtcbiAgICAgICAgICAgICAgICBmLmZpbGVMb29rdXBGaWVsZExhc3RWYWx1ZS5zZXQoaWQsIG5ld1ZhbHVlKVxuICAgICAgICAgICAgfSBlbHNlIGlmIChzb3VyY2UgIT09IFwiZnVsbCBJbmRleFwiKSB7XG4gICAgICAgICAgICAgICAgcGx1Z2luLmZpZWxkSW5kZXguZmlsZUNoYW5nZWQgPSBmYWxzZVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIGlmIChyZW5kZXJpbmdFcnJvcnMubGVuZ3RoKSBuZXcgTm90aWNlKGBUaG9zZSBmaWVsZHMgaGF2ZSBpbmNvcnJlY3Qgb3V0cHV0IHJlbmRlcmluZyBmdW5jdGlvbnM6XFxuJHtyZW5kZXJpbmdFcnJvcnMuam9pbihcIixcXG5cIil9YClcbiAgICAvL2NvbnNvbGUubG9nKFwiZmluaXNoZWQgdXBkYXRlIGxvb2t1cHMgW1wiLCBzb3VyY2UsIFwiXVwiLCBwbHVnaW4uZmllbGRJbmRleC5sYXN0UmV2aXNpb24sIFwiLT5cIiwgcGx1Z2luLmZpZWxkSW5kZXguZHY/LmFwaS5pbmRleC5yZXZpc2lvbilcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHJlc29sdmVMb29rdXBzKHBsdWdpbjogTWV0YWRhdGFNZW51LCBzb3VyY2U6IHN0cmluZyA9IFwiXCIpOiB2b2lkIHtcbiAgICBjb25zdCBmID0gcGx1Z2luLmZpZWxkSW5kZXg7XG4gICAgQXJyYXkuZnJvbShmLmZpbGVzRmllbGRzKS5mb3JFYWNoKCh2YWx1ZTogW3N0cmluZywgRmllbGRbXV0pID0+IHtcbiAgICAgICAgY29uc3QgW2ZpbGVQYXRoLCBmaWVsZHNdID0gdmFsdWU7XG4gICAgICAgIGNvbnN0IGR2UGFnZSA9IGYuZHYuYXBpLnBhZ2UoZmlsZVBhdGgpO1xuICAgICAgICBpZiAoZHZQYWdlKSB7XG4gICAgICAgICAgICBmaWVsZHMuZmlsdGVyKGZpZWxkID0+IGZpZWxkLnR5cGUgPT09IEZpZWxkVHlwZS5Mb29rdXAgJiYgT2JqZWN0LmtleXMoZHZQYWdlKS5pbmNsdWRlcyhmaWVsZC5uYW1lKSkuZm9yRWFjaChsb29rdXBGaWVsZCA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgcXVlcnlSZWxhdGVkRFZGaWxlcyA9IChuZXcgRnVuY3Rpb24oXCJkdlwiLCBgcmV0dXJuICR7bG9va3VwRmllbGQub3B0aW9ucy5kdlF1ZXJ5U3RyaW5nfWApKShmLmR2LmFwaSkudmFsdWVzIGFzIEFycmF5PGFueT5cbiAgICAgICAgICAgICAgICBjb25zdCBmaWxlUmVsYXRlZERWRmlsZXMgPSBxdWVyeVJlbGF0ZWREVkZpbGVzLmZpbHRlcihkdkZpbGUgPT4ge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCB0YXJnZXRWYWx1ZSA9IGR2RmlsZVtsb29rdXBGaWVsZC5vcHRpb25zLnRhcmdldEZpZWxkTmFtZV07XG4gICAgICAgICAgICAgICAgICAgIGlmIChBcnJheS5pc0FycmF5KHRhcmdldFZhbHVlKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRhcmdldFZhbHVlLmZpbHRlcih2ID0+IGYuZHYuYXBpLnZhbHVlLmlzTGluayh2KSkubWFwKHYgPT4gdi5wYXRoKS5pbmNsdWRlcyhmaWxlUGF0aClcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0YXJnZXRWYWx1ZT8ucGF0aCA9PT0gZmlsZVBhdGhcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgY29uc3QgZXhpc3RpbmdGaWxlTG9va3VwRmllbGRzID0gZi5maWxlTG9va3VwRmlsZXMuZ2V0KGAke2ZpbGVQYXRofV9fcmVsYXRlZF9fJHtsb29rdXBGaWVsZC5uYW1lfWApXG4gICAgICAgICAgICAgICAgZi5maWxlTG9va3VwRmlsZXMuc2V0KGAke2ZpbGVQYXRofV9fcmVsYXRlZF9fJHtsb29rdXBGaWVsZC5uYW1lfWAsIGZpbGVSZWxhdGVkRFZGaWxlcylcbiAgICAgICAgICAgICAgICBmLnByZXZpb3VzRmlsZUxvb2t1cEZpbGVzVmFsdWVzLnNldChgJHtmaWxlUGF0aH1fX3JlbGF0ZWRfXyR7bG9va3VwRmllbGQubmFtZX1gLCAoZXhpc3RpbmdGaWxlTG9va3VwRmllbGRzIHx8IGZpbGVSZWxhdGVkRFZGaWxlcykubGVuZ3RoKVxuICAgICAgICAgICAgICAgIGZpbGVSZWxhdGVkRFZGaWxlcy5mb3JFYWNoKGR2RmlsZSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHBhcmVudHMgPSBmLmZpbGVMb29rdXBQYXJlbnRzLmdldChkdkZpbGUuZmlsZS5wYXRoKSB8fCBbXVxuICAgICAgICAgICAgICAgICAgICBpZiAoIXBhcmVudHMuaW5jbHVkZXMoZmlsZVBhdGgpKSBwYXJlbnRzLnB1c2goZmlsZVBhdGgpXG4gICAgICAgICAgICAgICAgICAgIGYuZmlsZUxvb2t1cFBhcmVudHMuc2V0KGR2RmlsZS5maWxlLnBhdGgsIHBhcmVudHMpXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH1cbiAgICB9KVxuICAgIGZvciAobGV0IGlkIG9mIGYuZmlsZUxvb2t1cEZpbGVzLmtleXMoKSkge1xuICAgICAgICBjb25zdCBbZmlsZVBhdGgsIGZpZWxkTmFtZV0gPSBpZC5zcGxpdChcIl9fcmVsYXRlZF9fXCIpXG4gICAgICAgIGNvbnN0IGR2UGFnZSA9IGYuZHYuYXBpLnBhZ2UoZmlsZVBhdGgpO1xuICAgICAgICBpZiAoZHZQYWdlID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIGZvciAoY29uc3QgZmlsZSBpbiBmLmZpbGVMb29rdXBQYXJlbnRzLmtleXMoKSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IG5ld1BhcmVudHMgPSBmLmZpbGVMb29rdXBQYXJlbnRzLmdldChmaWxlKT8ucmVtb3ZlKGZpbGVQYXRoKSB8fCBbXVxuICAgICAgICAgICAgICAgIGYuZmlsZUxvb2t1cFBhcmVudHMuc2V0KGZpbGUsIG5ld1BhcmVudHMpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZi5maWxlTG9va3VwRmlsZXMuZGVsZXRlKGlkKTtcbiAgICAgICAgICAgIGYuZmlsZUxvb2t1cEZpZWxkTGFzdFZhbHVlLmRlbGV0ZShpZCk7XG4gICAgICAgICAgICBmLnByZXZpb3VzRmlsZUxvb2t1cEZpbGVzVmFsdWVzLmRlbGV0ZShpZClcbiAgICAgICAgfSBlbHNlIGlmIChkdlBhZ2VbZmllbGROYW1lXSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBmLmZpbGVMb29rdXBGaWxlcy5kZWxldGUoaWQpO1xuICAgICAgICAgICAgZi5maWxlTG9va3VwRmllbGRMYXN0VmFsdWUuZGVsZXRlKGlkKTtcbiAgICAgICAgICAgIGYucHJldmlvdXNGaWxlTG9va3VwRmlsZXNWYWx1ZXMuZGVsZXRlKGlkKVxuICAgICAgICB9XG4gICAgfVxufSIsICJpbXBvcnQgSW5wdXQgZnJvbSAnLi9JbnB1dEZpZWxkJ1xuaW1wb3J0IEJvb2xlYW4gZnJvbSAnLi9Cb29sZWFuRmllbGQnXG5pbXBvcnQgTnVtYmVyIGZyb20gJy4vTnVtYmVyRmllbGQnXG5pbXBvcnQgU2VsZWN0IGZyb20gJy4vU2VsZWN0RmllbGQnXG5pbXBvcnQgQ3ljbGUgZnJvbSAnLi9DeWNsZUZpZWxkJ1xuaW1wb3J0IE11bHRpIGZyb20gJy4vTXVsdGlGaWVsZCdcbmltcG9ydCBGaWxlIGZyb20gJy4vRmlsZUZpZWxkJ1xuaW1wb3J0IERhdGUgZnJvbSAnLi9EYXRlRmllbGQnXG5pbXBvcnQgTXVsdGlGaWxlIGZyb20gJy4vTXVsdGlGaWxlRmllbGQnXG5pbXBvcnQgTG9va3VwIGZyb20gJy4vTG9va3VwRmllbGQnXG5cbmNvbnN0IE1hbmFnZXJzID0ge1xuICAgIElucHV0LFxuICAgIEJvb2xlYW4sXG4gICAgTnVtYmVyLFxuICAgIFNlbGVjdCxcbiAgICBDeWNsZSxcbiAgICBNdWx0aSxcbiAgICBGaWxlLFxuICAgIERhdGUsXG4gICAgTXVsdGlGaWxlLFxuICAgIExvb2t1cFxufVxuXG5leHBvcnQgZGVmYXVsdCBNYW5hZ2VycyIsICJpbXBvcnQgTWFuYWdlcnMgZnJvbSBcInNyYy9maWVsZHMvZmllbGRNYW5hZ2Vycy9NYW5hZ2Vyc1wiO1xuXG5leHBvcnQgY29uc3QgZW51bSBGaWVsZFR5cGUge1xuICAgICdJbnB1dCcgPSBcIklucHV0XCIsXG4gICAgJ1NlbGVjdCcgPSBcIlNlbGVjdFwiLFxuICAgICdNdWx0aScgPSBcIk11bHRpXCIsXG4gICAgJ0N5Y2xlJyA9IFwiQ3ljbGVcIixcbiAgICAnQm9vbGVhbicgPSBcIkJvb2xlYW5cIixcbiAgICBcIk51bWJlclwiID0gXCJOdW1iZXJcIixcbiAgICBcIkZpbGVcIiA9IFwiRmlsZVwiLFxuICAgIFwiTXVsdGlGaWxlXCIgPSBcIk11bHRpRmlsZVwiLFxuICAgIFwiRGF0ZVwiID0gXCJEYXRlXCIsXG4gICAgXCJMb29rdXBcIiA9IFwiTG9va3VwXCJcbn1cblxuZXhwb3J0IGNvbnN0IEZpZWxkVHlwZUxhYmVsTWFwcGluZzogUmVjb3JkPGtleW9mIHR5cGVvZiBGaWVsZFR5cGUsIEZpZWxkVHlwZT4gPSB7XG4gICAgXCJJbnB1dFwiOiBGaWVsZFR5cGUuSW5wdXQsXG4gICAgXCJTZWxlY3RcIjogRmllbGRUeXBlLlNlbGVjdCxcbiAgICBcIk11bHRpXCI6IEZpZWxkVHlwZS5NdWx0aSxcbiAgICBcIkN5Y2xlXCI6IEZpZWxkVHlwZS5DeWNsZSxcbiAgICBcIkJvb2xlYW5cIjogRmllbGRUeXBlLkJvb2xlYW4sXG4gICAgXCJOdW1iZXJcIjogRmllbGRUeXBlLk51bWJlcixcbiAgICBcIkZpbGVcIjogRmllbGRUeXBlLkZpbGUsXG4gICAgXCJNdWx0aUZpbGVcIjogRmllbGRUeXBlLk11bHRpRmlsZSxcbiAgICBcIkRhdGVcIjogRmllbGRUeXBlLkRhdGUsXG4gICAgXCJMb29rdXBcIjogRmllbGRUeXBlLkxvb2t1cFxufTtcblxuZXhwb3J0IGNvbnN0IEZpZWxkVHlwZVRhZ0NsYXNzOiBSZWNvcmQ8a2V5b2YgdHlwZW9mIEZpZWxkVHlwZSwgc3RyaW5nPiA9IHtcbiAgICBcIklucHV0XCI6IFwic2luZ2xlXCIsXG4gICAgXCJTZWxlY3RcIjogXCJzZWxlY3RcIixcbiAgICBcIk11bHRpXCI6IFwibXVsdGlcIixcbiAgICBcIkN5Y2xlXCI6IFwiY3ljbGVcIixcbiAgICBcIkJvb2xlYW5cIjogXCJib29sZWFuXCIsXG4gICAgXCJOdW1iZXJcIjogXCJudW1iZXJcIixcbiAgICBcIkZpbGVcIjogXCJmaWxlXCIsXG4gICAgXCJNdWx0aUZpbGVcIjogXCJmaWxlXCIsXG4gICAgXCJEYXRlXCI6IFwiZGF0ZVwiLFxuICAgIFwiTG9va3VwXCI6IFwibG9va3VwXCJcbn1cblxuZXhwb3J0IGNvbnN0IEZpZWxkVHlwZVRvb2x0aXA6IFJlY29yZDxrZXlvZiB0eXBlb2YgRmllbGRUeXBlLCBzdHJpbmc+ID0ge1xuICAgIFwiSW5wdXRcIjogXCJBY2NlcHQgYW55IHZhbHVlXCIsXG4gICAgXCJTZWxlY3RcIjogXCJBY2NlcHQgYSBzaW5nbGUgdmFsdWUgZnJvbSBhIGxpc3RcIixcbiAgICBcIk11bHRpXCI6IFwiQWNjZXB0IG11bHRpcGxlIHZhbHVlcyBmcm9tIGEgbGlzdFwiLFxuICAgIFwiQ3ljbGVcIjogXCJDeWNsZSB0aHJvdWdoIHZhbHVlcyBmcm9tIGEgbGlzdFwiLFxuICAgIFwiQm9vbGVhblwiOiBcIkFjY2VwdCB0cnVlIG9mIGZhbHNlXCIsXG4gICAgXCJOdW1iZXJcIjogXCJBY2NlcHQgYSBudW1iZXJcIixcbiAgICBcIkZpbGVcIjogXCJBY2NlcHQgYSBsaW5rXCIsXG4gICAgXCJNdWx0aUZpbGVcIjogXCJBY2NlcHQgbXVsdGlwbGUgbGlua3NcIixcbiAgICBcIkRhdGVcIjogXCJBY2NlcHQgYSBkYXRlXCIsXG4gICAgXCJMb29rdXBcIjogXCJBY2NlcHQgYSBsb29rdXAgcXVlcnlcIlxufVxuXG5leHBvcnQgY29uc3QgRmllbGRNYW5hZ2VyOiBSZWNvcmQ8a2V5b2YgdHlwZW9mIEZpZWxkVHlwZSwgYW55PiA9IHtcbiAgICBcIklucHV0XCI6IE1hbmFnZXJzLklucHV0LFxuICAgIFwiU2VsZWN0XCI6IE1hbmFnZXJzLlNlbGVjdCxcbiAgICBcIk11bHRpXCI6IE1hbmFnZXJzLk11bHRpLFxuICAgIFwiQ3ljbGVcIjogTWFuYWdlcnMuQ3ljbGUsXG4gICAgXCJCb29sZWFuXCI6IE1hbmFnZXJzLkJvb2xlYW4sXG4gICAgXCJOdW1iZXJcIjogTWFuYWdlcnMuTnVtYmVyLFxuICAgIFwiRmlsZVwiOiBNYW5hZ2Vycy5GaWxlLFxuICAgIFwiTXVsdGlGaWxlXCI6IE1hbmFnZXJzLk11bHRpRmlsZSxcbiAgICBcIkRhdGVcIjogTWFuYWdlcnMuRGF0ZSxcbiAgICBcIkxvb2t1cFwiOiBNYW5hZ2Vycy5Mb29rdXBcbn1cblxuZXhwb3J0IGNvbnN0IEZpZWxkSWNvbjogUmVjb3JkPGtleW9mIHR5cGVvZiBGaWVsZFR5cGUsIHN0cmluZz4gPSB7XG4gICAgXCJJbnB1dFwiOiBcInBlbmNpbFwiLFxuICAgIFwiU2VsZWN0XCI6IFwicmlnaHQtdHJpYW5nbGVcIixcbiAgICBcIk11bHRpXCI6IFwiYnVsbGV0LWxpc3RcIixcbiAgICBcIkN5Y2xlXCI6IFwic3dpdGNoXCIsXG4gICAgXCJCb29sZWFuXCI6IFwiY2hlY2ttYXJrXCIsXG4gICAgXCJOdW1iZXJcIjogXCJwbHVzLW1pbnVzLWdseXBoXCIsXG4gICAgXCJGaWxlXCI6IFwibGlua1wiLFxuICAgIFwiTXVsdGlGaWxlXCI6IFwibGlua1wiLFxuICAgIFwiRGF0ZVwiOiBcImNhbGVuZGFyLXdpdGgtY2hlY2ttYXJrXCIsXG4gICAgXCJMb29rdXBcIjogXCJmaWxlLXNlYXJjaFwiXG59IiwgImltcG9ydCB7IEZpZWxkVHlwZSB9IGZyb20gXCIuLi90eXBlcy9maWVsZFR5cGVzXCJcblxuY2xhc3MgRmllbGQge1xuXG4gICAgY29uc3RydWN0b3IoXG4gICAgICAgIHB1YmxpYyBuYW1lOiBzdHJpbmcgPSBcIlwiLFxuICAgICAgICBwdWJsaWMgb3B0aW9uczogUmVjb3JkPHN0cmluZywgYW55PiA9IHt9LFxuICAgICAgICBwdWJsaWMgaWQ6IHN0cmluZyA9IFwiXCIsXG4gICAgICAgIHB1YmxpYyB0eXBlOiBGaWVsZFR5cGUgPSBGaWVsZFR5cGUuSW5wdXRcbiAgICApIHsgfTtcblxuICAgIHN0YXRpYyBjb3B5UHJvcGVydHkodGFyZ2V0OiBGaWVsZCwgc291cmNlOiBGaWVsZCkge1xuICAgICAgICB0YXJnZXQuaWQgPSBzb3VyY2UuaWQ7XG4gICAgICAgIHRhcmdldC5uYW1lID0gc291cmNlLm5hbWU7XG4gICAgICAgIHRhcmdldC50eXBlID0gc291cmNlLnR5cGVcbiAgICAgICAgT2JqZWN0LmtleXMoc291cmNlLm9wdGlvbnMpLmZvckVhY2goayA9PiB7XG4gICAgICAgICAgICB0YXJnZXQub3B0aW9uc1trXSA9IHNvdXJjZS5vcHRpb25zW2tdO1xuICAgICAgICB9KTtcbiAgICAgICAgT2JqZWN0LmtleXModGFyZ2V0Lm9wdGlvbnMpLmZvckVhY2goayA9PiB7XG4gICAgICAgICAgICBpZiAoIU9iamVjdC5rZXlzKHNvdXJjZS5vcHRpb25zKS5pbmNsdWRlcyhrKSkge1xuICAgICAgICAgICAgICAgIGRlbGV0ZSB0YXJnZXQub3B0aW9uc1trXTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIH0pO1xuICAgIH07XG5cbiAgICBwdWJsaWMgc3RhdGljIGNyZWF0ZURlZmF1bHQobmFtZTogc3RyaW5nKTogRmllbGQge1xuICAgICAgICBjb25zdCBmaWVsZCA9IG5ldyBGaWVsZCgpO1xuICAgICAgICBmaWVsZC50eXBlID0gRmllbGRUeXBlLklucHV0O1xuICAgICAgICBmaWVsZC5uYW1lID0gbmFtZTtcbiAgICAgICAgcmV0dXJuIGZpZWxkO1xuICAgIH1cbn07XG5cbmV4cG9ydCBkZWZhdWx0IEZpZWxkOyIsICJpbXBvcnQgeyBDb21wb25lbnQsIFRGaWxlIH0gZnJvbSBcIm9ic2lkaWFuXCJcbmltcG9ydCBNZXRhZGF0YU1lbnUgZnJvbSBcIm1haW5cIlxuaW1wb3J0IEZpZWxkIGZyb20gXCIuLi9maWVsZHMvRmllbGRcIjtcbmltcG9ydCB7IEZpbGVDbGFzcyB9IGZyb20gXCJzcmMvZmlsZUNsYXNzL2ZpbGVDbGFzc1wiO1xuaW1wb3J0IEZpbGVDbGFzc1F1ZXJ5IGZyb20gXCJzcmMvZmlsZUNsYXNzL0ZpbGVDbGFzc1F1ZXJ5XCI7XG5pbXBvcnQgRmllbGRTZXR0aW5nIGZyb20gXCJzcmMvc2V0dGluZ3MvRmllbGRTZXR0aW5nXCI7XG5pbXBvcnQgeyB1cGRhdGVMb29rdXBzLCByZXNvbHZlTG9va3VwcyB9IGZyb20gXCIuLi9maWVsZHMvZmllbGRNYW5hZ2Vycy9Mb29rdXBGaWVsZFwiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBGaWVsZEluZGV4IGV4dGVuZHMgQ29tcG9uZW50IHtcblxuICAgIHB1YmxpYyBmaWxlQ2xhc3Nlc0ZpZWxkczogTWFwPHN0cmluZywgRmllbGRbXT47XG4gICAgcHVibGljIGZpZWxkc0Zyb21HbG9iYWxGaWxlQ2xhc3M6IEZpZWxkW107XG4gICAgcHVibGljIGZpbGVzRmllbGRzRnJvbUZpbGVDbGFzc1F1ZXJpZXM6IE1hcDxzdHJpbmcsIEZpZWxkW10+O1xuICAgIHB1YmxpYyBmaWxlc0ZpZWxkc0Zyb21Jbm5lckZpbGVDbGFzc2VzOiBNYXA8c3RyaW5nLCBGaWVsZFtdPjtcbiAgICBwdWJsaWMgZmlsZXNGaWVsZHM6IE1hcDxzdHJpbmcsIEZpZWxkW10+O1xuICAgIHB1YmxpYyBmaWxlc0ZpbGVDbGFzczogTWFwPHN0cmluZywgRmlsZUNsYXNzPjtcbiAgICBwdWJsaWMgZmlsZUNsYXNzZXNQYXRoOiBNYXA8c3RyaW5nLCBGaWxlQ2xhc3M+O1xuICAgIHB1YmxpYyBmaWxlQ2xhc3Nlc05hbWU6IE1hcDxzdHJpbmcsIEZpbGVDbGFzcz47XG4gICAgcHVibGljIHZhbHVlc0xpc3ROb3RlUGF0aFZhbHVlczogTWFwPHN0cmluZywgc3RyaW5nW10+O1xuICAgIHB1YmxpYyBmaWxlc0ZpbGVDbGFzc05hbWU6IE1hcDxzdHJpbmcsIHN0cmluZyB8IHVuZGVmaW5lZD47XG4gICAgcHVibGljIGZpbGVMb29rdXBGaWxlczogTWFwPHN0cmluZywgYW55W10+O1xuICAgIHB1YmxpYyBwcmV2aW91c0ZpbGVMb29rdXBGaWxlc1ZhbHVlczogTWFwPHN0cmluZywgbnVtYmVyPjtcbiAgICBwdWJsaWMgZmlsZUxvb2t1cEZpZWxkTGFzdFZhbHVlOiBNYXA8c3RyaW5nLCBzdHJpbmc+O1xuICAgIHB1YmxpYyBmaWxlTG9va3VwUGFyZW50czogTWFwPHN0cmluZywgc3RyaW5nW10+O1xuICAgIHB1YmxpYyBkdjogYW55O1xuICAgIHB1YmxpYyBsYXN0UmV2aXNpb246IDA7XG4gICAgcHVibGljIGZpbGVDaGFuZ2VkOiBib29sZWFuID0gZmFsc2U7XG4gICAgcHVibGljIGR2UmVhZHk6IGJvb2xlYW4gPSBmYWxzZTtcbiAgICBwdWJsaWMgbG9hZFRpbWU6IG51bWJlcjtcblxuICAgIGNvbnN0cnVjdG9yKHByaXZhdGUgcGx1Z2luOiBNZXRhZGF0YU1lbnUsIHB1YmxpYyBjYWNoZVZlcnNpb246IHN0cmluZywgcHVibGljIG9uQ2hhbmdlOiAoKSA9PiB2b2lkKSB7XG4gICAgICAgIHN1cGVyKClcbiAgICAgICAgdGhpcy5mbHVzaENhY2hlKCk7XG4gICAgICAgIHRoaXMuZmlsZUxvb2t1cEZpbGVzID0gbmV3IE1hcCgpO1xuICAgICAgICB0aGlzLmZpbGVMb29rdXBQYXJlbnRzID0gbmV3IE1hcCgpO1xuICAgICAgICB0aGlzLmZpbGVMb29rdXBGaWVsZExhc3RWYWx1ZSA9IG5ldyBNYXAoKTtcbiAgICAgICAgdGhpcy5wcmV2aW91c0ZpbGVMb29rdXBGaWxlc1ZhbHVlcyA9IG5ldyBNYXAoKTtcbiAgICAgICAgdGhpcy5kdiA9IHRoaXMucGx1Z2luLmFwcC5wbHVnaW5zLnBsdWdpbnMuZGF0YXZpZXc7XG4gICAgfVxuXG4gICAgYXN5bmMgb25sb2FkKCk6IFByb21pc2U8dm9pZD4ge1xuXG4gICAgICAgIHRoaXMubG9hZFRpbWUgPSBEYXRlLm5vdygpXG5cbiAgICAgICAgaWYgKHRoaXMuZHY/LmFwaS5pbmRleC5pbml0aWFsaXplZCkge1xuICAgICAgICAgICAgdGhpcy5kdiA9IHRoaXMucGx1Z2luLmFwcC5wbHVnaW5zLnBsdWdpbnMuZGF0YXZpZXc7XG4gICAgICAgICAgICB0aGlzLmxhc3RSZXZpc2lvbiA9IHRoaXMuZHYuYXBpLmluZGV4LnJldmlzaW9uO1xuICAgICAgICAgICAgdGhpcy5kdlJlYWR5ID0gdHJ1ZTtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMuZnVsbEluZGV4KFwiZHYgaXMgcnVubmluZ1wiKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMucGx1Z2luLnJlZ2lzdGVyRXZlbnQoXG4gICAgICAgICAgICB0aGlzLnBsdWdpbi5hcHAubWV0YWRhdGFDYWNoZS5vbihcImRhdGF2aWV3OmluZGV4LXJlYWR5XCIsIGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLmR2ID0gdGhpcy5wbHVnaW4uYXBwLnBsdWdpbnMucGx1Z2lucy5kYXRhdmlldztcbiAgICAgICAgICAgICAgICB0aGlzLmR2UmVhZHkgPSB0cnVlO1xuICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMuZnVsbEluZGV4KFwiZHYgaW5kZXhcIiwgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgdGhpcy5sYXN0UmV2aXNpb24gPSB0aGlzLmR2LmFwaS5pbmRleC5yZXZpc2lvbjtcbiAgICAgICAgICAgIH0pXG4gICAgICAgIClcblxuICAgICAgICB0aGlzLnBsdWdpbi5yZWdpc3RlckV2ZW50KFxuICAgICAgICAgICAgdGhpcy5wbHVnaW4uYXBwLm1ldGFkYXRhQ2FjaGUub24oJ3Jlc29sdmVkJywgYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2coXCJvYnNpZGlhbiByZXNvbHZlZFwiKVxuICAgICAgICAgICAgICAgIGlmICh0aGlzLnBsdWdpbi5hcHAubWV0YWRhdGFDYWNoZS5pblByb2dyZXNzVGFza0NvdW50ID09PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZmlsZUNoYW5nZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLmZ1bGxJbmRleChcImNhY2hlIHJlc29sdmVkXCIpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmxhc3RSZXZpc2lvbiA9IHRoaXMuZHY/LmFwaS5pbmRleC5yZXZpc2lvbiB8fCAwO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pXG4gICAgICAgIClcblxuICAgICAgICB0aGlzLnBsdWdpbi5yZWdpc3RlckV2ZW50KFxuICAgICAgICAgICAgdGhpcy5wbHVnaW4uYXBwLm1ldGFkYXRhQ2FjaGUub24oJ2RhdGF2aWV3Om1ldGFkYXRhLWNoYW5nZScsIGFzeW5jIChvcDogYW55LCBmaWxlOiBURmlsZSkgPT4ge1xuICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2coXCJzb21lIGZpbGUgY2hhbmdlZFwiLCB0aGlzLmZpbGVDaGFuZ2VkKTtcbiAgICAgICAgICAgICAgICBpZiAob3AgPT09IFwidXBkYXRlXCJcbiAgICAgICAgICAgICAgICAgICAgLy9kYXRhdmlldyBpcyB0cmlnZ2VyaW5nIFwidXBkYXRlXCIgb24gbWV0YWRhdGFjYWNoZS5vbihcInJlc29sdmVcIikgZXZlbiBpZiBubyBjaGFuZ2UgaW4gdGhlIGZpbGUuIEl0IG9jY3VycyBhdCBhcHAgbGF1bmNoXG4gICAgICAgICAgICAgICAgICAgIC8vY2hlY2sgaWYgdGhlIGZpbGUgbXRpbWUgaXMgb2xkZXIgdGhhdCBwbHVnaW4gbG9hZCAtPiBpbiB0aGlzIGNhc2Ugbm8gZmlsZSBoYXMgY2hhbmdlLCBubyBuZWVkIHRvIHVwbGRhdGUgbG9va3Vwc1xuICAgICAgICAgICAgICAgICAgICAvL0B0cy1pZ25vcmVcbiAgICAgICAgICAgICAgICAgICAgJiYgdGhpcy5wbHVnaW4uYXBwLm1ldGFkYXRhQ2FjaGUuZmlsZUNhY2hlW2ZpbGUucGF0aF0ubXRpbWUgPj0gdGhpcy5sb2FkVGltZVxuICAgICAgICAgICAgICAgICAgICAmJiB0aGlzLmR2Py5hcGkuaW5kZXgucmV2aXNpb24gIT09IHRoaXMubGFzdFJldmlzaW9uXG4gICAgICAgICAgICAgICAgICAgICYmIHRoaXMuZmlsZUNoYW5nZWRcbiAgICAgICAgICAgICAgICAgICAgJiYgdGhpcy5kdlJlYWR5XG4gICAgICAgICAgICAgICAgKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGNsYXNzRmlsZXNQYXRoID0gdGhpcy5wbHVnaW4uc2V0dGluZ3MuY2xhc3NGaWxlc1BhdGhcbiAgICAgICAgICAgICAgICAgICAgaWYgKGNsYXNzRmlsZXNQYXRoICYmIGZpbGUucGF0aC5pbmNsdWRlcyhjbGFzc0ZpbGVzUGF0aCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZnVsbEluZGV4KFwiZmlsZUNsYXNzIGNoYW5nZWRcIilcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucmVzb2x2ZUxvb2t1cHMoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMudXBkYXRlTG9va3VwcyhmYWxzZSwgZmlsZS5iYXNlbmFtZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgdGhpcy5sYXN0UmV2aXNpb24gPSB0aGlzLmR2LmFwaS5pbmRleC5yZXZpc2lvblxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pXG4gICAgICAgIClcbiAgICB9XG5cbiAgICBwcml2YXRlIGZsdXNoQ2FjaGUoKSB7XG4gICAgICAgIHRoaXMuZmlsZUNsYXNzZXNGaWVsZHMgPSBuZXcgTWFwKCk7XG4gICAgICAgIHRoaXMuZmllbGRzRnJvbUdsb2JhbEZpbGVDbGFzcyA9IFtdO1xuICAgICAgICB0aGlzLmZpbGVzRmllbGRzRnJvbUZpbGVDbGFzc1F1ZXJpZXMgPSBuZXcgTWFwKCk7XG4gICAgICAgIHRoaXMuZmlsZXNGaWVsZHNGcm9tSW5uZXJGaWxlQ2xhc3NlcyA9IG5ldyBNYXAoKTtcbiAgICAgICAgdGhpcy5maWxlc0ZpZWxkcyA9IG5ldyBNYXAoKTtcbiAgICAgICAgdGhpcy5maWxlc0ZpbGVDbGFzcyA9IG5ldyBNYXAoKTtcbiAgICAgICAgdGhpcy5maWxlQ2xhc3Nlc1BhdGggPSBuZXcgTWFwKCk7XG4gICAgICAgIHRoaXMuZmlsZUNsYXNzZXNOYW1lID0gbmV3IE1hcCgpO1xuICAgICAgICB0aGlzLmZpbGVzRmlsZUNsYXNzTmFtZSA9IG5ldyBNYXAoKTtcbiAgICAgICAgdGhpcy52YWx1ZXNMaXN0Tm90ZVBhdGhWYWx1ZXMgPSBuZXcgTWFwKCk7XG4gICAgfVxuXG4gICAgYXN5bmMgZnVsbEluZGV4KGV2ZW50OiBzdHJpbmcsIGZvcmNlX3VwZGF0ZV9sb29rdXBzID0gZmFsc2UpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgLy9jb25zb2xlLmxvZyhcInN0YXJ0IGluZGV4IFtcIiwgZXZlbnQsIFwiXVwiLCB0aGlzLmxhc3RSZXZpc2lvbiwgXCItPlwiLCB0aGlzLmR2Py5hcGkuaW5kZXgucmV2aXNpb24pXG4gICAgICAgIGNvbnN0IHN0YXJ0ID0gRGF0ZS5ub3coKVxuICAgICAgICB0aGlzLmZsdXNoQ2FjaGUoKTtcbiAgICAgICAgdGhpcy5nZXRHbG9iYWxGaWxlQ2xhc3MoKTtcbiAgICAgICAgdGhpcy5nZXRGaWxlQ2xhc3NlcygpO1xuICAgICAgICB0aGlzLnJlc29sdmVGaWxlQ2xhc3NRdWVyaWVzKCk7XG4gICAgICAgIHRoaXMuZ2V0RmlsZXNGaWVsZHNGcm9tRmlsZUNsYXNzKCk7XG4gICAgICAgIHRoaXMuZ2V0RmlsZXNGaWVsZHMoKTtcbiAgICAgICAgYXdhaXQgdGhpcy5nZXRWYWx1ZXNMaXN0Tm90ZVBhdGhWYWx1ZXMoKTtcbiAgICAgICAgdGhpcy5yZXNvbHZlTG9va3VwcygpO1xuICAgICAgICBhd2FpdCB0aGlzLnVwZGF0ZUxvb2t1cHMoZm9yY2VfdXBkYXRlX2xvb2t1cHMsIFwiZnVsbCBJbmRleFwiKTtcbiAgICAgICAgLy9jb25zb2xlLmxvZyhcImVuZCBpbmRleCBbXCIsIGV2ZW50LCBcIl1cIiwgdGhpcy5sYXN0UmV2aXNpb24sIFwiLT5cIiwgdGhpcy5kdj8uYXBpLmluZGV4LnJldmlzaW9uLCBgJHsoRGF0ZS5ub3coKSAtIHN0YXJ0KX1tc2ApXG4gICAgfVxuXG4gICAgcmVzb2x2ZUxvb2t1cHMoKTogdm9pZCB7XG4gICAgICAgIHJlc29sdmVMb29rdXBzKHRoaXMucGx1Z2luKTtcbiAgICB9XG5cbiAgICBhc3luYyB1cGRhdGVMb29rdXBzKGZvcmNlX3VwZGF0ZTogYm9vbGVhbiA9IGZhbHNlLCBzb3VyY2U6IHN0cmluZyA9IFwiXCIpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgYXdhaXQgdXBkYXRlTG9va3Vwcyh0aGlzLnBsdWdpbiwgZm9yY2VfdXBkYXRlLCBzb3VyY2UpO1xuICAgIH1cblxuICAgIGFzeW5jIGdldFZhbHVlc0xpc3ROb3RlUGF0aFZhbHVlcygpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgdGhpcy5maWxlQ2xhc3Nlc05hbWUuZm9yRWFjaCgoZmlsZUNsYXNzKSA9PiB7XG4gICAgICAgICAgICBmaWxlQ2xhc3MuYXR0cmlidXRlcy5mb3JFYWNoKGFzeW5jIGF0dHIgPT4ge1xuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgYXR0ci5vcHRpb25zID09PSBcIm9iamVjdFwiICYmICEhKGF0dHIub3B0aW9ucyBhcyBSZWNvcmQ8c3RyaW5nLCBhbnk+KVtcInZhbHVlc0xpc3ROb3RlUGF0aFwiXSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnZhbHVlc0xpc3ROb3RlUGF0aFZhbHVlcy5zZXQoXG4gICAgICAgICAgICAgICAgICAgICAgICAoYXR0ci5vcHRpb25zIGFzIFJlY29yZDxzdHJpbmcsIGFueT4pLnZhbHVlc0xpc3ROb3RlUGF0aCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IEZpZWxkU2V0dGluZy5nZXRWYWx1ZXNMaXN0RnJvbU5vdGUoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKGF0dHIub3B0aW9ucyBhcyBSZWNvcmQ8c3RyaW5nLCBhbnk+KS52YWx1ZXNMaXN0Tm90ZVBhdGhcbiAgICAgICAgICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pXG4gICAgICAgIH0pXG4gICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLnByZXNldEZpZWxkcy5mb3JFYWNoKGFzeW5jIHNldHRpbmcgPT4ge1xuICAgICAgICAgICAgaWYgKHNldHRpbmcub3B0aW9ucy52YWx1ZXNMaXN0Tm90ZVBhdGgpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnZhbHVlc0xpc3ROb3RlUGF0aFZhbHVlcy5zZXQoXG4gICAgICAgICAgICAgICAgICAgIHNldHRpbmcub3B0aW9ucy52YWx1ZXNMaXN0Tm90ZVBhdGgsXG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IEZpZWxkU2V0dGluZy5nZXRWYWx1ZXNMaXN0RnJvbU5vdGUoXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbixcbiAgICAgICAgICAgICAgICAgICAgICAgIHNldHRpbmcub3B0aW9ucy52YWx1ZXNMaXN0Tm90ZVBhdGhcbiAgICAgICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSlcbiAgICB9XG5cbiAgICBnZXRHbG9iYWxGaWxlQ2xhc3MoKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IGdsb2JhbEZpbGVDbGFzcyA9IHRoaXMucGx1Z2luLnNldHRpbmdzLmdsb2JhbEZpbGVDbGFzc1xuICAgICAgICBpZiAoIWdsb2JhbEZpbGVDbGFzcykge1xuICAgICAgICAgICAgdGhpcy5maWVsZHNGcm9tR2xvYmFsRmlsZUNsYXNzID0gW11cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgdGhpcy5maWVsZHNGcm9tR2xvYmFsRmlsZUNsYXNzID0gRmlsZUNsYXNzXG4gICAgICAgICAgICAgICAgICAgIC5jcmVhdGVGaWxlQ2xhc3MoXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbixcbiAgICAgICAgICAgICAgICAgICAgICAgIGdsb2JhbEZpbGVDbGFzcylcbiAgICAgICAgICAgICAgICAgICAgLmF0dHJpYnV0ZXMubWFwKGF0dHIgPT4gYXR0ci5nZXRGaWVsZCgpKVxuICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHsgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgZ2V0RmlsZUNsYXNzZXMoKTogdm9pZCB7XG4gICAgICAgIGlmICh0aGlzLnBsdWdpbi5zZXR0aW5ncy5jbGFzc0ZpbGVzUGF0aCkge1xuICAgICAgICAgICAgdGhpcy5wbHVnaW4uYXBwLnZhdWx0LmdldE1hcmtkb3duRmlsZXMoKVxuICAgICAgICAgICAgICAgIC5maWx0ZXIoZiA9PiBmLnBhdGguaW5jbHVkZXModGhpcy5wbHVnaW4uc2V0dGluZ3MuY2xhc3NGaWxlc1BhdGghKSlcbiAgICAgICAgICAgICAgICAuZm9yRWFjaChmID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGZpbGVDbGFzcyA9IEZpbGVDbGFzcy5jcmVhdGVGaWxlQ2xhc3ModGhpcy5wbHVnaW4sIGYuYmFzZW5hbWUpXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmZpbGVDbGFzc2VzRmllbGRzLnNldChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmLmJhc2VuYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbGVDbGFzcy5hdHRyaWJ1dGVzLm1hcChhdHRyID0+IGF0dHIuZ2V0RmllbGQoKSlcbiAgICAgICAgICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZmlsZUNsYXNzZXNQYXRoLnNldChmLnBhdGgsIGZpbGVDbGFzcylcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZmlsZUNsYXNzZXNOYW1lLnNldChmaWxlQ2xhc3MubmFtZSwgZmlsZUNsYXNzKVxuICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIHtcblxuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICB9XG5cbiAgICB9XG4gICAgcmVzb2x2ZUZpbGVDbGFzc1F1ZXJpZXMoKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IGR2QXBpID0gdGhpcy5wbHVnaW4uYXBwLnBsdWdpbnMucGx1Z2lucy5kYXRhdmlldz8uYXBpXG4gICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmZpbGVDbGFzc1F1ZXJpZXMuZm9yRWFjaChzZmNxID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGZjcSA9IG5ldyBGaWxlQ2xhc3NRdWVyeShzZmNxLm5hbWUsIHNmY3EuaWQsIHNmY3EucXVlcnksIHNmY3EuZmlsZUNsYXNzTmFtZSlcbiAgICAgICAgICAgIGZjcS5nZXRSZXN1bHRzKGR2QXBpKS5mb3JFYWNoKChyZXN1bHQ6IGFueSkgPT4ge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLmZpbGVDbGFzc2VzTmFtZS5nZXQoZmNxLmZpbGVDbGFzc05hbWUpKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZmlsZXNGaWxlQ2xhc3Muc2V0KFxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0LmZpbGUucGF0aCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZmlsZUNsYXNzZXNOYW1lLmdldChmY3EuZmlsZUNsYXNzTmFtZSkhXG4gICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZmlsZXNGaWxlQ2xhc3NOYW1lLnNldChyZXN1bHQuZmlsZS5wYXRoLCBmY3EuZmlsZUNsYXNzTmFtZSlcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY29uc3QgZmlsZUZpbGVDbGFzc2VzRmllbGRzRnJvbVF1ZXJ5ID0gdGhpcy5maWxlQ2xhc3Nlc0ZpZWxkcy5nZXQoZmNxLmZpbGVDbGFzc05hbWUpXG4gICAgICAgICAgICAgICAgaWYgKGZpbGVGaWxlQ2xhc3Nlc0ZpZWxkc0Zyb21RdWVyeSkgdGhpcy5maWxlc0ZpZWxkc0Zyb21GaWxlQ2xhc3NRdWVyaWVzLnNldChyZXN1bHQuZmlsZS5wYXRoLCBmaWxlRmlsZUNsYXNzZXNGaWVsZHNGcm9tUXVlcnkpXG4gICAgICAgICAgICB9KVxuICAgICAgICB9KVxuICAgIH1cblxuICAgIGdldEZpbGVzRmllbGRzRnJvbUZpbGVDbGFzcygpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5wbHVnaW4uYXBwLnZhdWx0LmdldE1hcmtkb3duRmlsZXMoKVxuICAgICAgICAgICAgLmZpbHRlcihmID0+ICF0aGlzLnBsdWdpbi5zZXR0aW5ncy5jbGFzc0ZpbGVzUGF0aFxuICAgICAgICAgICAgICAgIHx8ICFmLnBhdGguaW5jbHVkZXModGhpcy5wbHVnaW4uc2V0dGluZ3MuY2xhc3NGaWxlc1BhdGgpXG4gICAgICAgICAgICApXG4gICAgICAgICAgICAuZm9yRWFjaChmID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBmaWxlRmlsZUNsYXNzTmFtZSA9IHRoaXMucGx1Z2luLmFwcC5tZXRhZGF0YUNhY2hlLmdldEZpbGVDYWNoZShmKT8uZnJvbnRtYXR0ZXI/Llt0aGlzLnBsdWdpbi5zZXR0aW5ncy5maWxlQ2xhc3NBbGlhc11cbiAgICAgICAgICAgICAgICBpZiAoZmlsZUZpbGVDbGFzc05hbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuZmlsZUNsYXNzZXNOYW1lLmdldChmaWxlRmlsZUNsYXNzTmFtZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZmlsZXNGaWxlQ2xhc3Muc2V0KGYucGF0aCwgdGhpcy5maWxlQ2xhc3Nlc05hbWUuZ2V0KGZpbGVGaWxlQ2xhc3NOYW1lKSEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5maWxlc0ZpbGVDbGFzc05hbWUuc2V0KGYucGF0aCwgZmlsZUZpbGVDbGFzc05hbWUpXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZmlsZUNsYXNzZXNGaWVsZHNGcm9tRmlsZSA9IHRoaXMuZmlsZUNsYXNzZXNGaWVsZHMuZ2V0KGZpbGVGaWxlQ2xhc3NOYW1lKVxuICAgICAgICAgICAgICAgICAgICBpZiAoZmlsZUNsYXNzZXNGaWVsZHNGcm9tRmlsZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5maWxlc0ZpZWxkc0Zyb21Jbm5lckZpbGVDbGFzc2VzLnNldChmLnBhdGgsIGZpbGVDbGFzc2VzRmllbGRzRnJvbUZpbGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgdGhpcy5maWxlc0ZpZWxkc0Zyb21Jbm5lckZpbGVDbGFzc2VzLnNldChmLnBhdGgsIFtdKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMuZmlsZXNGaWVsZHNGcm9tSW5uZXJGaWxlQ2xhc3Nlcy5zZXQoZi5wYXRoLCBbXSk7XG4gICAgICAgICAgICB9KVxuICAgIH1cblxuICAgIGdldEZpbGVzRmllbGRzKCk6IHZvaWQge1xuICAgICAgICB0aGlzLnBsdWdpbi5hcHAudmF1bHQuZ2V0TWFya2Rvd25GaWxlcygpXG4gICAgICAgICAgICAuZmlsdGVyKGYgPT4gIXRoaXMucGx1Z2luLnNldHRpbmdzLmNsYXNzRmlsZXNQYXRoIHx8ICFmLnBhdGguaW5jbHVkZXModGhpcy5wbHVnaW4uc2V0dGluZ3MuY2xhc3NGaWxlc1BhdGgpKVxuICAgICAgICAgICAgLmZvckVhY2goZiA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgZmlsZUZpZWxkc0Zyb21Jbm5lckZpbGVDbGFzc2VzID0gdGhpcy5maWxlc0ZpZWxkc0Zyb21Jbm5lckZpbGVDbGFzc2VzLmdldChmLnBhdGgpXG4gICAgICAgICAgICAgICAgaWYgKGZpbGVGaWVsZHNGcm9tSW5uZXJGaWxlQ2xhc3Nlcz8ubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZmlsZXNGaWVsZHMuc2V0KGYucGF0aCwgZmlsZUZpZWxkc0Zyb21Jbm5lckZpbGVDbGFzc2VzKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZmlsZUNsYXNzRnJvbVF1ZXJ5ID0gdGhpcy5maWxlc0ZpZWxkc0Zyb21GaWxlQ2xhc3NRdWVyaWVzLmdldChmLnBhdGgpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoZmlsZUNsYXNzRnJvbVF1ZXJ5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmZpbGVzRmllbGRzLnNldChmLnBhdGgsIGZpbGVDbGFzc0Zyb21RdWVyeSlcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0aGlzLmZpZWxkc0Zyb21HbG9iYWxGaWxlQ2xhc3MubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmZpbGVzRmllbGRzLnNldChmLnBhdGgsIHRoaXMuZmllbGRzRnJvbUdsb2JhbEZpbGVDbGFzcylcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZmlsZXNGaWxlQ2xhc3NOYW1lLnNldChmLnBhdGgsIHRoaXMucGx1Z2luLnNldHRpbmdzLmdsb2JhbEZpbGVDbGFzcylcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZmlsZXNGaWVsZHMuc2V0KGYucGF0aCwgdGhpcy5wbHVnaW4uc2V0dGluZ3MucHJlc2V0RmllbGRzKVxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5maWxlc0ZpbGVDbGFzc05hbWUuc2V0KGYucGF0aCwgdW5kZWZpbmVkKVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSlcbiAgICB9XG59IiwgImltcG9ydCBNZXRhZGF0YU1lbnUgZnJvbSBcIm1haW5cIjtcbmltcG9ydCB7IFRGaWxlIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5cbmNsYXNzIEZpbGVDbGFzc1F1ZXJ5IHtcblxuICAgIGNvbnN0cnVjdG9yKFxuICAgICAgICBwdWJsaWMgbmFtZTogc3RyaW5nID0gXCJcIixcbiAgICAgICAgcHVibGljIGlkOiBzdHJpbmcgPSBcIlwiLFxuICAgICAgICBwdWJsaWMgcXVlcnk6IHN0cmluZyA9IFwiXCIsXG4gICAgICAgIHB1YmxpYyBmaWxlQ2xhc3NOYW1lOiBzdHJpbmcgPSBcIlwiXG4gICAgKSB7IH07XG5cbiAgICAvL0B0cy1pZ25vcmVcbiAgICBwdWJsaWMgZ2V0UmVzdWx0cyhhcGk6IERhdGF2aWV3UGx1Z2luW1wiYXBpXCJdKTogYW55IHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHJldHVybiAobmV3IEZ1bmN0aW9uKFwiZHZcIiwgYHJldHVybiAke3RoaXMucXVlcnl9YCkpKGFwaSlcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIHRocm93IEVycm9yKGBXcm9uZyBxdWVyeSBmb3IgZmllbGQgPCR7dGhpcy5uYW1lfT4uIENoZWNrIHlvdXIgc2V0dGluZ3NgKVxuICAgICAgICB9XG4gICAgfTtcblxuICAgIHB1YmxpYyBtYXRjaEZpbGUoZmlsZTogVEZpbGUpOiBib29sZWFuIHtcblxuICAgICAgICBjb25zdCBkYXRhdmlldyA9IGFwcC5wbHVnaW5zLnBsdWdpbnMuZGF0YXZpZXdcbiAgICAgICAgLy9AdHMtaWdub3JlXG4gICAgICAgIGlmICh0aGlzLnF1ZXJ5ICYmIGRhdGF2aWV3Py5zZXR0aW5ncy5lbmFibGVEYXRhdmlld0pzICYmIGRhdGF2aWV3Py5zZXR0aW5ncy5lbmFibGVJbmxpbmVEYXRhdmlld0pzKSB7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGZpbGVzUGF0aCA9IHRoaXMuZ2V0UmVzdWx0cyhkYXRhdmlldy5hcGkpLnZhbHVlcy5tYXAoKHY6IGFueSkgPT4gdi5maWxlLnBhdGgpIGFzIHN0cmluZ1tdXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZpbGVzUGF0aC5pbmNsdWRlcyhmaWxlLnBhdGgpO1xuICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBzdGF0aWMgY29weVByb3BlcnR5KHRhcmdldDogRmlsZUNsYXNzUXVlcnksIHNvdXJjZTogRmlsZUNsYXNzUXVlcnkpIHtcbiAgICAgICAgdGFyZ2V0LmlkID0gc291cmNlLmlkO1xuICAgICAgICB0YXJnZXQubmFtZSA9IHNvdXJjZS5uYW1lO1xuICAgICAgICB0YXJnZXQucXVlcnkgPSBzb3VyY2UucXVlcnk7XG4gICAgICAgIHRhcmdldC5maWxlQ2xhc3NOYW1lID0gc291cmNlLmZpbGVDbGFzc05hbWVcbiAgICB9O1xufTtcblxuZXhwb3J0IGRlZmF1bHQgRmlsZUNsYXNzUXVlcnk7IiwgImltcG9ydCB7IERyb3Bkb3duQ29tcG9uZW50LCBNb2RhbCwgVGV4dENvbXBvbmVudCwgQnV0dG9uQ29tcG9uZW50LCBFeHRyYUJ1dHRvbkNvbXBvbmVudCwgTm90aWNlIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgeyBGaWxlQ2xhc3NBdHRyaWJ1dGUgfSBmcm9tIFwic3JjL2ZpbGVDbGFzcy9maWxlQ2xhc3NBdHRyaWJ1dGVcIjtcbmltcG9ydCB7IEZpZWxkVHlwZVRvb2x0aXAsIEZpZWxkVHlwZSwgRmllbGRUeXBlTGFiZWxNYXBwaW5nLCBGaWVsZE1hbmFnZXIgfSBmcm9tIFwic3JjL3R5cGVzL2ZpZWxkVHlwZXNcIjtcbmltcG9ydCB7IEZpbGVDbGFzcyB9IGZyb20gXCJzcmMvZmlsZUNsYXNzL2ZpbGVDbGFzc1wiO1xuaW1wb3J0IE1ldGFkYXRhTWVudSBmcm9tIFwibWFpblwiO1xuaW1wb3J0IEZpZWxkIGZyb20gXCJzcmMvZmllbGRzL0ZpZWxkXCI7XG5pbXBvcnQgeyBGaWVsZE1hbmFnZXIgYXMgRiwgU2V0dGluZ0xvY2F0aW9uIH0gZnJvbSBcInNyYy9maWVsZHMvRmllbGRNYW5hZ2VyXCI7XG5cbmNsYXNzIEZpbGVDbGFzc0F0dHJpYnV0ZU1vZGFsIGV4dGVuZHMgTW9kYWwge1xuXG4gICAgcHJpdmF0ZSBuYW1lSW5wdXRDb250YWluZXI6IEhUTUxEaXZFbGVtZW50O1xuICAgIHByaXZhdGUgbmFtZUlucHV0OiBUZXh0Q29tcG9uZW50O1xuICAgIHByaXZhdGUgYXR0ck5hbWU6IEhUTUxFbGVtZW50O1xuICAgIHByaXZhdGUgdHlwZVNlbGVjdENvbnRhaW5lcjogSFRNTERpdkVsZW1lbnQ7XG4gICAgcHJpdmF0ZSBpbml0aWFsRmllbGQ6IEZpZWxkO1xuICAgIHByaXZhdGUgZmllbGQ6IEZpZWxkO1xuICAgIHByaXZhdGUgZmllbGRNYW5hZ2VyOiBGO1xuICAgIHByaXZhdGUgZmllbGRPcHRpb25zQ29udGFpbmVyOiBIVE1MRGl2RWxlbWVudDtcblxuXG4gICAgY29uc3RydWN0b3IocHJpdmF0ZSBwbHVnaW46IE1ldGFkYXRhTWVudSwgcHJpdmF0ZSBmaWxlQ2xhc3M6IEZpbGVDbGFzcywgcHJpdmF0ZSBhdHRyPzogRmlsZUNsYXNzQXR0cmlidXRlKSB7XG4gICAgICAgIHN1cGVyKHBsdWdpbi5hcHApO1xuICAgICAgICB0aGlzLmluaXRpYWxGaWVsZCA9IG5ldyBGaWVsZCgpO1xuICAgICAgICBpZiAodGhpcy5hdHRyKSB7XG4gICAgICAgICAgICB0aGlzLmZpZWxkID0gYXR0ciEuZ2V0RmllbGQoKVxuICAgICAgICAgICAgRmllbGQuY29weVByb3BlcnR5KHRoaXMuaW5pdGlhbEZpZWxkLCB0aGlzLmZpZWxkKVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5maWVsZCA9IG5ldyBGaWVsZCgpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuZmllbGRNYW5hZ2VyID0gbmV3IEZpZWxkTWFuYWdlclt0aGlzLmZpZWxkLnR5cGVdKHRoaXMucGx1Z2luLCB0aGlzLmZpZWxkKTtcbiAgICAgICAgdGhpcy5uYW1lSW5wdXRDb250YWluZXIgPSB0aGlzLmNvbnRlbnRFbC5jcmVhdGVEaXYoKTtcbiAgICAgICAgdGhpcy50eXBlU2VsZWN0Q29udGFpbmVyID0gdGhpcy5jb250ZW50RWwuY3JlYXRlRGl2KHsgY2xzOiAnbWV0YWRhdGEtbWVudS12YWx1ZS1zZWxlY3Rvci1jb250YWluZXInIH0pO1xuICAgICAgICB0aGlzLmZpZWxkT3B0aW9uc0NvbnRhaW5lciA9IHRoaXMuY29udGVudEVsLmNyZWF0ZURpdigpXG4gICAgfVxuXG4gICAgYnVpbGROYW1lSW5wdXRDb250YWluZXIoKTogdm9pZCB7XG4gICAgICAgIHRoaXMubmFtZUlucHV0Q29udGFpbmVyLnNldFRleHQoXCJOYW1lOiBcIik7XG4gICAgICAgIHRoaXMubmFtZUlucHV0ID0gbmV3IFRleHRDb21wb25lbnQodGhpcy5uYW1lSW5wdXRDb250YWluZXIpO1xuICAgICAgICB0aGlzLmF0dHIgPyB0aGlzLm5hbWVJbnB1dC5zZXRWYWx1ZSh0aGlzLmZpZWxkLm5hbWUpIDogdGhpcy5uYW1lSW5wdXQuc2V0UGxhY2Vob2xkZXIoXCJUeXBlIGEgbmFtZSBmb3IgdGhpcyBhdHRyaWJ1dGVcIik7XG4gICAgICAgIHRoaXMubmFtZUlucHV0LmlucHV0RWwuZm9jdXMoKTtcbiAgICAgICAgdGhpcy5uYW1lSW5wdXQub25DaGFuZ2UodmFsdWUgPT4geyB0aGlzLmZpZWxkLm5hbWUgPSB2YWx1ZTsgdGhpcy5hdHRyTmFtZS5zZXRUZXh0KGA8JHt2YWx1ZX0+YCkgfSk7XG4gICAgICAgIHRoaXMudHlwZVNlbGVjdENvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6ICdtZXRhZGF0YS1tZW51LXNlcGFyYXRvcicgfSkuY3JlYXRlRWwoXCJoclwiKTtcbiAgICB9XG5cbiAgICBidWlsZFR5cGVTZWxlY3RDb250YWluZXIoKTogdm9pZCB7XG5cbiAgICAgICAgLy9oZWFkZXIgZm9yIHNlbGVjdFxuICAgICAgICBjb25zdCB0eXBlU2VsZWN0SGVhZGVyID0gdGhpcy50eXBlU2VsZWN0Q29udGFpbmVyLmNyZWF0ZURpdigpO1xuICAgICAgICBjb25zdCBhdHRyTGluZSA9IHR5cGVTZWxlY3RIZWFkZXIuY3JlYXRlRWwoXCJkaXZcIik7XG4gICAgICAgIHRoaXMuYXR0ck5hbWUgPSBhdHRyTGluZS5jcmVhdGVFbChcInN0cm9uZ1wiKTtcbiAgICAgICAgdGhpcy5hdHRyTmFtZS5zZXRUZXh0KGA8JHt0aGlzLmZpZWxkLm5hbWV9PmApO1xuICAgICAgICBhdHRyTGluZS5hcHBlbmQoXCIgZmllbGRzIGluIGZpbGVzIHdpdGg6XCIpO1xuICAgICAgICBTdHJpbmcoYC0tLVxcbiR7dGhpcy5wbHVnaW4uc2V0dGluZ3MuZmlsZUNsYXNzQWxpYXN9OiAke3RoaXMuZmlsZUNsYXNzLm5hbWV9XFxuLi4uXFxuLS0tYCkuc3BsaXQoJ1xcbicpLmZvckVhY2gobGluZSA9PiB7XG4gICAgICAgICAgICB0eXBlU2VsZWN0SGVhZGVyLmNyZWF0ZUVsKFwiZGl2XCIsIFwieWFtbC1tZXRhZGF0YS1tZW51LXJlZFwiKS5zZXRUZXh0KGxpbmUpO1xuICAgICAgICB9KVxuICAgICAgICAvL2Ryb3Bkb3duXG4gICAgICAgIGNvbnN0IHR5cGVTZWxlY3RMYWJlbCA9IHRoaXMudHlwZVNlbGVjdENvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6ICdtZXRhZGF0YS1tZW51LXZhbHVlLXNlbGVjdG9yLWlubGluZS1sYWJlbCcgfSk7XG4gICAgICAgIHR5cGVTZWxlY3RMYWJlbC5zZXRUZXh0KFwid2lsbDogXCIpO1xuICAgICAgICBjb25zdCB0eXBlU2VsZWN0RHJvcERvd24gPSB0aGlzLnR5cGVTZWxlY3RDb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiAnbWV0YWRhdGEtbWVudS12YWx1ZS1zZWxlY3Rvci10b2dnbGVyJyB9KTtcblxuICAgICAgICBjb25zdCB0eXBlU2VsZWN0ID0gbmV3IERyb3Bkb3duQ29tcG9uZW50KHR5cGVTZWxlY3REcm9wRG93bik7XG5cbiAgICAgICAgT2JqZWN0LmtleXMoRmllbGRUeXBlVG9vbHRpcCkuZm9yRWFjaCgoa2V5OiBrZXlvZiB0eXBlb2YgRmllbGRUeXBlKSA9PiB0eXBlU2VsZWN0LmFkZE9wdGlvbihrZXksIEZpZWxkVHlwZVRvb2x0aXBba2V5XSkpXG4gICAgICAgIHR5cGVTZWxlY3Quc2V0VmFsdWUodGhpcy5maWVsZC50eXBlKVxuICAgICAgICB0eXBlU2VsZWN0Lm9uQ2hhbmdlKCh0eXBlTGFiZWw6IGtleW9mIHR5cGVvZiBGaWVsZFR5cGUpID0+IHtcblxuICAgICAgICAgICAgdGhpcy5maWVsZCA9IG5ldyBGaWVsZCgpO1xuICAgICAgICAgICAgRmllbGQuY29weVByb3BlcnR5KHRoaXMuZmllbGQsIHRoaXMuaW5pdGlhbEZpZWxkKTtcbiAgICAgICAgICAgIHRoaXMuZmllbGQubmFtZSA9IHRoaXMubmFtZUlucHV0LmdldFZhbHVlKClcbiAgICAgICAgICAgIHRoaXMuZmllbGQudHlwZSA9IEZpZWxkVHlwZUxhYmVsTWFwcGluZ1t0eXBlTGFiZWxdO1xuICAgICAgICAgICAgaWYgKHRoaXMuZmllbGQudHlwZSAhPT0gdGhpcy5pbml0aWFsRmllbGQudHlwZSAmJlxuICAgICAgICAgICAgICAgICFbdGhpcy5maWVsZC50eXBlLCB0aGlzLmluaXRpYWxGaWVsZC50eXBlXS5ldmVyeShmaWVsZFR5cGUgPT5cbiAgICAgICAgICAgICAgICAgICAgW0ZpZWxkVHlwZS5NdWx0aSwgRmllbGRUeXBlLlNlbGVjdCwgRmllbGRUeXBlLkN5Y2xlXS5pbmNsdWRlcyhmaWVsZFR5cGUpXG4gICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5maWVsZC5vcHRpb25zID0ge31cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHdoaWxlICh0aGlzLmZpZWxkT3B0aW9uc0NvbnRhaW5lci5maXJzdENoaWxkKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5maWVsZE9wdGlvbnNDb250YWluZXIucmVtb3ZlQ2hpbGQodGhpcy5maWVsZE9wdGlvbnNDb250YWluZXIuZmlyc3RDaGlsZCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLmZpZWxkTWFuYWdlciA9IG5ldyBGaWVsZE1hbmFnZXJbdGhpcy5maWVsZC50eXBlXSh0aGlzLnBsdWdpbiwgdGhpcy5maWVsZClcbiAgICAgICAgICAgIHRoaXMuZmllbGRNYW5hZ2VyLmNyZWF0ZVNldHRpbmdDb250YWluZXIodGhpcy5maWVsZE9wdGlvbnNDb250YWluZXIsIHRoaXMucGx1Z2luLCBTZXR0aW5nTG9jYXRpb24uRmlsZUNsYXNzQXR0cmlidXRlU2V0dGluZ3MpXG4gICAgICAgIH0pXG4gICAgfVxuXG4gICAgcHJpdmF0ZSB2YWxpZGF0ZUZpZWxkcygpOiBib29sZWFuIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZmllbGRNYW5hZ2VyLnZhbGlkYXRlTmFtZShcbiAgICAgICAgICAgIHRoaXMubmFtZUlucHV0LFxuICAgICAgICAgICAgdGhpcy5uYW1lSW5wdXQuaW5wdXRFbFxuICAgICAgICApICYmXG4gICAgICAgICAgICB0aGlzLmZpZWxkTWFuYWdlci52YWxpZGF0ZU9wdGlvbnMoKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGNyZWF0ZVNhdmVCdG4oY29udGFpbmVyOiBIVE1MRGl2RWxlbWVudCk6IHZvaWQge1xuICAgICAgICBjb25zdCBzYXZlQnV0dG9uID0gbmV3IEJ1dHRvbkNvbXBvbmVudChjb250YWluZXIpO1xuICAgICAgICBzYXZlQnV0dG9uLnNldEljb24oXCJjaGVja21hcmtcIik7XG4gICAgICAgIHNhdmVCdXR0b24ub25DbGljaygoKSA9PiB7XG4gICAgICAgICAgICBsZXQgZXJyb3IgPSAhdGhpcy52YWxpZGF0ZUZpZWxkcygpO1xuICAgICAgICAgICAgaWYgKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgbmV3IE5vdGljZShcIkZpeCBlcnJvcnMgYmVmb3JlIHNhdmluZy5cIik7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHRoaXMuZmlsZUNsYXNzLnVwZGF0ZUF0dHJpYnV0ZSh0aGlzLmZpZWxkLnR5cGUsIHRoaXMuZmllbGQubmFtZSwgdGhpcy5maWVsZC5vcHRpb25zLCB0aGlzLmF0dHIpO1xuICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgICB9KVxuICAgIH1cblxuICAgIHByaXZhdGUgY3JlYXRlUmVtb3ZlbEJ0bihjb250YWluZXI6IEhUTUxEaXZFbGVtZW50KTogdm9pZCB7XG4gICAgICAgIGNvbnN0IHJlbW92ZUJ1dHRvbiA9IG5ldyBCdXR0b25Db21wb25lbnQoY29udGFpbmVyKTtcbiAgICAgICAgcmVtb3ZlQnV0dG9uLnNldEljb24oXCJ0cmFzaFwiKTtcbiAgICAgICAgcmVtb3ZlQnV0dG9uLm9uQ2xpY2soKCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgY29uZmlybU1vZGFsID0gbmV3IE1vZGFsKHRoaXMucGx1Z2luLmFwcCk7XG4gICAgICAgICAgICBjb25maXJtTW9kYWwudGl0bGVFbC5zZXRUZXh0KFwiUGxlYXNlIGNvbmZpcm1cIik7XG4gICAgICAgICAgICBjb25maXJtTW9kYWwuY29udGVudEVsLmNyZWF0ZURpdigpLnNldFRleHQoYERvIHlvdSByZWFsbHkgd2FudCB0byByZW1vdmUgJHt0aGlzLmF0dHI/Lm5hbWV9IGF0dHJpYnV0ZSBmcm9tICR7dGhpcy5maWxlQ2xhc3MubmFtZX0/YCk7XG4gICAgICAgICAgICBjb25zdCBjb25maXJtRm9vdGVyID0gY29uZmlybU1vZGFsLmNvbnRlbnRFbC5jcmVhdGVEaXYoeyBjbHM6IFwibWV0YWRhdGEtbWVudS12YWx1ZS1ncmlkLWZvb3RlclwiIH0pO1xuICAgICAgICAgICAgY29uc3QgY29uZmlybUJ1dHRvbiA9IG5ldyBCdXR0b25Db21wb25lbnQoY29uZmlybUZvb3Rlcik7XG4gICAgICAgICAgICBjb25maXJtQnV0dG9uLnNldEljb24oXCJjaGVja21hcmtcIik7XG4gICAgICAgICAgICBjb25maXJtQnV0dG9uLm9uQ2xpY2soKCkgPT4ge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLmF0dHIpIHRoaXMuZmlsZUNsYXNzLnJlbW92ZUF0dHJpYnV0ZSh0aGlzLmF0dHIpO1xuICAgICAgICAgICAgICAgIGNvbmZpcm1Nb2RhbC5jbG9zZSgpO1xuICAgICAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICBjb25zdCBkaXNtaXNzQnV0dG9uID0gbmV3IEV4dHJhQnV0dG9uQ29tcG9uZW50KGNvbmZpcm1Gb290ZXIpO1xuICAgICAgICAgICAgZGlzbWlzc0J1dHRvbi5zZXRJY29uKFwiY3Jvc3NcIik7XG4gICAgICAgICAgICBkaXNtaXNzQnV0dG9uLm9uQ2xpY2soKCkgPT4gdGhpcy5jbG9zZSgpKTtcbiAgICAgICAgICAgIGNvbmZpcm1Nb2RhbC5vcGVuKCk7XG4gICAgICAgIH0pXG4gICAgfVxuXG4gICAgcHJpdmF0ZSBjcmVhdGVDYW5jZWxCdG4oY29udGFpbmVyOiBIVE1MRGl2RWxlbWVudCk6IHZvaWQge1xuICAgICAgICBjb25zdCBjYW5jZWxCdXR0b24gPSBuZXcgRXh0cmFCdXR0b25Db21wb25lbnQoY29udGFpbmVyKTtcbiAgICAgICAgY2FuY2VsQnV0dG9uLnNldEljb24oXCJjcm9zc1wiKTtcbiAgICAgICAgY2FuY2VsQnV0dG9uLm9uQ2xpY2soKCkgPT4gdGhpcy5jbG9zZSgpKTtcbiAgICB9XG5cbiAgICBvbk9wZW4oKSB7XG4gICAgICAgIC8vdGl0bGVcbiAgICAgICAgdGhpcy50aXRsZUVsLnNldFRleHQodGhpcy5hdHRyID8gYE1hbmFnZSAke3RoaXMuYXR0ci5uYW1lfWAgOiBgQ3JlYXRlIGEgbmV3IGF0dHJpYnV0ZSBmb3IgJHt0aGlzLmZpbGVDbGFzcy5uYW1lfWApO1xuXG4gICAgICAgIHRoaXMuYnVpbGROYW1lSW5wdXRDb250YWluZXIoKVxuICAgICAgICB0aGlzLmJ1aWxkVHlwZVNlbGVjdENvbnRhaW5lcigpXG4gICAgICAgIHRoaXMuZmllbGRNYW5hZ2VyLmNyZWF0ZVNldHRpbmdDb250YWluZXIodGhpcy5maWVsZE9wdGlvbnNDb250YWluZXIsIHRoaXMucGx1Z2luLCBTZXR0aW5nTG9jYXRpb24uRmlsZUNsYXNzQXR0cmlidXRlU2V0dGluZ3MpXG5cbiAgICAgICAgLy8gZm9vdGVyIGJ1dHRvbnNcbiAgICAgICAgY29uc3QgZm9vdGVyID0gdGhpcy5jb250ZW50RWwuY3JlYXRlRGl2KHsgY2xzOiBcIm1ldGFkYXRhLW1lbnUtdmFsdWUtZ3JpZC1mb290ZXJcIiB9KTtcbiAgICAgICAgdGhpcy5jcmVhdGVTYXZlQnRuKGZvb3Rlcik7XG4gICAgICAgIGlmICh0aGlzLmF0dHIpIHRoaXMuY3JlYXRlUmVtb3ZlbEJ0bihmb290ZXIpO1xuICAgICAgICB0aGlzLmNyZWF0ZUNhbmNlbEJ0bihmb290ZXIpO1xuICAgIH1cbn1cblxuZXhwb3J0IHsgRmlsZUNsYXNzQXR0cmlidXRlTW9kYWwgfSIsICJpbXBvcnQgTWV0YWRhdGFNZW51IGZyb20gXCJtYWluXCI7XG5pbXBvcnQgeyBURmlsZSB9IGZyb20gXCJvYnNpZGlhblwiXG5pbXBvcnQgeyBpbmxpbmVGaWVsZFJlZ2V4LCBlbmNvZGVMaW5rLCBkZWNvZGVMaW5rIH0gZnJvbSBcInNyYy91dGlscy9wYXJzZXJcIjtcblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFZhbHVlcyhwbHVnaW46IE1ldGFkYXRhTWVudSwgZmlsZU9yZmlsZVBhdGg6IFRGaWxlIHwgc3RyaW5nLCBhdHRyaWJ1dGU6IHN0cmluZyk6IFByb21pc2U8c3RyaW5nW10+IHtcbiAgICBsZXQgZmlsZTogVEZpbGU7XG4gICAgaWYgKGZpbGVPcmZpbGVQYXRoIGluc3RhbmNlb2YgVEZpbGUpIHtcbiAgICAgICAgZmlsZSA9IGZpbGVPcmZpbGVQYXRoO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbnN0IF9maWxlID0gcGx1Z2luLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgoZmlsZU9yZmlsZVBhdGgpXG4gICAgICAgIGlmIChfZmlsZSBpbnN0YW5jZW9mIFRGaWxlICYmIF9maWxlLmV4dGVuc2lvbiA9PSBcIm1kXCIpIHtcbiAgICAgICAgICAgIGZpbGUgPSBfZmlsZTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRocm93IEVycm9yKFwicGF0aCBkb2Vzbid0IGNvcnJlc3BvbmQgdG8gYSBwcm9wZXIgZmlsZVwiKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBjb25zdCBjb250ZW50ID0gKGF3YWl0IHBsdWdpbi5hcHAudmF1bHQuY2FjaGVkUmVhZChmaWxlKSkuc3BsaXQoJ1xcbicpO1xuICAgIGNvbnN0IGZyb250bWF0dGVyID0gcGx1Z2luLmFwcC5tZXRhZGF0YUNhY2hlLmdldEZpbGVDYWNoZShmaWxlKT8uZnJvbnRtYXR0ZXI7XG4gICAgY29uc3QgeyBwb3NpdGlvbjogeyBzdGFydCwgZW5kIH0gfSA9IGZyb250bWF0dGVyID8gZnJvbnRtYXR0ZXIgOiB7IHBvc2l0aW9uOiB7IHN0YXJ0OiB1bmRlZmluZWQsIGVuZDogdW5kZWZpbmVkIH0gfTtcbiAgICBjb25zdCByZXN1bHQ6IHN0cmluZ1tdID0gW107XG4gICAgY29udGVudC5tYXAoKGxpbmUsIGkpID0+IHtcbiAgICAgICAgaWYgKHN0YXJ0ICYmIGVuZCAmJiBpID49IHN0YXJ0LmxpbmUgJiYgaSA8PSBlbmQubGluZSkge1xuICAgICAgICAgICAgY29uc3QgcmVnZXggPSBuZXcgUmVnRXhwKGAke2F0dHJpYnV0ZX06KC4qKWAsICd1Jyk7XG4gICAgICAgICAgICBjb25zdCByID0gbGluZS5tYXRjaChyZWdleCk7XG4gICAgICAgICAgICBpZiAociAmJiByLmxlbmd0aCA+IDApIHJlc3VsdC5wdXNoKHJbMV0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29uc3QgZnVsbExpbmVSZWdleCA9IG5ldyBSZWdFeHAoYF4ke2lubGluZUZpZWxkUmVnZXgoYXR0cmlidXRlKX0oPzx2YWx1ZXM+W15cXFxcXV0qKWAsIFwidVwiKTtcbiAgICAgICAgICAgIGNvbnN0IGZSID0gZW5jb2RlTGluayhsaW5lKS5tYXRjaChmdWxsTGluZVJlZ2V4KTtcbiAgICAgICAgICAgIGlmIChmUj8uZ3JvdXBzKSB7IHJlc3VsdC5wdXNoKGRlY29kZUxpbmsoZlIuZ3JvdXBzLnZhbHVlcykpIH07XG4gICAgICAgICAgICBjb25zdCBpblNlbnRlbmNlUmVnZXhCcmFja2V0cyA9IG5ldyBSZWdFeHAoYFxcXFxbJHtpbmxpbmVGaWVsZFJlZ2V4KGF0dHJpYnV0ZSl9KD88dmFsdWVzPlteXFxcXF1dKyk/XFxcXF1gLCBcImd1XCIpO1xuICAgICAgICAgICAgY29uc3Qgc1JCID0gZW5jb2RlTGluayhsaW5lKS5tYXRjaEFsbChpblNlbnRlbmNlUmVnZXhCcmFja2V0cyk7XG4gICAgICAgICAgICBsZXQgbmV4dCA9IHNSQi5uZXh0KCk7XG4gICAgICAgICAgICB3aGlsZSAoIW5leHQuZG9uZSkge1xuICAgICAgICAgICAgICAgIGlmIChuZXh0LnZhbHVlLmdyb3VwcykgeyByZXN1bHQucHVzaChkZWNvZGVMaW5rKG5leHQudmFsdWUuZ3JvdXBzLnZhbHVlcykpIH1cbiAgICAgICAgICAgICAgICBuZXh0ID0gc1JCLm5leHQoKVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uc3QgaW5TZW50ZW5jZVJlZ2V4UGFyID0gbmV3IFJlZ0V4cChgXFxcXCgke2lubGluZUZpZWxkUmVnZXgoYXR0cmlidXRlKX0oPzx2YWx1ZXM+W15cXFxcKV0rKT9cXFxcKWAsIFwiZ3VcIik7XG4gICAgICAgICAgICBjb25zdCBzUlAgPSBlbmNvZGVMaW5rKGxpbmUpLm1hdGNoQWxsKGluU2VudGVuY2VSZWdleFBhcik7XG4gICAgICAgICAgICBuZXh0ID0gc1JQLm5leHQoKTtcbiAgICAgICAgICAgIHdoaWxlICghbmV4dC5kb25lKSB7XG4gICAgICAgICAgICAgICAgaWYgKG5leHQudmFsdWUuZ3JvdXBzKSB7IHJlc3VsdC5wdXNoKGRlY29kZUxpbmsobmV4dC52YWx1ZS5ncm91cHMudmFsdWVzKSkgfVxuICAgICAgICAgICAgICAgIG5leHQgPSBzUlAubmV4dCgpXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9KVxuICAgIHJldHVybiByZXN1bHQ7XG59IiwgImltcG9ydCB7IE1vZGFsLCBEcm9wZG93bkNvbXBvbmVudCwgVEZpbGUsIFRvZ2dsZUNvbXBvbmVudCwgQnV0dG9uQ29tcG9uZW50IH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgTWV0YWRhdGFNZW51IGZyb20gXCJtYWluXCI7XG5pbXBvcnQgeyBGaWxlQ2xhc3MgfSBmcm9tIFwic3JjL2ZpbGVDbGFzcy9maWxlQ2xhc3NcIjtcbmltcG9ydCB7IEZpZWxkTWFuYWdlciBhcyBGIH0gZnJvbSBcInNyYy9maWVsZHMvRmllbGRNYW5hZ2VyXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIGNob29zZVNlY3Rpb25Nb2RhbCBleHRlbmRzIE1vZGFsIHtcblxuICAgIGNvbnN0cnVjdG9yKFxuICAgICAgICBwcml2YXRlIHBsdWdpbjogTWV0YWRhdGFNZW51LFxuICAgICAgICBwcml2YXRlIGZpbGU6IFRGaWxlLFxuICAgICAgICBwcml2YXRlIGZpbGVDbGFzcz86IEZpbGVDbGFzcyxcbiAgICAgICAgcHJpdmF0ZSBmaWVsZE5hbWU/OiBzdHJpbmdcbiAgICApIHtcbiAgICAgICAgc3VwZXIocGx1Z2luLmFwcCk7XG4gICAgfTtcblxuICAgIGFzeW5jIG9uT3BlbigpIHtcblxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLnBsdWdpbi5hcHAudmF1bHQucmVhZCh0aGlzLmZpbGUpXG4gICAgICAgIHRoaXMudGl0bGVFbC5zZXRUZXh0KGBBZGQgYSAke3RoaXMuZmllbGROYW1lID8gXCI8XCIgKyB0aGlzLmZpZWxkTmFtZSArIFwiPiBcIiA6IFwiXCJcbiAgICAgICAgICAgIH1maWVsZCBpbiBcIiR7dGhpcy5maWxlLmJhc2VuYW1lLnNsaWNlKDAsIDMwKVxuICAgICAgICAgICAgfSR7dGhpcy5maWxlLmJhc2VuYW1lLmxlbmd0aCA8IDMwID8gXCIuLi5cIiA6IFwiXCJcbiAgICAgICAgICAgIH1cIiBhZnRlcjpgKTtcbiAgICAgICAgY29uc3Qgc2VsZWN0RWwgPSBuZXcgRHJvcGRvd25Db21wb25lbnQodGhpcy5jb250ZW50RWwpO1xuICAgICAgICBzZWxlY3RFbC5zZWxlY3RFbC5hZGRDbGFzcyhcIm1ldGFkYXRhLW1lbnUtZmllbGQtYWRkLXNlY3Rpb24tc2VsZWN0XCIpO1xuICAgICAgICBzZWxlY3RFbC5hZGRPcHRpb24oXCJcIiwgXCJTZWxlY3QgbGluZVwiKTtcbiAgICAgICAgc2VsZWN0RWwuYWRkT3B0aW9uKFwidG9wXzBcIiwgXCJ0b3BcIik7XG4gICAgICAgIGxldCBmb3JlSGVhZFRleHQgPSBmYWxzZTtcbiAgICAgICAgbGV0IGZyb250bWF0dGVyU3RhcnQgPSBmYWxzZTtcbiAgICAgICAgbGV0IGZyb250bWF0dGVyRW5kID0gZmFsc2U7XG4gICAgICAgIGxldCBpbkZyb250bWF0dGVyID0gZmFsc2U7XG4gICAgICAgIHJlc3VsdC5zcGxpdChcIlxcblwiKS5mb3JFYWNoKChsaW5lLCBsaW5lTnVtYmVyKSA9PiB7XG4gICAgICAgICAgICBpZiAobGluZSAhPSBcIi0tLVwiICYmICFmb3JlSGVhZFRleHQgJiYgIWZyb250bWF0dGVyU3RhcnQpIHtcbiAgICAgICAgICAgICAgICBmb3JlSGVhZFRleHQgPSB0cnVlO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGlmIChsaW5lID09IFwiLS0tXCIgJiYgIWZvcmVIZWFkVGV4dCkge1xuICAgICAgICAgICAgICAgIGlmICghZnJvbnRtYXR0ZXJTdGFydCkge1xuICAgICAgICAgICAgICAgICAgICBmcm9udG1hdHRlclN0YXJ0ID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgaW5Gcm9udG1hdHRlciA9IHRydWU7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmICghZnJvbnRtYXR0ZXJFbmQpIHtcbiAgICAgICAgICAgICAgICAgICAgZnJvbnRtYXR0ZXJFbmQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICBpbkZyb250bWF0dGVyID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChpbkZyb250bWF0dGVyKSB7XG4gICAgICAgICAgICAgICAgc2VsZWN0RWwuYWRkT3B0aW9uKGBmcm9udG1hdHRlcl8ke2xpbmVOdW1iZXJ9YCwgYCR7bGluZS5zdWJzdHJpbmcoMCwgMzApfSR7bGluZS5sZW5ndGggPiAzMCA/IFwiLi4uXCIgOiBcIlwifWApO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBzZWxlY3RFbC5hZGRPcHRpb24oYGJvZHlfJHtsaW5lTnVtYmVyfWAsIGAke2xpbmUuc3Vic3RyaW5nKDAsIDMwKX0ke2xpbmUubGVuZ3RoID4gMzAgPyBcIi4uLlwiIDogXCJcIn1gKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIH0pO1xuICAgICAgICBzZWxlY3RFbC5zZWxlY3RFbC5mb2N1cygpO1xuICAgICAgICBzZWxlY3RFbC5vbkNoYW5nZSgoKSA9PiB7XG4gICAgICAgICAgICBjb25zdCB2YWx1ZUFycmF5ID0gc2VsZWN0RWwuZ2V0VmFsdWUoKS5tYXRjaCgvKFxcdyspXyhcXGQrKS8pO1xuICAgICAgICAgICAgY29uc3QgcG9zaXRpb24gPSB2YWx1ZUFycmF5ICYmIHZhbHVlQXJyYXkubGVuZ3RoID4gMCA/IHZhbHVlQXJyYXlbMV0gOiAwO1xuICAgICAgICAgICAgY29uc3QgbGluZU51bWJlciA9IE51bWJlcih2YWx1ZUFycmF5ICYmIHZhbHVlQXJyYXkubGVuZ3RoID4gMSA/IHZhbHVlQXJyYXlbMl0gOiAwKTtcbiAgICAgICAgICAgIGNvbnN0IGluRnJvbnRtYXR0ZXIgPSBwb3NpdGlvbiA9PSBcImZyb250bWF0dGVyXCIgPyB0cnVlIDogZmFsc2U7XG4gICAgICAgICAgICBjb25zdCBhZnRlciA9IHBvc2l0aW9uID09IFwidG9wXCIgPyBmYWxzZSA6IHRydWU7XG4gICAgICAgICAgICBGLm9wZW5GaWVsZE1vZGFsKFxuICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLFxuICAgICAgICAgICAgICAgIHRoaXMuZmlsZSxcbiAgICAgICAgICAgICAgICB0aGlzLmZpZWxkTmFtZSxcbiAgICAgICAgICAgICAgICBcIlwiLFxuICAgICAgICAgICAgICAgIGxpbmVOdW1iZXIsXG4gICAgICAgICAgICAgICAgaW5Gcm9udG1hdHRlcixcbiAgICAgICAgICAgICAgICBhZnRlcixcbiAgICAgICAgICAgICAgICB0aGlzLmZpbGVDbGFzcylcbiAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgICAgfSk7XG5cblxuICAgICAgICBpZiAodGhpcy5wbHVnaW4uYXBwLm1ldGFkYXRhQ2FjaGUuZ2V0Q2FjaGUodGhpcy5maWxlLnBhdGgpPy5mcm9udG1hdHRlcikge1xuICAgICAgICAgICAgY29uc3QgYWRkVG9Gcm9udE1hdHRlckJ0biA9IG5ldyBCdXR0b25Db21wb25lbnQodGhpcy5jb250ZW50RWwpXG4gICAgICAgICAgICBhZGRUb0Zyb250TWF0dGVyQnRuLnNldENsYXNzKFwibWV0YWRhdGEtbWVudS1maWVsZC1hZGQtZnJvbnRtYXR0ZXItYnRuXCIpXG4gICAgICAgICAgICBhZGRUb0Zyb250TWF0dGVyQnRuLnNldEJ1dHRvblRleHQoXCJBZGQgdG8gZnJvbnRtYXR0ZXJcIilcbiAgICAgICAgICAgIGFkZFRvRnJvbnRNYXR0ZXJCdG4ub25DbGljaygoKSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgbGluZU51bWJlciA9IHRoaXMucGx1Z2luLmFwcC5tZXRhZGF0YUNhY2hlLmdldENhY2hlKHRoaXMuZmlsZS5wYXRoKSEuZnJvbnRtYXR0ZXIhLnBvc2l0aW9uLmVuZC5saW5lIC0gMVxuICAgICAgICAgICAgICAgIEYub3BlbkZpZWxkTW9kYWwoXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLFxuICAgICAgICAgICAgICAgICAgICB0aGlzLmZpbGUsXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZmllbGROYW1lLFxuICAgICAgICAgICAgICAgICAgICBcIlwiLFxuICAgICAgICAgICAgICAgICAgICBsaW5lTnVtYmVyLFxuICAgICAgICAgICAgICAgICAgICB0cnVlLFxuICAgICAgICAgICAgICAgICAgICBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5maWxlQ2xhc3MpXG4gICAgICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgfVxuICAgIH07XG59OyIsICJpbXBvcnQgTWV0YWRhdGFNZW51IGZyb20gXCJtYWluXCI7XG5pbXBvcnQgeyBnZXRGaWVsZCB9IGZyb20gXCJzcmMvY29tbWFuZHMvZ2V0RmllbGRcIjtcbmltcG9ydCB7IEZpbGVDbGFzcyB9IGZyb20gXCJzcmMvZmlsZUNsYXNzL2ZpbGVDbGFzc1wiO1xuaW1wb3J0IHsgRmllbGRNYW5hZ2VyIH0gZnJvbSBcInNyYy90eXBlcy9maWVsZFR5cGVzXCI7XG5pbXBvcnQgeyBGaWVsZE1hbmFnZXIgYXMgRiB9IGZyb20gXCJzcmMvZmllbGRzL0ZpZWxkTWFuYWdlclwiO1xuaW1wb3J0IGNob29zZVNlY3Rpb25Nb2RhbCBmcm9tIFwic3JjL29wdGlvbk1vZGFscy9jaG9vc2VTZWN0aW9uTW9kYWxcIjtcbmltcG9ydCB7IE5vdGljZSwgc2V0SWNvbiwgVEZpbGUgfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCBGaWxlQ2xhc3NRdWVyeSBmcm9tIFwic3JjL2ZpbGVDbGFzcy9GaWxlQ2xhc3NRdWVyeVwiO1xuXG5cbmZ1bmN0aW9uIGdldFF1ZXJ5RmlsZUNsYXNzRm9yRmllbGRzKHBsdWdpbjogTWV0YWRhdGFNZW51LCBmaWxlOiBURmlsZSk6IEZpbGVDbGFzcyB8IHVuZGVmaW5lZCB7XG4gICAgbGV0IGZpbGVDbGFzc0ZvckZpZWxkcyA9IGZhbHNlO1xuICAgIGxldCBmaWxlQ2xhc3M6IEZpbGVDbGFzcyB8IHVuZGVmaW5lZDtcbiAgICBjb25zdCBmaWxlQ2xhc3NRdWVyaWVzID0gcGx1Z2luLnNldHRpbmdzLmZpbGVDbGFzc1F1ZXJpZXMubWFwKGZjcSA9PiBmY3EpXG4gICAgd2hpbGUgKCFmaWxlQ2xhc3NGb3JGaWVsZHMgJiYgZmlsZUNsYXNzUXVlcmllcy5sZW5ndGggPiAwKSB7XG4gICAgICAgIGNvbnN0IGZpbGVDbGFzc1F1ZXJ5ID0gbmV3IEZpbGVDbGFzc1F1ZXJ5KCk7XG4gICAgICAgIE9iamVjdC5hc3NpZ24oZmlsZUNsYXNzUXVlcnksIGZpbGVDbGFzc1F1ZXJpZXMucG9wKCkgYXMgRmlsZUNsYXNzUXVlcnkpXG4gICAgICAgIGlmIChmaWxlQ2xhc3NRdWVyeS5tYXRjaEZpbGUoZmlsZSkpIHtcbiAgICAgICAgICAgIGZpbGVDbGFzc0ZvckZpZWxkcyA9IHRydWU7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIGZpbGVDbGFzcyA9IEZpbGVDbGFzcy5jcmVhdGVGaWxlQ2xhc3MocGx1Z2luLCBmaWxlQ2xhc3NRdWVyeS5maWxlQ2xhc3NOYW1lKVxuICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICBmaWxlQ2xhc3MgPSB1bmRlZmluZWRcbiAgICAgICAgICAgIH1cblxuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBmaWxlQ2xhc3Ncbn1cblxuZnVuY3Rpb24gYnVpbGRBbmRPcGVuTW9kYWwoXG4gICAgcGx1Z2luOiBNZXRhZGF0YU1lbnUsXG4gICAgZmlsZTogVEZpbGUsXG4gICAgZmllbGROYW1lOiBzdHJpbmcsXG4gICAgZmlsZUNsYXNzPzogRmlsZUNsYXNzLFxuICAgIGF0dHJzPzogeyBjbHM/OiBzdHJpbmcsIGF0dHI/OiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+LCBvcHRpb25zPzogUmVjb3JkPHN0cmluZywgc3RyaW5nPiB9XG4pOiB2b2lkIHtcbiAgICBpZiAoYXR0cnM/Lm9wdGlvbnM/LmluRnJvbnRtYXR0ZXIgJiYgcGx1Z2luLmFwcC5tZXRhZGF0YUNhY2hlLmdldENhY2hlKGZpbGUucGF0aCk/LmZyb250bWF0dGVyKSB7XG4gICAgICAgIGNvbnN0IGxpbmVOdW1iZXIgPSBwbHVnaW4uYXBwLm1ldGFkYXRhQ2FjaGUuZ2V0Q2FjaGUoZmlsZS5wYXRoKSEuZnJvbnRtYXR0ZXIhLnBvc2l0aW9uLmVuZC5saW5lIC0gMVxuICAgICAgICBGLm9wZW5GaWVsZE1vZGFsKHBsdWdpbiwgZmlsZSwgZmllbGROYW1lLCBcIlwiLCBsaW5lTnVtYmVyLCB0cnVlLCBmYWxzZSwgZmlsZUNsYXNzKVxuICAgIH0gZWxzZSB7XG4gICAgICAgIG5ldyBjaG9vc2VTZWN0aW9uTW9kYWwocGx1Z2luLCBmaWxlLCBmaWxlQ2xhc3MsIGZpZWxkTmFtZSkub3BlbigpO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gY3JlYXRlRHZGaWVsZChwbHVnaW46IE1ldGFkYXRhTWVudSxcbiAgICBkdjogYW55LFxuICAgIHA6IGFueSxcbiAgICBmaWVsZENvbnRhaW5lcjogSFRNTEVsZW1lbnQsXG4gICAgZmllbGROYW1lOiBzdHJpbmcsXG4gICAgZmlsZUNsYXNzPzogRmlsZUNsYXNzLFxuICAgIGF0dHJzPzogeyBjbHM/OiBzdHJpbmcsIGF0dHI/OiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+LCBvcHRpb25zPzogUmVjb3JkPHN0cmluZywgc3RyaW5nPiB9XG4pOiB2b2lkIHtcbiAgICBjb25zdCBmaWVsZCA9IGdldEZpZWxkKHBsdWdpbiwgZmllbGROYW1lLCBmaWxlQ2xhc3MpO1xuICAgIGlmIChmaWVsZD8udHlwZSkge1xuICAgICAgICBjb25zdCBmaWVsZE1hbmFnZXIgPSBuZXcgRmllbGRNYW5hZ2VyW2ZpZWxkLnR5cGVdKHBsdWdpbiwgZmllbGQpO1xuICAgICAgICBmaWVsZE1hbmFnZXIuY3JlYXRlRHZGaWVsZChkdiwgcCwgZmllbGRDb250YWluZXIsIGF0dHJzKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICBjb25zdCBmaWVsZE1hbmFnZXIgPSBGLmNyZWF0ZURlZmF1bHQocGx1Z2luLCBmaWVsZE5hbWUpO1xuICAgICAgICBmaWVsZE1hbmFnZXIuY3JlYXRlRHZGaWVsZChkdiwgcCwgZmllbGRDb250YWluZXIsIGF0dHJzKTtcbiAgICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBmaWVsZE1vZGlmaWVyKFxuICAgIHBsdWdpbjogTWV0YWRhdGFNZW51LFxuICAgIGR2OiBhbnksXG4gICAgcDogYW55LFxuICAgIGZpZWxkTmFtZTogc3RyaW5nLFxuICAgIGF0dHJzPzogeyBjbHM/OiBzdHJpbmcsIGF0dHI/OiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+LCBvcHRpb25zPzogUmVjb3JkPHN0cmluZywgc3RyaW5nPiB9XG4pOiBIVE1MRWxlbWVudCB7XG5cbiAgICAvKiBmaWVsZENvbnRhaW5lciovXG4gICAgY29uc3QgZmllbGRDb250YWluZXI6IEhUTUxFbGVtZW50ID0gZHYuZWwoXCJkaXZcIiwgXCJcIilcbiAgICBmaWVsZENvbnRhaW5lci5zZXRBdHRyKFwiY2xhc3NcIiwgXCJtZXRhZGF0YS1tZW51LWR2LWZpZWxkLWNvbnRhaW5lclwiKVxuXG4gICAgLyogY3JlYXRlIGZpZWxkTW9kaWZpZXIgZGVwZW5kaW5nIG9uIGZpbGVDbGFzcyB0eXBlIG9yIHByZXNldCB2YWx1ZSovXG5cbiAgICBpZiAocFtmaWVsZE5hbWVdID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgaWYgKCFhdHRycz8ub3B0aW9ucz8uc2hvd0FkZEZpZWxkKSB7XG4gICAgICAgICAgICBjb25zdCBlbXB0eUZpZWxkID0gZHYuZWwoXCJzcGFuXCIsIG51bGwsIGF0dHJzKTtcbiAgICAgICAgICAgIGZpZWxkQ29udGFpbmVyLmFwcGVuZENoaWxkKGVtcHR5RmllbGQpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29uc3QgYWRkRmllbGRCdG4gPSBkdi5lbChcImJ1dHRvblwiLCBhdHRycyk7XG4gICAgICAgICAgICBzZXRJY29uKGFkZEZpZWxkQnRuLCBcInBsdXMtd2l0aC1jaXJjbGVcIilcbiAgICAgICAgICAgIGFkZEZpZWxkQnRuLmFkZENsYXNzKFwibWV0YWRhdGEtbWVudS1kdi1maWVsZC1idXR0b25cIik7XG4gICAgICAgICAgICBhZGRGaWVsZEJ0bi5hZGRDbGFzcyhcImlzb2xhdGVkXCIpO1xuICAgICAgICAgICAgYWRkRmllbGRCdG4ub25jbGljayA9IGFzeW5jICgpID0+IHtcblxuICAgICAgICAgICAgICAgIGNvbnN0IGZpbGUgPSBwbHVnaW4uYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChwLmZpbGUucGF0aClcbiAgICAgICAgICAgICAgICBpZiAoZmlsZSBpbnN0YW5jZW9mIFRGaWxlICYmIGZpbGUuZXh0ZW5zaW9uID09IFwibWRcIikge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBmaWxlQ2xhc3NBbGlhcyA9IHBsdWdpbi5zZXR0aW5ncy5maWxlQ2xhc3NBbGlhcztcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgcXVlcnlGaWxlQ2xhc3MgPSBnZXRRdWVyeUZpbGVDbGFzc0ZvckZpZWxkcyhwbHVnaW4sIGZpbGUpXG4gICAgICAgICAgICAgICAgICAgIGlmIChwW2ZpbGVDbGFzc0FsaWFzXSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZmlsZUNsYXNzTmFtZSA9IHBbZmlsZUNsYXNzQWxpYXNdIGFzIHN0cmluZ1xuICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBmaWxlQ2xhc3MgPSBGaWxlQ2xhc3MuY3JlYXRlRmlsZUNsYXNzKHBsdWdpbiwgZmlsZUNsYXNzTmFtZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnVpbGRBbmRPcGVuTW9kYWwocGx1Z2luLCBmaWxlLCBmaWVsZE5hbWUsIGZpbGVDbGFzcywgYXR0cnMpXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAocXVlcnlGaWxlQ2xhc3MpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJ1aWxkQW5kT3Blbk1vZGFsKHBsdWdpbiwgZmlsZSwgZmllbGROYW1lLCBxdWVyeUZpbGVDbGFzcywgYXR0cnMpXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAocGx1Z2luLnNldHRpbmdzLmdsb2JhbEZpbGVDbGFzcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZmlsZUNsYXNzTmFtZSA9IHBsdWdpbi5zZXR0aW5ncy5nbG9iYWxGaWxlQ2xhc3NcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZmlsZUNsYXNzID0gRmlsZUNsYXNzLmNyZWF0ZUZpbGVDbGFzcyhwbHVnaW4sIGZpbGVDbGFzc05hbWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJ1aWxkQW5kT3Blbk1vZGFsKHBsdWdpbiwgZmlsZSwgZmllbGROYW1lLCBmaWxlQ2xhc3MsIGF0dHJzKVxuICAgICAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHBsdWdpbi5zZXR0aW5ncy5wcmVzZXRGaWVsZHMuZmlsdGVyKGF0dHIgPT4gYXR0ci5uYW1lID09IGZpZWxkTmFtZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGZpZWxkID0gZ2V0RmllbGQocGx1Z2luLCBmaWVsZE5hbWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGZpZWxkPy50eXBlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnVpbGRBbmRPcGVuTW9kYWwocGx1Z2luLCBmaWxlLCBmaWVsZE5hbWUsIHVuZGVmaW5lZCwgYXR0cnMpXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBjaG9vc2VTZWN0aW9uTW9kYWwocGx1Z2luLCBmaWxlLCB1bmRlZmluZWQpLm9wZW4oKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBjaG9vc2VTZWN0aW9uTW9kYWwocGx1Z2luLCBmaWxlLCB1bmRlZmluZWQpLm9wZW4oKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRocm93IEVycm9yKFwicGF0aCBkb2Vzbid0IGNvcnJlc3BvbmQgdG8gYSBwcm9wZXIgZmlsZVwiKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGZpZWxkQ29udGFpbmVyLmFwcGVuZENoaWxkKGFkZEZpZWxkQnRuKTtcbiAgICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbnN0IGZpbGVDbGFzc0FsaWFzID0gcGx1Z2luLnNldHRpbmdzLmZpbGVDbGFzc0FsaWFzO1xuICAgICAgICBjb25zdCBmaWxlID0gcGx1Z2luLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgocC5maWxlLnBhdGgpXG4gICAgICAgIGlmIChmaWxlIGluc3RhbmNlb2YgVEZpbGUgJiYgZmlsZS5leHRlbnNpb24gPT0gXCJtZFwiKSB7XG4gICAgICAgICAgICBjb25zdCBxdWVyeUZpbGVDbGFzcyA9IGdldFF1ZXJ5RmlsZUNsYXNzRm9yRmllbGRzKHBsdWdpbiwgZmlsZSlcbiAgICAgICAgICAgIGlmIChwW2ZpbGVDbGFzc0FsaWFzXSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGZpbGVDbGFzc05hbWUgPSBwW2ZpbGVDbGFzc0FsaWFzXSB8fCBwbHVnaW4uc2V0dGluZ3MuZ2xvYmFsRmlsZUNsYXNzIC8vIGlubmVyIGZpbGVDbGFzcyBoYXMgdGhlIHByaW9yaXR5IG92ZXIgZ2xvYmFsIGZpbGVDbGFzc1xuICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGZpbGVDbGFzcyA9IEZpbGVDbGFzcy5jcmVhdGVGaWxlQ2xhc3MocGx1Z2luLCBmaWxlQ2xhc3NOYW1lKTtcbiAgICAgICAgICAgICAgICAgICAgY3JlYXRlRHZGaWVsZChwbHVnaW4sIGR2LCBwLCBmaWVsZENvbnRhaW5lciwgZmllbGROYW1lLCBmaWxlQ2xhc3MsIGF0dHJzKVxuICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG5cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHF1ZXJ5RmlsZUNsYXNzKSB7XG4gICAgICAgICAgICAgICAgY3JlYXRlRHZGaWVsZChwbHVnaW4sIGR2LCBwLCBmaWVsZENvbnRhaW5lciwgZmllbGROYW1lLCBxdWVyeUZpbGVDbGFzcywgYXR0cnMpXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHBsdWdpbi5zZXR0aW5ncy5nbG9iYWxGaWxlQ2xhc3MpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBmaWxlQ2xhc3NOYW1lID0gcGx1Z2luLnNldHRpbmdzLmdsb2JhbEZpbGVDbGFzcyAvLyBpbm5lciBmaWxlQ2xhc3MgaGFzIHRoZSBwcmlvcml0eSBvdmVyIGdsb2JhbCBmaWxlQ2xhc3NcbiAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBmaWxlQ2xhc3MgPSBGaWxlQ2xhc3MuY3JlYXRlRmlsZUNsYXNzKHBsdWdpbiwgZmlsZUNsYXNzTmFtZSk7XG4gICAgICAgICAgICAgICAgICAgIGNyZWF0ZUR2RmllbGQocGx1Z2luLCBkdiwgcCwgZmllbGRDb250YWluZXIsIGZpZWxkTmFtZSwgZmlsZUNsYXNzLCBhdHRycylcbiAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnJvcikgeyB9XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHBsdWdpbi5zZXR0aW5ncy5wcmVzZXRGaWVsZHMuZmlsdGVyKGF0dHIgPT4gYXR0ci5uYW1lID09IGZpZWxkTmFtZSkpIHtcbiAgICAgICAgICAgICAgICBjcmVhdGVEdkZpZWxkKHBsdWdpbiwgZHYsIHAsIGZpZWxkQ29udGFpbmVyLCBmaWVsZE5hbWUsIHVuZGVmaW5lZCwgYXR0cnMpXG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGNvbnN0IGZpZWxkTWFuYWdlciA9IEYuY3JlYXRlRGVmYXVsdChwbHVnaW4sIGZpZWxkTmFtZSk7XG4gICAgICAgICAgICAgICAgZmllbGRNYW5hZ2VyLmNyZWF0ZUR2RmllbGQoZHYsIHAsIGZpZWxkQ29udGFpbmVyLCBhdHRycyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGZpZWxkQ29udGFpbmVyXG59OyAiLCAiaW1wb3J0IE1ldGFkYXRhTWVudSBmcm9tIFwibWFpblwiO1xuaW1wb3J0IHsgVEZpbGUgfSBmcm9tIFwib2JzaWRpYW5cIlxuaW1wb3J0IHsgRmlsZUNsYXNzIH0gZnJvbSBcInNyYy9maWxlQ2xhc3MvZmlsZUNsYXNzXCI7XG5pbXBvcnQgRmlsZUNsYXNzUXVlcnkgZnJvbSBcInNyYy9maWxlQ2xhc3MvRmlsZUNsYXNzUXVlcnlcIjtcbmltcG9ydCB7IEZpZWxkTWFuYWdlciwgRmllbGRUeXBlIH0gZnJvbSBcInNyYy90eXBlcy9maWVsZFR5cGVzXCI7XG5pbXBvcnQgeyBnZW51aW5lS2V5cyB9IGZyb20gXCJzcmMvdXRpbHMvZGF0YXZpZXdVdGlsc1wiO1xuaW1wb3J0IHsgZ2V0RmllbGQgfSBmcm9tIFwiLi9nZXRGaWVsZFwiO1xuXG5leHBvcnQgY2xhc3MgRmllbGRJbmZvIHtcbiAgICBwcm90ZWN0ZWQgdHlwZT86IEZpZWxkVHlwZSA9IHVuZGVmaW5lZDtcbiAgICBwcm90ZWN0ZWQgc291cmNlVHlwZT86IFwiZmlsZUNsYXNzXCIgfCBcInNldHRpbmdzXCIgPSB1bmRlZmluZWQ7XG4gICAgcHJvdGVjdGVkIGZpbGVDbGFzcz86IHN0cmluZyA9IHVuZGVmaW5lZDtcbiAgICBwcm90ZWN0ZWQgZmlsZUNsYXNzUXVlcnk/OiBzdHJpbmcgPSB1bmRlZmluZWQ7XG4gICAgcHJvdGVjdGVkIG9wdGlvbnM/OiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+IHwgc3RyaW5nW10gPSB1bmRlZmluZWQ7XG4gICAgcHJvdGVjdGVkIGlzVmFsaWQ/OiBib29sZWFuID0gdW5kZWZpbmVkO1xuICAgIHByb3RlY3RlZCBpZ25vcmVJbk1lbnU6IGJvb2xlYW5cbiAgICBwcm90ZWN0ZWQgdmFsdWU6IHN0cmluZyA9IFwiXCI7XG4gICAgcHJvdGVjdGVkIHZhbHVlc0xpc3ROb3RlUGF0aD86IHN0cmluZyA9IHVuZGVmaW5lZDtcbiAgICBwdWJsaWMgdW5pcXVlOiBib29sZWFuID0gdHJ1ZVxuXG4gICAgcHVibGljIHNldEluZm9zKFxuICAgICAgICBwbHVnaW46IE1ldGFkYXRhTWVudSxcbiAgICAgICAgZmllbGROYW1lOiBzdHJpbmcsXG4gICAgICAgIHZhbHVlOiBzdHJpbmcsXG4gICAgICAgIGZpbGVDbGFzcz86IEZpbGVDbGFzcyxcbiAgICAgICAgbWF0Y2hpbmdGaWxlQ2xhc3NRdWVyeT86IHN0cmluZyB8IHVuZGVmaW5lZFxuICAgICk6IHZvaWQge1xuICAgICAgICB0aGlzLnZhbHVlID0gdmFsdWU7XG4gICAgICAgIHRoaXMuaWdub3JlSW5NZW51ID0gcGx1Z2luLnNldHRpbmdzLmdsb2JhbGx5SWdub3JlZEZpZWxkcy5pbmNsdWRlcyhmaWVsZE5hbWUpO1xuICAgICAgICBpZiAoZmlsZUNsYXNzKSB7XG4gICAgICAgICAgICBjb25zdCBmaWxlQ2xhc3NGaWVsZHMgPSBmaWxlQ2xhc3MuYXR0cmlidXRlcy5tYXAoYXR0ciA9PiBhdHRyLm5hbWUpO1xuICAgICAgICAgICAgaWYgKGZpbGVDbGFzc0ZpZWxkcy5pbmNsdWRlcyhmaWVsZE5hbWUpKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgZmllbGQgPSBnZXRGaWVsZChwbHVnaW4sIGZpZWxkTmFtZSwgZmlsZUNsYXNzKTtcbiAgICAgICAgICAgICAgICBpZiAoZmllbGQpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZmllbGRNYW5hZ2VyID0gbmV3IEZpZWxkTWFuYWdlcltmaWVsZC50eXBlXShwbHVnaW4sIGZpZWxkKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5pc1ZhbGlkID0gZmllbGRNYW5hZ2VyLnZhbGlkYXRlVmFsdWUodmFsdWUpXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGF0dHJpYnV0ZSA9IGZpbGVDbGFzcy5hdHRyaWJ1dGVzLmZpbHRlcihhID0+IGEubmFtZSA9PT0gZmllbGROYW1lKVswXTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5maWxlQ2xhc3MgPSBhdHRyaWJ1dGUub3JpZ2luO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmZpbGVDbGFzc1F1ZXJ5ID0gbWF0Y2hpbmdGaWxlQ2xhc3NRdWVyeTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy50eXBlID0gYXR0cmlidXRlLnR5cGU7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMub3B0aW9ucyA9IGF0dHJpYnV0ZS5vcHRpb25zO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIGlmIChwbHVnaW4uc2V0dGluZ3MucHJlc2V0RmllbGRzLm1hcChmID0+IGYubmFtZSkuaW5jbHVkZXMoZmllbGROYW1lKSkge1xuICAgICAgICAgICAgY29uc3QgZmllbGQgPSBnZXRGaWVsZChwbHVnaW4sIGZpZWxkTmFtZSk7XG4gICAgICAgICAgICBpZiAoZmllbGQpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBmaWVsZE1hbmFnZXIgPSBuZXcgRmllbGRNYW5hZ2VyW2ZpZWxkLnR5cGVdKHBsdWdpbiwgZmllbGQpO1xuICAgICAgICAgICAgICAgIHRoaXMuaXNWYWxpZCA9IGZpZWxkTWFuYWdlci52YWxpZGF0ZVZhbHVlKHZhbHVlKVxuICAgICAgICAgICAgICAgIHRoaXMudHlwZSA9IGZpZWxkLnR5cGU7XG4gICAgICAgICAgICAgICAgdGhpcy5vcHRpb25zID0gZmllbGQub3B0aW9ucztcbiAgICAgICAgICAgICAgICB0aGlzLnNvdXJjZVR5cGUgPSBcInNldHRpbmdzXCI7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBmaWxlRmllbGRzKHBsdWdpbjogTWV0YWRhdGFNZW51LCBmaWxlT3JmaWxlUGF0aDogVEZpbGUgfCBzdHJpbmcpOiBSZWNvcmQ8c3RyaW5nLCBGaWVsZEluZm8+IHtcbiAgICAvKlxuICAgIHJldHVybnMgYWxsIGZpZWxkcyB3aXRoIHNvdXJjZSwgdHlwZSwgb3B0aW9ucywgaXNWYWxpZCwgaWdub3JlZFxuICAgICovXG4gICAgbGV0IGZpbGU6IFRGaWxlO1xuICAgIGlmIChmaWxlT3JmaWxlUGF0aCBpbnN0YW5jZW9mIFRGaWxlKSB7XG4gICAgICAgIGZpbGUgPSBmaWxlT3JmaWxlUGF0aDtcbiAgICB9IGVsc2Uge1xuICAgICAgICBjb25zdCBfZmlsZSA9IHBsdWdpbi5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKGZpbGVPcmZpbGVQYXRoKVxuICAgICAgICBpZiAoX2ZpbGUgaW5zdGFuY2VvZiBURmlsZSAmJiBfZmlsZS5leHRlbnNpb24gPT0gXCJtZFwiKSB7XG4gICAgICAgICAgICBmaWxlID0gX2ZpbGU7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aHJvdyBFcnJvcihcInBhdGggZG9lc24ndCBjb3JyZXNwb25kIHRvIGEgcHJvcGVyIGZpbGVcIik7XG4gICAgICAgIH1cbiAgICB9XG4gICAgY29uc3QgZnJvbnRtYXR0ZXIgPSBwbHVnaW4uYXBwLm1ldGFkYXRhQ2FjaGUuZ2V0Q2FjaGUoZmlsZS5wYXRoKT8uZnJvbnRtYXR0ZXI7XG4gICAgY29uc3QgZmllbGRzOiBSZWNvcmQ8c3RyaW5nLCBGaWVsZEluZm8+ID0ge31cbiAgICBsZXQgZmlsZUNsYXNzOiBGaWxlQ2xhc3MgfCB1bmRlZmluZWQ7XG4gICAgaWYgKHBsdWdpbi5zZXR0aW5ncy5nbG9iYWxGaWxlQ2xhc3MpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGZpbGVDbGFzcyA9IEZpbGVDbGFzcy5jcmVhdGVGaWxlQ2xhc3MocGx1Z2luLCBwbHVnaW4uc2V0dGluZ3MuZ2xvYmFsRmlsZUNsYXNzKVxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgZmlsZUNsYXNzID0gdW5kZWZpbmVkO1xuICAgICAgICB9XG4gICAgfVxuICAgIGNvbnN0IGZpbGVDbGFzc1F1ZXJpZXMgPSBwbHVnaW4uc2V0dGluZ3MuZmlsZUNsYXNzUXVlcmllcztcbiAgICBsZXQgbWF0Y2hpbmdGaWxlQ2xhc3NRdWVyeTogc3RyaW5nIHwgdW5kZWZpbmVkID0gdW5kZWZpbmVkO1xuICAgIGlmIChmaWxlQ2xhc3NRdWVyaWVzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgd2hpbGUgKCFtYXRjaGluZ0ZpbGVDbGFzc1F1ZXJ5ICYmIGZpbGVDbGFzc1F1ZXJpZXMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgY29uc3QgZmlsZUNsYXNzUXVlcnkgPSBuZXcgRmlsZUNsYXNzUXVlcnkoKTtcbiAgICAgICAgICAgIE9iamVjdC5hc3NpZ24oZmlsZUNsYXNzUXVlcnksIGZpbGVDbGFzc1F1ZXJpZXMucG9wKCkgYXMgRmlsZUNsYXNzUXVlcnkpXG4gICAgICAgICAgICBpZiAoZmlsZUNsYXNzUXVlcnkubWF0Y2hGaWxlKGZpbGUpKSB7XG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgZmlsZUNsYXNzID0gRmlsZUNsYXNzLmNyZWF0ZUZpbGVDbGFzcyhwbHVnaW4sIGZpbGVDbGFzc1F1ZXJ5LmZpbGVDbGFzc05hbWUpO1xuICAgICAgICAgICAgICAgICAgICBtYXRjaGluZ0ZpbGVDbGFzc1F1ZXJ5ID0gZmlsZUNsYXNzUXVlcnkubmFtZTtcbiAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICBtYXRjaGluZ0ZpbGVDbGFzc1F1ZXJ5ID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBpZiAoZnJvbnRtYXR0ZXIpIHtcbiAgICAgICAgY29uc3QgeyBwb3NpdGlvbiwgLi4uYXR0cmlidXRlcyB9ID0gZnJvbnRtYXR0ZXI7XG4gICAgICAgIC8vIGNoZWNrIGlmIHRoZXJlJ3MgYSBmaWxlQ2xhc3NcbiAgICAgICAgY29uc3QgZmlsZUNsYXNzQWxpYXMgPSBwbHVnaW4uc2V0dGluZ3MuZmlsZUNsYXNzQWxpYXM7XG4gICAgICAgIGlmIChPYmplY3Qua2V5cyhhdHRyaWJ1dGVzKS5pbmNsdWRlcyhmaWxlQ2xhc3NBbGlhcykpIHtcbiAgICAgICAgICAgIGNvbnN0IGZpbGVDbGFzc05hbWUgPSBhdHRyaWJ1dGVzW2ZpbGVDbGFzc0FsaWFzXTtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgZmlsZUNsYXNzID0gRmlsZUNsYXNzLmNyZWF0ZUZpbGVDbGFzcyhwbHVnaW4sIGZpbGVDbGFzc05hbWUpO1xuICAgICAgICAgICAgICAgIG1hdGNoaW5nRmlsZUNsYXNzUXVlcnkgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgIGZpbGVDbGFzcyA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICAvLyB0aGVuIGV4cGxvcmUgZnJvbnRtYXR0ZXIgZmllbGRzIGFrYSBhdHRyaWJ1dGVzXG4gICAgICAgIE9iamVjdC5rZXlzKGF0dHJpYnV0ZXMpLmZvckVhY2goYXN5bmMga2V5ID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGZpZWxkSW5mbyA9IG5ldyBGaWVsZEluZm87XG4gICAgICAgICAgICBmaWVsZEluZm8udW5pcXVlID0gIU9iamVjdC5rZXlzKGZpZWxkcykuaW5jbHVkZXMoa2V5KTtcbiAgICAgICAgICAgIGZpZWxkc1trZXldID0gZmllbGRJbmZvO1xuICAgICAgICAgICAgYXdhaXQgZmllbGRJbmZvLnNldEluZm9zKHBsdWdpbiwga2V5LCBhdHRyaWJ1dGVzW2tleV0sIGZpbGVDbGFzcyk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICAvLyBsZXQncyBleHBsb3JlIHRoZSByZXN0IG9mIHRoZSBmaWxlOiBnZXQgaW5saW5lIGZpZWxkc1xuXG4gICAgY29uc3QgZGF0YXZpZXcgPSBwbHVnaW4uYXBwLnBsdWdpbnMucGx1Z2lucy5kYXRhdmlld1xuICAgIC8vQHRzLWlnbm9yZVxuICAgIGlmIChkYXRhdmlldykge1xuICAgICAgICBjb25zdCBkdkZpbGUgPSBkYXRhdmlldy5hcGkucGFnZShmaWxlLnBhdGgpXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBnZW51aW5lS2V5cyhkdkZpbGUpLmZvckVhY2goYXN5bmMga2V5ID0+IHtcbiAgICAgICAgICAgICAgICBpZiAoa2V5ICE9PSBcImZpbGVcIikge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBmaWVsZEluZm8gPSBuZXcgRmllbGRJbmZvO1xuICAgICAgICAgICAgICAgICAgICBmaWVsZEluZm8udW5pcXVlID0gIU9iamVjdC5rZXlzKGZpZWxkcykuaW5jbHVkZXMoa2V5KTtcbiAgICAgICAgICAgICAgICAgICAgZmllbGRzW2tleV0gPSBmaWVsZEluZm87XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IGZpZWxkSW5mby5zZXRJbmZvcyhwbHVnaW4sIGtleSwgZHZGaWxlW2tleV0sIGZpbGVDbGFzcywgbWF0Y2hpbmdGaWxlQ2xhc3NRdWVyeSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSlcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIHRocm93IChlcnJvcik7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gZmllbGRzO1xufSIsICJpbXBvcnQgeyBURmlsZSB9IGZyb20gXCJvYnNpZGlhblwiXG5pbXBvcnQgTWV0YWRhdGFNZW51IGZyb20gXCJtYWluXCJcbmltcG9ydCB7IGdldFZhbHVlcyB9IGZyb20gXCIuL2NvbW1hbmRzL2dldFZhbHVlc1wiO1xuaW1wb3J0IHsgcmVwbGFjZVZhbHVlcyB9IGZyb20gXCIuL2NvbW1hbmRzL3JlcGxhY2VWYWx1ZXNcIjtcbmltcG9ydCB7IGluc2VydFZhbHVlcyB9IGZyb20gXCIuL2NvbW1hbmRzL2luc2VydFZhbHVlc1wiO1xuaW1wb3J0IHsgZmllbGRNb2RpZmllciB9IGZyb20gXCIuL2NvbW1hbmRzL2ZpZWxkTW9kaWZpZXJcIjtcbmltcG9ydCB7IGZpbGVGaWVsZHMsIEZpZWxkSW5mbyB9IGZyb20gXCIuL2NvbW1hbmRzL2ZpbGVGaWVsZHNcIjtcblxuZXhwb3J0IGludGVyZmFjZSBJTWV0YWRhdGFNZW51QXBpIHtcbiAgICBnZXRWYWx1ZXM6IChmaWxlT3JGaWxlUGF0aDogVEZpbGUgfCBzdHJpbmcsIGF0dHJpYnV0ZTogc3RyaW5nKSA9PiBQcm9taXNlPHN0cmluZ1tdPjtcbiAgICByZXBsYWNlVmFsdWVzOiAoZmlsZU9yRmlsZVBhdGg6IFRGaWxlIHwgc3RyaW5nLCBhdHRyaWJ1dGU6IHN0cmluZywgaW5wdXQ6IHN0cmluZykgPT4gUHJvbWlzZTx2b2lkPjtcbiAgICBpbnNlcnRWYWx1ZXM6IChmaWxlT3JGaWxlUGF0aDogVEZpbGUgfCBzdHJpbmcsIGZpZWxkTmFtZTogc3RyaW5nLCB2YWx1ZTogc3RyaW5nLCBsaW5lTnVtYmVyPzogbnVtYmVyLCBpbkZyb250bWF0dGVyPzogYm9vbGVhbiwgYWZ0ZXI/OiBib29sZWFuKSA9PiBQcm9taXNlPHZvaWQ+XG4gICAgZmlsZUZpZWxkczogKGZpbGVPckZpbGVQYXRoOiBURmlsZSB8IHN0cmluZykgPT4gUHJvbWlzZTxSZWNvcmQ8c3RyaW5nLCBGaWVsZEluZm8+PjtcbiAgICBmaWVsZE1vZGlmaWVyOiAoZHY6IGFueSwgcDogYW55LCBmaWVsZE5hbWU6IHN0cmluZywgYXR0cnM/OiB7IGNscz86IHN0cmluZywgYXR0cj86IFJlY29yZDxzdHJpbmcsIHN0cmluZz4sIG9wdGlvbnM/OiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+IH0pID0+IEhUTUxFbGVtZW50O1xufVxuXG5leHBvcnQgY2xhc3MgTWV0YWRhdGFNZW51QXBpIHtcblxuICAgIGNvbnN0cnVjdG9yKHByaXZhdGUgcGx1Z2luOiBNZXRhZGF0YU1lbnUpIHsgfVxuXG4gICAgcHVibGljIG1ha2UoKTogSU1ldGFkYXRhTWVudUFwaSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBnZXRWYWx1ZXM6IHRoaXMuZ2V0VmFsdWVzKCksXG4gICAgICAgICAgICByZXBsYWNlVmFsdWVzOiB0aGlzLnJlcGxhY2VWYWx1ZXMoKSxcbiAgICAgICAgICAgIGluc2VydFZhbHVlczogdGhpcy5pbnNlcnRWYWx1ZXMoKSxcbiAgICAgICAgICAgIGZpZWxkTW9kaWZpZXI6IHRoaXMuZmllbGRNb2RpZmllcigpLFxuICAgICAgICAgICAgZmlsZUZpZWxkczogdGhpcy5maWxlRmllbGRzKCksXG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBnZXRWYWx1ZXMoKTogKGZpbGVPckZpbGVQYXRoOiBURmlsZSB8IHN0cmluZywgYXR0cmlidXRlOiBzdHJpbmcpID0+IFByb21pc2U8c3RyaW5nW10+IHtcbiAgICAgICAgcmV0dXJuIGFzeW5jIChmaWxlT3JGaWxlUGF0aDogVEZpbGUgfCBzdHJpbmcsIGF0dHJpYnV0ZTogc3RyaW5nKSA9PiBnZXRWYWx1ZXModGhpcy5wbHVnaW4sIGZpbGVPckZpbGVQYXRoLCBhdHRyaWJ1dGUpXG4gICAgfVxuXG4gICAgcHJpdmF0ZSByZXBsYWNlVmFsdWVzKCk6IChmaWxlT3JGaWxlUGF0aDogVEZpbGUgfCBzdHJpbmcsIGF0dHJpYnV0ZTogc3RyaW5nLCBpbnB1dDogc3RyaW5nKSA9PiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgcmV0dXJuIGFzeW5jIChmaWxlT3JGaWxlUGF0aDogVEZpbGUgfCBzdHJpbmcsIGF0dHJpYnV0ZTogc3RyaW5nLCBpbnB1dDogc3RyaW5nKSA9PiBhd2FpdCB0aGlzLnBsdWdpbi5maWxlVGFza01hbmFnZXIucHVzaFRhc2soKCkgPT4geyByZXBsYWNlVmFsdWVzKHRoaXMucGx1Z2luLCBmaWxlT3JGaWxlUGF0aCwgYXR0cmlidXRlLCBpbnB1dCkgfSlcbiAgICB9XG5cbiAgICBwcml2YXRlIGluc2VydFZhbHVlcygpOiAoZmlsZU9yRmlsZVBhdGg6IFRGaWxlIHwgc3RyaW5nLCBmaWVsZE5hbWU6IHN0cmluZywgdmFsdWU6IHN0cmluZywgbGluZU51bWJlcj86IG51bWJlciwgaW5Gcm9udG1hdHRlcj86IGJvb2xlYW4sIGFmdGVyPzogYm9vbGVhbikgPT4gUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIHJldHVybiBhc3luYyAoZmlsZU9yRmlsZVBhdGg6IFRGaWxlIHwgc3RyaW5nLCBmaWVsZE5hbWU6IHN0cmluZywgdmFsdWU6IHN0cmluZywgbGluZU51bWJlcj86IG51bWJlciwgaW5Gcm9udG1hdHRlcj86IGJvb2xlYW4sIGFmdGVyPzogYm9vbGVhbikgPT4gYXdhaXQgdGhpcy5wbHVnaW4uZmlsZVRhc2tNYW5hZ2VyLnB1c2hUYXNrKCgpID0+IHsgaW5zZXJ0VmFsdWVzKHRoaXMucGx1Z2luLCBmaWxlT3JGaWxlUGF0aCwgZmllbGROYW1lLCB2YWx1ZSwgbGluZU51bWJlciwgaW5Gcm9udG1hdHRlciwgYWZ0ZXIpIH0pXG4gICAgfVxuXG4gICAgcHJpdmF0ZSBmaWVsZE1vZGlmaWVyKCk6IChkdjogYW55LCBwOiBhbnksIGZpZWxkTmFtZTogc3RyaW5nLCBhdHRycz86IHsgY2xzPzogc3RyaW5nLCBhdHRyPzogUmVjb3JkPHN0cmluZywgc3RyaW5nPiwgb3B0aW9ucz86IFJlY29yZDxzdHJpbmcsIHN0cmluZz4gfSkgPT4gSFRNTEVsZW1lbnQge1xuICAgICAgICByZXR1cm4gKGR2OiBhbnksIHA6IGFueSwgZmllbGROYW1lOiBzdHJpbmcsIGF0dHJzPzogeyBjbHM/OiBzdHJpbmcsIGF0dHI/OiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+LCBvcHRpb25zPzogUmVjb3JkPHN0cmluZywgc3RyaW5nPiB9KSA9PiBmaWVsZE1vZGlmaWVyKHRoaXMucGx1Z2luLCBkdiwgcCwgZmllbGROYW1lLCBhdHRycylcbiAgICB9XG5cbiAgICBwcml2YXRlIGZpbGVGaWVsZHMoKTogKGZpbGVPckZpbGVQYXRoOiBURmlsZSB8IHN0cmluZykgPT4gUHJvbWlzZTxSZWNvcmQ8c3RyaW5nLCBGaWVsZEluZm8+PiB7XG4gICAgICAgIHJldHVybiBhc3luYyAoZmlsZU9yRmlsZVBhdGg6IFRGaWxlIHwgc3RyaW5nKSA9PiBmaWxlRmllbGRzKHRoaXMucGx1Z2luLCBmaWxlT3JGaWxlUGF0aClcbiAgICB9XG59IiwgImltcG9ydCB7IEZ1enp5TWF0Y2gsIEZ1enp5U3VnZ2VzdE1vZGFsLCBzZXRJY29uIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5cbmludGVyZmFjZSBPcHRpb24ge1xuICAgIGlkOiBzdHJpbmcsXG4gICAgYWN0aW9uTGFiZWw6IHN0cmluZyxcbiAgICBhY3Rpb246IGFueSxcbiAgICBpY29uPzogc3RyaW5nXG59XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEZpZWxkQ29tbWFuZFN1Z2dlc3RNb2RhbCBleHRlbmRzIEZ1enp5U3VnZ2VzdE1vZGFsPE9wdGlvbj4ge1xuICAgIHB1YmxpYyBvcHRpb25zOiBPcHRpb25bXSA9IFtdXG5cbiAgICBnZXRJdGVtcygpOiBPcHRpb25bXSB7XG4gICAgICAgIHJldHVybiB0aGlzLm9wdGlvbnNcbiAgICB9XG5cbiAgICBnZXRJdGVtVGV4dChpdGVtOiBPcHRpb24pOiBzdHJpbmcge1xuICAgICAgICByZXR1cm4gaXRlbS5hY3Rpb25MYWJlbFxuICAgIH1cblxuICAgIG9uQ2hvb3NlSXRlbShpdGVtOiBPcHRpb24sIGV2dDogTW91c2VFdmVudCB8IEtleWJvYXJkRXZlbnQpOiB2b2lkIHtcbiAgICAgICAgaXRlbS5hY3Rpb24oKTtcbiAgICB9XG5cbiAgICByZW5kZXJTdWdnZXN0aW9uKGl0ZW06IEZ1enp5TWF0Y2g8T3B0aW9uPiwgZWw6IEhUTUxFbGVtZW50KTogdm9pZCB7XG4gICAgICAgIGVsLmFkZENsYXNzKFwibWV0YWRhdGEtbWVudS1jb21tYW5kLXN1Z2dlc3QtaXRlbVwiKVxuICAgICAgICBjb25zdCBpY29uQ29udGFpbmVyID0gZWwuY3JlYXRlRGl2KHsgY2xzOiBcIm1ldGFkYXRhLW1lbnUtY29tbWFuZC1zdWdnZXN0LWljb25cIiB9KVxuICAgICAgICBpdGVtLml0ZW0uaWNvbiA/IHNldEljb24oaWNvbkNvbnRhaW5lciwgaXRlbS5pdGVtLmljb24pIDogc2V0SWNvbihpY29uQ29udGFpbmVyLCBcInBlbmNpbFwiKVxuICAgICAgICBjb25zdCBhY3Rpb25MYWJlbCA9IGVsLmNyZWF0ZURpdih7IGNsczogXCJtZXRhZGF0YS1tZW51LWNvbW1hbmQtc3VnZ2VzdC1hY3Rpb24tbGFiZWxcIiB9KVxuICAgICAgICBhY3Rpb25MYWJlbC5pbm5lckhUTUwgPSBpdGVtLml0ZW0uYWN0aW9uTGFiZWxcbiAgICB9XG59OyIsICJpbXBvcnQgTWV0YWRhdGFNZW51IGZyb20gXCJtYWluXCI7XG5pbXBvcnQgeyBNZW51LCBURmlsZSB9IGZyb20gXCJvYnNpZGlhblwiO1xuaW1wb3J0IHsgRmlsZUNsYXNzIH0gZnJvbSBcInNyYy9maWxlQ2xhc3MvZmlsZUNsYXNzXCI7XG5pbXBvcnQgeyBGaWxlQ2xhc3NBdHRyaWJ1dGUgfSBmcm9tIFwic3JjL2ZpbGVDbGFzcy9maWxlQ2xhc3NBdHRyaWJ1dGVcIjtcbmltcG9ydCB7IEZpbGVDbGFzc0F0dHJpYnV0ZU1vZGFsIH0gZnJvbSBcInNyYy9maWxlQ2xhc3MvRmlsZUNsYXNzQXR0cmlidXRlTW9kYWxcIjtcbmltcG9ydCBGaWVsZENvbW1hbmRTdWdnZXN0TW9kYWwgZnJvbSBcIi4vRmllbGRDb21tYW5kU3VnZ2VzdE1vZGFsXCI7XG5cbmZ1bmN0aW9uIGlzTWVudShsb2NhdGlvbjogTWVudSB8IFwiSW5zZXJ0RmllbGRDb21tYW5kXCIgfCBGaWVsZENvbW1hbmRTdWdnZXN0TW9kYWwpOiBsb2NhdGlvbiBpcyBNZW51IHtcbiAgICByZXR1cm4gKGxvY2F0aW9uIGFzIE1lbnUpLmFkZEl0ZW0gIT09IHVuZGVmaW5lZDtcbn07XG5cbmZ1bmN0aW9uIGlzSW5zZXJ0RmllbGRDb21tYW5kKGxvY2F0aW9uOiBNZW51IHwgXCJJbnNlcnRGaWVsZENvbW1hbmRcIiB8IEZpZWxkQ29tbWFuZFN1Z2dlc3RNb2RhbCk6IGxvY2F0aW9uIGlzIFwiSW5zZXJ0RmllbGRDb21tYW5kXCIge1xuICAgIHJldHVybiAobG9jYXRpb24gYXMgc3RyaW5nKSA9PT0gXCJJbnNlcnRGaWVsZENvbW1hbmRcIjtcbn1cblxuZnVuY3Rpb24gaXNTdWdnZXN0KGxvY2F0aW9uOiBNZW51IHwgXCJJbnNlcnRGaWVsZENvbW1hbmRcIiB8IEZpZWxkQ29tbWFuZFN1Z2dlc3RNb2RhbCk6IGxvY2F0aW9uIGlzIEZpZWxkQ29tbWFuZFN1Z2dlc3RNb2RhbCB7XG4gICAgcmV0dXJuIChsb2NhdGlvbiBhcyBGaWVsZENvbW1hbmRTdWdnZXN0TW9kYWwpLmdldEl0ZW1zICE9PSB1bmRlZmluZWQ7XG59O1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBGaWxlQ2xhc3NPcHRpb25zTGlzdCB7XG5cbiAgICAvLyBhZGRzIG9wdGlvbnMgdG8gY29udGV4dCBtZW51IG9yIHRvIGEgZHJvcGRvd24gbW9kYWwgdHJpZ2dlciB3aXRoIFwiRmllbGQ6IE9wdGlvbnNcIiBjb21tYW5kIGluIGNvbW1hbmQgcGFsbGV0dGVcbiAgICBwcml2YXRlIHBhdGg6IHN0cmluZztcbiAgICBwcml2YXRlIGZpbGVDbGFzczogRmlsZUNsYXNzIHwgdW5kZWZpbmVkO1xuXG4gICAgY29uc3RydWN0b3IoXG4gICAgICAgIHByaXZhdGUgcGx1Z2luOiBNZXRhZGF0YU1lbnUsXG4gICAgICAgIHByaXZhdGUgZmlsZTogVEZpbGUsXG4gICAgICAgIHByaXZhdGUgbG9jYXRpb246IE1lbnUgfCBcIkluc2VydEZpZWxkQ29tbWFuZFwiIHwgRmllbGRDb21tYW5kU3VnZ2VzdE1vZGFsXG4gICAgKSB7XG4gICAgICAgIHRoaXMuZmlsZUNsYXNzID0gdGhpcy5wbHVnaW4uZmllbGRJbmRleC5maWxlQ2xhc3Nlc1BhdGguZ2V0KHRoaXMuZmlsZS5wYXRoKVxuICAgIH07XG5cbiAgICBwdWJsaWMgY3JlYXRlRXh0cmFPcHRpb25MaXN0KG9wZW5BZnRlckNyZWF0ZTogYm9vbGVhbiA9IHRydWUpOiB2b2lkIHtcbiAgICAgICAgaWYgKGlzTWVudSh0aGlzLmxvY2F0aW9uKSkgeyB0aGlzLmxvY2F0aW9uLmFkZFNlcGFyYXRvcigpOyB9O1xuICAgICAgICBpZiAoaXNJbnNlcnRGaWVsZENvbW1hbmQodGhpcy5sb2NhdGlvbikgJiYgdGhpcy5maWxlQ2xhc3MpIHtcbiAgICAgICAgICAgIGNvbnN0IG1vZGFsID0gbmV3IEZpbGVDbGFzc0F0dHJpYnV0ZU1vZGFsKHRoaXMucGx1Z2luLCB0aGlzLmZpbGVDbGFzcyk7XG4gICAgICAgICAgICBtb2RhbC5vcGVuKCk7XG4gICAgICAgIH0gZWxzZSBpZiAoaXNTdWdnZXN0KHRoaXMubG9jYXRpb24pKSB7XG4gICAgICAgICAgICB0aGlzLmJ1aWxkRmllbGRPcHRpb25zKCk7XG5cbiAgICAgICAgICAgIGlmIChvcGVuQWZ0ZXJDcmVhdGUpIHRoaXMubG9jYXRpb24ub3BlbigpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5idWlsZEZpZWxkT3B0aW9ucygpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBidWlsZEZpZWxkT3B0aW9ucygpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5maWxlQ2xhc3M/LmF0dHJpYnV0ZXMuZm9yRWFjaCgoYXR0cjogRmlsZUNsYXNzQXR0cmlidXRlKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBtb2RhbCA9IG5ldyBGaWxlQ2xhc3NBdHRyaWJ1dGVNb2RhbCh0aGlzLnBsdWdpbiwgdGhpcy5maWxlQ2xhc3MhLCBhdHRyKVxuICAgICAgICAgICAgaWYgKGlzTWVudSh0aGlzLmxvY2F0aW9uKSkge1xuICAgICAgICAgICAgICAgIHRoaXMubG9jYXRpb24uYWRkSXRlbSgoaXRlbSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBpdGVtLnNldFRpdGxlKGAke2F0dHIubmFtZX1gKVxuICAgICAgICAgICAgICAgICAgICBpdGVtLnNldEljb24oXCJ3cmVuY2hcIilcbiAgICAgICAgICAgICAgICAgICAgaXRlbS5vbkNsaWNrKCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1vZGFsLm9wZW4oKVxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICBpdGVtLnNldFNlY3Rpb24oXCJtZXRhZGF0YS1tZW51LWZpbGVjbGFzcy5maWxlY2xhc3MtZmllbGRzXCIpXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoaXNTdWdnZXN0KHRoaXMubG9jYXRpb24pKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5sb2NhdGlvbi5vcHRpb25zLnB1c2goe1xuICAgICAgICAgICAgICAgICAgICBpZDogYHVwZGF0ZV8ke2F0dHIubmFtZX1gLFxuICAgICAgICAgICAgICAgICAgICBhY3Rpb25MYWJlbDogYDxzcGFuPiR7YXR0ci5uYW1lfTwvc3Bhbj5gLFxuICAgICAgICAgICAgICAgICAgICBhY3Rpb246ICgpID0+IG1vZGFsLm9wZW4oKSxcbiAgICAgICAgICAgICAgICAgICAgaWNvbjogXCJnZWFyXCJcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIGlmIChpc01lbnUodGhpcy5sb2NhdGlvbikgJiYgdGhpcy5maWxlQ2xhc3MpIHtcbiAgICAgICAgICAgIHRoaXMubG9jYXRpb24uYWRkSXRlbSgoaXRlbSkgPT4ge1xuICAgICAgICAgICAgICAgIGl0ZW0uc2V0VGl0bGUoXCJBZGQgbmV3IGZpbGVDbGFzcyBhdHRyaWJ1dGVcIilcbiAgICAgICAgICAgICAgICBpdGVtLnNldEljb24oXCJwbHVzLWNpcmNsZVwiKVxuICAgICAgICAgICAgICAgIGl0ZW0ub25DbGljaygoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG1vZGFsID0gbmV3IEZpbGVDbGFzc0F0dHJpYnV0ZU1vZGFsKHRoaXMucGx1Z2luLCB0aGlzLmZpbGVDbGFzcyEpO1xuICAgICAgICAgICAgICAgICAgICBtb2RhbC5vcGVuKCk7XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICBpdGVtLnNldFNlY3Rpb24oXCJtZXRhZGF0YS1tZW51LWZpbGVjbGFzc1wiKVxuICAgICAgICAgICAgfSlcbiAgICAgICAgfSBlbHNlIGlmIChpc1N1Z2dlc3QodGhpcy5sb2NhdGlvbikgJiYgdGhpcy5maWxlQ2xhc3MpIHtcbiAgICAgICAgICAgIGNvbnN0IG1vZGFsID0gbmV3IEZpbGVDbGFzc0F0dHJpYnV0ZU1vZGFsKHRoaXMucGx1Z2luLCB0aGlzLmZpbGVDbGFzcyk7XG4gICAgICAgICAgICB0aGlzLmxvY2F0aW9uLm9wdGlvbnMucHVzaCh7XG4gICAgICAgICAgICAgICAgaWQ6IFwiYWRkX2ZpbGVDbGFzc19hdHRyaWJ1dGVcIixcbiAgICAgICAgICAgICAgICBhY3Rpb25MYWJlbDogYDxzcGFuPkluc2VydCBhbiBhdHRyaWJ1dGUgZm9yIDxiPiR7dGhpcy5maWxlQ2xhc3MubmFtZX08L2I+IGZpbGVDbGFzczwvc3Bhbj5gLFxuICAgICAgICAgICAgICAgIGFjdGlvbjogKCkgPT4geyBtb2RhbC5vcGVuKCkgfSxcbiAgICAgICAgICAgICAgICBpY29uOiBcInBsdXMtY2lyY2xlXCJcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH1cbiAgICB9XG5cbn07XG4iLCAiaW1wb3J0IE1ldGFkYXRhTWVudSBmcm9tIFwibWFpblwiO1xuaW1wb3J0IHsgTWVudSwgUGxhdGZvcm0sIHJlcXVpcmVBcGlWZXJzaW9uLCBUQWJzdHJhY3RGaWxlLCBURmlsZSB9IGZyb20gXCJvYnNpZGlhblwiO1xuaW1wb3J0IE9wdGlvbnNMaXN0IGZyb20gXCJzcmMvb3B0aW9ucy9PcHRpb25zTGlzdFwiO1xuaW1wb3J0IEZpbGVDbGFzc09wdGlvbnNMaXN0IGZyb20gXCIuL0ZpbGVDbGFzc09wdGlvbnNMaXN0XCI7XG5pbXBvcnQgeyBmcm9udE1hdHRlckxpbmVGaWVsZCwgZ2V0TGluZUZpZWxkcyB9IGZyb20gXCJzcmMvdXRpbHMvcGFyc2VyXCI7XG5pbXBvcnQgRmllbGRDb21tYW5kU3VnZ2VzdE1vZGFsIGZyb20gXCIuL0ZpZWxkQ29tbWFuZFN1Z2dlc3RNb2RhbFwiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBsaW5rQ29udGV4dE1lbnUge1xuXG5cdGNvbnN0cnVjdG9yKHByaXZhdGUgcGx1Z2luOiBNZXRhZGF0YU1lbnUpIHtcblx0XHR0aGlzLmNyZWF0ZUNvbnRleHRNZW51KCk7XG5cdH07XG5cblx0cHJpdmF0ZSBidWlsZE9wdGlvbnMoZmlsZTogVEZpbGUgfCBUQWJzdHJhY3RGaWxlIHwgbnVsbCwgbWVudTogTWVudSwgaW5jbHVkZWRGaWVsZHM/OiBzdHJpbmdbXSk6IHZvaWQge1xuXHRcdGlmIChmaWxlIGluc3RhbmNlb2YgVEZpbGUgJiYgZmlsZS5leHRlbnNpb24gPT09ICdtZCcpIHtcblx0XHRcdGlmICghUGxhdGZvcm0uaXNNb2JpbGUgJiYgcmVxdWlyZUFwaVZlcnNpb24oXCIwLjE2LjBcIikpIHtcblx0XHRcdFx0Ly9AdHMtaWdub3JlXG5cdFx0XHRcdG1lbnUuc2V0U2VjdGlvblN1Ym1lbnUoXCJtZXRhZGF0YS1tZW51LmN1cnJlbnRfZmllbGRcIiwgeyB0aXRsZTogXCJDdXJyZW50IEZpZWxkXCIsIGljb246IFwicGVuY2lsXCIgfSlcblx0XHRcdFx0Ly9AdHMtaWdub3JlXG5cdFx0XHRcdG1lbnUuc2V0U2VjdGlvblN1Ym1lbnUoXCJtZXRhZGF0YS1tZW51LmZpZWxkc1wiLCB7IHRpdGxlOiBcIk1hbmFnZSBGaWVsZHNcIiwgaWNvbjogXCJwZW5jaWxcIiB9KVxuXHRcdFx0XHQvL0B0cy1pZ25vcmVcblx0XHRcdFx0bWVudS5zZXRTZWN0aW9uU3VibWVudShcIm1ldGFkYXRhLW1lbnUtZmlsZWNsYXNzLmZpbGVjbGFzcy1maWVsZHNcIiwgeyB0aXRsZTogXCJNYW5hZ2UgRmlsZWNsYXNzIEZpZWxkc1wiLCBpY29uOiBcIndyZW5jaFwiIH0pXG5cdFx0XHR9XG5cdFx0XHRpZiAodGhpcy5wbHVnaW4uc2V0dGluZ3MuZGlzcGxheUZpZWxkc0luQ29udGV4dE1lbnUpIHtcblx0XHRcdFx0Ly9JZiBmaWxlQ2xhc3Ncblx0XHRcdFx0aWYgKGZpbGUucGFyZW50LnBhdGggKyBcIi9cIiA9PSB0aGlzLnBsdWdpbi5zZXR0aW5ncy5jbGFzc0ZpbGVzUGF0aCkge1xuXHRcdFx0XHRcdGNvbnN0IGZpbGVDbGFzc09wdGlvbnNMaXN0ID0gbmV3IEZpbGVDbGFzc09wdGlvbnNMaXN0KHRoaXMucGx1Z2luLCBmaWxlLCBtZW51KVxuXHRcdFx0XHRcdGZpbGVDbGFzc09wdGlvbnNMaXN0LmNyZWF0ZUV4dHJhT3B0aW9uTGlzdCgpO1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdGNvbnN0IG9wdGlvbnNMaXN0ID0gbmV3IE9wdGlvbnNMaXN0KHRoaXMucGx1Z2luLCBmaWxlLCBtZW51LCBpbmNsdWRlZEZpZWxkcyk7XG5cdFx0XHRcdFx0b3B0aW9uc0xpc3QuY3JlYXRlRXh0cmFPcHRpb25MaXN0KCk7XG5cdFx0XHRcdH07XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRtZW51LmFkZEl0ZW0oKGl0ZW0pID0+IHtcblx0XHRcdFx0XHRpdGVtLnNldEljb24oXCJsaXN0XCIpXG5cdFx0XHRcdFx0aXRlbS5zZXRUaXRsZShcIkZpZWxkIE9wdGlvbnNcIilcblx0XHRcdFx0XHRpdGVtLm9uQ2xpY2soKCkgPT4ge1xuXHRcdFx0XHRcdFx0Y29uc3QgZmllbGRDb21tYW5kU3VnZ2VzdE1vZGFsID0gbmV3IEZpZWxkQ29tbWFuZFN1Z2dlc3RNb2RhbCh0aGlzLnBsdWdpbi5hcHApXG5cdFx0XHRcdFx0XHRjb25zdCBvcHRpb25zTGlzdCA9IG5ldyBPcHRpb25zTGlzdCh0aGlzLnBsdWdpbiwgZmlsZSwgZmllbGRDb21tYW5kU3VnZ2VzdE1vZGFsKTtcblx0XHRcdFx0XHRcdG9wdGlvbnNMaXN0LmNyZWF0ZUV4dHJhT3B0aW9uTGlzdCgpO1xuXHRcdFx0XHRcdH0pXG5cdFx0XHRcdH0pXG5cdFx0XHR9XG5cblxuXG5cdFx0fTtcblx0fVxuXG5cdHByaXZhdGUgY3JlYXRlQ29udGV4dE1lbnUoKTogdm9pZCB7XG5cdFx0dGhpcy5wbHVnaW4ucmVnaXN0ZXJFdmVudChcblx0XHRcdHRoaXMucGx1Z2luLmFwcC53b3Jrc3BhY2Uub24oJ2ZpbGUtbWVudScsIChtZW51LCBhYnN0cmFjdEZpbGUsIHNvdXJjZSkgPT4ge1xuXHRcdFx0XHRjb25zdCBmaWxlID0gdGhpcy5wbHVnaW4uYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChhYnN0cmFjdEZpbGUucGF0aCk7XG5cdFx0XHRcdHRoaXMuYnVpbGRPcHRpb25zKGZpbGUsIG1lbnUpO1xuXHRcdFx0fSlcblx0XHQpO1xuXG5cdFx0dGhpcy5wbHVnaW4ucmVnaXN0ZXJFdmVudChcblx0XHRcdHRoaXMucGx1Z2luLmFwcC53b3Jrc3BhY2Uub24oJ2VkaXRvci1tZW51JywgKG1lbnUsIGVkaXRvciwgdmlldykgPT4ge1xuXHRcdFx0XHRjb25zdCBmaWxlID0gdGhpcy5wbHVnaW4uYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVGaWxlKCk7XG5cdFx0XHRcdGNvbnN0IGluY2x1ZGVkRmllbGRzOiBzdHJpbmdbXSA9IFtdO1xuXHRcdFx0XHRjb25zdCBmcm9udG1hdHRlciA9IHRoaXMucGx1Z2luLmFwcC5tZXRhZGF0YUNhY2hlLmdldEZpbGVDYWNoZSh2aWV3LmZpbGUpPy5mcm9udG1hdHRlcjtcblx0XHRcdFx0aWYgKGZyb250bWF0dGVyXG5cdFx0XHRcdFx0JiYgZWRpdG9yLmdldEN1cnNvcigpLmxpbmUgPiBmcm9udG1hdHRlci5wb3NpdGlvbi5zdGFydC5saW5lXG5cdFx0XHRcdFx0JiYgZWRpdG9yLmdldEN1cnNvcigpLmxpbmUgPCBmcm9udG1hdHRlci5wb3NpdGlvbi5lbmQubGluZVxuXHRcdFx0XHQpIHtcblx0XHRcdFx0XHRjb25zdCBhdHRyaWJ1dGUgPSBmcm9udE1hdHRlckxpbmVGaWVsZChlZGl0b3IuZ2V0TGluZShlZGl0b3IuZ2V0Q3Vyc29yKCkubGluZSkpXG5cdFx0XHRcdFx0aWYgKGF0dHJpYnV0ZSkgaW5jbHVkZWRGaWVsZHMucHVzaChhdHRyaWJ1dGUpO1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdGdldExpbmVGaWVsZHMoZWRpdG9yLmdldExpbmUoZWRpdG9yLmdldEN1cnNvcigpLmxpbmUpKS5mb3JFYWNoKGZpZWxkID0+IHtcblx0XHRcdFx0XHRcdGlmIChlZGl0b3IuZ2V0Q3Vyc29yKCkuY2ggPD0gZmllbGQuaW5kZXggKyBmaWVsZC5sZW5ndGggJiYgZWRpdG9yLmdldEN1cnNvcigpLmNoID49IGZpZWxkLmluZGV4KSB7XG5cdFx0XHRcdFx0XHRcdGluY2x1ZGVkRmllbGRzLnB1c2goZmllbGQuYXR0cmlidXRlKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9KVxuXHRcdFx0XHR9XG5cdFx0XHRcdGlmIChpbmNsdWRlZEZpZWxkcy5sZW5ndGgpIHtcblx0XHRcdFx0XHR0aGlzLmJ1aWxkT3B0aW9ucyhmaWxlLCBtZW51LCBpbmNsdWRlZEZpZWxkcyk7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0dGhpcy5idWlsZE9wdGlvbnMoZmlsZSwgbWVudSk7XG5cdFx0XHRcdH1cblxuXHRcdFx0fSlcblx0XHQpXG5cdH07XG59OyIsICJpbXBvcnQgTWV0YWRhdGFNZW51IGZyb20gXCJtYWluXCI7XG5pbXBvcnQgeyBNYXJrZG93blZpZXcsIE1lbnUsIFRGaWxlIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgRmllbGQgZnJvbSBcInNyYy9maWVsZHMvRmllbGRcIjtcbmltcG9ydCB7IEZpZWxkTWFuYWdlciBhcyBGIH0gZnJvbSBcInNyYy9maWVsZHMvRmllbGRNYW5hZ2VyXCI7XG5pbXBvcnQgTWFuYWdlcnMgZnJvbSBcInNyYy9maWVsZHMvZmllbGRNYW5hZ2Vycy9NYW5hZ2Vyc1wiO1xuaW1wb3J0IHsgRmlsZUNsYXNzIH0gZnJvbSBcInNyYy9maWxlQ2xhc3MvZmlsZUNsYXNzXCI7XG5pbXBvcnQgSW5wdXRNb2RhbCBmcm9tIFwic3JjL29wdGlvbk1vZGFscy9maWVsZHMvSW5wdXRNb2RhbFwiO1xuaW1wb3J0IHsgRmllbGRJY29uLCBGaWVsZE1hbmFnZXIsIEZpZWxkVHlwZSB9IGZyb20gXCJzcmMvdHlwZXMvZmllbGRUeXBlc1wiO1xuaW1wb3J0IHsgZ2VudWluZUtleXMgfSBmcm9tIFwic3JjL3V0aWxzL2RhdGF2aWV3VXRpbHNcIjtcbmltcG9ydCBjaG9vc2VTZWN0aW9uTW9kYWwgZnJvbSBcIi4uL29wdGlvbk1vZGFscy9jaG9vc2VTZWN0aW9uTW9kYWxcIjtcbmltcG9ydCBGaWVsZENvbW1hbmRTdWdnZXN0TW9kYWwgZnJvbSBcIi4vRmllbGRDb21tYW5kU3VnZ2VzdE1vZGFsXCI7XG5pbXBvcnQgRmlsZUNsYXNzT3B0aW9uc0xpc3QgZnJvbSBcIi4vRmlsZUNsYXNzT3B0aW9uc0xpc3RcIjtcblxuZnVuY3Rpb24gaXNNZW51KGxvY2F0aW9uOiBNZW51IHwgXCJJbnNlcnRGaWVsZENvbW1hbmRcIiB8IEZpZWxkQ29tbWFuZFN1Z2dlc3RNb2RhbCB8IFwiTWFuYWdlQXRDdXJzb3JDb21tYW5kXCIpOiBsb2NhdGlvbiBpcyBNZW51IHtcblx0cmV0dXJuIChsb2NhdGlvbiBhcyBNZW51KS5hZGRJdGVtICE9PSB1bmRlZmluZWQ7XG59O1xuXG5mdW5jdGlvbiBpc0luc2VydEZpZWxkQ29tbWFuZChsb2NhdGlvbjogTWVudSB8IFwiSW5zZXJ0RmllbGRDb21tYW5kXCIgfCBGaWVsZENvbW1hbmRTdWdnZXN0TW9kYWwgfCBcIk1hbmFnZUF0Q3Vyc29yQ29tbWFuZFwiKTogbG9jYXRpb24gaXMgXCJJbnNlcnRGaWVsZENvbW1hbmRcIiB7XG5cdHJldHVybiAobG9jYXRpb24gYXMgc3RyaW5nKSA9PT0gXCJJbnNlcnRGaWVsZENvbW1hbmRcIjtcbn1cblxuZnVuY3Rpb24gaXNTdWdnZXN0KGxvY2F0aW9uOiBNZW51IHwgXCJJbnNlcnRGaWVsZENvbW1hbmRcIiB8IEZpZWxkQ29tbWFuZFN1Z2dlc3RNb2RhbCB8IFwiTWFuYWdlQXRDdXJzb3JDb21tYW5kXCIpOiBsb2NhdGlvbiBpcyBGaWVsZENvbW1hbmRTdWdnZXN0TW9kYWwge1xuXHRyZXR1cm4gKGxvY2F0aW9uIGFzIEZpZWxkQ29tbWFuZFN1Z2dlc3RNb2RhbCkuZ2V0SXRlbXMgIT09IHVuZGVmaW5lZDtcbn07XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIE9wdGlvbnNMaXN0IHtcblxuXHQvLyBhZGRzIG9wdGlvbnMgdG8gY29udGV4dCBtZW51IG9yIHRvIGEgZHJvcGRvd24gbW9kYWwgdHJpZ2dlciB3aXRoIFwiRmllbGQ6IE9wdGlvbnNcIiBjb21tYW5kIGluIGNvbW1hbmQgcGFsbGV0dGVcblx0cGF0aDogc3RyaW5nO1xuXHRmaWxlQ2xhc3M6IEZpbGVDbGFzcyB8IHVuZGVmaW5lZDtcblx0YXR0cmlidXRlczogUmVjb3JkPHN0cmluZywgc3RyaW5nPjtcblx0ZmllbGRzRnJvbUluZGV4OiBSZWNvcmQ8c3RyaW5nLCBGaWVsZD4gPSB7fTtcblxuXHRjb25zdHJ1Y3Rvcihcblx0XHRwcml2YXRlIHBsdWdpbjogTWV0YWRhdGFNZW51LFxuXHRcdHByaXZhdGUgZmlsZTogVEZpbGUsXG5cdFx0cHJpdmF0ZSBsb2NhdGlvbjogTWVudSB8IFwiSW5zZXJ0RmllbGRDb21tYW5kXCIgfCBGaWVsZENvbW1hbmRTdWdnZXN0TW9kYWwgfCBcIk1hbmFnZUF0Q3Vyc29yQ29tbWFuZFwiLFxuXHRcdHByaXZhdGUgaW5jbHVkZWRGaWVsZHM/OiBzdHJpbmdbXVxuXHQpIHtcblx0XHR0aGlzLmZpbGUgPSBmaWxlO1xuXHRcdHRoaXMubG9jYXRpb24gPSBsb2NhdGlvbjtcblx0XHR0aGlzLmF0dHJpYnV0ZXMgPSB7fTtcblx0XHR0aGlzLmluY2x1ZGVkRmllbGRzID0gaW5jbHVkZWRGaWVsZHMgPyBbdGhpcy5wbHVnaW4uc2V0dGluZ3MuZmlsZUNsYXNzQWxpYXMsIC4uLmluY2x1ZGVkRmllbGRzXSA6IFt0aGlzLnBsdWdpbi5zZXR0aW5ncy5maWxlQ2xhc3NBbGlhc107XG5cdFx0dGhpcy5maWxlQ2xhc3MgPSB0aGlzLnBsdWdpbi5maWVsZEluZGV4LmZpbGVzRmlsZUNsYXNzLmdldCh0aGlzLmZpbGUucGF0aClcblx0XHR0aGlzLmdldEZpZWxkc0Zyb21JbmRleCgpO1xuXHRcdHRoaXMuZ2V0RmllbGRzVmFsdWVzKCk7XG5cdH07XG5cblx0cHJpdmF0ZSBnZXRGaWVsZHNWYWx1ZXMoKTogdm9pZCB7XG5cdFx0Y29uc3QgZGF0YXZpZXcgPSB0aGlzLnBsdWdpbi5hcHAucGx1Z2lucy5wbHVnaW5zW1wiZGF0YXZpZXdcIl1cblx0XHQvL0B0cy1pZ25vcmVcblx0XHRpZiAoZGF0YXZpZXcpIHtcblx0XHRcdGNvbnN0IGR2RmlsZSA9IGRhdGF2aWV3LmFwaS5wYWdlKHRoaXMuZmlsZS5wYXRoKVxuXHRcdFx0dHJ5IHtcblx0XHRcdFx0Z2VudWluZUtleXMoZHZGaWxlKS5mb3JFYWNoKGtleSA9PiB0aGlzLmFkZEF0dHJpYnV0ZShrZXksIGR2RmlsZVtrZXldKSlcblx0XHRcdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0XHRcdHRocm93IChlcnJvcik7XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG5cblx0cHJpdmF0ZSBhZGRBdHRyaWJ1dGUoa2V5OiBzdHJpbmcsIHZhbHVlOiBhbnkpOiB2b2lkIHtcblx0XHRjb25zdCBpbmNsdWRlZEZpZWxkcyA9IHRoaXMuaW5jbHVkZWRGaWVsZHMhLmZpbHRlcihmID0+IGYgIT09IHRoaXMucGx1Z2luLnNldHRpbmdzLmZpbGVDbGFzc0FsaWFzKVxuXHRcdGlmIChpbmNsdWRlZEZpZWxkcy5sZW5ndGggPiAwKSB7XG5cdFx0XHRpZiAoXG5cdFx0XHRcdHRoaXMuaW5jbHVkZWRGaWVsZHMhLmluY2x1ZGVzKGtleSlcblx0XHRcdFx0JiZcblx0XHRcdFx0IXRoaXMucGx1Z2luLnNldHRpbmdzLmdsb2JhbGx5SWdub3JlZEZpZWxkcy5pbmNsdWRlcyhrZXkpXG5cdFx0XHQpIHtcblx0XHRcdFx0dGhpcy5hdHRyaWJ1dGVzW2tleV0gPSB2YWx1ZVxuXHRcdFx0fVxuXHRcdH0gZWxzZSBpZiAoIXRoaXMucGx1Z2luLnNldHRpbmdzLmdsb2JhbGx5SWdub3JlZEZpZWxkcy5pbmNsdWRlcyhrZXkpKSB7XG5cdFx0XHR0aGlzLmF0dHJpYnV0ZXNba2V5XSA9IHZhbHVlXG5cdFx0fVxuXHR9XG5cblx0cHJpdmF0ZSBnZXRGaWVsZHNGcm9tSW5kZXgoKTogdm9pZCB7XG5cdFx0Y29uc3QgaW5kZXggPSB0aGlzLnBsdWdpbi5maWVsZEluZGV4XG5cdFx0Y29uc3QgZmllbGRzID0gaW5kZXguZmlsZXNGaWVsZHMuZ2V0KHRoaXMuZmlsZS5wYXRoKVxuXHRcdGZpZWxkcz8uZm9yRWFjaChmaWVsZCA9PiB0aGlzLmZpZWxkc0Zyb21JbmRleFtmaWVsZC5uYW1lXSA9IGZpZWxkKVxuXHR9XG5cblx0cHVibGljIGNyZWF0ZUFuZE9wZW5GaWVsZE1vZGFsKGZpZWxkTmFtZTogc3RyaW5nKTogdm9pZCB7XG5cdFx0Y29uc3QgZmllbGQgPSB0aGlzLmZpZWxkc0Zyb21JbmRleFtmaWVsZE5hbWVdXG5cdFx0aWYgKGZpZWxkKSB7XG5cdFx0XHRjb25zdCBmaWVsZE1hbmFnZXIgPSBuZXcgRmllbGRNYW5hZ2VyW2ZpZWxkLnR5cGVdKHRoaXMucGx1Z2luLCBmaWVsZCk7XG5cdFx0XHQoZmllbGRNYW5hZ2VyIGFzIEYpLmNyZWF0ZUFuZE9wZW5GaWVsZE1vZGFsKHRoaXMuZmlsZSwgZmllbGQubmFtZSwgdGhpcy5hdHRyaWJ1dGVzW2ZpZWxkLm5hbWVdKVxuXHRcdH0gZWxzZSB7XG5cdFx0XHRjb25zdCBkZWZhdWx0RmllbGQgPSBuZXcgRmllbGQoZmllbGROYW1lKVxuXHRcdFx0ZGVmYXVsdEZpZWxkLnR5cGUgPSBGaWVsZFR5cGUuSW5wdXRcblx0XHRcdGlmIChmaWVsZE5hbWUgPT09IHRoaXMucGx1Z2luLnNldHRpbmdzLmZpbGVDbGFzc0FsaWFzKSB7XG5cdFx0XHRcdHRoaXMuYnVpbGRGaWxlQ2xhc3NGaWVsZE9wdGlvbnMoZGVmYXVsdEZpZWxkLCB0aGlzLmF0dHJpYnV0ZXNbZmllbGROYW1lXSlcblx0XHRcdH0gZWxzZSBpZiAodGhpcy5sb2NhdGlvbiA9PT0gXCJNYW5hZ2VBdEN1cnNvckNvbW1hbmRcIikge1xuXHRcdFx0XHRjb25zdCBmaWVsZE1hbmFnZXIgPSBuZXcgTWFuYWdlcnMuSW5wdXQodGhpcy5wbHVnaW4sIGRlZmF1bHRGaWVsZCkgYXMgRlxuXHRcdFx0XHQoZmllbGRNYW5hZ2VyIGFzIEYpLmNyZWF0ZUFuZE9wZW5GaWVsZE1vZGFsKHRoaXMuZmlsZSwgZmllbGROYW1lLCB0aGlzLmF0dHJpYnV0ZXNbZmllbGROYW1lXSlcblx0XHRcdH1cblx0XHR9XG5cdH1cblxuXHRwdWJsaWMgY3JlYXRlRXh0cmFPcHRpb25MaXN0KG9wZW5BZnRlckNyZWF0ZTogYm9vbGVhbiA9IHRydWUpOiB2b2lkIHtcblx0XHRpZiAoaXNNZW51KHRoaXMubG9jYXRpb24pKSB7IHRoaXMubG9jYXRpb24uYWRkU2VwYXJhdG9yKCk7IH07XG5cdFx0aWYgKGlzSW5zZXJ0RmllbGRDb21tYW5kKHRoaXMubG9jYXRpb24pKSB7XG5cdFx0XHR0aGlzLmFkZEZpZWxkQXRDdXJyZW50UG9zaXRpb25PcHRpb24oKTtcblx0XHR9IGVsc2UgaWYgKGlzU3VnZ2VzdCh0aGlzLmxvY2F0aW9uKSkge1xuXHRcdFx0dGhpcy5idWlsZEZpZWxkT3B0aW9ucygpO1xuXHRcdFx0dGhpcy5hZGRGaWVsZEF0Q3VycmVudFBvc2l0aW9uT3B0aW9uKCk7XG5cdFx0XHR0aGlzLmFkZFNlY3Rpb25TZWxlY3RNb2RhbE9wdGlvbigpO1xuXHRcdFx0dGhpcy5hZGRGaWVsZEF0VGhlRW5kT2ZGcm9udG1hdHRlck9wdGlvbigpO1xuXHRcdFx0aWYgKHRoaXMuZmlsZUNsYXNzKSB7XG5cdFx0XHRcdGNvbnN0IGZpZWxkQ29tbWFuZFN1Z2dlc3RNb2RhbCA9IG5ldyBGaWVsZENvbW1hbmRTdWdnZXN0TW9kYWwodGhpcy5wbHVnaW4uYXBwKVxuXHRcdFx0XHRjb25zdCBvcHRpb25zTGlzdCA9IG5ldyBGaWxlQ2xhc3NPcHRpb25zTGlzdCh0aGlzLnBsdWdpbiwgdGhpcy5maWxlQ2xhc3MuZ2V0Q2xhc3NGaWxlKCksIGZpZWxkQ29tbWFuZFN1Z2dlc3RNb2RhbCk7XG5cdFx0XHRcdG9wdGlvbnNMaXN0LmNyZWF0ZUV4dHJhT3B0aW9uTGlzdChmYWxzZSk7XG5cdFx0XHRcdHRoaXMubG9jYXRpb24ub3B0aW9ucy5wdXNoKHtcblx0XHRcdFx0XHRpZDogXCJtYW5hZ2VfZmlsZUNsYXNzX2F0dHJpYnV0ZXNcIixcblx0XHRcdFx0XHRhY3Rpb25MYWJlbDogYDxzcGFuPk1hbmFnZSA8Yj4ke3RoaXMuZmlsZUNsYXNzLm5hbWV9PC9iPiBmaWxlQ2xhc3MgZmllbGRzPC9zcGFuPmAsXG5cdFx0XHRcdFx0YWN0aW9uOiAoKSA9PiB7IGZpZWxkQ29tbWFuZFN1Z2dlc3RNb2RhbC5vcGVuKCkgfSxcblx0XHRcdFx0XHRpY29uOiBcIndyZW5jaFwiXG5cdFx0XHRcdH0pXG5cdFx0XHR9XG5cdFx0XHRpZiAob3BlbkFmdGVyQ3JlYXRlKSB0aGlzLmxvY2F0aW9uLm9wZW4oKTtcblx0XHR9IGVsc2UgaWYgKGlzTWVudSh0aGlzLmxvY2F0aW9uKSkge1xuXHRcdFx0dGhpcy5idWlsZEZpZWxkT3B0aW9ucygpO1xuXHRcdFx0dGhpcy5hZGRTZWN0aW9uU2VsZWN0TW9kYWxPcHRpb24oKTtcblx0XHRcdHRoaXMuYWRkRmllbGRBdEN1cnJlbnRQb3NpdGlvbk9wdGlvbigpO1xuXHRcdFx0dGhpcy5hZGRGaWVsZEF0VGhlRW5kT2ZGcm9udG1hdHRlck9wdGlvbigpO1xuXHRcdFx0aWYgKHRoaXMuZmlsZUNsYXNzKSB7XG5cdFx0XHRcdGNvbnN0IGZpbGVDbGFzc09wdGlvbnNMaXN0ID0gbmV3IEZpbGVDbGFzc09wdGlvbnNMaXN0KHRoaXMucGx1Z2luLCB0aGlzLmZpbGVDbGFzcy5nZXRDbGFzc0ZpbGUoKSwgdGhpcy5sb2NhdGlvbilcblx0XHRcdFx0ZmlsZUNsYXNzT3B0aW9uc0xpc3QuY3JlYXRlRXh0cmFPcHRpb25MaXN0KGZhbHNlKTtcblx0XHRcdH1cblx0XHR9XG5cdH1cblxuXHRwcml2YXRlIGJ1aWxkRmlsZUNsYXNzRmllbGRPcHRpb25zKGZpZWxkOiBGaWVsZCwgdmFsdWU6IHN0cmluZyk6IHZvaWQge1xuXHRcdGNvbnN0IG1vZGFsID0gbmV3IElucHV0TW9kYWwodGhpcy5wbHVnaW4sIHRoaXMuZmlsZSwgZmllbGQsIHZhbHVlKTtcblx0XHRtb2RhbC50aXRsZUVsLnNldFRleHQoYENoYW5nZSBWYWx1ZSBmb3IgPCR7ZmllbGQubmFtZX0+YCk7XG5cdFx0aWYgKGlzTWVudSh0aGlzLmxvY2F0aW9uKSkge1xuXHRcdFx0dGhpcy5sb2NhdGlvbi5hZGRJdGVtKChpdGVtKSA9PiB7XG5cdFx0XHRcdGl0ZW0uc2V0VGl0bGUoYFVwZGF0ZSAke2ZpZWxkLm5hbWV9YCk7XG5cdFx0XHRcdGl0ZW0uc2V0SWNvbihcIndyZW5jaFwiKTtcblx0XHRcdFx0aXRlbS5vbkNsaWNrKCgpID0+IG1vZGFsLm9wZW4oKSk7XG5cdFx0XHRcdGl0ZW0uc2V0U2VjdGlvbihcIm1ldGFkYXRhLW1lbnVcIik7XG5cdFx0XHR9KVxuXHRcdH0gZWxzZSBpZiAoaXNTdWdnZXN0KHRoaXMubG9jYXRpb24pKSB7XG5cdFx0XHR0aGlzLmxvY2F0aW9uLm9wdGlvbnMucHVzaCh7XG5cdFx0XHRcdGlkOiBgdXBkYXRlXyR7ZmllbGQubmFtZX1gLFxuXHRcdFx0XHRhY3Rpb25MYWJlbDogYDxzcGFuPlVwZGF0ZSA8Yj4ke2ZpZWxkLm5hbWV9PC9iPjwvc3Bhbj5gLFxuXHRcdFx0XHRhY3Rpb246ICgpID0+IG1vZGFsLm9wZW4oKSxcblx0XHRcdFx0aWNvbjogRmllbGRJY29uW0ZpZWxkVHlwZS5JbnB1dF1cblx0XHRcdH0pO1xuXHRcdH07XG5cdH1cblxuXHRwcml2YXRlIGJ1aWxkRmllbGRPcHRpb25zKCk6IHZvaWQge1xuXHRcdE9iamVjdC5rZXlzKHRoaXMuYXR0cmlidXRlcykuZm9yRWFjaCgoa2V5OiBzdHJpbmcpID0+IHtcblx0XHRcdGNvbnN0IHZhbHVlID0gdGhpcy5hdHRyaWJ1dGVzW2tleV07XG5cdFx0XHQvL2NvbnN0IGZpZWxkID0gZ2V0RmllbGQodGhpcy5wbHVnaW4sIGtleSwgdGhpcy5maWxlQ2xhc3MpO1xuXHRcdFx0Y29uc3QgZmllbGQgPSB0aGlzLmZpZWxkc0Zyb21JbmRleFtrZXldXG5cblx0XHRcdGlmIChmaWVsZCkge1xuXHRcdFx0XHRjb25zdCBmaWVsZE1hbmFnZXIgPSBuZXcgRmllbGRNYW5hZ2VyW2ZpZWxkLnR5cGVdKHRoaXMucGx1Z2luLCBmaWVsZCk7XG5cdFx0XHRcdGZpZWxkTWFuYWdlci5hZGRGaWVsZE9wdGlvbihrZXksIHZhbHVlLCB0aGlzLmZpbGUsIHRoaXMubG9jYXRpb24pO1xuXHRcdFx0fSBlbHNlIGlmIChrZXkgIT09IFwiZmlsZVwiICYmIChpc1N1Z2dlc3QodGhpcy5sb2NhdGlvbikgfHwgaXNNZW51KHRoaXMubG9jYXRpb24pKSkge1xuXHRcdFx0XHRjb25zdCBkZWZhdWx0RmllbGQgPSBuZXcgRmllbGQoa2V5KVxuXHRcdFx0XHRkZWZhdWx0RmllbGQudHlwZSA9IEZpZWxkVHlwZS5JbnB1dFxuXHRcdFx0XHRpZiAoa2V5ID09PSB0aGlzLnBsdWdpbi5zZXR0aW5ncy5maWxlQ2xhc3NBbGlhcykge1xuXHRcdFx0XHRcdHRoaXMuYnVpbGRGaWxlQ2xhc3NGaWVsZE9wdGlvbnMoZGVmYXVsdEZpZWxkLCB2YWx1ZSlcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRjb25zdCBmaWVsZE1hbmFnZXIgPSBuZXcgTWFuYWdlcnMuSW5wdXQodGhpcy5wbHVnaW4sIGRlZmF1bHRGaWVsZClcblx0XHRcdFx0XHRmaWVsZE1hbmFnZXIuYWRkRmllbGRPcHRpb24oa2V5LCB2YWx1ZSB8fCBcIlwiLCB0aGlzLmZpbGUsIHRoaXMubG9jYXRpb24pXG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdH0pO1xuXHR9XG5cblx0cHJpdmF0ZSBhZGRTZWN0aW9uU2VsZWN0TW9kYWxPcHRpb24oKTogdm9pZCB7XG5cdFx0Y29uc3QgbW9kYWwgPSBuZXcgY2hvb3NlU2VjdGlvbk1vZGFsKHRoaXMucGx1Z2luLCB0aGlzLmZpbGUsIHRoaXMuZmlsZUNsYXNzKTtcblx0XHRpZiAoaXNNZW51KHRoaXMubG9jYXRpb24pKSB7XG5cdFx0XHR0aGlzLmxvY2F0aW9uLmFkZEl0ZW0oKGl0ZW0pID0+IHtcblx0XHRcdFx0aXRlbS5zZXRJY29uKFwiZW50ZXJcIik7XG5cdFx0XHRcdGl0ZW0uc2V0VGl0bGUoXCJBZGQgZmllbGQgYXQgc2VjdGlvbi4uLlwiKTtcblx0XHRcdFx0aXRlbS5vbkNsaWNrKChldnQ6IE1vdXNlRXZlbnQpID0+IHtcblx0XHRcdFx0XHRtb2RhbC5vcGVuKCk7XG5cdFx0XHRcdH0pO1xuXHRcdFx0XHRpdGVtLnNldFNlY3Rpb24oXCJtZXRhZGF0YS1tZW51XCIpO1xuXHRcdFx0fSk7XG5cdFx0fSBlbHNlIGlmIChpc1N1Z2dlc3QodGhpcy5sb2NhdGlvbikpIHtcblx0XHRcdHRoaXMubG9jYXRpb24ub3B0aW9ucy5wdXNoKHtcblx0XHRcdFx0aWQ6IFwiYWRkX2ZpZWxkX2F0X3NlY3Rpb25cIixcblx0XHRcdFx0YWN0aW9uTGFiZWw6IFwiQWRkIGZpZWxkIGF0IHNlY3Rpb24uLi5cIixcblx0XHRcdFx0YWN0aW9uOiAoKSA9PiBtb2RhbC5vcGVuKCksXG5cdFx0XHRcdGljb246IFwiZW50ZXJcIlxuXHRcdFx0fSlcblx0XHR9O1xuXHR9O1xuXG5cdHByaXZhdGUgYWRkRmllbGRBdFRoZUVuZE9mRnJvbnRtYXR0ZXJPcHRpb24oKTogdm9pZCB7XG5cdFx0aWYgKHRoaXMucGx1Z2luLmFwcC5tZXRhZGF0YUNhY2hlLmdldENhY2hlKHRoaXMuZmlsZS5wYXRoKT8uZnJvbnRtYXR0ZXIpIHtcblx0XHRcdGNvbnN0IGxpbmVOdW1iZXIgPSB0aGlzLnBsdWdpbi5hcHAubWV0YWRhdGFDYWNoZS5nZXRDYWNoZSh0aGlzLmZpbGUucGF0aCkhLmZyb250bWF0dGVyIS5wb3NpdGlvbi5lbmQubGluZSAtIDFcblx0XHRcdGlmIChpc01lbnUodGhpcy5sb2NhdGlvbikpIHtcblx0XHRcdFx0dGhpcy5sb2NhdGlvbi5hZGRJdGVtKChpdGVtKSA9PiB7XG5cdFx0XHRcdFx0aXRlbS5zZXRJY29uKFwicGluXCIpO1xuXHRcdFx0XHRcdGl0ZW0uc2V0VGl0bGUoXCJBZGQgZmllbGQgaW4gZnJvbnRtYXR0ZXJcIik7XG5cdFx0XHRcdFx0aXRlbS5vbkNsaWNrKGFzeW5jIChldnQ6IE1vdXNlRXZlbnQpID0+IHtcblx0XHRcdFx0XHRcdEYub3BlbkZpZWxkTW9kYWwodGhpcy5wbHVnaW4sIHRoaXMuZmlsZSwgdW5kZWZpbmVkLCBcIlwiLCBsaW5lTnVtYmVyICsgMSwgdHJ1ZSwgZmFsc2UpXG5cdFx0XHRcdFx0fSk7XG5cdFx0XHRcdFx0aXRlbS5zZXRTZWN0aW9uKFwibWV0YWRhdGEtbWVudVwiKTtcblx0XHRcdFx0fSk7XG5cdFx0XHR9IGVsc2UgaWYgKGlzU3VnZ2VzdCh0aGlzLmxvY2F0aW9uKSkge1xuXHRcdFx0XHR0aGlzLmxvY2F0aW9uLm9wdGlvbnMucHVzaCh7XG5cdFx0XHRcdFx0aWQ6IFwiYWRkX2ZpZWxkX2luX2Zyb250bWF0dGVyXCIsXG5cdFx0XHRcdFx0YWN0aW9uTGFiZWw6IFwiQWRkIGEgZmllbGQgaW4gZnJvbnRtYXR0ZXIuLi5cIixcblx0XHRcdFx0XHRhY3Rpb246ICgpID0+IEYub3BlbkZpZWxkTW9kYWwoXG5cdFx0XHRcdFx0XHR0aGlzLnBsdWdpbiwgdGhpcy5maWxlLCB1bmRlZmluZWQsIFwiXCIsIGxpbmVOdW1iZXIgKyAxLCB0cnVlLCBmYWxzZSwgdGhpcy5maWxlQ2xhc3MpLFxuXHRcdFx0XHRcdGljb246IFwicGluXCJcblx0XHRcdFx0fSlcblx0XHRcdH1cblx0XHR9XG5cdH1cblxuXHRwcml2YXRlIGFkZEZpZWxkQXRDdXJyZW50UG9zaXRpb25PcHRpb24oKTogdm9pZCB7XG5cdFx0Y29uc3QgY3VycmVudFZpZXcgPSB0aGlzLnBsdWdpbi5hcHAud29ya3NwYWNlLmdldEFjdGl2ZVZpZXdPZlR5cGUoTWFya2Rvd25WaWV3KVxuXHRcdGNvbnN0IGxpbmVOdW1iZXIgPSBjdXJyZW50Vmlldz8uZWRpdG9yLmdldEN1cnNvcigpLmxpbmU7XG5cdFx0aWYgKGxpbmVOdW1iZXIgIT09IHVuZGVmaW5lZCAmJiB0aGlzLmZpbGUucGF0aCA9PSBjdXJyZW50Vmlldz8uZmlsZS5wYXRoKSB7XG5cdFx0XHRsZXQgaW5Gcm9udG1hdHRlcjogYm9vbGVhbiA9IGZhbHNlO1xuXHRcdFx0Y29uc3QgZnJvbnRtYXR0ZXIgPSB0aGlzLnBsdWdpbi5hcHAubWV0YWRhdGFDYWNoZS5nZXRGaWxlQ2FjaGUodGhpcy5maWxlKT8uZnJvbnRtYXR0ZXJcblx0XHRcdGlmIChmcm9udG1hdHRlcikge1xuXHRcdFx0XHRjb25zdCB7IHBvc2l0aW9uOiB7IHN0YXJ0LCBlbmQgfSB9ID0gZnJvbnRtYXR0ZXJcblx0XHRcdFx0aWYgKGxpbmVOdW1iZXIgPj0gc3RhcnQubGluZSAmJiBsaW5lTnVtYmVyIDwgZW5kLmxpbmUpIGluRnJvbnRtYXR0ZXIgPSB0cnVlXG5cdFx0XHR9XG5cdFx0XHRpZiAoaXNNZW51KHRoaXMubG9jYXRpb24pKSB7XG5cdFx0XHRcdHRoaXMubG9jYXRpb24uYWRkSXRlbSgoaXRlbSkgPT4ge1xuXHRcdFx0XHRcdGl0ZW0uc2V0SWNvbihcInBpblwiKTtcblx0XHRcdFx0XHRpdGVtLnNldFRpdGxlKFwiQWRkIGZpZWxkIGF0IGN1cnNvclwiKTtcblx0XHRcdFx0XHRpdGVtLm9uQ2xpY2soKGV2dDogTW91c2VFdmVudCkgPT4ge1xuXHRcdFx0XHRcdFx0Ri5vcGVuRmllbGRNb2RhbChcblx0XHRcdFx0XHRcdFx0dGhpcy5wbHVnaW4sIHRoaXMuZmlsZSwgdW5kZWZpbmVkLCBcIlwiLCBsaW5lTnVtYmVyLCBpbkZyb250bWF0dGVyLCBmYWxzZSwgdGhpcy5maWxlQ2xhc3MpXG5cdFx0XHRcdFx0fSk7XG5cdFx0XHRcdFx0aXRlbS5zZXRTZWN0aW9uKFwibWV0YWRhdGEtbWVudVwiKTtcblx0XHRcdFx0fSk7XG5cdFx0XHR9IGVsc2UgaWYgKGlzSW5zZXJ0RmllbGRDb21tYW5kKHRoaXMubG9jYXRpb24pKSB7XG5cdFx0XHRcdEYub3BlbkZpZWxkTW9kYWwoXG5cdFx0XHRcdFx0dGhpcy5wbHVnaW4sIHRoaXMuZmlsZSwgdW5kZWZpbmVkLCBcIlwiLCBsaW5lTnVtYmVyLCBpbkZyb250bWF0dGVyLCBmYWxzZSwgdGhpcy5maWxlQ2xhc3MpO1xuXHRcdFx0fSBlbHNlIGlmIChpc1N1Z2dlc3QodGhpcy5sb2NhdGlvbikpIHtcblx0XHRcdFx0dGhpcy5sb2NhdGlvbi5vcHRpb25zLnB1c2goe1xuXHRcdFx0XHRcdGlkOiBcImFkZF9maWVsZF9hdF9jdXJzb3JcIixcblx0XHRcdFx0XHRhY3Rpb25MYWJlbDogXCJBZGQgZmllbGQgYXQgY3Vyc29yLi4uXCIsXG5cdFx0XHRcdFx0YWN0aW9uOiAoKSA9PiBGLm9wZW5GaWVsZE1vZGFsKFxuXHRcdFx0XHRcdFx0dGhpcy5wbHVnaW4sIHRoaXMuZmlsZSwgdW5kZWZpbmVkLCBcIlwiLCBsaW5lTnVtYmVyLCBpbkZyb250bWF0dGVyLCBmYWxzZSwgdGhpcy5maWxlQ2xhc3MpLFxuXHRcdFx0XHRcdGljb246IFwicGluXCJcblx0XHRcdFx0fSlcblx0XHRcdH07XG5cdFx0fVxuXHR9XG59O1xuIiwgImltcG9ydCBGaWVsZCBmcm9tIFwic3JjL2ZpZWxkcy9GaWVsZFwiO1xuaW1wb3J0IEZpbGVDbGFzc1F1ZXJ5IGZyb20gXCJzcmMvZmlsZUNsYXNzL0ZpbGVDbGFzc1F1ZXJ5XCI7XG5cbmV4cG9ydCBpbnRlcmZhY2UgTWV0YWRhdGFNZW51U2V0dGluZ3Mge1xuXHRwcmVzZXRGaWVsZHM6IEFycmF5PEZpZWxkPjtcblx0ZmlsZUNsYXNzUXVlcmllczogQXJyYXk8RmlsZUNsYXNzUXVlcnk+O1xuXHRkaXNwbGF5RmllbGRzSW5Db250ZXh0TWVudTogYm9vbGVhbjtcblx0Z2xvYmFsbHlJZ25vcmVkRmllbGRzOiBBcnJheTxzdHJpbmc+O1xuXHRjbGFzc0ZpbGVzUGF0aDogc3RyaW5nIHwgbnVsbDtcblx0aXNBdXRvc3VnZ2VzdEVuYWJsZWQ6IGJvb2xlYW47XG5cdGZpbGVDbGFzc0FsaWFzOiBzdHJpbmc7XG5cdHNldHRpbmdzVmVyc2lvbj86IG51bWJlcjtcblx0Z2xvYmFsRmlsZUNsYXNzPzogc3RyaW5nO1xuXHRmaXJzdERheU9mV2VlazogbnVtYmVyO1xufVxuXG5leHBvcnQgY29uc3QgREVGQVVMVF9TRVRUSU5HUzogTWV0YWRhdGFNZW51U2V0dGluZ3MgPSB7XG5cdHByZXNldEZpZWxkczogW10sXG5cdGZpbGVDbGFzc1F1ZXJpZXM6IFtdLFxuXHRkaXNwbGF5RmllbGRzSW5Db250ZXh0TWVudTogdHJ1ZSxcblx0Z2xvYmFsbHlJZ25vcmVkRmllbGRzOiBbXSxcblx0Y2xhc3NGaWxlc1BhdGg6IG51bGwsXG5cdGlzQXV0b3N1Z2dlc3RFbmFibGVkOiB0cnVlLFxuXHRmaWxlQ2xhc3NBbGlhczogXCJmaWxlQ2xhc3NcIixcblx0c2V0dGluZ3NWZXJzaW9uOiB1bmRlZmluZWQsXG5cdGdsb2JhbEZpbGVDbGFzczogdW5kZWZpbmVkLFxuXHRmaXJzdERheU9mV2VlazogMVxufTsiLCAiaW1wb3J0IHsgUGx1Z2luU2V0dGluZ1RhYiwgU2V0dGluZywgQnV0dG9uQ29tcG9uZW50LCBUb2dnbGVDb21wb25lbnQsIE1vZGFsLCBEcm9wZG93bkNvbXBvbmVudCwgbW9tZW50LCBzZXRJY29uIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgTWV0YWRhdGFNZW51IGZyb20gXCJtYWluXCI7XG5pbXBvcnQgRmllbGRTZXR0aW5nc01vZGFsIGZyb20gXCJzcmMvc2V0dGluZ3MvRmllbGRTZXR0aW5nc01vZGFsXCI7XG5pbXBvcnQgRmllbGQgZnJvbSBcInNyYy9maWVsZHMvRmllbGRcIjtcbmltcG9ydCBGaWVsZFNldHRpbmcgZnJvbSBcInNyYy9zZXR0aW5ncy9GaWVsZFNldHRpbmdcIjtcbmltcG9ydCB7IEZvbGRlclN1Z2dlc3QgfSBmcm9tIFwic3JjL3N1Z2dlc3Rlci9Gb2xkZXJTdWdnZXN0ZXJcIjtcbmltcG9ydCB7IEZpbGVTdWdnZXN0IH0gZnJvbSBcInNyYy9zdWdnZXN0ZXIvRmlsZVN1Z2dlc3RlclwiO1xuaW1wb3J0IEZpbGVDbGFzc1F1ZXJ5IGZyb20gXCJzcmMvZmlsZUNsYXNzL0ZpbGVDbGFzc1F1ZXJ5XCI7XG5pbXBvcnQgRmlsZUNsYXNzUXVlcnlTZXR0aW5nc01vZGFsIGZyb20gXCIuL0ZpbGVDbGFzc1F1ZXJ5U2V0dGluZ01vZGFsXCI7XG5pbXBvcnQgRmlsZUNsYXNzUXVlcnlTZXR0aW5nIGZyb20gXCIuL0ZpbGVDbGFzc1F1ZXJ5U2V0dGluZ1wiO1xuXG5jbGFzcyBTZXR0aW5nc01pZ3JhdGlvbkNvbmZpcm1Nb2RhbCBleHRlbmRzIE1vZGFsIHtcblxuXHRjb25zdHJ1Y3Rvcihcblx0XHRwcml2YXRlIHBsdWdpbjogTWV0YWRhdGFNZW51LFxuXHRcdHByaXZhdGUgdGFiOiBNZXRhZGF0YU1lbnVTZXR0aW5nVGFiXG5cdCkge1xuXHRcdHN1cGVyKHBsdWdpbi5hcHApO1xuXHR9O1xuXG5cdG9uT3BlbigpOiB2b2lkIHtcblxuXHRcdHRoaXMudGl0bGVFbC5zZXRUZXh0KFwiQ29uZmlybVwiKTtcblx0XHRjb25zdCBib2R5ID0gdGhpcy5jb250ZW50RWwuY3JlYXRlRGl2KHtcblx0XHRcdGNsczogXCJtb2RhbC10ZXh0LWRhbmdlclwiXG5cdFx0fSk7XG5cdFx0Ym9keS5zZXRUZXh0KFwiVGhpcyB3aWxsIGVyYXNlIGN1cnJlbnQgc2V0dGluZ3MuIEFyZSB5b3Ugc3VyZT9cIik7XG5cdFx0Y29uc3QgY29uZmlybUJ1dHRvbiA9IG5ldyBCdXR0b25Db21wb25lbnQodGhpcy5jb250ZW50RWwpO1xuXHRcdGNvbmZpcm1CdXR0b24uc2V0SWNvbihcImNoZWNrXCIpO1xuXHRcdGNvbmZpcm1CdXR0b24ub25DbGljaygoKSA9PiB7XG5cdFx0XHQvL0B0cy1pZ25vcmVcblx0XHRcdGlmICh0aGlzLnBsdWdpbi5hcHAucGx1Z2lucy5wbHVnaW5zLmhhc093blByb3BlcnR5KFwic3VwZXJjaGFyZ2VkLWxpbmtzLW9ic2lkaWFuXCIpKSB7XG5cdFx0XHRcdC8vQHRzLWlnbm9yZVxuXHRcdFx0XHRsZXQgc2V0dGluZ3MgPSB0aGlzLnBsdWdpbi5hcHAucGx1Z2lucy5wbHVnaW5zW1wic3VwZXJjaGFyZ2VkLWxpbmtzLW9ic2lkaWFuXCJdLnNldHRpbmdzO1xuXHRcdFx0XHQvL2RlZXAgY29weWluZyBwcmVzZXRGaWVsZHMgaW4gaW5pdGlhbFByb3BlcnR5XG5cdFx0XHRcdHRoaXMucGx1Z2luLmluaXRpYWxQcm9wZXJ0aWVzID0gW107XG5cdFx0XHRcdHNldHRpbmdzLnByZXNldEZpZWxkcy5mb3JFYWNoKChwcm9wOiBGaWVsZCkgPT4ge1xuXHRcdFx0XHRcdGNvbnN0IGZpZWxkID0gbmV3IEZpZWxkKCk7XG5cdFx0XHRcdFx0T2JqZWN0LmFzc2lnbihmaWVsZCwgcHJvcCk7XG5cdFx0XHRcdFx0dGhpcy5wbHVnaW4uaW5pdGlhbFByb3BlcnRpZXMucHVzaChmaWVsZCk7XG5cdFx0XHRcdH0pXG5cblx0XHRcdFx0dGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cdFx0XHRcdHRoaXMuY2xvc2UoKTtcblx0XHRcdH07XG5cdFx0fSk7XG5cdH07XG5cblx0b25DbG9zZSgpOiB2b2lkIHtcblx0XHR0aGlzLnRhYi5kaXNwbGF5KCk7XG5cdH07XG59O1xuXG5cblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgTWV0YWRhdGFNZW51U2V0dGluZ1RhYiBleHRlbmRzIFBsdWdpblNldHRpbmdUYWIge1xuXHRwcml2YXRlIHBsdWdpbjogTWV0YWRhdGFNZW51O1xuXG5cdGNvbnN0cnVjdG9yKHBsdWdpbjogTWV0YWRhdGFNZW51KSB7XG5cdFx0c3VwZXIoYXBwLCBwbHVnaW4pO1xuXHRcdHRoaXMucGx1Z2luID0gcGx1Z2luO1xuXHR9O1xuXG5cdGRpc3BsYXkoKTogdm9pZCB7XG5cdFx0bGV0IHsgY29udGFpbmVyRWwgfSA9IHRoaXM7XG5cdFx0Y29udGFpbmVyRWwuZW1wdHkoKTtcblxuXHRcdC8qIFxuXHRcdC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cdFx0R2xvYmFsIFNldHRpbmdzIFxuXHRcdC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cdFx0Ki9cblx0XHRjb25zdCBnbG9iYWxTZXR0aW5ncyA9IGNvbnRhaW5lckVsLmNyZWF0ZUVsKCdkaXYnKVxuXHRcdGdsb2JhbFNldHRpbmdzLmNyZWF0ZUVsKCdoNCcsIHsgdGV4dDogJ0dsb2JhbCBzZXR0aW5ncycsIGNsczogXCJtZXRhZGF0YS1tZW51LXNldHRpbmctc2VjdGlvbi1oZWFkZXJcIiB9KTtcblx0XHRnbG9iYWxTZXR0aW5ncy5jcmVhdGVFbCgnZGl2Jywge1xuXHRcdFx0Y2xzOiBcInNldHRpbmctaXRlbS1kZXNjcmlwdGlvbiBtZXRhZGF0YS1tZW51LXNldHRpbmctc2VjdGlvbi1kZXNjXCIsXG5cdFx0XHR0ZXh0OiBcIkdsb2JhbCBzZXR0aW5ncyB0byBhcHBseSB0byB5b3VyIHdob2xlIHZhdWx0XCJcblx0XHR9KVxuXG5cdFx0LyogTWFuYWdlIG1lbnUgb3B0aW9ucyBkaXNwbGF5Ki9cblx0XHRuZXcgU2V0dGluZyhnbG9iYWxTZXR0aW5ncylcblx0XHRcdC5zZXROYW1lKFwiRGlzcGxheSBmaWVsZCBvcHRpb25zIGluIGNvbnRleHQgbWVudVwiKVxuXHRcdFx0LnNldERlc2MoXCJDaG9vc2UgdG8gc2hvdyBvciBoaWRlIGZpZWxkcyBvcHRpb25zIGluIHRoZSBjb250ZXh0IG1lbnUgb2YgYSBsaW5rIG9yIGEgZmlsZVwiKVxuXHRcdFx0LmFkZFRvZ2dsZSgodG9nZ2xlOiBUb2dnbGVDb21wb25lbnQpID0+IHtcblx0XHRcdFx0dG9nZ2xlLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmRpc3BsYXlGaWVsZHNJbkNvbnRleHRNZW51KVxuXHRcdFx0XHR0b2dnbGUub25DaGFuZ2UoYXN5bmMgdmFsdWUgPT4ge1xuXHRcdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLmRpc3BsYXlGaWVsZHNJbkNvbnRleHRNZW51ID0gdmFsdWVcblx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKVxuXHRcdFx0XHR9KTtcblx0XHRcdH0pO1xuXHRcdC8qIEV4Y2x1ZGUgRmllbGRzIGZyb20gY29udGV4dCBtZW51Ki9cblx0XHRuZXcgU2V0dGluZyhnbG9iYWxTZXR0aW5ncylcblx0XHRcdC5zZXROYW1lKCdHbG9iYWxseSBpZ25vcmVkIGZpZWxkcycpXG5cdFx0XHQuc2V0RGVzYygnRmllbGRzIHRvIGJlIGlnbm9yZWQgYnkgdGhlIHBsdWdpbiB3aGVuIGFkZGluZyBvcHRpb25zIHRvIHRoZSBjb250ZXh0IG1lbnUnKVxuXHRcdFx0LmFkZFRleHRBcmVhKCh0ZXh0KSA9PiB7XG5cdFx0XHRcdHRleHRcblx0XHRcdFx0XHQuc2V0UGxhY2Vob2xkZXIoJ0VudGVyIGZpZWxkcyBhcyBzdHJpbmcsIGNvbW1hIHNlcGFyYXRlZCcpXG5cdFx0XHRcdFx0LnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmdsb2JhbGx5SWdub3JlZEZpZWxkcy5qb2luKCcsICcpKVxuXHRcdFx0XHRcdC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcblx0XHRcdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLmdsb2JhbGx5SWdub3JlZEZpZWxkcyA9IHZhbHVlLnNwbGl0KCcsJykubWFwKGl0ZW0gPT4gaXRlbS50cmltKCkpO1xuXHRcdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cdFx0XHRcdFx0fSk7XG5cdFx0XHRcdHRleHQuaW5wdXRFbC5yb3dzID0gNjtcblx0XHRcdFx0dGV4dC5pbnB1dEVsLmNvbHMgPSAyNTtcblx0XHRcdH0pO1xuXG5cblx0XHQvKiBGaXJzdCBkYXkgb2Ygd2VlayAoZm9yIERhdGUgRmllbGRzKi9cblx0XHRuZXcgU2V0dGluZyhnbG9iYWxTZXR0aW5ncylcblx0XHRcdC5zZXROYW1lKCdGaXJzdCBkYXkgb2Ygd2VlaycpXG5cdFx0XHQuc2V0RGVzYygnRm9yIGRhdGUgZmllbGRzLCB3aGljaCBkYXkgdGhlIGRhdGUgcGlja2VyXFwncyB3ZWVrIHNob3VsZCBzdGFydCB3aXRoJylcblx0XHRcdC5hZGREcm9wZG93bigoY2I6IERyb3Bkb3duQ29tcG9uZW50KSA9PiB7XG5cdFx0XHRcdGZvciAobGV0IGkgPSAwOyBpIDwgMjsgaSsrKSB7XG5cdFx0XHRcdFx0Y2IuYWRkT3B0aW9uKGkudG9TdHJpbmcoKSwgbW9tZW50KCkuZGF5KGkpLmZvcm1hdChcImRkZGRcIikpXG5cdFx0XHRcdH1cblx0XHRcdFx0Y2Iuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuZmlyc3REYXlPZldlZWsudG9TdHJpbmcoKSB8fCBcIjFcIilcblx0XHRcdFx0Y2Iub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG5cdFx0XHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MuZmlyc3REYXlPZldlZWsgPSBwYXJzZUludCh2YWx1ZSk7XG5cdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cdFx0XHRcdH0pO1xuXHRcdFx0fSk7XG5cblx0XHQvKiBcblx0XHQtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXHRcdE1hbmFnaW5nIHByZWRlZmluZWQgb3B0aW9ucyBmb3IgcHJvcGVydGllcyBcblx0XHQtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXHRcdCovXG5cdFx0LyogQWRkIG5ldyBwcm9wZXJ0eSBmb3Igd2hpY2ggd2Ugd2FudCB0byBwcmVzZXQgb3B0aW9ucyovXG5cdFx0Y29uc3QgcHJlc2V0RmllbGRzU2V0dGluZ3MgPSBjb250YWluZXJFbC5jcmVhdGVFbChcImRpdlwiKTtcblx0XHRjb25zdCBwcmVzZXRGaWVsZHNTZXR0aW5nSGVhZGVyQ29udGFpbmVyID0gcHJlc2V0RmllbGRzU2V0dGluZ3MuY3JlYXRlRWwoXCJkaXZcIiwgeyBjbHM6IFwibWV0YWRhdGEtbWVudS1zZXR0aW5nLXNlY3Rpb24taGVhZGVyLWNvbnRhaW5lclwiIH0pO1xuXHRcdGNvbnN0IHByZXNldEZpZWxkc1NldHRpbmdIZWFkZXJUZXh0Q29udGFpbmVyID0gcHJlc2V0RmllbGRzU2V0dGluZ0hlYWRlckNvbnRhaW5lci5jcmVhdGVFbChcImRpdlwiLCB7IGNsczogXCJtZXRhZGF0YS1tZW51LXNldHRpbmctc2VjdGlvbi1oZWFkZXItdGV4dC1jb250YWluZXJcIiB9KTtcblx0XHRwcmVzZXRGaWVsZHNTZXR0aW5nSGVhZGVyVGV4dENvbnRhaW5lci5jcmVhdGVFbCgnaDQnLCB7IHRleHQ6ICdQcmVzZXQgRmllbGRzIHNldHRpbmdzJywgY2xzOiBcIm1ldGFkYXRhLW1lbnUtc2V0dGluZy1zZWN0aW9uLWhlYWRlclwiIH0pO1xuXHRcdHByZXNldEZpZWxkc1NldHRpbmdIZWFkZXJUZXh0Q29udGFpbmVyLmNyZWF0ZUVsKCdkaXYnLCB7XG5cdFx0XHRjbHM6IFwic2V0dGluZy1pdGVtLWRlc2NyaXB0aW9uIG1ldGFkYXRhLW1lbnUtc2V0dGluZy1zZWN0aW9uLWRlc2NcIixcblx0XHRcdHRleHQ6IFwiTWFuYWdlIGdsb2JhbGx5IHByZWRlZmluZWQgdHlwZSBhbmQgb3B0aW9ucyBmb3IgYSBmaWVsZCB0aHJvdWdob3V0IHlvdXIgd2hvbGUgdmF1bHRcIlxuXHRcdH0pO1xuXHRcdGNvbnN0IHByZXNldEZpZWxkc1NldHRpbmdzQ29udGFpbmVyU2hvd0J1dHRvbkNvbnRhaW5lciA9IHByZXNldEZpZWxkc1NldHRpbmdIZWFkZXJDb250YWluZXIuY3JlYXRlRWwoXCJkaXZcIiwgeyBjbHM6IFwic2V0dGluZy1pdGVtLWNvbnRyb2xcIiB9KTtcblx0XHRjb25zdCBwcmVzZXRGaWVsZHNTZXR0aW5nc0NvbnRhaW5lclNob3dCdXR0b24gPSBwcmVzZXRGaWVsZHNTZXR0aW5nc0NvbnRhaW5lclNob3dCdXR0b25Db250YWluZXIuY3JlYXRlRWwoXCJidXR0b25cIik7XG5cdFx0cHJlc2V0RmllbGRzU2V0dGluZ3NDb250YWluZXJTaG93QnV0dG9uLmFkZENsYXNzKFwic2V0dGluZy1pdGVtLWNvbnRyb2xcIik7XG5cblx0XHRjb25zdCBwcmVzZXRGaWVsZHNTZXR0aW5nc0NvbnRhaW5lciA9IHByZXNldEZpZWxkc1NldHRpbmdzLmNyZWF0ZUVsKFwiZGl2XCIpO1xuXHRcdG5ldyBTZXR0aW5nKHByZXNldEZpZWxkc1NldHRpbmdzQ29udGFpbmVyKVxuXHRcdFx0LnNldE5hbWUoXCJBZGQgTmV3IEZpZWxkIFNldHRpbmdcIilcblx0XHRcdC5zZXREZXNjKFwiQWRkIGEgbmV3IEZyb250bWF0dGVyIHByb3BlcnR5IGZvciB3aGljaCB5b3Ugd2FudCBwcmVzZXQgb3B0aW9ucy5cIilcblx0XHRcdC5hZGRCdXR0b24oKGJ1dHRvbjogQnV0dG9uQ29tcG9uZW50KTogQnV0dG9uQ29tcG9uZW50ID0+IHtcblx0XHRcdFx0cmV0dXJuIGJ1dHRvblxuXHRcdFx0XHRcdC5zZXRUb29sdGlwKFwiQWRkIE5ldyBQcm9wZXJ0eSBNYW5hZ2VyXCIpXG5cdFx0XHRcdFx0LnNldEJ1dHRvblRleHQoXCIrXCIpXG5cdFx0XHRcdFx0Lm9uQ2xpY2soYXN5bmMgKCkgPT4ge1xuXHRcdFx0XHRcdFx0bGV0IG1vZGFsID0gbmV3IEZpZWxkU2V0dGluZ3NNb2RhbCh0aGlzLnBsdWdpbiwgcHJlc2V0RmllbGRzU2V0dGluZ3NDb250YWluZXIpO1xuXHRcdFx0XHRcdFx0bW9kYWwub3BlbigpO1xuXHRcdFx0XHRcdH0pO1xuXHRcdFx0fSk7XG5cblx0XHQvKiBNYW5hZ2VkIHByb3BlcnRpZXMgdGhhdCBjdXJyZW50bHkgaGF2ZSBwcmVzZXQgb3B0aW9ucyAqL1xuXHRcdHRoaXMucGx1Z2luLmluaXRpYWxQcm9wZXJ0aWVzLmZvckVhY2gocHJvcCA9PiB7XG5cdFx0XHRjb25zdCBwcm9wZXJ0eSA9IG5ldyBGaWVsZCgpO1xuXHRcdFx0T2JqZWN0LmFzc2lnbihwcm9wZXJ0eSwgcHJvcCk7XG5cdFx0XHRuZXcgRmllbGRTZXR0aW5nKHByZXNldEZpZWxkc1NldHRpbmdzQ29udGFpbmVyLCBwcm9wZXJ0eSwgdGhpcy5wbHVnaW4pO1xuXHRcdH0pO1xuXG5cdFx0cHJlc2V0RmllbGRzU2V0dGluZ3NDb250YWluZXIuaXNTaG93bigpID9cblx0XHRcdHNldEljb24ocHJlc2V0RmllbGRzU2V0dGluZ3NDb250YWluZXJTaG93QnV0dG9uLCBcImRvdWJsZS11cC1hcnJvdy1nbHlwaFwiKSA6XG5cdFx0XHRzZXRJY29uKHByZXNldEZpZWxkc1NldHRpbmdzQ29udGFpbmVyU2hvd0J1dHRvbiwgXCJkb3VibGUtZG93bi1hcnJvdy1nbHlwaFwiKTtcblx0XHRwcmVzZXRGaWVsZHNTZXR0aW5nc0NvbnRhaW5lclNob3dCdXR0b24ub25jbGljayA9ICgpID0+IHtcblx0XHRcdHByZXNldEZpZWxkc1NldHRpbmdzQ29udGFpbmVyLmlzU2hvd24oKSA/XG5cdFx0XHRcdHByZXNldEZpZWxkc1NldHRpbmdzQ29udGFpbmVyLmhpZGUoKSA6XG5cdFx0XHRcdHByZXNldEZpZWxkc1NldHRpbmdzQ29udGFpbmVyLnNob3coKTtcblx0XHRcdHByZXNldEZpZWxkc1NldHRpbmdzQ29udGFpbmVyLmlzU2hvd24oKSA/XG5cdFx0XHRcdHNldEljb24ocHJlc2V0RmllbGRzU2V0dGluZ3NDb250YWluZXJTaG93QnV0dG9uLCBcImRvdWJsZS11cC1hcnJvdy1nbHlwaFwiKSA6XG5cdFx0XHRcdHNldEljb24ocHJlc2V0RmllbGRzU2V0dGluZ3NDb250YWluZXJTaG93QnV0dG9uLCBcImRvdWJsZS1kb3duLWFycm93LWdseXBoXCIpO1xuXHRcdH1cblxuXHRcdC8qIFxuXHRcdC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cdFx0TWFuYWdpbmcgZmlsZUNsYXNzIFxuXHRcdC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cdFx0Ki9cblxuXHRcdC8qIFNldCBjbGFzc0ZpbGVzIFBhdGgqL1xuXHRcdGNvbnN0IGNsYXNzRmlsZXNTZXR0aW5ncyA9IGNvbnRhaW5lckVsLmNyZWF0ZUVsKFwiZGl2XCIpXG5cdFx0Y29uc3QgY2xhc3NGaWxlc1NldHRpbmdzSGVhZGVyQ29udGFpbmVyID0gY2xhc3NGaWxlc1NldHRpbmdzLmNyZWF0ZUVsKFwiZGl2XCIsIHsgY2xzOiBcIm1ldGFkYXRhLW1lbnUtc2V0dGluZy1zZWN0aW9uLWhlYWRlci1jb250YWluZXJcIiB9KTtcblx0XHRjb25zdCBjbGFzc0ZpbGVzU2V0dGluZ3NIZWFkZXJUZXh0Q29udGFpbmVyID0gY2xhc3NGaWxlc1NldHRpbmdzSGVhZGVyQ29udGFpbmVyLmNyZWF0ZUVsKFwiZGl2XCIsIHsgY2xzOiBcIm1ldGFkYXRhLW1lbnUtc2V0dGluZy1zZWN0aW9uLWhlYWRlci10ZXh0LWNvbnRhaW5lclwiIH0pO1xuXHRcdGNsYXNzRmlsZXNTZXR0aW5nc0hlYWRlclRleHRDb250YWluZXIuY3JlYXRlRWwoJ2g0JywgeyB0ZXh0OiAnRmlsZUNsYXNzIHNldHRpbmdzJywgY2xzOiBcIm1ldGFkYXRhLW1lbnUtc2V0dGluZy1zZWN0aW9uLWhlYWRlclwiIH0pO1xuXHRcdGNsYXNzRmlsZXNTZXR0aW5nc0hlYWRlclRleHRDb250YWluZXIuY3JlYXRlRWwoJ2RpdicsIHtcblx0XHRcdGNsczogXCJzZXR0aW5nLWl0ZW0tZGVzY3JpcHRpb24gbWV0YWRhdGEtbWVudS1zZXR0aW5nLXNlY3Rpb24tZGVzY1wiLFxuXHRcdFx0dGV4dDogXCJNYW5hZ2UgZmlsZUNsYXNzIGZvbGRlciBhbmQgYWxpYXMuIFwiICtcblx0XHRcdFx0XCJXaGVuIGEgbm90ZSBoYXMgYSBmaWVsQ2xhc3MgZGVmaW5lZCwgZmlsZUNsYXNzIGZpZWxkIHByb3BlcnRpZXMgd2lsbCBvdmVycmlkZSBnbG9iYWwgcHJlc2V0IGZpZWxkcyBzZXR0aW5ncyBmb3IgdGhlIHNhbWUgZmllbGQgbmFtZVwiXG5cdFx0fSk7XG5cblx0XHRjb25zdCBjbGFzc0ZpbGVzU2V0dGluZ3NDb250YWluZXJTaG93QnV0dG9uQ29udGFpbmVyID0gY2xhc3NGaWxlc1NldHRpbmdzSGVhZGVyQ29udGFpbmVyLmNyZWF0ZUVsKFwiZGl2XCIsIHsgY2xzOiBcInNldHRpbmctaXRlbS1jb250cm9sXCIgfSk7XG5cdFx0Y29uc3QgY2xhc3NGaWxlc1NldHRpbmdzQ29udGFpbmVyU2hvd0J1dHRvbiA9IGNsYXNzRmlsZXNTZXR0aW5nc0NvbnRhaW5lclNob3dCdXR0b25Db250YWluZXIuY3JlYXRlRWwoXCJidXR0b25cIik7XG5cblx0XHRjbGFzc0ZpbGVzU2V0dGluZ3NDb250YWluZXJTaG93QnV0dG9uLmFkZENsYXNzKFwic2V0dGluZy1pdGVtLWNvbnRyb2xcIik7XG5cdFx0Y29uc3QgY2xhc3NGaWxlc1NldHRpbmdzQ29udGFpbmVyID0gY2xhc3NGaWxlc1NldHRpbmdzLmNyZWF0ZUVsKFwiZGl2XCIpO1xuXG5cdFx0bmV3IFNldHRpbmcoY2xhc3NGaWxlc1NldHRpbmdzQ29udGFpbmVyKVxuXHRcdFx0LnNldE5hbWUoJ2NsYXNzIEZpbGVzIHBhdGgnKVxuXHRcdFx0LnNldERlc2MoJ1BhdGggdG8gdGhlIGZpbGVzIGNvbnRhaW5pbmcgdGhlIGF1dGhvcml6ZWQgZmllbGRzIGZvciBhIHR5cGUgb2Ygbm90ZScpXG5cdFx0XHQuYWRkU2VhcmNoKChjZnMpID0+IHtcblx0XHRcdFx0bmV3IEZvbGRlclN1Z2dlc3QodGhpcy5wbHVnaW4sIGNmcy5pbnB1dEVsKTtcblx0XHRcdFx0Y2ZzLnNldFBsYWNlaG9sZGVyKFwiRm9sZGVyXCIpXG5cdFx0XHRcdFx0LnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmNsYXNzRmlsZXNQYXRoIHx8IFwiXCIpXG5cdFx0XHRcdFx0Lm9uQ2hhbmdlKChuZXdfZm9sZGVyKSA9PiB7XG5cdFx0XHRcdFx0XHRjb25zdCBuZXdQYXRoID0gbmV3X2ZvbGRlci5lbmRzV2l0aChcIi9cIikgfHwgIW5ld19mb2xkZXIgPyBuZXdfZm9sZGVyIDogbmV3X2ZvbGRlciArIFwiL1wiO1xuXHRcdFx0XHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MuY2xhc3NGaWxlc1BhdGggPSBuZXdQYXRoIHx8IG51bGw7XG5cdFx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcblx0XHRcdFx0XHR9KTtcblx0XHRcdFx0Ly8gQHRzLWlnbm9yZVxuXHRcdFx0XHRjZnMuY29udGFpbmVyRWwuYWRkQ2xhc3MoXCJtZXRhZGF0YS1tZW51LXNldHRpbmctZmlsZUNsYXNzLXNlYXJjaFwiKVxuXHRcdFx0fSk7XG5cblx0XHRuZXcgU2V0dGluZyhjbGFzc0ZpbGVzU2V0dGluZ3NDb250YWluZXIpXG5cdFx0XHQuc2V0TmFtZSgnZmlsZUNsYXNzIGZpZWxkIGFsaWFzJylcblx0XHRcdC5zZXREZXNjKCdDaG9vc2UgYW5vdGhlciBuYW1lIGZvciBmaWxlQ2xhc3MgZmllbGQgaW4gZnJvbnRtYXR0ZXIgKGV4YW1wbGU6IENhdGVnb3J5LCB0eXBlLCAuLi4nKVxuXHRcdFx0LmFkZFRleHQoKHRleHQpID0+IHtcblx0XHRcdFx0dGV4dFxuXHRcdFx0XHRcdC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5maWxlQ2xhc3NBbGlhcylcblx0XHRcdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG5cdFx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5maWxlQ2xhc3NBbGlhcyA9IHZhbHVlIHx8IFwiZmlsZUNsYXNzXCI7XG5cdFx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcblx0XHRcdFx0XHR9KTtcblx0XHRcdH0pO1xuXG5cdFx0LyogXG5cblx0XHQvKiBTZXQgZ2xvYmFsIGZpbGVDbGFzcyovXG5cdFx0bmV3IFNldHRpbmcoY2xhc3NGaWxlc1NldHRpbmdzQ29udGFpbmVyKVxuXHRcdFx0LnNldE5hbWUoJ2dsb2JhbCBmaWxlQ2xhc3MnKVxuXHRcdFx0LnNldERlc2MoJ0Nob29zZSBvbmUgZmlsZUNsYXNzIHRvIGJlIGFwcGxpY2FibGUgdG8gYWxsIGZpbGVzIChldmVuIGl0IGlzIG5vdCBwcmVzZW50IGFzIGEgZmlsZUNsYXNzIGF0dHJpYnV0ZSBpbiB0aGVpciBmcm9udG1hdHRlcikuIFRoaXMgd2lsbCBvdmVycmlkZSB0aGUgcHJlc2V0IEZpZWxkcyBkZWZpbmVkIGFib3ZlJylcblx0XHRcdC5hZGRTZWFyY2goKGNmcykgPT4ge1xuXHRcdFx0XHRuZXcgRmlsZVN1Z2dlc3QoXG5cdFx0XHRcdFx0Y2ZzLmlucHV0RWwsXG5cdFx0XHRcdFx0dGhpcy5wbHVnaW4sXG5cdFx0XHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MuY2xhc3NGaWxlc1BhdGggfHwgXCJcIlxuXHRcdFx0XHQpO1xuXHRcdFx0XHRjZnMuc2V0UGxhY2Vob2xkZXIoXCJHbG9iYWwgZmlsZUNsYXNzXCIpXG5cdFx0XHRcdGNmcy5zZXRWYWx1ZShcblx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5nbG9iYWxGaWxlQ2xhc3MgP1xuXHRcdFx0XHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MuY2xhc3NGaWxlc1BhdGggKyB0aGlzLnBsdWdpbi5zZXR0aW5ncy5nbG9iYWxGaWxlQ2xhc3MgKyBcIi5tZFwiIDpcblx0XHRcdFx0XHRcdFwiXCJcblx0XHRcdFx0KVxuXHRcdFx0XHRcdC5vbkNoYW5nZSgobmV3UGF0aCkgPT4ge1xuXHRcdFx0XHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MuZ2xvYmFsRmlsZUNsYXNzID0gbmV3UGF0aCA/XG5cdFx0XHRcdFx0XHRcdG5ld1BhdGguc3BsaXQoJ1xcXFwnKS5wb3AoKSEuc3BsaXQoJy8nKS5wb3AoKT8ucmVwbGFjZShcIi5tZFwiLCBcIlwiKSA6XG5cdFx0XHRcdFx0XHRcdFwiXCI7XG5cdFx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcblx0XHRcdFx0XHR9KTtcblx0XHRcdFx0Ly8gQHRzLWlnbm9yZVxuXHRcdFx0XHRjZnMuY29udGFpbmVyRWwuYWRkQ2xhc3MoXCJtZXRhZGF0YS1tZW51LXNldHRpbmctZmlsZUNsYXNzLXNlYXJjaFwiKVxuXHRcdFx0fSlcblxuXHRcdC8qIFxuXHRcdC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cdFx0TWFuYWdpbmcgcHJlZGVmaW5lZCBmaWxlQ2xhc3MgZm9yIHF1ZXJ5J3MgbWF0Y2hpbmcgZmlsZXMgXG5cdFx0LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblx0XHQqL1xuXHRcdC8qIEFkZCBuZXcgcXVlcnkgZm9yIHdoaWNoIG1hdGNoaW5nIGZpbGVzIHdpbGwgYmUgYXBwbGllZCB0aGUgZmlsZUNsYXNzKi9cblx0XHRjb25zdCBxdWVyeUZpbGVDbGFzc1NldHRpbmdzID0gY2xhc3NGaWxlc1NldHRpbmdzQ29udGFpbmVyLmNyZWF0ZUVsKFwiZGl2XCIpXG5cdFx0cXVlcnlGaWxlQ2xhc3NTZXR0aW5ncy5jcmVhdGVFbCgnaDQnLCB7IHRleHQ6ICdRdWVyeSBiYXNlZCBGaWxlQ2xhc3Mgc2V0dGluZ3MnLCBjbHM6IFwibWV0YWRhdGEtbWVudS1zZXR0aW5nLXNlY3Rpb24taGVhZGVyXCIgfSk7XG5cdFx0cXVlcnlGaWxlQ2xhc3NTZXR0aW5ncy5jcmVhdGVFbCgnZGl2Jywge1xuXHRcdFx0Y2xzOiBcInNldHRpbmctaXRlbS1kZXNjcmlwdGlvbiBtZXRhZGF0YS1tZW51LXNldHRpbmctc2VjdGlvbi1kZXNjXCIsXG5cdFx0XHR0ZXh0OiBcIk1hbmFnZSBnbG9iYWxseSBwcmVkZWZpbmVkIHR5cGUgYW5kIG9wdGlvbnMgZm9yIGEgZmllbGQgbWF0Y2hpbmcgdGhpcyBxdWVyeVwiXG5cdFx0fSlcblx0XHRuZXcgU2V0dGluZyhxdWVyeUZpbGVDbGFzc1NldHRpbmdzKVxuXHRcdFx0LnNldE5hbWUoXCJBZGQgTmV3IFF1ZXJ5IGZvciBmaWxlQ2xhc3NcIilcblx0XHRcdC5zZXREZXNjKFwiQWRkIGEgbmV3IHF1ZXJ5IGFuZCBhIEZpbGVDbGFzcyB0aGF0IHdpbGwgYXBwbHkgdG8gZmlsZXMgbWF0Y2hpbmcgdGhpcyBxdWVyeS5cIilcblx0XHRcdC5hZGRCdXR0b24oKGJ1dHRvbjogQnV0dG9uQ29tcG9uZW50KTogQnV0dG9uQ29tcG9uZW50ID0+IHtcblx0XHRcdFx0cmV0dXJuIGJ1dHRvblxuXHRcdFx0XHRcdC5zZXRUb29sdGlwKFwiQWRkIE5ldyBQcm9wZXJ0eSBNYW5hZ2VyXCIpXG5cdFx0XHRcdFx0LnNldEJ1dHRvblRleHQoXCIrXCIpXG5cdFx0XHRcdFx0Lm9uQ2xpY2soYXN5bmMgKCkgPT4ge1xuXHRcdFx0XHRcdFx0bGV0IG1vZGFsID0gbmV3IEZpbGVDbGFzc1F1ZXJ5U2V0dGluZ3NNb2RhbCh0aGlzLnBsdWdpbiwgcXVlcnlGaWxlQ2xhc3NTZXR0aW5ncyk7XG5cdFx0XHRcdFx0XHRtb2RhbC5vcGVuKCk7XG5cdFx0XHRcdFx0fSk7XG5cdFx0XHR9KTtcblxuXHRcdC8qIE1hbmFnZWQgcHJvcGVydGllcyB0aGF0IGN1cnJlbnRseSBoYXZlIHByZXNldCBvcHRpb25zICovXG5cdFx0dGhpcy5wbHVnaW4uaW5pdGlhbEZpbGVDbGFzc1F1ZXJpZXNcblx0XHRcdC5mb3JFYWNoKHF1ZXJ5ID0+IHtcblx0XHRcdFx0Y29uc3QgZmlsZUNsYXNzUXVlcnkgPSBuZXcgRmlsZUNsYXNzUXVlcnkoKTtcblx0XHRcdFx0T2JqZWN0LmFzc2lnbihmaWxlQ2xhc3NRdWVyeSwgcXVlcnkpO1xuXHRcdFx0XHRuZXcgRmlsZUNsYXNzUXVlcnlTZXR0aW5nKHF1ZXJ5RmlsZUNsYXNzU2V0dGluZ3MsIGZpbGVDbGFzc1F1ZXJ5LCB0aGlzLnBsdWdpbik7XG5cdFx0XHR9KTtcblxuXHRcdGNsYXNzRmlsZXNTZXR0aW5nc0NvbnRhaW5lci5pc1Nob3duKCkgP1xuXHRcdFx0c2V0SWNvbihjbGFzc0ZpbGVzU2V0dGluZ3NDb250YWluZXJTaG93QnV0dG9uLCBcImRvdWJsZS11cC1hcnJvdy1nbHlwaFwiKSA6XG5cdFx0XHRzZXRJY29uKGNsYXNzRmlsZXNTZXR0aW5nc0NvbnRhaW5lclNob3dCdXR0b24sIFwiZG91YmxlLWRvd24tYXJyb3ctZ2x5cGhcIik7XG5cdFx0Y2xhc3NGaWxlc1NldHRpbmdzQ29udGFpbmVyU2hvd0J1dHRvbi5vbmNsaWNrID0gKCkgPT4ge1xuXHRcdFx0Y2xhc3NGaWxlc1NldHRpbmdzQ29udGFpbmVyLmlzU2hvd24oKSA/XG5cdFx0XHRcdGNsYXNzRmlsZXNTZXR0aW5nc0NvbnRhaW5lci5oaWRlKCkgOlxuXHRcdFx0XHRjbGFzc0ZpbGVzU2V0dGluZ3NDb250YWluZXIuc2hvdygpO1xuXHRcdFx0Y2xhc3NGaWxlc1NldHRpbmdzQ29udGFpbmVyLmlzU2hvd24oKSA/XG5cdFx0XHRcdHNldEljb24oY2xhc3NGaWxlc1NldHRpbmdzQ29udGFpbmVyU2hvd0J1dHRvbiwgXCJkb3VibGUtdXAtYXJyb3ctZ2x5cGhcIikgOlxuXHRcdFx0XHRzZXRJY29uKGNsYXNzRmlsZXNTZXR0aW5nc0NvbnRhaW5lclNob3dCdXR0b24sIFwiZG91YmxlLWRvd24tYXJyb3ctZ2x5cGhcIik7XG5cdFx0fVxuXG5cdFx0LyogXG5cdFx0LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblx0XHRNaWdyYXRpb24gc2V0dGluZ3MgXG5cdFx0LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblx0XHQqL1xuXHRcdGNvbnN0IG1pZ3JhdGVTZXR0aW5ncyA9IGNvbnRhaW5lckVsLmNyZWF0ZUVsKFwiZGl2XCIpXG5cdFx0bWlncmF0ZVNldHRpbmdzLmNyZWF0ZUVsKCdoNCcsIHsgdGV4dDogJ01pZ3JhdGUnIH0pO1xuXG5cdFx0LyogQWRkIG5ldyBwcm9wZXJ0eSBmb3Igd2hpY2ggd2Ugd2FudCB0byBwcmVzZXQgb3B0aW9ucyovXG5cdFx0bmV3IFNldHRpbmcobWlncmF0ZVNldHRpbmdzKVxuXHRcdFx0LnNldE5hbWUoXCJDb3B5IHNldHRpbmdzIGZyb20gc3VwZXJjaGFyZ2VkIGxpbmtzIHBsdWdpblwiKVxuXHRcdFx0LnNldERlc2MoXCJDb3B5IHNldHRpbmdzIGZyb20gc3VwZXJjaGFyZ2VkIGxpbmtzIHBsdWdpblwiKVxuXHRcdFx0LmFkZEJ1dHRvbigoYnV0dG9uOiBCdXR0b25Db21wb25lbnQpOiBCdXR0b25Db21wb25lbnQgPT4ge1xuXHRcdFx0XHRyZXR1cm4gYnV0dG9uXG5cdFx0XHRcdFx0LnNldFRvb2x0aXAoXCJHZXQgc2V0dGluZ3MgZnJvbSBzdXBlcmNoYXJnZWQgbGlua3NcIilcblx0XHRcdFx0XHQuc2V0QnV0dG9uVGV4dChcIkNvcHlcIilcblx0XHRcdFx0XHQub25DbGljayhhc3luYyAoKSA9PiB7XG5cdFx0XHRcdFx0XHRsZXQgbW9kYWwgPSBuZXcgU2V0dGluZ3NNaWdyYXRpb25Db25maXJtTW9kYWwodGhpcy5wbHVnaW4sIHRoaXMpO1xuXHRcdFx0XHRcdFx0bW9kYWwub3BlbigpO1xuXHRcdFx0XHRcdH0pO1xuXHRcdFx0fSk7XG5cdH07XG59O1xuIiwgIi8vIENyZWRpdHMgZ28gdG8gTGlhbSdzIFBlcmlvZGljIE5vdGVzIFBsdWdpbjogaHR0cHM6Ly9naXRodWIuY29tL2xpYW1jYWluL29ic2lkaWFuLXBlcmlvZGljLW5vdGVzXG5cbmltcG9ydCBNZXRhZGF0YU1lbnUgZnJvbSBcIm1haW5cIjtcbmltcG9ydCB7IFRBYnN0cmFjdEZpbGUsIFRGb2xkZXIgfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCB7IFRleHRJbnB1dFN1Z2dlc3QgfSBmcm9tIFwiLi9zdWdnZXN0XCI7XG5cbmV4cG9ydCBjbGFzcyBGb2xkZXJTdWdnZXN0IGV4dGVuZHMgVGV4dElucHV0U3VnZ2VzdDxURm9sZGVyPiB7XG5cbiAgICBjb25zdHJ1Y3RvcihcbiAgICAgICAgcHJpdmF0ZSBwbHVnaW46IE1ldGFkYXRhTWVudSxcbiAgICAgICAgcHVibGljIGlucHV0RWw6IEhUTUxJbnB1dEVsZW1lbnQgfCBIVE1MVGV4dEFyZWFFbGVtZW50XG4gICAgKSB7XG4gICAgICAgIHN1cGVyKGlucHV0RWwpO1xuICAgIH1cblxuICAgIGdldFN1Z2dlc3Rpb25zKGlucHV0U3RyOiBzdHJpbmcpOiBURm9sZGVyW10ge1xuICAgICAgICBjb25zdCBhYnN0cmFjdEZpbGVzID0gdGhpcy5wbHVnaW4uYXBwLnZhdWx0LmdldEFsbExvYWRlZEZpbGVzKCk7XG4gICAgICAgIGNvbnN0IGZvbGRlcnM6IFRGb2xkZXJbXSA9IFtdO1xuICAgICAgICBjb25zdCBsb3dlckNhc2VJbnB1dFN0ciA9IGlucHV0U3RyLnRvTG93ZXJDYXNlKCk7XG5cbiAgICAgICAgYWJzdHJhY3RGaWxlcy5mb3JFYWNoKChmb2xkZXI6IFRBYnN0cmFjdEZpbGUpID0+IHtcbiAgICAgICAgICAgIGlmIChcbiAgICAgICAgICAgICAgICBmb2xkZXIgaW5zdGFuY2VvZiBURm9sZGVyICYmXG4gICAgICAgICAgICAgICAgZm9sZGVyLnBhdGgudG9Mb3dlckNhc2UoKS5jb250YWlucyhsb3dlckNhc2VJbnB1dFN0cilcbiAgICAgICAgICAgICkge1xuICAgICAgICAgICAgICAgIGZvbGRlcnMucHVzaChmb2xkZXIpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICByZXR1cm4gZm9sZGVycztcbiAgICB9XG5cbiAgICByZW5kZXJTdWdnZXN0aW9uKGZpbGU6IFRGb2xkZXIsIGVsOiBIVE1MRWxlbWVudCk6IHZvaWQge1xuICAgICAgICBlbC5zZXRUZXh0KGZpbGUucGF0aCk7XG4gICAgfVxuXG4gICAgc2VsZWN0U3VnZ2VzdGlvbihmaWxlOiBURm9sZGVyKTogdm9pZCB7XG4gICAgICAgIHRoaXMuaW5wdXRFbC52YWx1ZSA9IGZpbGUucGF0aDtcbiAgICAgICAgdGhpcy5pbnB1dEVsLnRyaWdnZXIoXCJpbnB1dFwiKTtcbiAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgIH1cbn1cbiIsICJpbXBvcnQgTWV0YWRhdGFNZW51IGZyb20gXCJtYWluXCI7XG5pbXBvcnQgeyBCdXR0b25Db21wb25lbnQsIERyb3Bkb3duQ29tcG9uZW50LCBFeHRyYUJ1dHRvbkNvbXBvbmVudCwgTW9kYWwsIFNldHRpbmcsIFRleHRBcmVhQ29tcG9uZW50LCBUZXh0Q29tcG9uZW50IH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgRmlsZUNsYXNzUXVlcnkgZnJvbSBcInNyYy9maWxlQ2xhc3MvRmlsZUNsYXNzUXVlcnlcIjtcbmltcG9ydCBGaWxlQ2xhc3NRdWVyeVNldHRpbmcgZnJvbSBcIi4vRmlsZUNsYXNzUXVlcnlTZXR0aW5nXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEZpbGVDbGFzc1F1ZXJ5U2V0dGluZ3NNb2RhbCBleHRlbmRzIE1vZGFsIHtcbiAgICBwcml2YXRlIHNhdmVkOiBib29sZWFuID0gZmFsc2U7XG4gICAgcHJpdmF0ZSBmaWxlQ2xhc3NRdWVyeTogRmlsZUNsYXNzUXVlcnk7XG4gICAgcHJpdmF0ZSBpbml0aWFsRmlsZUNsYXNzUXVlcnk6IEZpbGVDbGFzc1F1ZXJ5O1xuICAgIHByaXZhdGUgbmV3OiBib29sZWFuID0gdHJ1ZTtcblxuICAgIGNvbnN0cnVjdG9yKFxuICAgICAgICBwcml2YXRlIHBsdWdpbjogTWV0YWRhdGFNZW51LFxuICAgICAgICBwcml2YXRlIHBhcmVudFNldHRpbmdDb250YWluZXI6IEhUTUxFbGVtZW50LFxuICAgICAgICBwcml2YXRlIHBhcmVudFNldHRpbmc/OiBGaWxlQ2xhc3NRdWVyeVNldHRpbmcsXG4gICAgICAgIGZpbGVDbGFzc1F1ZXJ5PzogRmlsZUNsYXNzUXVlcnlcbiAgICApIHtcbiAgICAgICAgc3VwZXIocGx1Z2luLmFwcCk7XG4gICAgICAgIHRoaXMuaW5pdGlhbEZpbGVDbGFzc1F1ZXJ5ID0gbmV3IEZpbGVDbGFzc1F1ZXJ5KCk7XG4gICAgICAgIGlmIChmaWxlQ2xhc3NRdWVyeSkge1xuICAgICAgICAgICAgdGhpcy5uZXcgPSBmYWxzZTtcbiAgICAgICAgICAgIHRoaXMuZmlsZUNsYXNzUXVlcnkgPSBmaWxlQ2xhc3NRdWVyeTtcbiAgICAgICAgICAgIEZpbGVDbGFzc1F1ZXJ5LmNvcHlQcm9wZXJ0eSh0aGlzLmluaXRpYWxGaWxlQ2xhc3NRdWVyeSwgdGhpcy5maWxlQ2xhc3NRdWVyeSlcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGxldCBuZXdJZCA9IDE7XG4gICAgICAgICAgICB0aGlzLnBsdWdpbi5pbml0aWFsRmlsZUNsYXNzUXVlcmllcy5mb3JFYWNoKHByb3AgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChwYXJzZUludChwcm9wLmlkKSAmJiBwYXJzZUludChwcm9wLmlkKSA+PSBuZXdJZCkge1xuICAgICAgICAgICAgICAgICAgICBuZXdJZCA9IHBhcnNlSW50KHByb3AuaWQpICsgMTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB0aGlzLmZpbGVDbGFzc1F1ZXJ5ID0gbmV3IEZpbGVDbGFzc1F1ZXJ5KCk7XG4gICAgICAgICAgICB0aGlzLmZpbGVDbGFzc1F1ZXJ5LmlkID0gbmV3SWQudG9TdHJpbmcoKTtcbiAgICAgICAgICAgIHRoaXMuaW5pdGlhbEZpbGVDbGFzc1F1ZXJ5LmlkID0gbmV3SWQudG9TdHJpbmcoKTtcbiAgICAgICAgfTtcbiAgICB9O1xuXG4gICAgYXN5bmMgb25PcGVuKCk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICBpZiAodGhpcy5maWxlQ2xhc3NRdWVyeS5uYW1lID09IFwiXCIpIHtcbiAgICAgICAgICAgIHRoaXMudGl0bGVFbC5zZXRUZXh0KGBTZWxlY3QgYSBmaWxlQ2xhc3MgYW5kIGFkZCBhbiBhcHBsaWNhYmxlIHF1ZXJ5YCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLnRpdGxlRWwuc2V0VGV4dChgTWFuYWdlICR7dGhpcy5maWxlQ2xhc3NRdWVyeS5uYW1lfSBzZXR0aW5nc2ApO1xuICAgICAgICB9O1xuICAgICAgICBhd2FpdCB0aGlzLmNyZWF0ZUZvcm0oKTtcbiAgICB9O1xuXG4gICAgb25DbG9zZSgpOiB2b2lkIHtcbiAgICAgICAgT2JqZWN0LmFzc2lnbih0aGlzLmZpbGVDbGFzc1F1ZXJ5LCB0aGlzLmluaXRpYWxGaWxlQ2xhc3NRdWVyeSk7XG4gICAgICAgIGlmICghdGhpcy5uZXcgJiYgdGhpcy5wYXJlbnRTZXR0aW5nKSB7XG4gICAgICAgICAgICB0aGlzLnBhcmVudFNldHRpbmcuc2V0VGV4dENvbnRlbnRXaXRobmFtZSgpXG4gICAgICAgIH0gZWxzZSBpZiAodGhpcy5zYXZlZCkge1xuICAgICAgICAgICAgbmV3IEZpbGVDbGFzc1F1ZXJ5U2V0dGluZyh0aGlzLnBhcmVudFNldHRpbmdDb250YWluZXIsIHRoaXMuZmlsZUNsYXNzUXVlcnksIHRoaXMucGx1Z2luKTtcbiAgICAgICAgfTtcbiAgICB9O1xuXG4gICAgcHJpdmF0ZSBjcmVhdGVuYW1lSW5wdXRDb250YWluZXIocGFyZW50Tm9kZTogSFRNTERpdkVsZW1lbnQpOiBUZXh0Q29tcG9uZW50IHtcbiAgICAgICAgY29uc3QgZmlsZUNsYXNzUXVlcnlOYW1lQ29udGFpbmVyTGFiZWwgPSBwYXJlbnROb2RlLmNyZWF0ZURpdigpO1xuICAgICAgICBmaWxlQ2xhc3NRdWVyeU5hbWVDb250YWluZXJMYWJlbC5zZXRUZXh0KGBGaWxlQ2xhc3MgUXVlcnkgTmFtZTpgKTtcbiAgICAgICAgY29uc3QgaW5wdXQgPSBuZXcgVGV4dENvbXBvbmVudChwYXJlbnROb2RlKTtcbiAgICAgICAgY29uc3QgbmFtZSA9IHRoaXMuZmlsZUNsYXNzUXVlcnkubmFtZTtcbiAgICAgICAgaW5wdXQuc2V0VmFsdWUobmFtZSk7XG4gICAgICAgIGlucHV0LnNldFBsYWNlaG9sZGVyKFwiTmFtZSBvZiB0aGlzIGZpbGVDbGFzcyBxdWVyeVwiKTtcbiAgICAgICAgaW5wdXQub25DaGFuZ2UodmFsdWUgPT4ge1xuICAgICAgICAgICAgdGhpcy5maWxlQ2xhc3NRdWVyeS5uYW1lID0gdmFsdWU7XG4gICAgICAgICAgICB0aGlzLnRpdGxlRWwuc2V0VGV4dChgTWFuYWdlIG9wdGlvbnMgZm9yICR7dGhpcy5maWxlQ2xhc3NRdWVyeS5uYW1lfWApO1xuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIGlucHV0O1xuICAgIH07XG5cbiAgICBwcml2YXRlIGNyZWF0ZUZpbGVDbGFzc1NlbGVjdG9yQ29udGFpbmVyKHBhcmVudE5vZGU6IEhUTUxEaXZFbGVtZW50KTogdm9pZCB7XG4gICAgICAgIGNvbnN0IEZpbGVDbGFzc1NlbGVjdG9yQ29udGFpbmVyTGFiZWwgPSBwYXJlbnROb2RlLmNyZWF0ZURpdigpO1xuICAgICAgICBGaWxlQ2xhc3NTZWxlY3RvckNvbnRhaW5lckxhYmVsLnNldFRleHQoYEZpbGVjbGFzczpgKTtcbiAgICAgICAgY29uc3Qgc2VsZWN0ID0gbmV3IERyb3Bkb3duQ29tcG9uZW50KHBhcmVudE5vZGUpO1xuICAgICAgICBjb25zdCBmaWxlQ2xhc3NlcyA9IHRoaXMucGx1Z2luLmFwcC52YXVsdC5nZXRGaWxlcygpLmZpbHRlcihmID0+IHRoaXMucGx1Z2luLnNldHRpbmdzLmNsYXNzRmlsZXNQYXRoICYmIGYucGF0aC5zdGFydHNXaXRoKHRoaXMucGx1Z2luLnNldHRpbmdzLmNsYXNzRmlsZXNQYXRoKSlcbiAgICAgICAgc2VsZWN0LmFkZE9wdGlvbihcIi0tU2VsZWN0IGEgZmlsZUNsYXNzLS1cIiwgXCItLVNlbGVjdCBhIGZpbGVDbGFzcy0tXCIpXG4gICAgICAgIGZpbGVDbGFzc2VzLmZvckVhY2goZmlsZUNsYXNzID0+IHNlbGVjdC5hZGRPcHRpb24oZmlsZUNsYXNzLmJhc2VuYW1lLCBmaWxlQ2xhc3MuYmFzZW5hbWUpKVxuICAgICAgICBpZiAodGhpcy5maWxlQ2xhc3NRdWVyeS5maWxlQ2xhc3NOYW1lKSB7XG4gICAgICAgICAgICBzZWxlY3Quc2V0VmFsdWUodGhpcy5maWxlQ2xhc3NRdWVyeS5maWxlQ2xhc3NOYW1lKVxuICAgICAgICB9XG4gICAgICAgIHNlbGVjdC5vbkNoYW5nZSh2YWx1ZSA9PiB7XG4gICAgICAgICAgICBpZiAodmFsdWUgIT0gXCItLVNlbGVjdCBhIGZpbGVDbGFzcy0tXCIpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmZpbGVDbGFzc1F1ZXJ5LmZpbGVDbGFzc05hbWUgPSB2YWx1ZVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLmZpbGVDbGFzc1F1ZXJ5LmZpbGVDbGFzc05hbWUgPSBcIlwiXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pXG4gICAgfVxuXG4gICAgcHJpdmF0ZSBjcmVhdGVRdWVyeUlucHV0Q29udGFpbmVyKHBhcmVudE5vZGU6IEhUTUxEaXZFbGVtZW50KTogdm9pZCB7XG4gICAgICAgIGNvbnN0IHF1ZXJ5Q29udGFpbmVyTGFiZWwgPSBwYXJlbnROb2RlLmNyZWF0ZURpdigpO1xuICAgICAgICBxdWVyeUNvbnRhaW5lckxhYmVsLnNldFRleHQoXCJkYXRhdmlld0pTIHF1ZXJ5OlwiKVxuICAgICAgICBjb25zdCBxdWVyeVN0cmluZ0lucHV0ID0gbmV3IFRleHRBcmVhQ29tcG9uZW50KHBhcmVudE5vZGUpO1xuICAgICAgICBxdWVyeVN0cmluZ0lucHV0LnNldFZhbHVlKHRoaXMuZmlsZUNsYXNzUXVlcnkucXVlcnkpO1xuICAgICAgICBxdWVyeVN0cmluZ0lucHV0Lm9uQ2hhbmdlKHZhbHVlID0+IHRoaXMuZmlsZUNsYXNzUXVlcnkucXVlcnkgPSB2YWx1ZSlcbiAgICB9XG5cbiAgICBwcml2YXRlIGFzeW5jIGNyZWF0ZUZvcm0oKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIGNvbnN0IGRpdiA9IHRoaXMuY29udGVudEVsLmNyZWF0ZURpdih7IGNsczogXCJtZXRhZGF0YS1tZW51LXByb21wdC1kaXZcIiB9KTtcbiAgICAgICAgY29uc3QgbWFpbkRpdiA9IGRpdi5jcmVhdGVEaXYoeyBjbHM6IFwibWV0YWRhdGEtbWVudS1wcm9tcHQtZm9ybVwiIH0pO1xuXG4gICAgICAgIC8qIFNlY3Rpb25zICovXG4gICAgICAgIGNvbnN0IG5hbWVDb250YWluZXIgPSBtYWluRGl2LmNyZWF0ZURpdigpO1xuICAgICAgICB0aGlzLmNyZWF0ZW5hbWVJbnB1dENvbnRhaW5lcihuYW1lQ29udGFpbmVyKTtcbiAgICAgICAgbWFpbkRpdi5jcmVhdGVEaXYoeyBjbHM6ICdtZXRhZGF0YS1tZW51LXNlcGFyYXRvcicgfSkuY3JlYXRlRWwoXCJoclwiKTtcblxuICAgICAgICBjb25zdCBmaWxlQ2xhc3NTZWxlY3RDb250YWluZXIgPSBtYWluRGl2LmNyZWF0ZURpdigpXG5cbiAgICAgICAgLyogZm9vdGVyIGJ1dHRvbnMqL1xuICAgICAgICBjb25zdCBmb290ZXJFbCA9IHRoaXMuY29udGVudEVsLmNyZWF0ZURpdigpO1xuICAgICAgICBjb25zdCBmb290ZXJCdXR0b25zID0gbmV3IFNldHRpbmcoZm9vdGVyRWwpO1xuICAgICAgICBmb290ZXJCdXR0b25zLmFkZEJ1dHRvbigoYikgPT4gdGhpcy5jcmVhdGVTYXZlQnV0dG9uKGIpKTtcbiAgICAgICAgZm9vdGVyQnV0dG9ucy5hZGRFeHRyYUJ1dHRvbigoYikgPT4gdGhpcy5jcmVhdGVDYW5jZWxCdXR0b24oYikpO1xuXG4gICAgICAgIC8qIGluaXQgc3RhdGUgKi9cbiAgICAgICAgdGhpcy5jcmVhdGVGaWxlQ2xhc3NTZWxlY3RvckNvbnRhaW5lcihmaWxlQ2xhc3NTZWxlY3RDb250YWluZXIpXG4gICAgICAgIGNvbnN0IGZpbGVDbGFzc1F1ZXJ5Q29udGFpbmVyID0gbWFpbkRpdi5jcmVhdGVEaXYoKTtcbiAgICAgICAgdGhpcy5jcmVhdGVRdWVyeUlucHV0Q29udGFpbmVyKGZpbGVDbGFzc1F1ZXJ5Q29udGFpbmVyKTtcbiAgICB9O1xuXG4gICAgcHJpdmF0ZSBjcmVhdGVTYXZlQnV0dG9uKGI6IEJ1dHRvbkNvbXBvbmVudCk6IEJ1dHRvbkNvbXBvbmVudCB7XG4gICAgICAgIGIuc2V0VG9vbHRpcChcIlNhdmVcIik7XG4gICAgICAgIGIuc2V0SWNvbihcImNoZWNrbWFya1wiKTtcbiAgICAgICAgYi5vbkNsaWNrKGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIGlmICh0aGlzLmZpbGVDbGFzc1F1ZXJ5LmZpbGVDbGFzc05hbWUgJiYgdGhpcy5maWxlQ2xhc3NRdWVyeS5uYW1lICYmIHRoaXMuZmlsZUNsYXNzUXVlcnkucXVlcnkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNhdmVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBjb25zdCBjdXJyZW50RXhpc3RpbmdGaWxlQ2xhc3NRdWVyeSA9IHRoaXMucGx1Z2luLmluaXRpYWxGaWxlQ2xhc3NRdWVyaWVzLmZpbHRlcihwID0+IHAuaWQgPT0gdGhpcy5maWxlQ2xhc3NRdWVyeS5pZClbMF07XG4gICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRFeGlzdGluZ0ZpbGVDbGFzc1F1ZXJ5KSB7XG4gICAgICAgICAgICAgICAgICAgIEZpbGVDbGFzc1F1ZXJ5LmNvcHlQcm9wZXJ0eShjdXJyZW50RXhpc3RpbmdGaWxlQ2xhc3NRdWVyeSwgdGhpcy5maWxlQ2xhc3NRdWVyeSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uaW5pdGlhbEZpbGVDbGFzc1F1ZXJpZXMucHVzaCh0aGlzLmZpbGVDbGFzc1F1ZXJ5KTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIEZpbGVDbGFzc1F1ZXJ5LmNvcHlQcm9wZXJ0eSh0aGlzLmluaXRpYWxGaWxlQ2xhc3NRdWVyeSwgdGhpcy5maWxlQ2xhc3NRdWVyeSlcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5wYXJlbnRTZXR0aW5nKSBGaWxlQ2xhc3NRdWVyeS5jb3B5UHJvcGVydHkodGhpcy5wYXJlbnRTZXR0aW5nLmZpbGVDbGFzc1F1ZXJ5LCB0aGlzLmZpbGVDbGFzc1F1ZXJ5KTtcbiAgICAgICAgICAgICAgICB0aGlzLnBhcmVudFNldHRpbmc/LnNldFRleHRDb250ZW50V2l0aG5hbWUoKVxuICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBiO1xuICAgIH07XG5cbiAgICBwcml2YXRlIGNyZWF0ZUNhbmNlbEJ1dHRvbihiOiBFeHRyYUJ1dHRvbkNvbXBvbmVudCk6IEV4dHJhQnV0dG9uQ29tcG9uZW50IHtcbiAgICAgICAgYi5zZXRJY29uKFwiY3Jvc3NcIilcbiAgICAgICAgICAgIC5zZXRUb29sdGlwKFwiQ2FuY2VsXCIpXG4gICAgICAgICAgICAub25DbGljaygoKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5zYXZlZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIC8qIHJlc2V0IG9wdGlvbnMgZnJvbSBzZXR0aW5ncyAqL1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLmluaXRpYWxGaWxlQ2xhc3NRdWVyeS5uYW1lICE9IFwiXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgT2JqZWN0LmFzc2lnbih0aGlzLmZpbGVDbGFzc1F1ZXJ5LCB0aGlzLmluaXRpYWxGaWxlQ2xhc3NRdWVyeSk7XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIGI7XG4gICAgfTtcbn07IiwgImltcG9ydCB7IFNldHRpbmcgfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCBNZXRhZGF0YU1lbnUgZnJvbSBcIm1haW5cIjtcbmltcG9ydCBGaWxlQ2xhc3NRdWVyeSBmcm9tIFwic3JjL2ZpbGVDbGFzcy9GaWxlQ2xhc3NRdWVyeVwiO1xuaW1wb3J0IEZpbGVDbGFzc1F1ZXJ5U2V0dGluZ3NNb2RhbCBmcm9tIFwiLi9GaWxlQ2xhc3NRdWVyeVNldHRpbmdNb2RhbFwiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBGaWxlQ2xhc3NRdWVyeVNldHRpbmcgZXh0ZW5kcyBTZXR0aW5nIHtcbiAgICBwdWJsaWMgZmlsZUNsYXNzUXVlcnk6IEZpbGVDbGFzc1F1ZXJ5O1xuXG4gICAgY29uc3RydWN0b3IoXG4gICAgICAgIHByaXZhdGUgY29udGFpbmVyRWw6IEhUTUxFbGVtZW50LFxuICAgICAgICBwcm9wZXJ0eTogRmlsZUNsYXNzUXVlcnksXG4gICAgICAgIHByaXZhdGUgcGx1Z2luOiBNZXRhZGF0YU1lbnVcbiAgICApIHtcbiAgICAgICAgc3VwZXIoY29udGFpbmVyRWwpO1xuICAgICAgICB0aGlzLmZpbGVDbGFzc1F1ZXJ5ID0gcHJvcGVydHk7XG4gICAgICAgIHRoaXMuc2V0VGV4dENvbnRlbnRXaXRobmFtZSgpO1xuICAgICAgICB0aGlzLmFkZEVkaXRCdXR0b24oKTtcbiAgICAgICAgdGhpcy5hZGREZWxldGVCdXR0b24oKTtcbiAgICAgICAgdGhpcy5hZGRNb3ZlVXBCdXR0b24oKTtcbiAgICB9O1xuXG4gICAgcHVibGljIHNldFRleHRDb250ZW50V2l0aG5hbWUoKTogdm9pZCB7XG5cbiAgICAgICAgdGhpcy5pbmZvRWwudGV4dENvbnRlbnQgPSBcIlwiO1xuICAgICAgICB0aGlzLmluZm9FbC5hZGRDbGFzcyhcIm1ldGFkYXRhLW1lbnUtc2V0dGluZy1pdGVtXCIpXG4gICAgICAgIGNvbnN0IGZpbGVDbGFzc1F1ZXJ5Q29udGFpbmVyID0gdGhpcy5pbmZvRWwuY3JlYXRlRGl2KCk7XG5cbiAgICAgICAgY29uc3QgbmFtZUNvbnRhaW5lciA9IGZpbGVDbGFzc1F1ZXJ5Q29udGFpbmVyLmNyZWF0ZUVsKFwiZGl2XCIsIFwibWV0YWRhdGEtbWVudS1zZXR0aW5nLWl0ZW0tbmFtZVwiKVxuICAgICAgICBuYW1lQ29udGFpbmVyLmlubmVySFRNTCA9IGA8c3Ryb25nPiR7dGhpcy5maWxlQ2xhc3NRdWVyeS5uYW1lfTwvc3Ryb25nPmBcblxuICAgICAgICBjb25zdCBmaWxlQ2xhc3NOYW1lQ29udGFpbmVyID0gZmlsZUNsYXNzUXVlcnlDb250YWluZXIuY3JlYXRlRWwoXCJkaXZcIilcbiAgICAgICAgZmlsZUNsYXNzTmFtZUNvbnRhaW5lci5pbm5lckhUTUwgPSBgPHNwYW4+RmlsZUNsYXNzPC9zcGFuPiA6ICR7dGhpcy5maWxlQ2xhc3NRdWVyeS5maWxlQ2xhc3NOYW1lfWBcblxuICAgICAgICBjb25zdCBxdWVyeUNvbnRhaW5lciA9IGZpbGVDbGFzc1F1ZXJ5Q29udGFpbmVyLmNyZWF0ZUVsKFwiZGl2XCIpXG4gICAgICAgIHF1ZXJ5Q29udGFpbmVyLmlubmVySFRNTCA9IGA8c3Bhbj5RdWVyeTwvc3Bhbj4gOiAke3RoaXMuZmlsZUNsYXNzUXVlcnkucXVlcnl9YFxuXG4gICAgfTtcblxuICAgIHByaXZhdGUgYWRkRWRpdEJ1dHRvbigpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5hZGRCdXR0b24oKGIpID0+IHtcbiAgICAgICAgICAgIGIuc2V0SWNvbihcInBlbmNpbFwiKVxuICAgICAgICAgICAgICAgIC5zZXRUb29sdGlwKFwiRWRpdFwiKVxuICAgICAgICAgICAgICAgIC5vbkNsaWNrKCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgbGV0IG1vZGFsID0gbmV3IEZpbGVDbGFzc1F1ZXJ5U2V0dGluZ3NNb2RhbCh0aGlzLnBsdWdpbiwgdGhpcy5jb250YWluZXJFbCwgdGhpcywgdGhpcy5maWxlQ2xhc3NRdWVyeSk7XG4gICAgICAgICAgICAgICAgICAgIG1vZGFsLm9wZW4oKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfTtcblxuICAgIHByaXZhdGUgYWRkRGVsZXRlQnV0dG9uKCk6IHZvaWQge1xuICAgICAgICB0aGlzLmFkZEJ1dHRvbigoYikgPT4ge1xuICAgICAgICAgICAgYi5zZXRJY29uKFwidHJhc2hcIilcbiAgICAgICAgICAgICAgICAuc2V0VG9vbHRpcChcIkRlbGV0ZVwiKVxuICAgICAgICAgICAgICAgIC5vbkNsaWNrKCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgY3VycmVudEV4aXN0aW5nRmlsZUNsYXNzUXVlcnkgPSB0aGlzLnBsdWdpbi5pbml0aWFsRmlsZUNsYXNzUXVlcmllcy5maW5kKHAgPT4gcC5pZCA9PSB0aGlzLmZpbGVDbGFzc1F1ZXJ5LmlkKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRFeGlzdGluZ0ZpbGVDbGFzc1F1ZXJ5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5pbml0aWFsRmlsZUNsYXNzUXVlcmllcy5yZW1vdmUoY3VycmVudEV4aXN0aW5nRmlsZUNsYXNzUXVlcnkpO1xuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnNldHRpbmdFbC5wYXJlbnRFbGVtZW50Py5yZW1vdmVDaGlsZCh0aGlzLnNldHRpbmdFbCk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9O1xuXG4gICAgcHJpdmF0ZSBhZGRNb3ZlVXBCdXR0b24oKTogdm9pZCB7XG4gICAgICAgIHRoaXMuYWRkQnV0dG9uKChiKSA9PiB7XG4gICAgICAgICAgICBiLnNldEljb24oXCJ1cC1jaGV2cm9uLWdseXBoXCIpXG4gICAgICAgICAgICAgICAgLnNldFRvb2x0aXAoXCJNb3ZlIHVwIChsb3dlciBwcmlvcml0eSlcIilcbiAgICAgICAgICAgICAgICAub25DbGljaygoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGN1cnJlbnRGaWxlQ2xhc3NRdWVyeUluZGV4ID0gdGhpcy5wbHVnaW4uaW5pdGlhbEZpbGVDbGFzc1F1ZXJpZXMubWFwKGZjcSA9PiBmY3EuaWQpLmluZGV4T2YodGhpcy5maWxlQ2xhc3NRdWVyeS5pZCk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChjdXJyZW50RmlsZUNsYXNzUXVlcnlJbmRleCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY29udGFpbmVyRWwuaW5zZXJ0QmVmb3JlKHRoaXMuc2V0dGluZ0VsLCB0aGlzLnNldHRpbmdFbC5wcmV2aW91c0VsZW1lbnRTaWJsaW5nKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLmluaXRpYWxGaWxlQ2xhc3NRdWVyaWVzLnNwbGljZShjdXJyZW50RmlsZUNsYXNzUXVlcnlJbmRleCwgMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5pbml0aWFsRmlsZUNsYXNzUXVlcmllcy5zcGxpY2UoY3VycmVudEZpbGVDbGFzc1F1ZXJ5SW5kZXggLSAxLCAwLCB0aGlzLmZpbGVDbGFzc1F1ZXJ5KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgfSlcbiAgICB9XG59OyIsICJpbXBvcnQgTWV0YWRhdGFNZW51IGZyb20gXCJtYWluXCJcbmltcG9ydCBGaWVsZCBmcm9tIFwiLi4vZmllbGRzL0ZpZWxkXCJcbmltcG9ydCB7IEZpZWxkVHlwZSB9IGZyb20gXCJzcmMvdHlwZXMvZmllbGRUeXBlc1wiXG5pbXBvcnQgKiBhcyBzZWxlY3RWYWx1ZXNTb3VyY2UgZnJvbSBcIi4uL3R5cGVzL3NlbGVjdFZhbHVlc1NvdXJjZVR5cGVzXCJcblxuaW50ZXJmYWNlIFYxRmllbGQgZXh0ZW5kcyBGaWVsZCB7XG4gICAgaXNNdWx0aT86IGJvb2xlYW4sXG4gICAgaXNDeWNsZT86IGJvb2xlYW4sXG4gICAgaXNCb29sZWFuPzogYm9vbGVhbixcbiAgICB2YWx1ZXM/OiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+XG59XG5cbmludGVyZmFjZSBWMkZpZWxkIGV4dGVuZHMgRmllbGQge1xuICAgIHZhbHVlc0xpc3ROb3RlUGF0aD86IHN0cmluZ1xufVxuXG5leHBvcnQgY29uc3QgbWlncmF0ZVNldHRpbmdzVjF0b1YyID0gYXN5bmMgKHBsdWdpbjogTWV0YWRhdGFNZW51KSA9PiB7XG4gICAgY29uc3QgcHJlc2V0RmllbGRzID0gcGx1Z2luLnNldHRpbmdzLnByZXNldEZpZWxkc1xuICAgIHByZXNldEZpZWxkcy5mb3JFYWNoKChwOiBWMUZpZWxkKSA9PiB7XG4gICAgICAgIGlmICghT2JqZWN0LmtleXMocCkuY29udGFpbnMoXCJ0eXBlXCIpKSB7XG4gICAgICAgICAgICBpZiAocC5pc011bHRpKSBwLnR5cGUgPSBGaWVsZFR5cGUuTXVsdGlcbiAgICAgICAgICAgIGVsc2UgaWYgKHAuaXNDeWNsZSkgcC50eXBlID0gRmllbGRUeXBlLkN5Y2xlXG4gICAgICAgICAgICBlbHNlIGlmIChwLmlzQm9vbGVhbikgcC50eXBlID0gRmllbGRUeXBlLkJvb2xlYW5cbiAgICAgICAgICAgIGVsc2UgaWYgKHAub3B0aW9ucyAmJiBPYmplY3Qua2V5cyhwLm9wdGlvbnMpLmxlbmd0aCA+IDApIHAudHlwZSA9IEZpZWxkVHlwZS5TZWxlY3RcbiAgICAgICAgICAgIGVsc2UgcC50eXBlID0gRmllbGRUeXBlLklucHV0XG4gICAgICAgIH1cbiAgICAgICAgLy9lcmFzZSBpc011bHRpLCBpc0N5Y2xlLCBpc0Jvb2xlYW4gaWYgZXhpc3RzXG4gICAgICAgIGRlbGV0ZSBwLmlzTXVsdGk7XG4gICAgICAgIGRlbGV0ZSBwLmlzQ3ljbGU7XG4gICAgICAgIGRlbGV0ZSBwLmlzQm9vbGVhblxuICAgICAgICAvL3JlbmFtZSBcInZhbHVlc1wiIGluIFwib3B0aW9uXCJcbiAgICAgICAgaWYgKE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IocCwgXCJ2YWx1ZXNcIikgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHAsIFwib3B0aW9uc1wiLFxuICAgICAgICAgICAgICAgIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IocCwgXCJ2YWx1ZXNcIikhKTtcbiAgICAgICAgICAgIGRlbGV0ZSBwW1widmFsdWVzXCJdO1xuICAgICAgICB9XG4gICAgfSlcbiAgICBwbHVnaW4uc2V0dGluZ3Muc2V0dGluZ3NWZXJzaW9uID0gMlxuICAgIGF3YWl0IHBsdWdpbi5zYXZlRGF0YShwbHVnaW4uc2V0dGluZ3MpXG4gICAgY29uc29sZS5sb2coXCJNZXRhZGF0YSBtZW51IHNldHRpbmdzIG1pZ3JhdGVkIHRvIHZlcnNpb24gMlwiKVxufVxuXG5leHBvcnQgY29uc3QgbWlncmF0ZVNldHRpbmdzVjJ0b1YzID0gYXN5bmMgKHBsdWdpbjogTWV0YWRhdGFNZW51KSA9PiB7XG4gICAgY29uc3QgcHJlc2V0RmllbGRzID0gcGx1Z2luLnNldHRpbmdzLnByZXNldEZpZWxkc1xuICAgIHByZXNldEZpZWxkcy5mb3JFYWNoKChwOiBWMkZpZWxkKSA9PiB7XG4gICAgICAgIGlmIChbRmllbGRUeXBlLlNlbGVjdCwgRmllbGRUeXBlLk11bHRpXS5pbmNsdWRlcyhwLnR5cGUpKSB7XG4gICAgICAgICAgICAvL1N0ZXAwOiBtb2RpZnkgb3B0aW9ucyBmb3IgU2VsZWN0IGFuZCBNdWx0aVNlbGVjdFxuICAgICAgICAgICAgY29uc3QgY3VycmVudE9wdGlvbktleXMgPSBPYmplY3Qua2V5cyhwLm9wdGlvbnMpO1xuICAgICAgICAgICAgcC5vcHRpb25zLnZhbHVlc0xpc3QgPSB7fVxuICAgICAgICAgICAgY3VycmVudE9wdGlvbktleXMuZm9yRWFjaChrZXkgPT4gcC5vcHRpb25zLnZhbHVlc0xpc3Rba2V5XSA9IHAub3B0aW9uc1trZXldKVxuICAgICAgICAgICAgLy9TdGVwMTogc2V0IHRoZSB2YWx1ZXNTb3VyY2VUeXBlXG4gICAgICAgICAgICBpZiAocC52YWx1ZXNMaXN0Tm90ZVBhdGgpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBzZWxlY3RUeXBlID0gc2VsZWN0VmFsdWVzU291cmNlLlR5cGUuVmFsdWVzTGlzdE5vdGVQYXRoO1xuICAgICAgICAgICAgICAgIHAub3B0aW9ucy5zb3VyY2VUeXBlID0gc2VsZWN0VHlwZTtcbiAgICAgICAgICAgICAgICBwLm9wdGlvbnNbc2VsZWN0VmFsdWVzU291cmNlLktleVtzZWxlY3RUeXBlXV07XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHAub3B0aW9ucy5zb3VyY2VUeXBlID0gc2VsZWN0VmFsdWVzU291cmNlLlR5cGUuVmFsdWVzTGlzdFxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy9TdGVwMjogbW92ZSB2YWx1ZXNMaXN0Tm90ZVBhdGhcbiAgICAgICAgICAgIHAub3B0aW9ucy52YWx1ZXNMaXN0Tm90ZVBhdGggPSBwLnZhbHVlc0xpc3ROb3RlUGF0aFxuICAgICAgICAgICAgLy9TdGVwMzogZGVsZXRlIGxlZ2FjeSBvcHRpb25zXG4gICAgICAgICAgICBjdXJyZW50T3B0aW9uS2V5cy5mb3JFYWNoKGtleSA9PiBkZWxldGUgcC5vcHRpb25zW2tleV0pXG4gICAgICAgICAgICAvL1N0ZXA0OiBwb3B1bGF0ZSB2YWx1ZXNGcm9tRFZRdWVyeSBvcHRpb24gd2l0aCBlbXB0eSBzdHJpbmdcbiAgICAgICAgICAgIHAub3B0aW9ucy52YWx1ZXNGcm9tRFZRdWVyeSA9IFwiXCJcbiAgICAgICAgfVxuICAgICAgICBkZWxldGUgcC52YWx1ZXNMaXN0Tm90ZVBhdGhcbiAgICB9KVxuICAgIHBsdWdpbi5zZXR0aW5ncy5zZXR0aW5nc1ZlcnNpb24gPSAzXG4gICAgYXdhaXQgcGx1Z2luLnNhdmVEYXRhKHBsdWdpbi5zZXR0aW5ncylcbiAgICBjb25zb2xlLmxvZyhcIk1ldGFkYXRhIG1lbnUgc2V0dGluZ3MgbWlncmF0ZWQgdG8gdmVyc2lvbiAzXCIpXG59IiwgImltcG9ydCBNZXRhZGF0YU1lbnUgZnJvbSBcIm1haW5cIjtcbmltcG9ydCB7XG4gICAgRWRpdG9yLFxuICAgIEVkaXRvclBvc2l0aW9uLFxuICAgIEVkaXRvclN1Z2dlc3QsXG4gICAgRWRpdG9yU3VnZ2VzdENvbnRleHQsXG4gICAgRWRpdG9yU3VnZ2VzdFRyaWdnZXJJbmZvLFxuICAgIE1hcmtkb3duVmlldyxcbiAgICBURmlsZSxcbiAgICBwYXJzZVlhbWwsXG4gICAgTm90aWNlLFxufSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCB7IEZpZWxkTWFuYWdlciwgRmllbGRUeXBlIH0gZnJvbSBcInNyYy90eXBlcy9maWVsZFR5cGVzXCI7XG5pbXBvcnQgeyBnZW5lcmljRmllbGRSZWdleCwgZ2V0TGluZUZpZWxkcywgZW5jb2RlTGluayB9IGZyb20gXCIuLi91dGlscy9wYXJzZXJcIjtcbmltcG9ydCBGaWxlRmllbGQgZnJvbSBcInNyYy9maWVsZHMvZmllbGRNYW5hZ2Vycy9GaWxlRmllbGRcIjtcbmltcG9ydCBBYnN0cmFjdExpc3RCYXNlZEZpZWxkIGZyb20gXCJzcmMvZmllbGRzL2ZpZWxkTWFuYWdlcnMvQWJzdHJhY3RMaXN0QmFzZWRGaWVsZFwiO1xuaW1wb3J0IEZpZWxkIGZyb20gXCJzcmMvZmllbGRzL0ZpZWxkXCI7XG5cbmludGVyZmFjZSBJVmFsdWVDb21wbGV0aW9uIHtcbiAgICB2YWx1ZTogc3RyaW5nO1xufTtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgVmFsdWVTdWdnZXN0IGV4dGVuZHMgRWRpdG9yU3VnZ2VzdDxJVmFsdWVDb21wbGV0aW9uPiB7XG4gICAgcHJpdmF0ZSBwbHVnaW46IE1ldGFkYXRhTWVudTtcbiAgICBwcml2YXRlIGluRnJvbnRtYXR0ZXI6IGJvb2xlYW4gPSBmYWxzZTtcbiAgICBwcml2YXRlIGluRnVsbExpbmU6IGJvb2xlYW4gPSBmYWxzZTtcbiAgICBwcml2YXRlIGluU2VudGVuY2U6IGJvb2xlYW4gPSBmYWxzZTtcbiAgICBwcml2YXRlIGRpZFNlbGVjdDogYm9vbGVhbiA9IGZhbHNlO1xuICAgIHByaXZhdGUgZmllbGQ/OiBGaWVsZDtcblxuICAgIGNvbnN0cnVjdG9yKHBsdWdpbjogTWV0YWRhdGFNZW51KSB7XG4gICAgICAgIHN1cGVyKHBsdWdpbi5hcHApO1xuICAgICAgICB0aGlzLnBsdWdpbiA9IHBsdWdpbjtcbiAgICAgICAgdGhpcy5zZXRJbnN0cnVjdGlvbnMoW3sgY29tbWFuZDogXCJTaGlmdFwiLCBwdXJwb3NlOiBcInB1dCBhIHNwYWNlIGFmdGVyOjpcIiB9XSk7XG5cbiAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICB0aGlzLnNjb3BlLnJlZ2lzdGVyKFtcIlNoaWZ0XCJdLCBcIkVudGVyXCIsIChldnQ6IEtleWJvYXJkRXZlbnQpID0+IHtcbiAgICAgICAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgICAgICAgIHRoaXMuc3VnZ2VzdGlvbnMudXNlU2VsZWN0ZWRJdGVtKGV2dCk7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH0pO1xuICAgIH07XG5cbiAgICBvblRyaWdnZXIoXG4gICAgICAgIGN1cnNvcjogRWRpdG9yUG9zaXRpb24sXG4gICAgICAgIGVkaXRvcjogRWRpdG9yLFxuICAgICAgICBmaWxlOiBURmlsZVxuICAgICk6IEVkaXRvclN1Z2dlc3RUcmlnZ2VySW5mbyB8IG51bGwge1xuICAgICAgICBpZiAodGhpcy5kaWRTZWxlY3QpIHtcbiAgICAgICAgICAgIHRoaXMuZGlkU2VsZWN0ID0gZmFsc2VcbiAgICAgICAgICAgIHJldHVybiBudWxsXG4gICAgICAgIH1cbiAgICAgICAgaWYgKCF0aGlzLnBsdWdpbi5zZXR0aW5ncy5pc0F1dG9zdWdnZXN0RW5hYmxlZCkge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH07XG4gICAgICAgIGNvbnN0IGZyb250bWF0dGVyID0gdGhpcy5wbHVnaW4uYXBwLm1ldGFkYXRhQ2FjaGUuZ2V0RmlsZUNhY2hlKGZpbGUpPy5mcm9udG1hdHRlcjtcbiAgICAgICAgY29uc3QgZnVsbExpbmUgPSBlZGl0b3IuZ2V0TGluZShlZGl0b3IuZ2V0Q3Vyc29yKCkubGluZSlcbiAgICAgICAgdGhpcy5pbkZyb250bWF0dGVyID0gISFmcm9udG1hdHRlciAmJlxuICAgICAgICAgICAgZnJvbnRtYXR0ZXIucG9zaXRpb24uc3RhcnQubGluZSA8IGN1cnNvci5saW5lICYmXG4gICAgICAgICAgICBjdXJzb3IubGluZSA8IGZyb250bWF0dGVyLnBvc2l0aW9uLmVuZC5saW5lXG4gICAgICAgIGlmICh0aGlzLmluRnJvbnRtYXR0ZXIpIHtcbiAgICAgICAgICAgIGNvbnN0IHJlZ2V4ID0gbmV3IFJlZ0V4cChgXiR7Z2VuZXJpY0ZpZWxkUmVnZXh9Oig/PHZhbHVlcz4uKilgLCBcInVcIik7XG4gICAgICAgICAgICBpZiAoIXJlZ2V4LnRlc3QoZnVsbExpbmUpKSByZXR1cm4gbnVsbDtcbiAgICAgICAgfSBlbHNlIGlmIChnZXRMaW5lRmllbGRzKGZ1bGxMaW5lKS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBzdGFydDogY3Vyc29yLFxuICAgICAgICAgICAgZW5kOiBjdXJzb3IsXG4gICAgICAgICAgICBxdWVyeTogZWRpdG9yLmdldExpbmUoY3Vyc29yLmxpbmUpLFxuICAgICAgICB9O1xuICAgIH07XG5cbiAgICBwcml2YXRlIGZpbHRlck9wdGlvbiA9IChmaXJzdFZhbHVlczogc3RyaW5nW10gfCB1bmRlZmluZWQsIGxhc3RWYWx1ZTogc3RyaW5nIHwgdW5kZWZpbmVkLCBvcHRpb246IHN0cmluZyk6IGJvb2xlYW4gPT4ge1xuICAgICAgICByZXR1cm4gIWZpcnN0VmFsdWVzIHx8XG4gICAgICAgICAgICAhZmlyc3RWYWx1ZXM/LmNvbnRhaW5zKGVuY29kZUxpbmsob3B0aW9uKSkgJiYgKCFsYXN0VmFsdWUgfHxcbiAgICAgICAgICAgICAgICAhIWxhc3RWYWx1ZSAmJiBlbmNvZGVMaW5rKG9wdGlvbikuaW5jbHVkZXMobGFzdFZhbHVlKSlcbiAgICB9XG5cbiAgICBwcml2YXRlIGdldEFsaWFzKHRGaWxlOiBURmlsZSk6IHN0cmluZyB8IHVuZGVmaW5lZCB7XG4gICAgICAgIGNvbnN0IGR2QXBpID0gdGhpcy5wbHVnaW4uYXBwLnBsdWdpbnMucGx1Z2lucy5kYXRhdmlldz8uYXBpXG4gICAgICAgIGxldCBhbGlhczogc3RyaW5nIHwgdW5kZWZpbmVkID0gdW5kZWZpbmVkO1xuICAgICAgICBpZiAoZHZBcGkgJiYgdGhpcy5maWVsZD8ub3B0aW9ucy5jdXN0b21SZW5kZXJpbmcpIHtcbiAgICAgICAgICAgIGFsaWFzID0gbmV3IEZ1bmN0aW9uKFwicGFnZVwiLCBgcmV0dXJuICR7dGhpcy5maWVsZC5vcHRpb25zLmN1c3RvbVJlbmRlcmluZ31gKShkdkFwaS5wYWdlKHRGaWxlLnBhdGgpKVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBhbGlhc1xuICAgIH1cblxuICAgIGFzeW5jIGdldFN1Z2dlc3Rpb25zKGNvbnRleHQ6IEVkaXRvclN1Z2dlc3RDb250ZXh0KTogUHJvbWlzZTxJVmFsdWVDb21wbGV0aW9uW10+IHtcbiAgICAgICAgY29uc3Qgc3VnZ2VzdGlvbnMgPSBhd2FpdCB0aGlzLmdldFZhbHVlU3VnZ2VzdGlvbnMoY29udGV4dCk7XG4gICAgICAgIGlmIChzdWdnZXN0aW9ucy5sZW5ndGgpIHtcbiAgICAgICAgICAgIHJldHVybiBzdWdnZXN0aW9ucztcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gW107XG4gICAgfTtcblxuICAgIGFzeW5jIGdldFZhbHVlU3VnZ2VzdGlvbnMoY29udGV4dDogRWRpdG9yU3VnZ2VzdENvbnRleHQpOiBQcm9taXNlPElWYWx1ZUNvbXBsZXRpb25bXT4ge1xuICAgICAgICBjb25zdCBsaW5lTnVtYmVyID0gY29udGV4dC5zdGFydC5saW5lO1xuICAgICAgICBjb25zdCBtYXRjaEZpZWxkOiB7IGF0dHJpYnV0ZT86IHN0cmluZywgdmFsdWVzPzogc3RyaW5nIH0gPSB7IGF0dHJpYnV0ZTogdW5kZWZpbmVkLCB2YWx1ZXM6IFwiXCIgfVxuICAgICAgICBjb25zdCBkdkFwaSA9IHRoaXMucGx1Z2luLmFwcC5wbHVnaW5zLnBsdWdpbnMuZGF0YXZpZXc/LmFwaVxuICAgICAgICBpZiAoIXRoaXMuaW5Gcm9udG1hdHRlcikge1xuICAgICAgICAgICAgY29uc3QgbGluZUZpZWxkcyA9IGdldExpbmVGaWVsZHMoZW5jb2RlTGluayhjb250ZXh0LmVkaXRvci5nZXRMaW5lKGxpbmVOdW1iZXIpKSk7XG4gICAgICAgICAgICBjb25zdCBwb3NpdGlvbiA9IGNvbnRleHQuZWRpdG9yLmdldEN1cnNvcigpLmNoXG4gICAgICAgICAgICBjb25zdCBhY3RpdmVMaW5lRmllbGQgPSBsaW5lRmllbGRzLmZpbmQobGluZUZpZWxkID0+IGxpbmVGaWVsZC5pbmRleCA8PSBwb3NpdGlvbiAmJiBsaW5lRmllbGQuaW5kZXggKyBsaW5lRmllbGQubGVuZ3RoID49IHBvc2l0aW9uKVxuICAgICAgICAgICAgaWYgKGFjdGl2ZUxpbmVGaWVsZCkge1xuICAgICAgICAgICAgICAgIHRoaXMuaW5TZW50ZW5jZSA9IGFjdGl2ZUxpbmVGaWVsZC5pbmRleCA+IDA7XG4gICAgICAgICAgICAgICAgdGhpcy5pbkZ1bGxMaW5lID0gYWN0aXZlTGluZUZpZWxkLmluZGV4ID09PSAwO1xuICAgICAgICAgICAgICAgIG1hdGNoRmllbGQuYXR0cmlidXRlID0gYWN0aXZlTGluZUZpZWxkLmF0dHJpYnV0ZTtcbiAgICAgICAgICAgICAgICBtYXRjaEZpZWxkLnZhbHVlcyA9IGFjdGl2ZUxpbmVGaWVsZC52YWx1ZXM7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjb25zdCByZWdleCA9IG5ldyBSZWdFeHAoYF4ke2dlbmVyaWNGaWVsZFJlZ2V4fTooPzx2YWx1ZXM+LispP2AsIFwidVwiKTtcbiAgICAgICAgICAgIGNvbnN0IHJlZ2V4UmVzdWx0ID0gY29udGV4dC5lZGl0b3IuZ2V0UmFuZ2UoeyBsaW5lOiBsaW5lTnVtYmVyLCBjaDogMCB9LCBjb250ZXh0LmVuZCkubWF0Y2gocmVnZXgpO1xuICAgICAgICAgICAgaWYgKHJlZ2V4UmVzdWx0Py5ncm91cHMpIHtcbiAgICAgICAgICAgICAgICBtYXRjaEZpZWxkLmF0dHJpYnV0ZSA9IHJlZ2V4UmVzdWx0Lmdyb3Vwcy5hdHRyaWJ1dGU7XG4gICAgICAgICAgICAgICAgbWF0Y2hGaWVsZC52YWx1ZXMgPSByZWdleFJlc3VsdC5ncm91cHMudmFsdWVzO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuXG4gICAgICAgIGlmIChtYXRjaEZpZWxkLmF0dHJpYnV0ZSkge1xuICAgICAgICAgICAgY29uc3QgZmllbGROYW1lID0gbWF0Y2hGaWVsZC5hdHRyaWJ1dGU7XG4gICAgICAgICAgICB0aGlzLmZpZWxkID0gdGhpcy5wbHVnaW4uZmllbGRJbmRleC5maWxlc0ZpZWxkcy5nZXQoY29udGV4dC5maWxlLnBhdGgpPy5maW5kKGYgPT4gZi5uYW1lID09PSBmaWVsZE5hbWUpO1xuICAgICAgICAgICAgY29uc3QgdmFsdWVzTGlzdCA9IG1hdGNoRmllbGQudmFsdWVzPy5yZXBsYWNlKC9eXFxbfF5cXHNcXFt8XlxcKHxeXFxzXFwoLywgJycpXG4gICAgICAgICAgICAgICAgLnJlcGxhY2UoL1xcXSR8XFwpJC8sICcnKVxuICAgICAgICAgICAgICAgIC5zcGxpdChcIixcIikubWFwKG8gPT4gZW5jb2RlTGluayhvLnRyaW0oKSkpXG4gICAgICAgICAgICBjb25zdCBsYXN0VmFsdWUgPSB2YWx1ZXNMaXN0Py5sYXN0KClcbiAgICAgICAgICAgIGNvbnN0IGZpcnN0VmFsdWVzID0gdmFsdWVzTGlzdD8uc2xpY2UoMCwgLTEpXG4gICAgICAgICAgICAvL3RhZ3Mgc3BlY2lmaWMgY2FzZVxuICAgICAgICAgICAgaWYgKGZpZWxkTmFtZSA9PT0gXCJ0YWdzXCIgJiYgdGhpcy5pbkZyb250bWF0dGVyKSB7XG4gICAgICAgICAgICAgICAgLy9AdHMtaWdub3JlXG4gICAgICAgICAgICAgICAgcmV0dXJuIE9iamVjdC5rZXlzKHRoaXMucGx1Z2luLmFwcC5tZXRhZGF0YUNhY2hlLmdldFRhZ3MoKSlcbiAgICAgICAgICAgICAgICAgICAgLmZpbHRlcih0ID0+IGxhc3RWYWx1ZSA/IHQuY29udGFpbnMobGFzdFZhbHVlKSA6IHQpXG4gICAgICAgICAgICAgICAgICAgIC5zb3J0KClcbiAgICAgICAgICAgICAgICAgICAgLm1hcCh0YWcgPT4gT2JqZWN0KHsgdmFsdWU6IHRhZy5yZXBsYWNlKC9eIy8sIFwiXCIpIH0pKVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRoaXMuZmllbGQgJiYgW0ZpZWxkVHlwZS5DeWNsZSwgRmllbGRUeXBlLk11bHRpLCBGaWVsZFR5cGUuU2VsZWN0XS5jb250YWlucyh0aGlzLmZpZWxkLnR5cGUpKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgZmllbGRNYW5hZ2VyID0gbmV3IEZpZWxkTWFuYWdlclt0aGlzLmZpZWxkLnR5cGVdKHRoaXMucGx1Z2luLCB0aGlzLmZpZWxkKVxuXG4gICAgICAgICAgICAgICAgcmV0dXJuIChmaWVsZE1hbmFnZXIgYXMgQWJzdHJhY3RMaXN0QmFzZWRGaWVsZClcbiAgICAgICAgICAgICAgICAgICAgLmdldE9wdGlvbnNMaXN0KGR2QXBpLnBhZ2UodGhpcy5jb250ZXh0Py5maWxlLnBhdGgpKVxuICAgICAgICAgICAgICAgICAgICAuZmlsdGVyKG9wdGlvbiA9PiB0aGlzLmZpbHRlck9wdGlvbihmaXJzdFZhbHVlcywgbGFzdFZhbHVlLCBvcHRpb24pKVxuICAgICAgICAgICAgICAgICAgICAubWFwKF92YWx1ZSA9PiBPYmplY3QoeyB2YWx1ZTogX3ZhbHVlIH0pKVxuICAgICAgICAgICAgfSBlbHNlIGlmICh0aGlzLmZpZWxkICYmIFtGaWVsZFR5cGUuRmlsZSwgRmllbGRUeXBlLk11bHRpRmlsZV0uaW5jbHVkZXModGhpcy5maWVsZC50eXBlKSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGZpZWxkTWFuYWdlcjogRmlsZUZpZWxkID0gbmV3IEZpZWxkTWFuYWdlclt0aGlzLmZpZWxkLnR5cGVdKHRoaXMucGx1Z2luLCB0aGlzLmZpZWxkKVxuICAgICAgICAgICAgICAgIGNvbnN0IGZpbGVzID0gZmllbGRNYW5hZ2VyLmdldEZpbGVzKHRoaXMuY29udGV4dD8uZmlsZSk7XG4gICAgICAgICAgICAgICAgaWYgKGxhc3RWYWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmlsZXNcbiAgICAgICAgICAgICAgICAgICAgICAgIC5maWx0ZXIoZiA9PiBmLmJhc2VuYW1lLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMobGFzdFZhbHVlKSB8fCB0aGlzLmdldEFsaWFzKGYpPy50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKGxhc3RWYWx1ZSkpXG4gICAgICAgICAgICAgICAgICAgICAgICAubWFwKGYgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBPYmplY3QoeyB2YWx1ZTogRmlsZUZpZWxkLmJ1aWxkTWFya0Rvd25MaW5rKHRoaXMucGx1Z2luLCBjb250ZXh0LmZpbGUsIGYuYmFzZW5hbWUsIHRoaXMuZ2V0QWxpYXMoZikpIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmlsZXNcbiAgICAgICAgICAgICAgICAgICAgICAgIC5tYXAoZiA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGFsaWFzOiBzdHJpbmcgfCB1bmRlZmluZWQgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGR2QXBpICYmIHRoaXMuZmllbGQ/Lm9wdGlvbnMuY3VzdG9tUmVuZGVyaW5nKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFsaWFzID0gbmV3IEZ1bmN0aW9uKFwicGFnZVwiLCBgcmV0dXJuICR7dGhpcy5maWVsZC5vcHRpb25zLmN1c3RvbVJlbmRlcmluZ31gKShkdkFwaS5wYWdlKGYucGF0aCkpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBPYmplY3QoeyB2YWx1ZTogRmlsZUZpZWxkLmJ1aWxkTWFya0Rvd25MaW5rKHRoaXMucGx1Z2luLCBjb250ZXh0LmZpbGUsIGYuYmFzZW5hbWUsIGFsaWFzKSB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gW11cbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIFtdO1xuICAgIH07XG5cbiAgICByZW5kZXJTdWdnZXN0aW9uKHN1Z2dlc3Rpb246IElWYWx1ZUNvbXBsZXRpb24sIGVsOiBIVE1MRWxlbWVudCk6IHZvaWQge1xuICAgICAgICBjb25zdCBbcmF3VmFsdWUsIGFsaWFzXSA9IHN1Z2dlc3Rpb24udmFsdWUucmVwbGFjZSgvXlxcW1xcWy8sIFwiXCIpLnJlcGxhY2UoL1xcXVxcXSQvLCBcIlwiKS5zcGxpdChcInxcIilcbiAgICAgICAgY29uc3QgdGFyZ2V0RmlsZSA9IHRoaXMucGx1Z2luLmFwcC5tZXRhZGF0YUNhY2hlLmdldEZpcnN0TGlua3BhdGhEZXN0KHJhd1ZhbHVlLCB0aGlzLmNvbnRleHQhLmZpbGUucGF0aClcbiAgICAgICAgY29uc3QgZHZBcGkgPSB0aGlzLnBsdWdpbi5hcHAucGx1Z2lucy5wbHVnaW5zLmRhdGF2aWV3Py5hcGlcbiAgICAgICAgaWYgKGR2QXBpICYmIHRoaXMuZmllbGQgJiYgdGhpcy5maWVsZC5vcHRpb25zLmN1c3RvbVJlbmRlcmluZyAmJiB0YXJnZXRGaWxlKSB7XG4gICAgICAgICAgICBpZiAoYWxpYXMpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBzdWdnZXN0aW9uQ29udGFpbmVyID0gZWwuY3JlYXRlRGl2KHsgY2xzOiBcIm1ldGFkYXRhLW1lbnUtc3VnZ2VzdGVyLWl0ZW0td2l0aC1hbGlhc1wiIH0pO1xuICAgICAgICAgICAgICAgIGNvbnN0IGxhYmVsID0gc3VnZ2VzdGlvbkNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IFwibWV0YWRhdGEtbWVudS1zdWdnZXN0ZXItaXRlbS13aXRoLWFsaWFzLWxhYmVsXCIgfSlcbiAgICAgICAgICAgICAgICBsYWJlbC5zZXRUZXh0KGFsaWFzKVxuICAgICAgICAgICAgICAgIGNvbnN0IGZpbGVQYXRoID0gc3VnZ2VzdGlvbkNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IFwibWV0YWRhdGEtbWVudS1zdWdnZXN0ZXItaXRlbS13aXRoLWFsaWFzLWZpbGVwYXRoXCIgfSlcbiAgICAgICAgICAgICAgICBmaWxlUGF0aC5zZXRUZXh0KHJhd1ZhbHVlKVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBlbC5zZXRUZXh0KG5ldyBGdW5jdGlvbihcInBhZ2VcIiwgYHJldHVybiAke3RoaXMuZmllbGQub3B0aW9ucy5jdXN0b21SZW5kZXJpbmd9YCkoZHZBcGkucGFnZSh0YXJnZXRGaWxlLnBhdGgpKSlcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGVsLnNldFRleHQocmF3VmFsdWUpXG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgc2VsZWN0U3VnZ2VzdGlvbihzdWdnZXN0aW9uOiBJVmFsdWVDb21wbGV0aW9uLCBldmVudDogS2V5Ym9hcmRFdmVudCB8IE1vdXNlRXZlbnQpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgYWN0aXZlVmlldyA9IHRoaXMucGx1Z2luLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlVmlld09mVHlwZShNYXJrZG93blZpZXcpO1xuICAgICAgICBpZiAoIWFjdGl2ZVZpZXcpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfTtcbiAgICAgICAgY29uc3QgZWRpdG9yID0gYWN0aXZlVmlldy5lZGl0b3I7XG4gICAgICAgIGNvbnN0IGFjdGl2ZUxpbmUgPSBlZGl0b3IuZ2V0TGluZSh0aGlzLmNvbnRleHQhLnN0YXJ0LmxpbmUpO1xuXG4gICAgICAgIGlmICh0aGlzLmluRnJvbnRtYXR0ZXIpIHtcbiAgICAgICAgICAgIC8vZm9ybWF0IGxpc3QgaWYgaW4gZnJvbnRtYXR0ZXJcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgbGV0IHBhcnNlZEZpZWxkOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmcgfCBzdHJpbmdbXSB8IG51bGw+ID0gcGFyc2VZYW1sKGFjdGl2ZUxpbmUpXG4gICAgICAgICAgICAgICAgbGV0IFthdHRyLCBwYXN0VmFsdWVzXSA9IE9iamVjdC5lbnRyaWVzKHBhcnNlZEZpZWxkKVswXVxuICAgICAgICAgICAgICAgIGxldCBuZXdGaWVsZDogc3RyaW5nXG4gICAgICAgICAgICAgICAgaWYgKCFwYXN0VmFsdWVzKSB7XG4gICAgICAgICAgICAgICAgICAgIG5ld0ZpZWxkID0gYXR0ciArIFwiOiBcIiArIHN1Z2dlc3Rpb24udmFsdWU7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0eXBlb2YgcGFzdFZhbHVlcyA9PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgICAgICAgICBpZiAoIXBhc3RWYWx1ZXMuY29udGFpbnMoXCIsXCIpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBuZXdGaWVsZCA9IGF0dHIgKyBcIjogXCIgKyBzdWdnZXN0aW9uLnZhbHVlO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgbmV3RmllbGQgPSBhdHRyICsgXCI6IFtcIiArIHBhc3RWYWx1ZXMuc3BsaXQoXCIsXCIpLm1hcChvID0+IG8udHJpbSgpKS5zbGljZSgwLCAtMSkuam9pbignLCAnKSArIFwiLCBcIiArIHN1Z2dlc3Rpb24udmFsdWUgKyBcIl1cIjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoQXJyYXkuaXNBcnJheShwYXN0VmFsdWVzKSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoYWN0aXZlTGluZS5lbmRzV2l0aChcIixdXCIpIHx8IGFjdGl2ZUxpbmUuZW5kc1dpdGgoXCIsIF1cIikpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vdmFsdWUgY2FuIGJlIGRpcmVjdGx5IGFkZGVkIHNpbmNlIHBhcnNlWWFtbCB3b250IGNyZWF0ZSBhbiBlbXB0eSBsYXN0IGl0ZW0gaW4gcGFzdFZhbHVlc1xuICAgICAgICAgICAgICAgICAgICAgICAgbmV3RmllbGQgPSBhdHRyICsgXCI6IFtcIiArIFsuLi5wYXN0VmFsdWVzLCBzdWdnZXN0aW9uLnZhbHVlXS5qb2luKFwiLCBcIikgKyBcIl1cIjtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vd2UgaGF2ZSB0eXBlZCBzb21ldGhpbmcgdGhhdCB3ZSBhaHZlIHRvIHJlbW92ZSB0byByZXBsYWNlIHdpdGggc2VsZWN0ZWQgdmFsdWVcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ld0ZpZWxkID0gYXR0ciArIFwiOiBbXCIgKyBbLi4ucGFzdFZhbHVlcy5zbGljZSgwLCAtMSksIHN1Z2dlc3Rpb24udmFsdWVdLmpvaW4oXCIsIFwiKSArIFwiXVwiO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBuZXdGaWVsZCA9IGF0dHIgKyBcIjogW1wiICsgWy4uLnBhc3RWYWx1ZXNdLmpvaW4oXCIsIFwiKSArIFwiXVwiO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlZGl0b3IucmVwbGFjZVJhbmdlKG5ld0ZpZWxkLCB7IGxpbmU6IHRoaXMuY29udGV4dCEuc3RhcnQubGluZSwgY2g6IDAgfSwgeyBsaW5lOiB0aGlzLmNvbnRleHQhLnN0YXJ0LmxpbmUsIGNoOiBhY3RpdmVMaW5lLmxlbmd0aCB9KTtcbiAgICAgICAgICAgICAgICBpZiAoQXJyYXkuaXNBcnJheShwYXN0VmFsdWVzKSB8fCB0eXBlb2YgcGFzdFZhbHVlcyA9PT0gJ3N0cmluZycgJiYgcGFzdFZhbHVlcy5jb250YWlucyhcIixcIikpIHtcbiAgICAgICAgICAgICAgICAgICAgZWRpdG9yLnNldEN1cnNvcih7IGxpbmU6IHRoaXMuY29udGV4dCEuc3RhcnQubGluZSwgY2g6IG5ld0ZpZWxkLmxlbmd0aCAtIDEgfSlcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBlZGl0b3Iuc2V0Q3Vyc29yKHsgbGluZTogdGhpcy5jb250ZXh0IS5zdGFydC5saW5lLCBjaDogbmV3RmllbGQubGVuZ3RoIH0pXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICBuZXcgTm90aWNlKFwiRnJvbnRtYXR0ZXIgd3JvbmdseSBmb3JtYXR0ZWRcIiwgMjAwMClcbiAgICAgICAgICAgICAgICB0aGlzLmNsb3NlKClcbiAgICAgICAgICAgICAgICByZXR1cm5cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIGlmICh0aGlzLmluRnVsbExpbmUpIHtcbiAgICAgICAgICAgIGxldCBjbGVhbmVkTGluZSA9IGFjdGl2ZUxpbmVcbiAgICAgICAgICAgIHdoaWxlICghWycsJywgJzonXS5jb250YWlucyhjbGVhbmVkTGluZS5jaGFyQXQoY2xlYW5lZExpbmUubGVuZ3RoIC0gMSkpKSB7XG4gICAgICAgICAgICAgICAgY2xlYW5lZExpbmUgPSBjbGVhbmVkTGluZS5zbGljZSgwLCAtMSlcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVkaXRvci5yZXBsYWNlUmFuZ2UoYCR7Y2xlYW5lZExpbmV9JHtldmVudC5zaGlmdEtleSA/IFwiIFwiIDogXCJcIn1gICsgc3VnZ2VzdGlvbi52YWx1ZSxcbiAgICAgICAgICAgICAgICB7IGxpbmU6IHRoaXMuY29udGV4dCEuc3RhcnQubGluZSwgY2g6IDAgfSwgdGhpcy5jb250ZXh0IS5lbmQpO1xuICAgICAgICB9IGVsc2UgaWYgKHRoaXMuaW5TZW50ZW5jZSkge1xuICAgICAgICAgICAgY29uc3QgcG9zaXRpb24gPSB0aGlzLmNvbnRleHQ/LmVkaXRvci5nZXRDdXJzb3IoKS5jaCB8fCAwXG4gICAgICAgICAgICBsZXQgYmVmb3JlQ3Vyc29yID0gYWN0aXZlTGluZS5zbGljZSgwLCBwb3NpdGlvbilcbiAgICAgICAgICAgIGxldCBhZnRlckN1cnNvciA9IGFjdGl2ZUxpbmUuc2xpY2UocG9zaXRpb24pXG4gICAgICAgICAgICBsZXQgc2VwYXJhdG9yUG9zID0gcG9zaXRpb247XG4gICAgICAgICAgICBsZXQgY3VycmVudFZhbHVlTGVuZ3RoID0gMDtcbiAgICAgICAgICAgIHdoaWxlICghYmVmb3JlQ3Vyc29yLmVuZHNXaXRoKFwiOjpcIikgJiYgIWJlZm9yZUN1cnNvci5lbmRzV2l0aChcIixcIikgJiYgYmVmb3JlQ3Vyc29yLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIHNlcGFyYXRvclBvcyA9IHNlcGFyYXRvclBvcyAtIDE7XG4gICAgICAgICAgICAgICAgY3VycmVudFZhbHVlTGVuZ3RoID0gY3VycmVudFZhbHVlTGVuZ3RoICsgMVxuICAgICAgICAgICAgICAgIGJlZm9yZUN1cnNvciA9IGJlZm9yZUN1cnNvci5zbGljZSgwLCAtMSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBsZXQgbmV4dEJyYWNrZXRQb3MgPSBwb3NpdGlvbjtcbiAgICAgICAgICAgIHdoaWxlICghZW5jb2RlTGluayhhZnRlckN1cnNvcikubWF0Y2goXCIoXFxcXF18XFxcXCkpLipcIikgJiYgYWZ0ZXJDdXJzb3IubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgbmV4dEJyYWNrZXRQb3MgPSBuZXh0QnJhY2tldFBvcyArIDE7XG4gICAgICAgICAgICAgICAgYWZ0ZXJDdXJzb3IgPSBhZnRlckN1cnNvci5zbGljZShuZXh0QnJhY2tldFBvcyAtIHBvc2l0aW9uKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVkaXRvci5yZXBsYWNlUmFuZ2UoXG4gICAgICAgICAgICAgICAgc3VnZ2VzdGlvbi52YWx1ZSxcbiAgICAgICAgICAgICAgICB7IGxpbmU6IHRoaXMuY29udGV4dCEuc3RhcnQubGluZSwgY2g6IHNlcGFyYXRvclBvcyB9LFxuICAgICAgICAgICAgICAgIHsgbGluZTogdGhpcy5jb250ZXh0IS5zdGFydC5saW5lLCBjaDogbmV4dEJyYWNrZXRQb3MgfVxuICAgICAgICAgICAgKVxuICAgICAgICAgICAgZWRpdG9yLnNldEN1cnNvcih7IGxpbmU6IHRoaXMuY29udGV4dCEuc3RhcnQubGluZSwgY2g6IG5leHRCcmFja2V0UG9zIC0gY3VycmVudFZhbHVlTGVuZ3RoICsgc3VnZ2VzdGlvbi52YWx1ZS5sZW5ndGggfSlcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmRpZFNlbGVjdCA9IHRydWVcbiAgICAgICAgdGhpcy5jbG9zZSgpXG4gICAgfTtcbn07IiwgImltcG9ydCB7IENvbXBvbmVudCwgVEZpbGUgfSBmcm9tIFwib2JzaWRpYW5cIlxuaW1wb3J0IE1ldGFkYXRhTWVudSBmcm9tIFwibWFpblwiXG5pbXBvcnQgeyB2NCBhcyB1dWlkdjQgfSBmcm9tICd1dWlkJztcblxuXG5leHBvcnQgY2xhc3MgVGFzayB7XG4gICAgcHVibGljIHN0YXR1czogXCJwZW5kaW5nXCIgfCBcIm9uZ29pbmdcIiB8IFwiZG9uZVwiO1xuICAgIHB1YmxpYyBpZDogc3RyaW5nO1xuXG4gICAgY29uc3RydWN0b3IocHVibGljIGZuOiAoKSA9PiBhbnkpIHtcbiAgICAgICAgdGhpcy5zdGF0dXMgPSBcInBlbmRpbmdcIlxuICAgICAgICB0aGlzLmlkID0gdXVpZHY0KClcbiAgICB9XG59XG5cbmV4cG9ydCBjbGFzcyBGaWxlVGFza01hbmFnZXIgZXh0ZW5kcyBDb21wb25lbnQge1xuXG4gICAgcHVibGljIHF1ZXVlOiBNYXA8c3RyaW5nLCBUYXNrPjtcblxuICAgIGNvbnN0cnVjdG9yKHByaXZhdGUgcGx1Z2luOiBNZXRhZGF0YU1lbnUsIHB1YmxpYyBjYWNoZVZlcnNpb246IHN0cmluZywgcHVibGljIG9uQ2hhbmdlOiAoKSA9PiB2b2lkKSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIHRoaXMucXVldWUgPSBuZXcgTWFwKCk7XG4gICAgfVxuXG4gICAgYXN5bmMgb25sb2FkKCk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICB0aGlzLnBsdWdpbi5yZWdpc3RlckV2ZW50KHRoaXMucGx1Z2luLmFwcC5tZXRhZGF0YUNhY2hlLm9uKCdyZXNvbHZlZCcsIGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIC8vY29uc29sZS5sb2coXCJvYnNpZGlhbiByZXNvbHZlZFwiKVxuICAgICAgICAgICAgYXdhaXQgdGhpcy5leGVjdXRlTmV4dCgpO1xuICAgICAgICB9KSlcbiAgICB9XG5cbiAgICBwdWJsaWMgYXN5bmMgcHVzaFRhc2soZm46ICgpID0+IGFueSkge1xuICAgICAgICBjb25zdCB0YXNrID0gbmV3IFRhc2soZm4pO1xuICAgICAgICB0aGlzLnF1ZXVlLnNldCh0YXNrLmlkLCB0YXNrKTtcbiAgICAgICAgYXdhaXQgdGhpcy5leGVjdXRlTmV4dCgpO1xuICAgIH1cblxuICAgIHB1YmxpYyBhc3luYyBleGVjdXRlTmV4dCgpIHtcbiAgICAgICAgY29uc3QgW2ZpcnN0VGFza0luUXVldWVJZCwgZmlyc3RUYXNrSW5RdWV1ZV0gPSBbLi4udGhpcy5xdWV1ZV1bMF0gfHwgW3VuZGVmaW5lZCwgdW5kZWZpbmVkXVxuICAgICAgICBpZiAoZmlyc3RUYXNrSW5RdWV1ZSAmJiAhdGhpcy5wbHVnaW4uYXBwLm1ldGFkYXRhQ2FjaGUuaW5Qcm9ncmVzc1Rhc2tDb3VudCkge1xuICAgICAgICAgICAgZmlyc3RUYXNrSW5RdWV1ZS5zdGF0dXMgPSBcIm9uZ29pbmdcIlxuICAgICAgICAgICAgYXdhaXQgZmlyc3RUYXNrSW5RdWV1ZS5mbigpXG4gICAgICAgICAgICBmaXJzdFRhc2tJblF1ZXVlLnN0YXR1cyA9IFwiZG9uZVwiXG4gICAgICAgICAgICB0aGlzLnF1ZXVlLmRlbGV0ZShmaXJzdFRhc2tJblF1ZXVlSWQpXG4gICAgICAgICAgICAvL2NvbnNvbGUubG9nKFwiZG9uZTogXCIsIGZpcnN0VGFza0luUXVldWVJZClcbiAgICAgICAgICAgIC8vY29uc29sZS5sb2coXCJyZW1haW5pbmdcIiwgWy4uLnRoaXMucXVldWVdLmxlbmd0aClcbiAgICAgICAgfSBlbHNlIGlmICh0aGlzLnBsdWdpbi5hcHAubWV0YWRhdGFDYWNoZS5pblByb2dyZXNzVGFza0NvdW50KSB7XG4gICAgICAgICAgICAvL2NvbnNvbGUubG9nKGB3YWl0IC4uLiAke3RoaXMucGx1Z2luLmFwcC5tZXRhZGF0YUNhY2hlLmluUHJvZ3Jlc3NUYXNrQ291bnR9IHRhc2tzIGluIHByb2dyZXNzYClcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIC8vY29uc29sZS5sb2coXCJub3RoaW5nIGVsc2UgdG8gZG9cIilcbiAgICAgICAgfVxuICAgIH1cbn0iLCAiLy8gVW5pcXVlIElEIGNyZWF0aW9uIHJlcXVpcmVzIGEgaGlnaCBxdWFsaXR5IHJhbmRvbSAjIGdlbmVyYXRvci4gSW4gdGhlIGJyb3dzZXIgd2UgdGhlcmVmb3JlXG4vLyByZXF1aXJlIHRoZSBjcnlwdG8gQVBJIGFuZCBkbyBub3Qgc3VwcG9ydCBidWlsdC1pbiBmYWxsYmFjayB0byBsb3dlciBxdWFsaXR5IHJhbmRvbSBudW1iZXJcbi8vIGdlbmVyYXRvcnMgKGxpa2UgTWF0aC5yYW5kb20oKSkuXG5sZXQgZ2V0UmFuZG9tVmFsdWVzO1xuY29uc3Qgcm5kczggPSBuZXcgVWludDhBcnJheSgxNik7XG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBybmcoKSB7XG4gIC8vIGxhenkgbG9hZCBzbyB0aGF0IGVudmlyb25tZW50cyB0aGF0IG5lZWQgdG8gcG9seWZpbGwgaGF2ZSBhIGNoYW5jZSB0byBkbyBzb1xuICBpZiAoIWdldFJhbmRvbVZhbHVlcykge1xuICAgIC8vIGdldFJhbmRvbVZhbHVlcyBuZWVkcyB0byBiZSBpbnZva2VkIGluIGEgY29udGV4dCB3aGVyZSBcInRoaXNcIiBpcyBhIENyeXB0byBpbXBsZW1lbnRhdGlvbi5cbiAgICBnZXRSYW5kb21WYWx1ZXMgPSB0eXBlb2YgY3J5cHRvICE9PSAndW5kZWZpbmVkJyAmJiBjcnlwdG8uZ2V0UmFuZG9tVmFsdWVzICYmIGNyeXB0by5nZXRSYW5kb21WYWx1ZXMuYmluZChjcnlwdG8pO1xuXG4gICAgaWYgKCFnZXRSYW5kb21WYWx1ZXMpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignY3J5cHRvLmdldFJhbmRvbVZhbHVlcygpIG5vdCBzdXBwb3J0ZWQuIFNlZSBodHRwczovL2dpdGh1Yi5jb20vdXVpZGpzL3V1aWQjZ2V0cmFuZG9tdmFsdWVzLW5vdC1zdXBwb3J0ZWQnKTtcbiAgICB9XG4gIH1cblxuICByZXR1cm4gZ2V0UmFuZG9tVmFsdWVzKHJuZHM4KTtcbn0iLCAiaW1wb3J0IHZhbGlkYXRlIGZyb20gJy4vdmFsaWRhdGUuanMnO1xuLyoqXG4gKiBDb252ZXJ0IGFycmF5IG9mIDE2IGJ5dGUgdmFsdWVzIHRvIFVVSUQgc3RyaW5nIGZvcm1hdCBvZiB0aGUgZm9ybTpcbiAqIFhYWFhYWFhYLVhYWFgtWFhYWC1YWFhYLVhYWFhYWFhYWFhYWFxuICovXG5cbmNvbnN0IGJ5dGVUb0hleCA9IFtdO1xuXG5mb3IgKGxldCBpID0gMDsgaSA8IDI1NjsgKytpKSB7XG4gIGJ5dGVUb0hleC5wdXNoKChpICsgMHgxMDApLnRvU3RyaW5nKDE2KS5zbGljZSgxKSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiB1bnNhZmVTdHJpbmdpZnkoYXJyLCBvZmZzZXQgPSAwKSB7XG4gIC8vIE5vdGU6IEJlIGNhcmVmdWwgZWRpdGluZyB0aGlzIGNvZGUhICBJdCdzIGJlZW4gdHVuZWQgZm9yIHBlcmZvcm1hbmNlXG4gIC8vIGFuZCB3b3JrcyBpbiB3YXlzIHlvdSBtYXkgbm90IGV4cGVjdC4gU2VlIGh0dHBzOi8vZ2l0aHViLmNvbS91dWlkanMvdXVpZC9wdWxsLzQzNFxuICByZXR1cm4gKGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgMF1dICsgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyAxXV0gKyBieXRlVG9IZXhbYXJyW29mZnNldCArIDJdXSArIGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgM11dICsgJy0nICsgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyA0XV0gKyBieXRlVG9IZXhbYXJyW29mZnNldCArIDVdXSArICctJyArIGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgNl1dICsgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyA3XV0gKyAnLScgKyBieXRlVG9IZXhbYXJyW29mZnNldCArIDhdXSArIGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgOV1dICsgJy0nICsgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyAxMF1dICsgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyAxMV1dICsgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyAxMl1dICsgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyAxM11dICsgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyAxNF1dICsgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyAxNV1dKS50b0xvd2VyQ2FzZSgpO1xufVxuXG5mdW5jdGlvbiBzdHJpbmdpZnkoYXJyLCBvZmZzZXQgPSAwKSB7XG4gIGNvbnN0IHV1aWQgPSB1bnNhZmVTdHJpbmdpZnkoYXJyLCBvZmZzZXQpOyAvLyBDb25zaXN0ZW5jeSBjaGVjayBmb3IgdmFsaWQgVVVJRC4gIElmIHRoaXMgdGhyb3dzLCBpdCdzIGxpa2VseSBkdWUgdG8gb25lXG4gIC8vIG9mIHRoZSBmb2xsb3dpbmc6XG4gIC8vIC0gT25lIG9yIG1vcmUgaW5wdXQgYXJyYXkgdmFsdWVzIGRvbid0IG1hcCB0byBhIGhleCBvY3RldCAobGVhZGluZyB0b1xuICAvLyBcInVuZGVmaW5lZFwiIGluIHRoZSB1dWlkKVxuICAvLyAtIEludmFsaWQgaW5wdXQgdmFsdWVzIGZvciB0aGUgUkZDIGB2ZXJzaW9uYCBvciBgdmFyaWFudGAgZmllbGRzXG5cbiAgaWYgKCF2YWxpZGF0ZSh1dWlkKSkge1xuICAgIHRocm93IFR5cGVFcnJvcignU3RyaW5naWZpZWQgVVVJRCBpcyBpbnZhbGlkJyk7XG4gIH1cblxuICByZXR1cm4gdXVpZDtcbn1cblxuZXhwb3J0IGRlZmF1bHQgc3RyaW5naWZ5OyIsICJjb25zdCByYW5kb21VVUlEID0gdHlwZW9mIGNyeXB0byAhPT0gJ3VuZGVmaW5lZCcgJiYgY3J5cHRvLnJhbmRvbVVVSUQgJiYgY3J5cHRvLnJhbmRvbVVVSUQuYmluZChjcnlwdG8pO1xuZXhwb3J0IGRlZmF1bHQge1xuICByYW5kb21VVUlEXG59OyIsICJpbXBvcnQgbmF0aXZlIGZyb20gJy4vbmF0aXZlLmpzJztcbmltcG9ydCBybmcgZnJvbSAnLi9ybmcuanMnO1xuaW1wb3J0IHsgdW5zYWZlU3RyaW5naWZ5IH0gZnJvbSAnLi9zdHJpbmdpZnkuanMnO1xuXG5mdW5jdGlvbiB2NChvcHRpb25zLCBidWYsIG9mZnNldCkge1xuICBpZiAobmF0aXZlLnJhbmRvbVVVSUQgJiYgIWJ1ZiAmJiAhb3B0aW9ucykge1xuICAgIHJldHVybiBuYXRpdmUucmFuZG9tVVVJRCgpO1xuICB9XG5cbiAgb3B0aW9ucyA9IG9wdGlvbnMgfHwge307XG4gIGNvbnN0IHJuZHMgPSBvcHRpb25zLnJhbmRvbSB8fCAob3B0aW9ucy5ybmcgfHwgcm5nKSgpOyAvLyBQZXIgNC40LCBzZXQgYml0cyBmb3IgdmVyc2lvbiBhbmQgYGNsb2NrX3NlcV9oaV9hbmRfcmVzZXJ2ZWRgXG5cbiAgcm5kc1s2XSA9IHJuZHNbNl0gJiAweDBmIHwgMHg0MDtcbiAgcm5kc1s4XSA9IHJuZHNbOF0gJiAweDNmIHwgMHg4MDsgLy8gQ29weSBieXRlcyB0byBidWZmZXIsIGlmIHByb3ZpZGVkXG5cbiAgaWYgKGJ1Zikge1xuICAgIG9mZnNldCA9IG9mZnNldCB8fCAwO1xuXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCAxNjsgKytpKSB7XG4gICAgICBidWZbb2Zmc2V0ICsgaV0gPSBybmRzW2ldO1xuICAgIH1cblxuICAgIHJldHVybiBidWY7XG4gIH1cblxuICByZXR1cm4gdW5zYWZlU3RyaW5naWZ5KHJuZHMpO1xufVxuXG5leHBvcnQgZGVmYXVsdCB2NDsiXSwKICAibWFwcGluZ3MiOiAiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLHdCQUFvRTs7O0FDQ3BFLHVCQUF3RDs7O0FDQXhELHVCQUEyRjs7O0FDQTNGLHNCQUFvQztBQUVwQyxzQkFDSSxRQUNBLGdCQUNBLFdBQ0EsT0FDQSxZQUNBLGVBQ0EsUUFBaUIsTUFDSjtBQUFBO0FBWGpCO0FBWUksUUFBSTtBQUNKLFFBQUksMEJBQTBCLHVCQUFPO0FBQ2pDLGFBQU87QUFBQSxJQUNYLE9BQU87QUFDSCxZQUFNLFFBQVEsT0FBTyxJQUFJLE1BQU0sc0JBQXNCLGNBQWM7QUFDbkUsVUFBSSxpQkFBaUIseUJBQVMsTUFBTSxhQUFhLE1BQU07QUFDbkQsZUFBTztBQUFBLE1BQ1gsT0FBTztBQUNILGNBQU0sTUFBTSwwQ0FBMEM7QUFBQSxNQUMxRDtBQUFBLElBQ0o7QUFDQSxVQUFNLFNBQVMsTUFBTSxPQUFPLElBQUksTUFBTSxLQUFLLElBQUk7QUFDL0MsUUFBSSxhQUF1QixDQUFDO0FBRTVCLFdBQU8sTUFBTSxJQUFJLEVBQUUsUUFBUSxDQUFDLE1BQU0sZ0JBQWdCO0FBQzlDLFVBQUksZUFBZSxZQUFZO0FBQzNCLFlBQUk7QUFBTyxxQkFBVyxLQUFLLElBQUk7QUFDL0IsbUJBQVcsS0FBSyxH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
